!function(){function e(){return e="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,r,n){var i=t(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},e.apply(this,arguments)}function t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}function r(e){var t="function"==typeof Map?new Map:void 0;return r=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return n(e,arguments,m(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),d(i,e)},r(e)}function n(e,t,r){return n=b()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&d(i,r.prototype),i},n.apply(null,arguments)}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);a=!0);}catch(c){s=!0,i=c}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(e,t)||f(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach(function(t){c(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function s(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||f(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=f(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function f(e,t){if(e){if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */p=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(A){c=function(e,t,r){return e[t]=r}}function u(e,t,r,i){var o=t&&t.prototype instanceof h?t:h,a=Object.create(o.prototype),s=new O(i||[]);return n(a,"_invoke",{value:k(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(A){return{type:"throw",arg:A}}}e.wrap=u;var l={};function h(){}function d(){}function v(){}var g={};c(g,o,function(){return this});var y=Object.getPrototypeOf,b=y&&y(y(_([])));b&&b!==t&&r.call(b,o)&&(g=b);var m=v.prototype=h.prototype=Object.create(g);function w(e){["next","throw","return"].forEach(function(t){c(e,t,function(e){return this._invoke(t,e)})})}function x(e,t){function i(n,o,a,s){var c=f(e[n],e,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==typeof l&&r.call(l,"__await")?t.resolve(l.__await).then(function(e){i("next",e,a,s)},function(e){i("throw",e,a,s)}):t.resolve(l).then(function(e){u.value=e,a(u)},function(e){return i("throw",e,a,s)})}s(c.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t(function(t,n){i(e,r,t,n)})}return o=o?o.then(n,n):n()}})}function k(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return P()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=E(a,r);if(s){if(s===l)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=f(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function E(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var n=f(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,l;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function _(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:P}}function P(){return{value:void 0,done:!0}}return d.prototype=v,n(m,"constructor",{value:v,configurable:!0}),n(v,"constructor",{value:d,configurable:!0}),d.displayName=c(v,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,c(e,s,"GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},w(x.prototype),c(x.prototype,a,function(){return this}),e.AsyncIterator=x,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new x(u(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next()})},w(m),c(m,s,"Generator"),c(m,o,function(){return this}),c(m,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=_,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var s=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:_(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),l}},e}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function v(e){var t=b();return function(){var r,n=m(e);if(t){var i=m(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return g(this,r)}}function g(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return y(e)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function x(e,t,r){return t&&w(e.prototype,t),r&&w(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var E=Object.defineProperty,I=function(e,t,r){return function(e,t,r){t in e?E(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r}(e,"symbol"!=typeof t?t+"":t,r),r};(self.webpackChunkofb_dashboard=self.webpackChunkofb_dashboard||[]).push([[6202],{5158:function(e,t){"use strict";function r(){return(null==global?void 0:global.crypto)||(null==global?void 0:global.msCrypto)||{}}function n(){var e=r();return e.subtle||e.webkitSubtle}Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowserCryptoAvailable=t.getSubtleCrypto=t.getBrowerCrypto=void 0,t.getBrowerCrypto=r,t.getSubtleCrypto=n,t.isBrowserCryptoAvailable=function(){return!!r()&&!!n()}},69537:function(e,t){"use strict";function r(){return"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product}function n(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node}Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowser=t.isNode=t.isReactNative=void 0,t.isReactNative=r,t.isNode=n,t.isBrowser=function(){return!r()&&!n()}},38572:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(33172);n.__exportStar(r(5158),t),n.__exportStar(r(69537),t)},52399:function(e,t,r){"use strict";r.d(t,{q:function(){return n}});var n=x(function e(){k(this,e)})},59093:function(e,t,r){"use strict";r.d(t,{Lx:function(){return c},C$:function(){return u}});var n=r(8239),i=r(93105),o=r(14611),a=function(e){h(r,e);var t=v(r);function r(e){return k(this,r),t.call(this)}return x(r)}(r(52399).q),s=o.FIVE_SECONDS,c={pulse:"heartbeat_pulse"},u=function(e){h(r,e);var t=v(r);function r(e){var n;return k(this,r),(n=t.call(this,e)).events=new i.EventEmitter,n.interval=s,n.interval=(null==e?void 0:e.interval)||s,n}return x(r,[{key:"init",value:function(){var e=this;return(0,n.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.initialize();case 2:case"end":return t.stop()}},t)}))()}},{key:"stop",value:function(){clearInterval(this.intervalRef)}},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"once",value:function(e,t){this.events.once(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"removeListener",value:function(e,t){this.events.removeListener(e,t)}},{key:"initialize",value:function(){var e=this;return(0,n.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.intervalRef=setInterval(function(){return e.pulse()},(0,o.toMiliseconds)(e.interval));case 1:case"end":return t.stop()}},t)}))()}},{key:"pulse",value:function(){this.events.emit(c.pulse)}}],[{key:"init",value:function(e){return(0,n.Z)(p().mark(function t(){var n;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new r(e),t.next=3,n.init();case 3:return t.abrupt("return",n);case 4:case"end":return t.stop()}},t)}))()}}]),r}(a)},39330:function(e,t,r){"use strict";r.d(t,{k:function(){return E},Z:function(){return E}});var n=r(8239),i=r(93105),o=r(75630),a=r.n(o),s=r(80328),c=r(22339),f=Object.defineProperty,l=Object.defineProperties,h=Object.getOwnPropertyDescriptors,d=Object.getOwnPropertySymbols,v=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable,y=function(e,t,r){return t in e?f(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},b=function(e,t){for(var r in t||(t={}))v.call(t,r)&&y(e,r,t[r]);if(d){var n,i=u(d(t));try{for(i.s();!(n=i.n()).done;){r=n.value;g.call(t,r)&&y(e,r,t[r])}}catch(o){i.e(o)}finally{i.f()}}return e},m=function(e,t){return l(e,h(t))},w={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"},E=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(k(this,e),this.url=t,this.disableProviderPing=r,this.events=new i.EventEmitter,this.isAvailable=!1,this.registering=!1,!(0,c.isHttpUrl)(t))throw new Error("Provided URL is not compatible with HTTP connection: ".concat(t));this.url=t,this.disableProviderPing=r}return x(e,[{key:"connected",get:function(){return this.isAvailable}},{key:"connecting",get:function(){return this.registering}},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"once",value:function(e,t){this.events.once(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"removeListener",value:function(e,t){this.events.removeListener(e,t)}},{key:"open",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.url,t=this;return(0,n.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.register(e);case 2:case"end":return r.stop()}},r)}))()}},{key:"close",value:function(){var e=this;return(0,n.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isAvailable){t.next=2;break}throw new Error("Connection already closed");case 2:e.onClose();case 3:case"end":return t.stop()}},t)}))()}},{key:"send",value:function(e){var t=this;return(0,n.Z)(p().mark(function r(){var n,i;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=t.isAvailable,r.t0){r.next=4;break}return r.next=4,t.register();case 4:return r.prev=4,n=(0,s.u)(e),r.next=8,a()(t.url,m(b({},w),{body:n}));case 8:return r.next=10,r.sent.json();case 10:i=r.sent,t.onPayload({data:i}),r.next=17;break;case 14:r.prev=14,r.t1=r.catch(4),t.onError(e.id,r.t1);case 17:case"end":return r.stop()}},r,null,[[4,14]])}))()}},{key:"register",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.url,t=this;return(0,n.Z)(p().mark(function r(){var n,i,o;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if((0,c.isHttpUrl)(e)){r.next=2;break}throw new Error("Provided URL is not compatible with HTTP connection: ".concat(e));case 2:if(!t.registering){r.next=5;break}return n=t.events.getMaxListeners(),r.abrupt("return",((t.events.listenerCount("register_error")>=n||t.events.listenerCount("open")>=n)&&t.events.setMaxListeners(n+1),new Promise(function(e,r){t.events.once("register_error",function(e){t.resetMaxListeners(),r(e)}),t.events.once("open",function(){if(t.resetMaxListeners(),typeof t.isAvailable>"u")return r(new Error("HTTP connection is missing or invalid"));e()})})));case 5:if(t.url=e,t.registering=!0,r.prev=6,t.disableProviderPing){r.next=11;break}return i=(0,s.u)({id:1,jsonrpc:"2.0",method:"test",params:[]}),r.next=11,a()(e,m(b({},w),{body:i}));case 11:t.onOpen(),r.next=18;break;case 14:throw r.prev=14,r.t0=r.catch(6),o=t.parseError(r.t0),t.events.emit("register_error",o),t.onClose(),o;case 18:case"end":return r.stop()}},r,null,[[6,14]])}))()}},{key:"onOpen",value:function(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}},{key:"onClose",value:function(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}},{key:"onPayload",value:function(e){if(!(typeof e.data>"u")){var t="string"==typeof e.data?(0,s.D)(e.data):e.data;this.events.emit("payload",t)}}},{key:"onError",value:function(e,t){var r=this.parseError(t),n=r.message||r.toString(),i=(0,c.formatJsonRpcError)(e,n);this.events.emit("payload",i)}},{key:"parseError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.url;return(0,c.CX)(e,t,"HTTP")}},{key:"resetMaxListeners",value:function(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}}]),e}()},2517:function(e,t,r){"use strict";r.d(t,{r:function(){return a}});var n=r(8239),i=r(93105),o=r(22339),a=function(e){h(r,e);var t=v(r);function r(e){var n;return k(this,r),(n=t.call(this,e)).events=new i.EventEmitter,n.hasRegisteredEventListeners=!1,n.connection=n.setConnection(e),n.connection.connected&&n.registerEventListeners(),n}return x(r,[{key:"connect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.connection,t=this;return(0,n.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.open(e);case 2:case"end":return r.stop()}},r)}))()}},{key:"disconnect",value:function(){var e=this;return(0,n.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.close();case 2:case"end":return t.stop()}},t)}))()}},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"once",value:function(e,t){this.events.once(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"removeListener",value:function(e,t){this.events.removeListener(e,t)}},{key:"request",value:function(e,t){var r=this;return(0,n.Z)(p().mark(function n(){return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",r.requestStrict((0,o.formatJsonRpcRequest)(e.method,e.params||[],e.id||(0,o.getBigIntRpcId)().toString()),t));case 1:case"end":return n.stop()}},n)}))()}},{key:"requestStrict",value:function(e,t){var r=this;return(0,n.Z)(p().mark(function i(){return p().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",new Promise(function(){var i=(0,n.Z)(p().mark(function n(i,a){return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r.connection.connected){n.next=9;break}return n.prev=1,n.next=4,r.open();case 4:n.next=9;break;case 6:n.prev=6,n.t0=n.catch(1),a(n.t0);case 9:return r.events.on("".concat(e.id),function(e){(0,o.isJsonRpcError)(e)?a(e.error):i(e.result)}),n.prev=10,n.next=13,r.connection.send(e,t);case 13:n.next=18;break;case 15:n.prev=15,n.t1=n.catch(10),a(n.t1);case 18:case"end":return n.stop()}},n,null,[[1,6],[10,15]])}));return function(e,t){return i.apply(this,arguments)}}()));case 1:case"end":return i.stop()}},i)}))()}},{key:"setConnection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.connection;return e}},{key:"onPayload",value:function(e){this.events.emit("payload",e),(0,o.isJsonRpcResponse)(e)?this.events.emit("".concat(e.id),e):this.events.emit("message",{type:e.method,data:e.params})}},{key:"onClose",value:function(e){e&&3e3===e.code&&this.events.emit("error",new Error("WebSocket connection closed abnormally with code: ".concat(e.code," ").concat(e.reason?"(".concat(e.reason,")"):""))),this.events.emit("disconnect")}},{key:"open",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.connection,t=this;return(0,n.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=t.connection===e&&t.connection.connected,r.t0){r.next=13;break}if(t.connection.connected&&t.close(),r.t1="string"==typeof e,!r.t1){r.next=8;break}return r.next=7,t.connection.open(e);case 7:e=t.connection;case 8:return t.connection=t.setConnection(e),r.next=11,t.connection.open();case 11:t.registerEventListeners(),t.events.emit("connect");case 13:case"end":return r.stop()}},r)}))()}},{key:"close",value:function(){var e=this;return(0,n.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connection.close();case 2:case"end":return t.stop()}},t)}))()}},{key:"registerEventListeners",value:function(){var e=this;this.hasRegisteredEventListeners||(this.connection.on("payload",function(t){return e.onPayload(t)}),this.connection.on("close",function(t){return e.onClose(t)}),this.connection.on("error",function(t){return e.events.emit("error",t)}),this.connection.on("register_error",function(t){return e.onClose()}),this.hasRegisteredEventListeners=!0)}}]),r}(o.IJsonRpcProvider)},52885:function(e,t,r){"use strict";var n;r.d(t,{O4:function(){return i},CA:function(){return o},dQ:function(){return a},xK:function(){return s},JV:function(){return u}});var i="INTERNAL_ERROR",o="SERVER_ERROR",a=[-32700,-32600,-32601,-32602,-32603],s=(c(n={PARSE_ERROR:{code:-32700,message:"Parse error"},INVALID_REQUEST:{code:-32600,message:"Invalid Request"},METHOD_NOT_FOUND:{code:-32601,message:"Method not found"},INVALID_PARAMS:{code:-32602,message:"Invalid params"}},i,{code:-32603,message:"Internal error"}),c(n,o,{code:-32e3,message:"Server error"}),n),u=o},84275:function(e,t,r){"use strict";var n=r(38572);r.o(n,"IJsonRpcProvider")&&r.d(t,{IJsonRpcProvider:function(){return n.IJsonRpcProvider}}),r.o(n,"formatJsonRpcError")&&r.d(t,{formatJsonRpcError:function(){return n.formatJsonRpcError}}),r.o(n,"formatJsonRpcRequest")&&r.d(t,{formatJsonRpcRequest:function(){return n.formatJsonRpcRequest}}),r.o(n,"formatJsonRpcResult")&&r.d(t,{formatJsonRpcResult:function(){return n.formatJsonRpcResult}}),r.o(n,"getBigIntRpcId")&&r.d(t,{getBigIntRpcId:function(){return n.getBigIntRpcId}}),r.o(n,"isHttpUrl")&&r.d(t,{isHttpUrl:function(){return n.isHttpUrl}}),r.o(n,"isJsonRpcError")&&r.d(t,{isJsonRpcError:function(){return n.isJsonRpcError}}),r.o(n,"isJsonRpcRequest")&&r.d(t,{isJsonRpcRequest:function(){return n.isJsonRpcRequest}}),r.o(n,"isJsonRpcResponse")&&r.d(t,{isJsonRpcResponse:function(){return n.isJsonRpcResponse}}),r.o(n,"isJsonRpcResult")&&r.d(t,{isJsonRpcResult:function(){return n.isJsonRpcResult}}),r.o(n,"isLocalhostUrl")&&r.d(t,{isLocalhostUrl:function(){return n.isLocalhostUrl}}),r.o(n,"isReactNative")&&r.d(t,{isReactNative:function(){return n.isReactNative}}),r.o(n,"isWsUrl")&&r.d(t,{isWsUrl:function(){return n.isWsUrl}}),r.o(n,"payloadId")&&r.d(t,{payloadId:function(){return n.payloadId}})},93938:function(e,t,r){"use strict";r.d(t,{i5:function(){return i},by:function(){return o},L2:function(){return a},CX:function(){return s}});var n=r(52885);function i(e){return n.dQ.includes(e)}function o(e){return Object.keys(n.xK).includes(e)?n.xK[e]:n.xK[n.JV]}function a(e){return Object.values(n.xK).find(function(t){return t.code===e})||n.xK[n.JV]}function s(e,t,r){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error("Unavailable ".concat(r," RPC url at ").concat(t)):e}},90863:function(e,t,r){"use strict";r.d(t,{o0:function(){return o},CS:function(){return a},sT:function(){return s},tm:function(){return c},RI:function(){return u}});var n=r(93938),i=r(52885);function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;return Date.now()*Math.pow(10,e)+Math.floor(Math.random()*Math.pow(10,e))}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;return BigInt(o(e))}function s(e,t,r){return{id:r||o(),jsonrpc:"2.0",method:e,params:t}}function c(e,t){return{id:e,jsonrpc:"2.0",result:t}}function u(e,t,r){return{id:e,jsonrpc:"2.0",error:f(t,r)}}function f(e,t){return void 0===e?(0,n.by)(i.O4):("string"==typeof e&&(e=Object.assign(Object.assign({},(0,n.by)(i.CA)),{message:e})),void 0!==t&&(e.data=t),(0,n.i5)(e.code)&&(e=(0,n.L2)(e.code)),e)}},22339:function(e,t,r){"use strict";r.d(t,{CX:function(){return n.CX},formatJsonRpcError:function(){return o.RI},formatJsonRpcRequest:function(){return o.sT},formatJsonRpcResult:function(){return o.tm},getBigIntRpcId:function(){return o.CS},payloadId:function(){return o.o0},IJsonRpcProvider:function(){return a.x0},isHttpUrl:function(){return s.jK},isLocalhostUrl:function(){return s.JF},isWsUrl:function(){return s.UZ},isJsonRpcError:function(){return c.jg},isJsonRpcRequest:function(){return c.DW},isJsonRpcResponse:function(){return c.u},isJsonRpcResult:function(){return c.k4}}),r(52885);var n=r(93938),i=r(84275);r.o(i,"IJsonRpcProvider")&&r.d(t,{IJsonRpcProvider:function(){return i.IJsonRpcProvider}}),r.o(i,"formatJsonRpcError")&&r.d(t,{formatJsonRpcError:function(){return i.formatJsonRpcError}}),r.o(i,"formatJsonRpcRequest")&&r.d(t,{formatJsonRpcRequest:function(){return i.formatJsonRpcRequest}}),r.o(i,"formatJsonRpcResult")&&r.d(t,{formatJsonRpcResult:function(){return i.formatJsonRpcResult}}),r.o(i,"getBigIntRpcId")&&r.d(t,{getBigIntRpcId:function(){return i.getBigIntRpcId}}),r.o(i,"isHttpUrl")&&r.d(t,{isHttpUrl:function(){return i.isHttpUrl}}),r.o(i,"isJsonRpcError")&&r.d(t,{isJsonRpcError:function(){return i.isJsonRpcError}}),r.o(i,"isJsonRpcRequest")&&r.d(t,{isJsonRpcRequest:function(){return i.isJsonRpcRequest}}),r.o(i,"isJsonRpcResponse")&&r.d(t,{isJsonRpcResponse:function(){return i.isJsonRpcResponse}}),r.o(i,"isJsonRpcResult")&&r.d(t,{isJsonRpcResult:function(){return i.isJsonRpcResult}}),r.o(i,"isLocalhostUrl")&&r.d(t,{isLocalhostUrl:function(){return i.isLocalhostUrl}}),r.o(i,"isReactNative")&&r.d(t,{isReactNative:function(){return i.isReactNative}}),r.o(i,"isWsUrl")&&r.d(t,{isWsUrl:function(){return i.isWsUrl}}),r.o(i,"payloadId")&&r.d(t,{payloadId:function(){return i.payloadId}});var o=r(90863),a=r(12484),s=r(96796),c=r(9087)},12484:function(e,t,r){"use strict";r.d(t,{x0:function(){return n}});var n=function(e){h(r,e);var t=v(r);function r(e){return k(this,r),t.call(this)}return x(r)}(function(e){h(r,e);var t=v(r);function r(){return k(this,r),t.call(this)}return x(r)}(function(){return x(function e(){k(this,e)})}()))},96796:function(e,t,r){"use strict";function n(e,t){var r=function(e){var t=e.match(new RegExp(/^\w+:/,"gi"));if(t&&t.length)return t[0]}(e);return void 0!==r&&new RegExp(t).test(r)}function i(e){return n(e,"^https?:")}function o(e){return n(e,"^wss?:")}function a(e){return new RegExp("wss?://localhost(:d{2,5})?").test(e)}r.d(t,{jK:function(){return i},UZ:function(){return o},JF:function(){return a}})},9087:function(e,t,r){"use strict";function n(e){return"object"==typeof e&&"id"in e&&"jsonrpc"in e&&"2.0"===e.jsonrpc}function i(e){return n(e)&&"method"in e}function o(e){return n(e)&&(a(e)||s(e))}function a(e){return"result"in e}function s(e){return"error"in e}r.d(t,{DW:function(){return i},u:function(){return o},k4:function(){return a},jg:function(){return s}})},70213:function(e,t,r){"use strict";r.d(t,{Z:function(){return u}});var n=r(8239),i=r(93105),o=r(80328),a=r(22339),s=function(e){return e.split("?")[0]},c=typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:r(98164),u=function(){function e(t){if(k(this,e),this.url=t,this.events=new i.EventEmitter,this.registering=!1,!(0,a.isWsUrl)(t))throw new Error("Provided URL is not compatible with WebSocket connection: ".concat(t));this.url=t}return x(e,[{key:"connected",get:function(){return typeof this.socket<"u"}},{key:"connecting",get:function(){return this.registering}},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"once",value:function(e,t){this.events.once(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"removeListener",value:function(e,t){this.events.removeListener(e,t)}},{key:"open",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.url,t=this;return(0,n.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.register(e);case 2:case"end":return r.stop()}},r)}))()}},{key:"close",value:function(){var e=this;return(0,n.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t,r){typeof e.socket>"u"?r(new Error("Connection already closed")):(e.socket.onclose=function(r){e.onClose(r),t()},e.socket.close())}));case 1:case"end":return t.stop()}},t)}))()}},{key:"send",value:function(e){var t=this;return(0,n.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=typeof t.socket>"u",!r.t0){r.next=5;break}return r.next=4,t.register();case 4:t.socket=r.sent;case 5:try{t.socket.send((0,o.u)(e))}catch(n){t.onError(e.id,n)}case 6:case"end":return r.stop()}},r)}))()}},{key:"register",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.url;if(!(0,a.isWsUrl)(t))throw new Error("Provided URL is not compatible with WebSocket connection: ".concat(t));if(this.registering){var r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise(function(t,r){e.events.once("register_error",function(t){e.resetMaxListeners(),r(t)}),e.events.once("open",function(){if(e.resetMaxListeners(),typeof e.socket>"u")return r(new Error("WebSocket connection is missing or invalid"));t(e.socket)})})}return this.url=t,this.registering=!0,new Promise(function(r,n){var i=(0,a.isReactNative)()?void 0:{rejectUnauthorized:!(0,a.isLocalhostUrl)(t)},o=new c(t,[],i);typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u"?o.onerror=function(t){n(e.emitError(t.error))}:o.on("error",function(t){n(e.emitError(t))}),o.onopen=function(){e.onOpen(o),r(o)}})}},{key:"onOpen",value:function(e){var t=this;e.onmessage=function(e){return t.onPayload(e)},e.onclose=function(e){return t.onClose(e)},this.socket=e,this.registering=!1,this.events.emit("open")}},{key:"onClose",value:function(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}},{key:"onPayload",value:function(e){if(!(typeof e.data>"u")){var t="string"==typeof e.data?(0,o.D)(e.data):e.data;this.events.emit("payload",t)}}},{key:"onError",value:function(e,t){var r=this.parseError(t),n=r.message||r.toString(),i=(0,a.formatJsonRpcError)(e,n);this.events.emit("payload",i)}},{key:"parseError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.url;return(0,a.CX)(e,s(t),"WS")}},{key:"resetMaxListeners",value:function(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}},{key:"emitError",value:function(e){var t=this.parseError(new Error((null==e?void 0:e.message)||"WebSocket connection failed for host: ".concat(s(this.url))));return this.events.emit("register_error",t),t}}]),e}()},98164:function(e){"use strict";e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},39927:function(e,t,r){"use strict";r.d(t,{Z:function(){return q}});var n=r(8239),i=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,o=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,c=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function f(e,t){if(!("__proto__"===e||"constructor"===e&&t&&"object"==typeof t&&"prototype"in t))return t;!function(e){console.warn('[destr] Dropping "'.concat(e,'" key to prevent prototype pollution.'))}(e)}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"!=typeof e)return e;if('"'===e[0]&&'"'===e[e.length-1]&&-1===e.indexOf("\\"))return e.slice(1,-1);var r=e.trim();if(r.length<=9)switch(r.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!c.test(e)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return e}try{if(i.test(e)||o.test(e)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(e,f)}return JSON.parse(e)}catch(n){if(t.strict)throw n;return e}}function h(e){try{for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(e){return e&&"function"==typeof e.then?e:Promise.resolve(e)}(e.apply(void 0,r))}catch(i){return Promise.reject(i)}}function d(e){if(function(e){var t=typeof e;return null===e||"object"!==t&&"function"!==t}(e))return String(e);if(function(e){var t=Object.getPrototypeOf(e);return!t||t.isPrototypeOf(Object)}(e)||Array.isArray(e))return JSON.stringify(e);if("function"==typeof e.toJSON)return d(e.toJSON());throw new Error("[unstorage] Cannot stringify value!")}var v="base64:";function g(e){var t;return e&&(null===(t=e.split("?")[0])||void 0===t?void 0:t.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function y(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return g(t.join(":"))}function b(e){return(e=g(e))?e+":":""}var m,w=function(){var e=new Map;return{name:"memory",getInstance:function(){return e},hasItem:function(t){return e.has(t)},getItem:function(t){var r;return null!==(r=e.get(t))&&void 0!==r?r:null},getItemRaw:function(t){var r;return null!==(r=e.get(t))&&void 0!==r?r:null},setItem:function(t,r){e.set(t,r)},setItemRaw:function(t,r){e.set(t,r)},removeItem:function(t){e.delete(t)},getKeys:function(){return s(e.keys())},clear:function(){e.clear()},dispose:function(){e.clear()}}};function E(e,t,r){return e.watch?e.watch(function(e,n){return t(e,r+n)}):function(){}}function I(e){return S.apply(this,arguments)}function S(){return(S=(0,n.Z)(p().mark(function e(t){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0="function"==typeof t.dispose,!e.t0){e.next=4;break}return e.next=4,h(t.dispose);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function O(e){return new Promise(function(t,r){e.oncomplete=e.onsuccess=function(){return t(e.result)},e.onabort=e.onerror=function(){return r(e.error)}})}function _(e,t){var r=indexedDB.open(e);r.onupgradeneeded=function(){return r.result.createObjectStore(t)};var n=O(r);return function(e,r){return n.then(function(n){return r(n.transaction(t,e).objectStore(t))})}}function P(){return m||(m=_("keyval-store","keyval")),m}function A(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P();return t("readonly",function(t){return O(t.get(e))})}var R=r(80328),T=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.base&&t.base.length>0?"".concat(t.base,":"):"",i=function(e){return r+e};return t.dbName&&t.storeName&&(e=_(t.dbName,t.storeName)),{name:"idb-keyval",options:t,hasItem:function(t){return(0,n.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,A(i(t),e);case 2:return r.t0=typeof r.sent,r.abrupt("return",!(r.t0>"u"));case 4:case"end":return r.stop()}},r)}))()},getItem:function(t){return(0,n.Z)(p().mark(function r(){var n;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,A(i(t),e);case 2:if(r.t1=n=r.sent,r.t0=null!==r.t1,!r.t0){r.next=6;break}r.t0=void 0!==n;case 6:if(!r.t0){r.next=10;break}r.t2=n,r.next=11;break;case 10:r.t2=null;case 11:return r.abrupt("return",r.t2);case 12:case"end":return r.stop()}},r)}))()},setItem:function(t,r){return function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:P();return r("readwrite",function(r){return r.put(t,e),O(r.transaction)})}(i(t),r,e)},removeItem:function(t){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P();return t("readwrite",function(t){return t.delete(e),O(t.transaction)})}(i(t),e)},getKeys:function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P();return e("readonly",function(e){if(e.getAllKeys)return O(e.getAllKeys());var t=[];return function(e,r){return e.openCursor().onsuccess=function(){!this.result||(function(e){t.push(e.key)}(this.result),this.result.continue())},O(e.transaction)}(e).then(function(){return t})})}(e)},clear:function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P();return e("readwrite",function(e){return e.clear(),O(e.transaction)})}(e)}}},B=function(){function e(){k(this,e),this.indexedDb=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r={mounts:{"":t.driver||w()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},i=function(e){var t,n=u(r.mountpoints);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(e.startsWith(i))return{base:i,relativeKey:e.slice(i.length),driver:r.mounts[i]}}}catch(o){n.e(o)}finally{n.f()}return{base:"",relativeKey:e,driver:r.mounts[""]}},o=function(e,t){return r.mountpoints.filter(function(r){return r.startsWith(e)||t&&e.startsWith(r)}).map(function(t){return{relativeBase:e.length>t.length?e.slice(t.length):void 0,mountpoint:t,driver:r.mounts[t]}})},c=function(e,t){if(r.watching){t=g(t);var n,i=u(r.watchListeners);try{for(i.s();!(n=i.n()).done;){(0,n.value)(e,t)}}catch(o){i.e(o)}finally{i.f()}}},f=(e=(0,n.Z)(p().mark(function e(){var t;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r.watching){e.next=10;break}r.watching=!0,e.t0=p().keys(r.mounts);case 3:if((e.t1=e.t0()).done){e.next=10;break}return t=e.t1.value,e.next=7,E(r.mounts[t],c,t);case 7:r.unwatch[t]=e.sent,e.next=3;break;case 10:case"end":return e.stop()}},e)})),function(){return e.apply(this,arguments)}),m=function(){var e=(0,n.Z)(p().mark(function e(){var t;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.watching){e.next=9;break}e.t0=p().keys(r.unwatch);case 2:if((e.t1=e.t0()).done){e.next=8;break}return t=e.t1.value,e.next=6,r.unwatch[t]();case 6:e.next=2;break;case 8:r.unwatch={},r.watching=!1;case 9:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),x=function(e,t,r){var n,o=new Map,c=function(e){var t=o.get(e.base);return t||(t={driver:e.driver,base:e.base,items:[]},o.set(e.base,t)),t},f=u(e);try{for(f.s();!(n=f.n()).done;){var l=n.value,p="string"==typeof l,h=g(p?l:l.key),d=p?void 0:l.value,v=p||!l.options?t:a(a({},t),l.options),y=i(h);c(y).items.push({key:h,value:d,relativeKey:y.relativeKey,options:v})}}catch(b){f.e(b)}finally{f.f()}return Promise.all(s(o.values()).map(function(e){return r(e)})).then(function(e){return e.flat()})},k={hasItem:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=g(e);var r=i(e),n=r.relativeKey,o=r.driver;return h(o.hasItem,n,t)},getItem:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=g(e);var r=i(e),n=r.relativeKey,o=r.driver;return h(o.getItem,n,t).then(function(e){return l(e)})},getItems:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return x(e,t,function(e){return e.driver.getItems?h(e.driver.getItems,e.items.map(function(e){return{key:e.relativeKey,options:e.options}}),t).then(function(t){return t.map(function(t){return{key:y(e.base,t.key),value:l(t.value)}})}):Promise.all(e.items.map(function(t){return h(e.driver.getItem,t.relativeKey,t.options).then(function(e){return{key:t.key,value:l(e)}})}))})},getItemRaw:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=g(e);var r=i(e),n=r.relativeKey,o=r.driver;return o.getItemRaw?h(o.getItemRaw,n,t):h(o.getItem,n,t).then(function(e){return function(e){return"string"==typeof e&&e.startsWith(v)?function(e){return globalThis.Buffer?Buffer.from(e,"base64"):Uint8Array.from(globalThis.atob(e),function(e){return e.codePointAt(0)})}(e.slice(v.length)):e}(e)})},setItem:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,n.Z)(p().mark(function n(){var o,a,s;return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0!==t){n.next=2;break}return n.abrupt("return",k.removeItem(e));case 2:if(e=g(e),o=i(e),a=o.relativeKey,s=o.driver,n.t0=!s.setItem,n.t0){n.next=9;break}return n.next=8,h(s.setItem,a,d(t),r);case 8:s.watch||c("update",e);case 9:case"end":return n.stop()}},n)}))()},setItems:function(e,t){return(0,n.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,x(e,t,function(){var e=(0,n.Z)(p().mark(function e(r){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.driver.setItems){e.next=2;break}return e.abrupt("return",h(r.driver.setItems,r.items.map(function(e){return{key:e.relativeKey,value:d(e.value),options:e.options}}),t));case 2:if(e.t0=!r.driver.setItem,e.t0){e.next=6;break}return e.next=6,Promise.all(r.items.map(function(e){return h(r.driver.setItem,e.relativeKey,d(e.value),e.options)}));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return r.stop()}},r)}))()},setItemRaw:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,n.Z)(p().mark(function n(){var o,a,u;return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0!==t){n.next=2;break}return n.abrupt("return",k.removeItem(e,r));case 2:if(e=g(e),o=i(e),a=o.relativeKey,!(u=o.driver).setItemRaw){n.next=9;break}return n.next=7,h(u.setItemRaw,a,t,r);case 7:n.next=13;break;case 9:if(u.setItem){n.next=11;break}return n.abrupt("return");case 11:return n.next=13,h(u.setItem,a,function(e){return"string"==typeof e?e:v+function(e){return globalThis.Buffer?Buffer.from(e).toString("base64"):globalThis.btoa(String.fromCodePoint.apply(String,s(e)))}(e)}(t),r);case 13:u.watch||c("update",e);case 14:case"end":return n.stop()}},n)}))()},removeItem:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.Z)(p().mark(function r(){var n,o,a;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if("boolean"==typeof t&&(t={removeMeta:t}),e=g(e),n=i(e),o=n.relativeKey,a=n.driver,r.t0=!a.removeItem,r.t0){r.next=11;break}return r.next=6,h(a.removeItem,o,t);case 6:if(r.t1=t.removeMeta||t.removeMata,!r.t1){r.next=10;break}return r.next=10,h(a.removeItem,o+"$",t);case 10:a.watch||c("remove",e);case 11:case"end":return r.stop()}},r)}))()},getMeta:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.Z)(p().mark(function r(){var n,o,a,s,c;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if("boolean"==typeof t&&(t={nativeOnly:t}),e=g(e),n=i(e),o=n.relativeKey,a=n.driver,s=Object.create(null),r.t0=a.getMeta,!r.t0){r.next=10;break}return r.t1=Object,r.t2=s,r.next=8,h(a.getMeta,o,t);case 8:r.t3=r.sent,r.t1.assign.call(r.t1,r.t2,r.t3);case 10:if(t.nativeOnly){r.next=15;break}return r.next=13,h(a.getItem,o+"$",t).then(function(e){return l(e)});case 13:(c=r.sent)&&"object"==typeof c&&("string"==typeof c.atime&&(c.atime=new Date(c.atime)),"string"==typeof c.mtime&&(c.mtime=new Date(c.mtime)),Object.assign(s,c));case 15:return r.abrupt("return",s);case 16:case"end":return r.stop()}},r)}))()},setMeta:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.setItem(e+"$",t,r)},removeMeta:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.removeItem(e+"$",t)},getKeys:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.Z)(p().mark(function r(){var n,i,a,c,f,l,d,v;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:e=b(e),n=o(e,!0),i=[],a=[],c=!0,f=u(n),r.prev=6,d=p().mark(function e(){var r,n,o,f,d,v;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.value,(null===(r=n.driver.flags)||void 0===r?void 0:r.maxDepth)||(c=!1),e.next=4,h(n.driver.getKeys,n.relativeBase,t);case 4:o=e.sent,f=u(o);try{for(v=function(){var e=d.value,t=n.mountpoint+g(e);i.some(function(e){return t.startsWith(e)})||a.push(t)},f.s();!(d=f.n()).done;)v()}catch(p){f.e(p)}finally{f.f()}i=[n.mountpoint].concat(s(i.filter(function(e){return!e.startsWith(n.mountpoint)})));case 8:case"end":return e.stop()}},e)}),f.s();case 9:if((l=f.n()).done){r.next=13;break}return r.delegateYield(d(),"t0",11);case 11:r.next=9;break;case 13:r.next=18;break;case 15:r.prev=15,r.t1=r.catch(6),f.e(r.t1);case 18:return r.prev=18,f.f(),r.finish(18);case 21:return v=void 0!==t.maxDepth&&!c,r.abrupt("return",a.filter(function(r){return(!v||function(e,t){if(void 0===t)return!0;for(var r=0,n=e.indexOf(":");n>-1;)r++,n=e.indexOf(":",n+1);return r<=t}(r,t.maxDepth))&&function(e,t){return t?e.startsWith(t)&&"$"!==e[e.length-1]:"$"!==e[e.length-1]}(r,e)}));case 23:case"end":return r.stop()}},r,null,[[6,15,18,21]])}))()},clear:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=b(e),r.next=3,Promise.all(o(e,!1).map(function(){var e=(0,n.Z)(p().mark(function e(r){var n;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.driver.clear){e.next=2;break}return e.abrupt("return",h(r.driver.clear,r.relativeBase,t));case 2:if(!r.driver.removeItem){e.next=7;break}return e.next=5,r.driver.getKeys(r.relativeBase||"",t);case 5:return n=e.sent,e.abrupt("return",Promise.all(n.map(function(e){return r.driver.removeItem(e,t)})));case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 3:case"end":return r.stop()}},r)}))()},dispose:function(){return(0,n.Z)(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(Object.values(r.mounts).map(function(e){return I(e)}));case 2:case"end":return e.stop()}},e)}))()},watch:function(e){return(0,n.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f();case 2:return r.watchListeners.push(e),t.abrupt("return",(0,n.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r.watchListeners=r.watchListeners.filter(function(t){return t!==e}),t.t0=0===r.watchListeners.length,!t.t0){t.next=5;break}return t.next=5,m();case 5:case"end":return t.stop()}},t)})));case 4:case"end":return t.stop()}},t)}))()},unwatch:function(){return(0,n.Z)(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.watchListeners=[],e.next=3,m();case 3:case"end":return e.stop()}},e)}))()},mount:function(e,t){if((e=b(e))&&r.mounts[e])throw new Error("already mounted at ".concat(e));return e&&(r.mountpoints.push(e),r.mountpoints.sort(function(e,t){return t.length-e.length})),r.mounts[e]=t,r.watching&&Promise.resolve(E(t,c,e)).then(function(t){r.unwatch[e]=t}).catch(console.error),k},unmount:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return(0,n.Z)(p().mark(function n(){var i,o;return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=(e=b(e))&&r.mounts[e],!n.t0){n.next=9;break}if(r.watching&&e in r.unwatch&&(null!==(i=(o=r.unwatch)[e])&&void 0!==i&&i.call(o),delete r.unwatch[e]),n.t1=t,!n.t1){n.next=7;break}return n.next=7,I(r.mounts[e]);case 7:r.mountpoints=r.mountpoints.filter(function(t){return t!==e}),delete r.mounts[e];case 9:case"end":return n.stop()}},n)}))()},getMount:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e=g(e)+":";var t=i(e);return{driver:t.driver,base:t.base}},getMounts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=g(e),o(e,t.parents).map(function(e){return{driver:e.driver,base:e.mountpoint}})},keys:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return k.getKeys(e,t)},get:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return k.getItem(e,t)},set:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return k.setItem(e,t,r)},has:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return k.hasItem(e,t)},del:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return k.removeItem(e,t)},remove:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return k.removeItem(e,t)}};return k}({driver:T({dbName:"WALLET_CONNECT_V2_INDEXED_DB",storeName:"keyvaluestorage"})})}return x(e,[{key:"getKeys",value:function(){var e=this;return(0,n.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.indexedDb.getKeys());case 1:case"end":return t.stop()}},t)}))()}},{key:"getEntries",value:function(){var e=this;return(0,n.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e.indexedDb,t.next=3,e.indexedDb.getKeys();case 3:return t.t1=t.sent,t.next=6,t.t0.getItems.call(t.t0,t.t1);case 6:return t.abrupt("return",t.sent.map(function(e){return[e.key,e.value]}));case 7:case"end":return t.stop()}},t)}))()}},{key:"getItem",value:function(e){var t=this;return(0,n.Z)(p().mark(function r(){var n;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.indexedDb.getItem(e);case 2:if(null===(n=r.sent)){r.next=5;break}return r.abrupt("return",n);case 5:case"end":return r.stop()}},r)}))()}},{key:"setItem",value:function(e,t){var r=this;return(0,n.Z)(p().mark(function n(){return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.indexedDb.setItem(e,(0,R.u)(t));case 2:case"end":return n.stop()}},n)}))()}},{key:"removeItem",value:function(e){var t=this;return(0,n.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.indexedDb.removeItem(e);case 2:case"end":return r.stop()}},r)}))()}}]),e}(),C=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},U={exports:{}};function N(e){var t;return[e[0],(0,R.D)(null!=(t=e[1])?t:"")]}!function(){var e;function t(){}(e=t).prototype.getItem=function(e){return this.hasOwnProperty(e)?String(this[e]):null},e.prototype.setItem=function(e,t){this[e]=String(t)},e.prototype.removeItem=function(e){delete this[e]},e.prototype.clear=function(){var e=this;Object.keys(e).forEach(function(t){e[t]=void 0,delete e[t]})},e.prototype.key=function(e){return e=e||0,Object.keys(this)[e]},e.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),U.exports=typeof C<"u"&&C.localStorage?C.localStorage:typeof window<"u"&&window.localStorage?window.localStorage:new t}();var j,L=function(){function e(){k(this,e),this.localStorage=U.exports}return x(e,[{key:"getKeys",value:function(){var e=this;return(0,n.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object.keys(e.localStorage));case 1:case"end":return t.stop()}},t)}))()}},{key:"getEntries",value:function(){var e=this;return(0,n.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object.entries(e.localStorage).map(N));case 1:case"end":return t.stop()}},t)}))()}},{key:"getItem",value:function(e){var t=this;return(0,n.Z)(p().mark(function r(){var n;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(null===(n=t.localStorage.getItem(e))){r.next=3;break}return r.abrupt("return",(0,R.D)(n));case 3:case"end":return r.stop()}},r)}))()}},{key:"setItem",value:function(e,t){var r=this;return(0,n.Z)(p().mark(function n(){return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r.localStorage.setItem(e,(0,R.u)(t));case 1:case"end":return n.stop()}},n)}))()}},{key:"removeItem",value:function(e){var t=this;return(0,n.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:t.localStorage.removeItem(e);case 1:case"end":return r.stop()}},r)}))()}}]),e}(),D=(j=(0,n.Z)(p().mark(function e(t,r,n){var i,o,a,s,c,u,f;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i="wc_storage_version",e.next=3,r.getItem(i);case 3:if(!((o=e.sent)&&o>=1)){e.next=6;break}return e.abrupt("return",void n(r));case 6:return e.next=8,t.getKeys();case 8:if((a=e.sent).length){e.next=11;break}return e.abrupt("return",void n(r));case 11:s=[];case 12:if(!a.length){e.next=26;break}if(c=a.shift()){e.next=16;break}return e.abrupt("continue",24);case 16:if(!((u=c.toLowerCase()).includes("wc@")||u.includes("walletconnect")||u.includes("wc_")||u.includes("wallet_connect"))){e.next=24;break}return e.next=20,t.getItem(c);case 20:return f=e.sent,e.next=23,r.setItem(c,f);case 23:s.push(c);case 24:e.next=12;break;case 26:return e.next=28,r.setItem(i,1);case 28:n(r),M(t,s);case 30:case"end":return e.stop()}},e)})),function(e,t,r){return j.apply(this,arguments)}),M=function(){var e=(0,n.Z)(p().mark(function e(t,r){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r.length&&r.forEach(function(){var e=(0,n.Z)(p().mark(function e(r){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.removeItem(r);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}(),q=function(){function e(){var t=this;k(this,e),this.initialized=!1,this.setInitialized=function(e){t.storage=e,t.initialized=!0};var r=new L;this.storage=r;try{var n=new B;D(r,n,this.setInitialized)}catch(i){this.initialized=!0}}return x(e,[{key:"getKeys",value:function(){var e=this;return(0,n.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.initialize();case 2:return t.abrupt("return",e.storage.getKeys());case 3:case"end":return t.stop()}},t)}))()}},{key:"getEntries",value:function(){var e=this;return(0,n.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.initialize();case 2:return t.abrupt("return",e.storage.getEntries());case 3:case"end":return t.stop()}},t)}))()}},{key:"getItem",value:function(e){var t=this;return(0,n.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.initialize();case 2:return r.abrupt("return",t.storage.getItem(e));case 3:case"end":return r.stop()}},r)}))()}},{key:"setItem",value:function(e,t){var r=this;return(0,n.Z)(p().mark(function n(){return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.initialize();case 2:return n.abrupt("return",r.storage.setItem(e,t));case 3:case"end":return n.stop()}},n)}))()}},{key:"removeItem",value:function(e){var t=this;return(0,n.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.initialize();case 2:return r.abrupt("return",t.storage.removeItem(e));case 3:case"end":return r.stop()}},r)}))()}},{key:"initialize",value:function(){var e=this;return(0,n.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.initialized,t.t0){t.next=4;break}return t.next=4,new Promise(function(t){var r=setInterval(function(){e.initialized&&(clearInterval(r),t())},20)});case 4:case"end":return t.stop()}},t)}))()}}]),e}()},14616:function(e,t,r){"use strict";r.d(t,{Ep:function(){return te},Rt:function(){return re},jI:function(){return $},Fd:function(){return ee}});var n={exports:{}};function i(e){try{return JSON.stringify(e)}catch(t){return'"[Circular]"'}}var o=function(e,t,r){var n=r&&r.stringify||i;if("object"==typeof e&&null!==e){var o=t.length+1;if(1===o)return e;var a=new Array(o);a[0]=n(e);for(var s=1;s<o;s++)a[s]=n(t[s]);return a.join(" ")}if("string"!=typeof e)return e;var c=t.length;if(0===c)return e;for(var u="",f=0,l=-1,p=e&&e.length||0,h=0;h<p;){if(37===e.charCodeAt(h)&&h+1<p){switch(l=l>-1?l:0,e.charCodeAt(h+1)){case 100:case 102:if(f>=c||null==t[f])break;l<h&&(u+=e.slice(l,h)),u+=Number(t[f]),l=h+2,h++;break;case 105:if(f>=c||null==t[f])break;l<h&&(u+=e.slice(l,h)),u+=Math.floor(Number(t[f])),l=h+2,h++;break;case 79:case 111:case 106:if(f>=c||void 0===t[f])break;l<h&&(u+=e.slice(l,h));var d=typeof t[f];if("string"===d){u+="'"+t[f]+"'",l=h+2,h++;break}if("function"===d){u+=t[f].name||"<anonymous>",l=h+2,h++;break}u+=n(t[f]),l=h+2,h++;break;case 115:if(f>=c)break;l<h&&(u+=e.slice(l,h)),u+=String(t[f]),l=h+2,h++;break;case 37:l<h&&(u+=e.slice(l,h)),u+="%",l=h+2,h++,f--}++f}++h}return-1===l?e:(l<p&&(u+=e.slice(l)),u)};n.exports=v;var a=function(){function e(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(t){return e(self)||e(window)||e(this)||{}}}().console||{},c={mapHttpRequest:S,mapHttpResponse:S,wrapRequestSerializer:O,wrapResponseSerializer:O,wrapErrorSerializer:O,req:S,res:S,err:E,errWithCause:E};function f(e,t){return"silent"===e?1/0:t.levels.values[e]}var l=Symbol("pino.logFuncs"),p=Symbol("pino.hierarchy"),h={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function d(e,t){t[p]={logger:t,parent:e[p]}}function v(e){(e=e||{}).browser=e.browser||{};var t=e.browser.transmit;if(t&&"function"!=typeof t.send)throw Error("pino: transmit option must have a send function");var r=e.browser.write||a;e.browser.write&&(e.browser.asObject=!0);var n=e.serializers||{},i=function(e,t){return Array.isArray(e)?e.filter(function(e){return"!stdSerializers.err"!==e}):!0===e&&Object.keys(t)}(e.browser.serialize,n),o=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(o=!1);var s=Object.keys(e.customLevels||{}),c=["error","fatal","warn","info","debug","trace"].concat(s);"function"==typeof r&&c.forEach(function(e){r[e]=r}),(!1===e.enabled||e.browser.disabled)&&(e.level="silent");var u=e.level||"info",p=Object.create(r);p.log||(p.log=_),function(e,t,r){var n={};t.forEach(function(e){n[e]=r[e]?r[e]:a[e]||a[h[e]||"log"]||_}),e[l]=n}(p,c,r),d({},p),Object.defineProperty(p,"levelVal",{get:function(){return f(this.level,this)}}),Object.defineProperty(p,"level",{get:function(){return this._level},set:function(e){var t=this;if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,g(this,y,p,"error"),g(this,y,p,"fatal"),g(this,y,p,"warn"),g(this,y,p,"info"),g(this,y,p,"debug"),g(this,y,p,"trace"),s.forEach(function(e){g(t,y,p,e)})}});var y={transmit:t,serialize:i,asObject:e.browser.asObject,asObjectBindingsOnly:e.browser.asObjectBindingsOnly,formatters:e.browser.formatters,levels:c,timestamp:I(e),messageKey:e.messageKey||"msg",onChild:e.onChild||_};function m(r,o,a){if(!o)throw new Error("missing bindings for child Pino");a=a||{},i&&o.serializers&&(a.serializers=o.serializers);var s=a.serializers;if(i&&s){var c=Object.assign({},n,s),u=!0===e.browser.serialize?Object.keys(c):i;delete o.serializers,b([o],u,c,this._stdErrSerialize)}function f(e){this._childLevel=1+(0|e._childLevel),this.bindings=o,c&&(this.serializers=c,this._serialize=u),t&&(this._logEvent=w([].concat(e._logEvent.bindings,o)))}f.prototype=this;var l=new f(this);return d(this,l),l.child=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return m.call.apply(m,[this,r].concat(t))},l.level=a.level||this.level,r.onChild(l),l}return p.levels=function(e){var t=e.customLevels||{},r=Object.assign({},v.levels.values,t),n=Object.assign({},v.levels.labels,function(e){var t={};return Object.keys(e).forEach(function(r){t[e[r]]=r}),t}(t));return{values:r,labels:n}}(e),p.level=u,p.isLevelEnabled=function(e){return!!this.levels.values[e]&&this.levels.values[e]>=this.levels.values[this.level]},p.setMaxListeners=p.getMaxListeners=p.emit=p.addListener=p.on=p.prependListener=p.once=p.prependOnceListener=p.removeListener=p.removeAllListeners=p.listeners=p.listenerCount=p.eventNames=p.write=p.flush=_,p.serializers=n,p._serialize=i,p._stdErrSerialize=o,p.child=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.call.apply(m,[this,y].concat(t))},t&&(p._logEvent=w()),p}function g(e,t,r,n){if(Object.defineProperty(e,n,{value:f(e.level,r)>f(n,r)?_:r[l][n],writable:!0,enumerable:!0,configurable:!0}),e[n]===_){if(!t.transmit)return;var i=f(t.transmit.level||e.level,r);if(f(n,r)<i)return}e[n]=function(e,t,r,n){return function(i){return function(){for(var o=t.timestamp(),c=new Array(arguments.length),u=Object.getPrototypeOf&&Object.getPrototypeOf(this)===a?a:this,l=0;l<c.length;l++)c[l]=arguments[l];var p=!1;if(t.serialize&&(b(c,this._serialize,this.serializers,this._stdErrSerialize),p=!0),t.asObject||t.formatters?i.call.apply(i,[u].concat(s(y(this,n,c,o,t)))):i.apply(u,c),t.transmit){var h=t.transmit.level||e._level,d=f(h,r),v=f(n,r);if(v<d)return;m(this,{ts:o,methodLevel:n,methodValue:v,transmitLevel:h,transmitValue:r.levels.values[t.transmit.level||e._level],send:t.transmit.send,val:f(e._level,r)},c,p)}}}(e[l][n])}(e,t,r,n);var o=function(e){var t=[];e.bindings&&t.push(e.bindings);for(var r=e[p];r.parent;)(r=r.parent).logger.bindings&&t.push(r.logger.bindings);return t.reverse()}(e);0!==o.length&&(e[n]=function(e,t){return function(){return t.apply(this,[].concat(s(e),Array.prototype.slice.call(arguments)))}}(o,e[n]))}function y(e,t,r,n,i){var a=i.formatters||{},c=a.level,u=a.log,f=void 0===u?function(e){return e}:u,l=r.slice(),p=l[0],h={},d=1+(0|e._childLevel);if(d<1&&(d=1),n&&(h.time=n),c){var v=c(t,e.levels.values[t]);Object.assign(h,v)}else h.level=e.levels.values[t];if(i.asObjectBindingsOnly){if(null!==p&&"object"==typeof p)for(;d--&&"object"==typeof l[0];)Object.assign(h,l.shift());return[f(h)].concat(s(l))}if(null!==p&&"object"==typeof p){for(;d--&&"object"==typeof l[0];)Object.assign(h,l.shift());p=l.length?o(l.shift(),l):void 0}else"string"==typeof p&&(p=o(l.shift(),l));return void 0!==p&&(h[i.messageKey]=p),[f(h)]}function b(e,t,r,n){for(var i in e)if(n&&e[i]instanceof Error)e[i]=v.stdSerializers.err(e[i]);else if("object"==typeof e[i]&&!Array.isArray(e[i])&&t)for(var o in e[i])t.indexOf(o)>-1&&o in r&&(e[i][o]=r[o](e[i][o]))}function m(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=t.send,o=t.ts,a=t.methodLevel,s=t.methodValue,c=t.val,u=e._logEvent.bindings;n||b(r,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=o,e._logEvent.messages=r.filter(function(e){return-1===u.indexOf(e)}),e._logEvent.level.label=a,e._logEvent.level.value=s,i(a,e._logEvent,c),e._logEvent=w(u)}function w(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function E(e){var t={type:e.constructor.name,msg:e.message,stack:e.stack};for(var r in e)void 0===t[r]&&(t[r]=e[r]);return t}function I(e){return"function"==typeof e.timestamp?e.timestamp:!1===e.timestamp?P:A}function S(){return{}}function O(e){return e}function _(){}function P(){return!1}function A(){return Date.now()}v.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},v.stdSerializers=c,v.stdTimeFunctions=Object.assign({},{nullTime:P,epochTime:A,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}}),n.exports.default=v,n.exports.pino=v;var R="custom_context",T=1024e3,B=Object.defineProperty,C=function(e,t,r){return function(e,t,r){return t in e?B(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r}(e,"symbol"!=typeof t?t+"":t,r)},U=function(){function e(t){k(this,e),C(this,"nodeValue"),C(this,"sizeInBytes"),C(this,"next"),this.nodeValue=t,this.sizeInBytes=(new TextEncoder).encode(this.nodeValue).length,this.next=null}return x(e,[{key:"value",get:function(){return this.nodeValue}},{key:"size",get:function(){return this.sizeInBytes}}]),e}(),N=function(e){function t(e){k(this,t),C(this,"lengthInNodes"),C(this,"sizeInBytes"),C(this,"head"),C(this,"tail"),C(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}return x(t,[{key:"append",value:function(e){var t=new U(e);if(t.size>this.maxSizeInBytes)throw new Error("[LinkedList] Value too big to insert into list: ".concat(e," with size ").concat(t.size));for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=t),this.tail=t):(this.head=t,this.tail=t),this.lengthInNodes++,this.sizeInBytes+=t.size}},{key:"shift",value:function(){if(this.head){var e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}}},{key:"toArray",value:function(){for(var e=[],t=this.head;null!==t;)e.push(t.value),t=t.next;return e}},{key:"length",get:function(){return this.lengthInNodes}},{key:"size",get:function(){return this.sizeInBytes}},{key:"toOrderedArray",value:function(){return Array.from(this)}},{key:Symbol.iterator,value:function(){var e=this.head;return{next:function(){if(!e)return{done:!0,value:null};var t=e.value;return e=e.next,{done:!1,value:t}}}}}]),t}();function j(e){return"string"==typeof e?e:function(e){return JSON.stringify(e,function(e,t){return"bigint"==typeof t?t.toString()+"n":t})}(e)||""}var L=Object.defineProperty,D=function(e,t,r){return function(e,t,r){return t in e?L(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r}(e,"symbol"!=typeof t?t+"":t,r)},M=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:T;k(this,e),D(this,"logs"),D(this,"level"),D(this,"levelValue"),D(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=null!=t?t:"error",this.levelValue=n.exports.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=r,this.logs=new N(this.MAX_LOG_SIZE_IN_BYTES)}return x(e,[{key:"forwardToConsole",value:function(e,t){t===n.exports.levels.values.error?console.error(e):t===n.exports.levels.values.warn?console.warn(e):t===n.exports.levels.values.debug?console.debug(e):t===n.exports.levels.values.trace?console.trace(e):console.log(e)}},{key:"appendToLogs",value:function(e){this.logs.append(j({timestamp:(new Date).toISOString(),log:e}));var t="string"==typeof e?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}},{key:"getLogs",value:function(){return this.logs}},{key:"clearLogs",value:function(){this.logs=new N(this.MAX_LOG_SIZE_IN_BYTES)}},{key:"getLogArray",value:function(){return Array.from(this.logs)}},{key:"logsToBlob",value:function(e){var t=this.getLogArray();return t.push(j({extraMetadata:e})),new Blob(t,{type:"application/json"})}}]),e}(),q=Object.defineProperty,z=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:T;k(this,e),function(e,t,r){!function(e,t,r){t in e?q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r}(e,t+"",void 0)}(this,"baseChunkLogger"),this.baseChunkLogger=new M(t,r)}return x(e,[{key:"write",value:function(e){this.baseChunkLogger.appendToLogs(e)}},{key:"getLogs",value:function(){return this.baseChunkLogger.getLogs()}},{key:"clearLogs",value:function(){this.baseChunkLogger.clearLogs()}},{key:"getLogArray",value:function(){return this.baseChunkLogger.getLogArray()}},{key:"logsToBlob",value:function(e){return this.baseChunkLogger.logsToBlob(e)}},{key:"downloadLogsBlobInBrowser",value:function(e){var t=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=t,r.download="walletconnect-logs-".concat((new Date).toISOString(),".txt"),document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t)}}]),e}(),Z=Object.defineProperty,F=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:T;k(this,e),function(e,t,r){!function(e,t,r){t in e?Z(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r}(e,t+"",void 0)}(this,"baseChunkLogger"),this.baseChunkLogger=new M(t,r)}return x(e,[{key:"write",value:function(e){this.baseChunkLogger.appendToLogs(e)}},{key:"getLogs",value:function(){return this.baseChunkLogger.getLogs()}},{key:"clearLogs",value:function(){this.baseChunkLogger.clearLogs()}},{key:"getLogArray",value:function(){return this.baseChunkLogger.getLogArray()}},{key:"logsToBlob",value:function(e){return this.baseChunkLogger.logsToBlob(e)}}]),e}(),K=Object.defineProperty,V=Object.defineProperties,H=Object.getOwnPropertyDescriptors,W=Object.getOwnPropertySymbols,G=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable,Y=function(e,t,r){return t in e?K(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Q=function(e,t){for(var r in t||(t={}))G.call(t,r)&&Y(e,r,t[r]);if(W){var n,i=u(W(t));try{for(i.s();!(n=i.n()).done;){r=n.value;J.call(t,r)&&Y(e,r,t[r])}}catch(o){i.e(o)}finally{i.f()}}return e},X=function(e,t){return V(e,H(t))};function $(e){return X(Q({},e),{level:(null==e?void 0:e.level)||"info"})}function ee(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:R;return e[t]||""}function te(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:R,n=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:R,n=ee(e,r);return n.trim()?"".concat(n,"/").concat(t):t}(e,t,r);return function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:R;return e[r]=t,e}(e.child({context:n}),n,r)}function re(e){var t;if(typeof e.loggerOverride<"u"&&"string"!=typeof e.loggerOverride)return{logger:e.loggerOverride,chunkLoggerController:null};var r=X(Q({},e.opts),{level:"string"==typeof e.loggerOverride?e.loggerOverride:null==(t=e.opts)?void 0:t.level});return typeof window<"u"?function(e){var t,r,i=new z(null==(t=e.opts)?void 0:t.level,e.maxSizeInBytes);return{logger:n.exports(X(Q({},e.opts),{level:"trace",browser:X(Q({},null==(r=e.opts)?void 0:r.browser),{write:function(e){return i.write(e)}})})),chunkLoggerController:i}}(X(Q({},e),{opts:r})):function(e){var t,r,i=new F(null==(t=e.opts)?void 0:t.level,e.maxSizeInBytes);return{logger:n.exports(X(Q({},e.opts),{level:"trace",browser:X(Q({},null==(r=e.opts)?void 0:r.browser),{write:function(e){return i.write(e)}})}),i),chunkLoggerController:i}}(X(Q({},e),{opts:r}))}},63840:function(e,t,r){"use strict";r.d(t,{iO:function(){return n}});var n={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}}},29168:function(e,t,r){"use strict";r.d(t,{xp:function(){return Pr},bG:function(){return Ir},Au:function(){return Ar},vf:function(){return Rr}});var n=r(8239),o=r(14611),f=r(80328);function l(e){if(!function(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}(e))throw new Error("Uint8Array expected");for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(r.length>0&&!r.includes(e.length))throw new Error("Uint8Array expected of length "+r+", got length="+e.length)}function d(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}var g="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,y=function(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)};function b(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e)),l(e),e}function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(g&&"function"==typeof g.getRandomValues)return g.getRandomValues(new Uint8Array(e));if(g&&"function"==typeof g.randomBytes)return g.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}var w=BigInt(Math.pow(2,32)-1),E=BigInt(32);function I(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?{h:Number(e&w),l:Number(e>>E&w)}:{h:0|Number(e>>E&w),l:0|Number(e&w)}}var S=function(e,t,r){return e>>>r},O=function(e,t,r){return e<<32-r|t>>>r},_=function(e,t,r){return e>>>r|t<<32-r},P=function(e,t,r){return e<<32-r|t>>>r},A=function(e,t,r){return e<<64-r|t>>>r-32},R=function(e,t,r){return e>>>r-32|t<<64-r},T=function(e,t,r,n){var i=(t>>>0)+(n>>>0);return{h:e+r+(i/Math.pow(2,32)|0)|0,l:0|i}},B=function(e,t,r){return(e>>>0)+(t>>>0)+(r>>>0)},C=function(e,t,r,n){return t+r+n+(e/Math.pow(2,32)|0)|0},U=function(e,t,r,n){return(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)},N=function(e,t,r,n,i){return t+r+n+i+(e/Math.pow(2,32)|0)|0},j=function(e,t,r,n,i,o){return t+r+n+i+o+(e/Math.pow(2,32)|0)|0},L=function(e,t,r,n,i){return(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0)},D=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=new Uint32Array(e.length),n=new Uint32Array(e.length),i=0;i<e.length;i++){var o=I(e[i],t),a=o.h,s=o.l,c=[a,s];r[i]=c[0],n[i]=c[1]}return[r,n]}(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(function(e){return BigInt(e)})),M=i(D,2),q=M[0],z=M[1],Z=new Uint32Array(80),F=new Uint32Array(80),K=function(e){h(r,e);var t=v(r);function r(){var e;return k(this,r),(e=t.call(this,128,64,16,!1)).Ah=1779033703,e.Al=-205731576,e.Bh=-1150833019,e.Bl=-2067093701,e.Ch=1013904242,e.Cl=-23791573,e.Dh=-1521486534,e.Dl=1595750129,e.Eh=1359893119,e.El=-1377402159,e.Fh=-1694144372,e.Fl=725511199,e.Gh=528734635,e.Gl=-79577749,e.Hh=1541459225,e.Hl=327033209,e}return x(r,[{key:"get",value:function(){return[this.Ah,this.Al,this.Bh,this.Bl,this.Ch,this.Cl,this.Dh,this.Dl,this.Eh,this.El,this.Fh,this.Fl,this.Gh,this.Gl,this.Hh,this.Hl]}},{key:"set",value:function(e,t,r,n,i,o,a,s,c,u,f,l,p,h,d,v){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|o,this.Dh=0|a,this.Dl=0|s,this.Eh=0|c,this.El=0|u,this.Fh=0|f,this.Fl=0|l,this.Gh=0|p,this.Gl=0|h,this.Hh=0|d,this.Hl=0|v}},{key:"process",value:function(e,t){for(var r,n,i,o,a,s,c,u,f=0;f<16;f++,t+=4)Z[f]=e.getUint32(t),F[f]=e.getUint32(t+=4);for(var l=16;l<80;l++){var p=0|Z[l-15],h=0|F[l-15],d=_(p,h,1)^_(p,h,8)^S(p,0,7),v=P(p,h,1)^P(p,h,8)^O(p,h,7),g=0|Z[l-2],y=0|F[l-2],b=_(g,y,19)^A(g,y,61)^S(g,0,6),m=P(g,y,19)^R(g,y,61)^O(g,y,6),w=U(v,m,F[l-7],F[l-16]),x=N(w,d,b,Z[l-7],Z[l-16]);Z[l]=0|x,F[l]=0|w}var k=this.Ah,E=this.Al,I=this.Bh,D=this.Bl,M=this.Ch,K=this.Cl,V=this.Dh,H=this.Dl,W=this.Eh,G=this.El,J=this.Fh,Y=this.Fl,Q=this.Gh,X=this.Gl,$=this.Hh,ee=this.Hl;for(f=0;f<80;f++){p=_(W,G,14)^_(W,G,18)^A(W,G,41),h=P(W,G,14)^P(W,G,18)^R(W,G,41),d=W&J^~W&Q,g=L(ee,h,G&Y^~G&X,z[f],F[f]),y=j(g,$,p,d,q[f],Z[f]),b=0|g,m=_(k,E,28)^A(k,E,34)^A(k,E,39),w=P(k,E,28)^R(k,E,34)^R(k,E,39),x=k&I^k&M^I&M;var te,re=E&D^E&K^D&K;$=0|Q,ee=0|X,Q=0|J,X=0|Y,J=0|W,Y=0|G,W=(te=T(0|V,0|H,0|y,0|b)).h,G=te.l,V=0|M,H=0|K,M=0|I,K=0|D,I=0|k,D=0|E;var ne=B(b,w,re);k=C(ne,y,m,x),E=0|ne}k=(r=T(0|this.Ah,0|this.Al,0|k,0|E)).h,E=r.l,I=(n=T(0|this.Bh,0|this.Bl,0|I,0|D)).h,D=n.l,M=(i=T(0|this.Ch,0|this.Cl,0|M,0|K)).h,K=i.l,V=(o=T(0|this.Dh,0|this.Dl,0|V,0|H)).h,H=o.l,W=(a=T(0|this.Eh,0|this.El,0|W,0|G)).h,G=a.l,J=(s=T(0|this.Fh,0|this.Fl,0|J,0|Y)).h,Y=s.l,Q=(c=T(0|this.Gh,0|this.Gl,0|Q,0|X)).h,X=c.l,$=(u=T(0|this.Hh,0|this.Hl,0|$,0|ee)).h,ee=u.l,this.set(k,E,I,D,M,K,V,H,W,G,J,Y,Q,X,$,ee)}},{key:"roundClean",value:function(){Z.fill(0),F.fill(0)}},{key:"destroy",value:function(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}]),r}(function(e){h(r,e);var t=v(r);function r(e,n,i,o){var a;return k(this,r),(a=t.call(this)).blockLen=e,a.outputLen=n,a.padOffset=i,a.isLE=o,a.finished=!1,a.length=0,a.pos=0,a.destroyed=!1,a.buffer=new Uint8Array(e),a.view=y(a.buffer),a}return x(r,[{key:"update",value:function(e){d(this);for(var t=this.view,r=this.buffer,n=this.blockLen,i=(e=b(e)).length,o=0;o<i;){var a=Math.min(n-this.pos,i-o);if(a!==n)r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===n&&(this.process(t,0),this.pos=0);else for(var s=y(e);n<=i-o;o+=n)this.process(s,o)}return this.length+=e.length,this.roundClean(),this}},{key:"digestInto",value:function(e){d(this),function(e,t){l(e);var r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}(e,this),this.finished=!0;var t=this.buffer,r=this.view,n=this.blockLen,i=this.isLE,o=this.pos;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>n-o&&(this.process(r,0),o=0);for(var a=o;a<n;a++)t[a]=0;(function(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);var i=BigInt(32),o=BigInt(4294967295),a=Number(r>>i&o),s=Number(r&o),c=n?0:4;e.setUint32(t+(n?4:0),a,n),e.setUint32(t+c,s,n)})(r,n-8,BigInt(8*this.length),i),this.process(r,0);var s=y(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");var u=c/4,f=this.get();if(u>f.length)throw new Error("_sha2: outputLen bigger than state");for(var p=0;p<u;p++)s.setUint32(4*p,f[p],i)}},{key:"digest",value:function(){var e=this.buffer,t=this.outputLen;this.digestInto(e);var r=e.slice(0,t);return this.destroy(),r}},{key:"_cloneInto",value:function(e){var t;e||(e=new this.constructor),(t=e).set.apply(t,s(this.get()));var r=this.blockLen,n=this.buffer,i=this.length,o=this.finished,a=this.destroyed,c=this.pos;return e.length=i,e.pos=c,e.finished=o,e.destroyed=a,i%r&&e.buffer.set(n),e}}]),r}(function(){function e(){k(this,e)}return x(e,[{key:"clone",value:function(){return this._cloneInto()}}]),e}())),V=function(e){var t=function(t){return e().update(b(t)).digest()},r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=function(){return e()},t}(function(){return new K}),H=BigInt(0),W=BigInt(1),G=BigInt(2);function J(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function Y(e){if(!J(e))throw new Error("Uint8Array expected")}function Q(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)}var X=Array.from({length:256},function(e,t){return t.toString(16).padStart(2,"0")});function $(e){Y(e);for(var t="",r=0;r<e.length;r++)t+=X[e[r]];return t}function ee(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?H:BigInt("0x"+e)}function te(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}function re(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);var t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);for(var n=new Uint8Array(r),i=0,o=0;i<r;i++,o+=2){var a=te(e.charCodeAt(o)),s=te(e.charCodeAt(o+1));if(void 0===a||void 0===s)throw new Error('hex string expected, got non-hex character "'+(e[o]+e[o+1])+'" at index '+o);n[i]=16*a+s}return n}function ne(e){return Y(e),ee($(Uint8Array.from(e).reverse()))}function ie(e,t){return re(e.toString(16).padStart(2*t,"0"))}function oe(e,t){return ie(e,t).reverse()}function ae(e,t,r){var n;if("string"==typeof t)try{n=re(t)}catch(o){throw new Error(e+" must be hex string or Uint8Array, cause: "+o)}else{if(!J(t))throw new Error(e+" must be hex string or Uint8Array");n=Uint8Array.from(t)}var i=n.length;if("number"==typeof r&&i!==r)throw new Error(e+" of length "+r+" expected, got "+i);return n}function se(){for(var e=0,t=0;t<arguments.length;t++){var r=t<0||arguments.length<=t?void 0:arguments[t];Y(r),e+=r.length}for(var n=new Uint8Array(e),i=0,o=0;i<arguments.length;i++){var a=i<0||arguments.length<=i?void 0:arguments[i];n.set(a,o),o+=a.length}return n}var ce=function(e){return"bigint"==typeof e&&H<=e};function ue(e,t,r,n){if(!function(e,t,r){return ce(e)&&ce(t)&&ce(r)&&t<=e&&e<r}(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}var fe=function(e){return(G<<BigInt(e-1))-W},le={bigint:function(e){return"bigint"==typeof e},function:function(e){return"function"==typeof e},boolean:function(e){return"boolean"==typeof e},string:function(e){return"string"==typeof e},stringOrUint8Array:function(e){return"string"==typeof e||J(e)},isSafeInteger:function(e){return Number.isSafeInteger(e)},array:function(e){return Array.isArray(e)},field:function(e,t){return t.Fp.isValid(e)},hash:function(e){return"function"==typeof e&&Number.isSafeInteger(e.outputLen)}};function pe(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=function(t,r,n){var i=le[r];if("function"!=typeof i)throw new Error("invalid validator function");var o=e[t];if(!(n&&void 0===o||i(o,e)))throw new Error("param "+String(t)+" is invalid. Expected "+r+", got "+o)},o=0,a=Object.entries(t);o<a.length;o++){var s=i(a[o],2),c=s[0],u=s[1];n(c,u,!1)}for(var f=0,l=Object.entries(r);f<l.length;f++){var p=i(l[f],2),h=p[0],d=p[1];n(h,d,!0)}return e}function he(e){var t=new WeakMap;return function(r){var n=t.get(r);if(void 0!==n)return n;for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];var s=e.apply(void 0,[r].concat(o));return t.set(r,s),s}}var de=BigInt(0),ve=BigInt(1),ge=BigInt(2),ye=BigInt(3),be=BigInt(4),me=BigInt(5),we=BigInt(8);function xe(e,t){var r=e%t;return r>=de?r:t+r}function ke(e,t,r){if(t<de)throw new Error("invalid exponent, negatives unsupported");if(r<=de)throw new Error("invalid modulus");if(r===ve)return de;for(var n=ve;t>de;)t&ve&&(n=n*e%r),e=e*e%r,t>>=ve;return n}function Ee(e,t,r){for(var n=e;t-- >de;)n*=n,n%=r;return n}function Ie(e,t){if(e===de)throw new Error("invert: expected non-zero number");if(t<=de)throw new Error("invert: expected positive modulus, got "+t);for(var r=xe(e,t),n=t,i=de,o=ve;r!==de;){var a=n%r,s=i-o*(n/r);n=r,r=a,i=o,o=s}if(n!==ve)throw new Error("invert: does not exist");return xe(i,t)}var Se=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Oe(e,t){var r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function _e(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(e<=de)throw new Error("invalid field: expected ORDER > 0, got "+e);var i,o=Oe(e,t),a=o.nBitLength,s=o.nByteLength;if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");var c=Object.freeze({ORDER:e,isLE:r,BITS:a,BYTES:s,MASK:fe(a),ZERO:de,ONE:ve,create:function(t){return xe(t,e)},isValid:function(t){if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return de<=t&&t<e},is0:function(e){return e===de},isOdd:function(e){return(e&ve)===ve},neg:function(t){return xe(-t,e)},eql:function(e,t){return e===t},sqr:function(t){return xe(t*t,e)},add:function(t,r){return xe(t+r,e)},sub:function(t,r){return xe(t-r,e)},mul:function(t,r){return xe(t*r,e)},pow:function(e,t){return function(e,t,r){if(r<de)throw new Error("invalid exponent, negatives unsupported");if(r===de)return e.ONE;if(r===ve)return t;for(var n=e.ONE,i=t;r>de;)r&ve&&(n=e.mul(n,i)),i=e.sqr(i),r>>=ve;return n}(c,e,t)},div:function(t,r){return xe(t*Ie(r,e),e)},sqrN:function(e){return e*e},addN:function(e,t){return e+t},subN:function(e,t){return e-t},mulN:function(e,t){return e*t},inv:function(t){return Ie(t,e)},sqrt:n.sqrt||function(t){return i||(i=function(e){if(e%be===ye){var t=(e+ve)/be;return function(e,r){var n=e.pow(r,t);if(!e.eql(e.sqr(n),r))throw new Error("Cannot find square root");return n}}if(e%we===me){var r=(e-me)/we;return function(e,t){var n=e.mul(t,ge),i=e.pow(n,r),o=e.mul(t,i),a=e.mul(e.mul(o,ge),i),s=e.mul(o,e.sub(a,e.ONE));if(!e.eql(e.sqr(s),t))throw new Error("Cannot find square root");return s}}return function(e){var t,r,n,i=(e-ve)/ge;for(t=e-ve,r=0;t%ge===de;t/=ge,r++);for(n=ge;n<e&&ke(n,i,e)!==e-ve;n++)if(n>1e3)throw new Error("Cannot find square root: likely non-prime P");if(1===r){var o=(e+ve)/be;return function(e,t){var r=e.pow(t,o);if(!e.eql(e.sqr(r),t))throw new Error("Cannot find square root");return r}}var a=(t+ve)/ge;return function(e,o){if(e.pow(o,i)===e.neg(e.ONE))throw new Error("Cannot find square root");for(var s=r,c=e.pow(e.mul(e.ONE,n),t),u=e.pow(o,a),f=e.pow(o,t);!e.eql(f,e.ONE);){if(e.eql(f,e.ZERO))return e.ZERO;for(var l=1,p=e.sqr(f);l<s&&!e.eql(p,e.ONE);l++)p=e.sqr(p);var h=e.pow(c,ve<<BigInt(s-l-1));c=e.sqr(h),u=e.mul(u,h),f=e.mul(f,c),s=l}return u}}(e)}(e)),i(c,t)},invertBatch:function(e){return function(e,t){var r=new Array(t.length),n=t.reduce(function(t,n,i){return e.is0(n)?t:(r[i]=t,e.mul(t,n))},e.ONE),i=e.inv(n);return t.reduceRight(function(t,n,i){return e.is0(n)?t:(r[i]=e.mul(t,r[i]),e.mul(t,n))},i),r}(c,e)},cmov:function(e,t,r){return r?t:e},toBytes:function(e){return r?oe(e,s):ie(e,s)},fromBytes:function(e){if(e.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+e.length);return r?ne(e):function(e){return ee($(e))}(e)}});return Object.freeze(c)}var Pe=BigInt(0),Ae=BigInt(1);function Re(e,t){var r=t.negate();return e?r:t}function Te(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Be(e,t){return Te(e,t),{windows:Math.ceil(t/e)+1,windowSize:Math.pow(2,e-1)}}var Ce=new WeakMap,Ue=new WeakMap;function Ne(e){return Ue.get(e)||1}var je=BigInt(0),Le=BigInt(1),De=BigInt(2),Me=BigInt(8),qe={zip215:!0};BigInt(0),BigInt(1);var ze=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Ze=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);var Fe=BigInt(1),Ke=BigInt(2);BigInt(3);var Ve=BigInt(5),He=BigInt(8),We=_e(ze,void 0,!0),Ge=function(e){var t=function(e){var t=function(e){return function(e){pe(e,Se.reduce(function(e,t){return e[t]="function",e},{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}(e.Fp),pe(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze(a(a(a({},Oe(e.n,e.nBitLength)),e),{},{p:e.Fp.ORDER}))}(e);return pe(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze(a({},t))}(e),r=t.Fp,n=t.n,i=t.prehash,o=t.hash,s=t.randomBytes,c=t.nByteLength,u=t.h,f=De<<BigInt(8*c)-Le,l=r.create,p=_e(t.n,t.nBitLength),h=t.uvRatio||function(e,t){try{return{isValid:!0,value:r.sqrt(e*r.inv(t))}}catch(n){return{isValid:!1,value:je}}},d=t.adjustScalarBytes||function(e){return e},v=t.domain||function(e,t,r){if(Q("phflag",r),t.length||r)throw new Error("Contexts/pre-hash are not supported");return e};function g(e,t){ue("coordinate "+e,t,je,f)}function y(e){if(!(e instanceof w))throw new Error("ExtendedPoint expected")}var b=he(function(e,t){var n=e.ex,i=e.ey,o=e.ez,a=e.is0();null==t&&(t=a?Me:r.inv(o));var s=l(n*t),c=l(i*t),u=l(o*t);if(a)return{x:je,y:Le};if(u!==Le)throw new Error("invZ was invalid");return{x:s,y:c}}),m=he(function(e){var r=t.a,n=t.d;if(e.is0())throw new Error("bad point: ZERO");var i=e.ex,o=e.ey,a=e.ez,s=e.et,c=l(i*i),u=l(o*o),f=l(a*a),p=l(f*f),h=l(c*r);if(l(f*l(h+u))!==l(p+l(n*l(c*u))))throw new Error("bad point: equation left != right (1)");if(l(i*o)!==l(a*s))throw new Error("bad point: equation left != right (2)");return!0}),w=function(){function e(t,r,n,i){k(this,e),this.ex=t,this.ey=r,this.ez=n,this.et=i,g("x",t),g("y",r),g("z",n),g("t",i),Object.freeze(this)}return x(e,[{key:"x",get:function(){return this.toAffine().x}},{key:"y",get:function(){return this.toAffine().y}},{key:"_setWindowSize",value:function(e){S.setWindowSize(this,e)}},{key:"assertValidity",value:function(){m(this)}},{key:"equals",value:function(e){y(e);var t=this.ex,r=this.ey,n=this.ez,i=e.ex,o=e.ey,a=e.ez,s=l(t*a),c=l(i*n),u=l(r*a),f=l(o*n);return s===c&&u===f}},{key:"is0",value:function(){return this.equals(e.ZERO)}},{key:"negate",value:function(){return new e(l(-this.ex),this.ey,this.ez,l(-this.et))}},{key:"double",value:function(){var r=t.a,n=this.ex,i=this.ey,o=this.ez,a=l(n*n),s=l(i*i),c=l(De*l(o*o)),u=l(r*a),f=n+i,p=l(l(f*f)-a-s),h=u+s,d=h-c,v=u-s,g=l(p*d),y=l(h*v),b=l(p*v);return new e(g,y,l(d*h),b)}},{key:"add",value:function(r){y(r);var n=t.a,i=t.d,o=this.ex,a=this.ey,s=this.ez,c=this.et,u=r.ex,f=r.ey,p=r.ez,h=r.et;if(n===BigInt(-1)){var d=l((a-o)*(f+u)),v=l((a+o)*(f-u)),g=l(v-d);if(g===je)return this.double();var b=l(s*De*h),m=l(c*De*p),w=m+b,x=v+d,k=m-b,E=l(w*g),I=l(x*k),S=l(w*k);return new e(E,I,l(g*x),S)}var O=l(o*u),_=l(a*f),P=l(c*i*h),A=l(s*p),R=l((o+a)*(u+f)-O-_),T=A-P,B=A+P,C=l(_-n*O),U=l(R*T),N=l(B*C),j=l(R*C);return new e(U,N,l(T*B),j)}},{key:"subtract",value:function(e){return this.add(e.negate())}},{key:"wNAF",value:function(t){return S.wNAFCached(this,t,e.normalizeZ)}},{key:"multiply",value:function(t){var r=t;ue("scalar",r,Le,n);var i=this.wNAF(r),o=i.p,a=i.f;return e.normalizeZ([o,a])[0]}},{key:"multiplyUnsafe",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.ZERO,i=t;return ue("scalar",i,je,n),i===je?I:this.is0()||i===Le?this:S.wNAFCachedUnsafe(this,i,e.normalizeZ,r)}},{key:"isSmallOrder",value:function(){return this.multiplyUnsafe(u).is0()}},{key:"isTorsionFree",value:function(){return S.unsafeLadder(this,n).is0()}},{key:"toAffine",value:function(e){return b(this,e)}},{key:"clearCofactor",value:function(){var e=t.h;return e===Le?this:this.multiplyUnsafe(e)}},{key:"toRawBytes",value:function(){var e=this.toAffine(),t=e.x,n=oe(e.y,r.BYTES);return n[n.length-1]|=t&Le?128:0,n}},{key:"toHex",value:function(){return $(this.toRawBytes())}}],[{key:"fromAffine",value:function(t){if(t instanceof e)throw new Error("extended point not allowed");var r=t||{},n=r.x,i=r.y;return g("x",n),g("y",i),new e(n,i,Le,l(n*i))}},{key:"normalizeZ",value:function(t){var n=r.invertBatch(t.map(function(e){return e.ez}));return t.map(function(e,t){return e.toAffine(n[t])}).map(e.fromAffine)}},{key:"msm",value:function(t,r){return function(e,t,r,n){if(function(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach(function(e,r){if(!(e instanceof t))throw new Error("invalid point at index "+r)})}(r,e),function(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach(function(e,r){if(!t.isValid(e))throw new Error("invalid scalar at index "+r)})}(n,t),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");for(var i=e.ZERO,o=function(e){var t;for(t=0;e>H;e>>=W,t+=1);return t}(BigInt(r.length)),a=o>12?o-3:o>4?o-2:o?2:1,s=(1<<a)-1,c=new Array(s+1).fill(i),u=i,f=Math.floor((t.BITS-1)/a)*a;f>=0;f-=a){c.fill(i);for(var l=0;l<n.length;l++){var p=Number(n[l]>>BigInt(f)&BigInt(s));c[p]=c[p].add(r[l])}for(var h=i,d=c.length-1,v=i;d>0;d--)v=v.add(c[d]),h=h.add(v);if(u=u.add(h),0!==f)for(var g=0;g<a;g++)u=u.double()}return u}(e,p,t,r)}},{key:"fromHex",value:function(n){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=t.d,a=t.a,s=r.BYTES;n=ae("pointHex",n,s),Q("zip215",i);var c=n.slice(),u=n[s-1];c[s-1]=-129&u;var p=ne(c);ue("pointHex.y",p,je,i?f:r.ORDER);var d=l(p*p),v=l(d-Le),g=l(o*d-a),y=h(v,g),b=y.isValid,m=y.value;if(!b)throw new Error("Point.fromHex: invalid y coordinate");var w=(m&Le)===Le,x=0!=(128&u);if(!i&&m===je&&x)throw new Error("Point.fromHex: x=0 and x_0=1");return x!==w&&(m=l(-m)),e.fromAffine({x:m,y:p})}},{key:"fromPrivateKey",value:function(e){return P(e).point}}]),e}();w.BASE=new w(t.Gx,t.Gy,Le,l(t.Gx*t.Gy)),w.ZERO=new w(je,Le,Le,je);var E=w.BASE,I=w.ZERO,S=function(e,t){return{constTimeNegate:Re,hasPrecomputes:function(e){return 1!==Ne(e)},unsafeLadder:function(t,r){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.ZERO,i=t;r>Pe;)r&Ae&&(n=n.add(i)),i=i.double(),r>>=Ae;return n},precomputeWindow:function(e,r){for(var n=Be(r,t),i=n.windows,o=n.windowSize,a=[],s=e,c=s,u=0;u<i;u++){c=s,a.push(c);for(var f=1;f<o;f++)c=c.add(s),a.push(c);s=c.double()}return a},wNAF:function(r,n,i){for(var o=Be(r,t),a=o.windows,s=o.windowSize,c=e.ZERO,u=e.BASE,f=BigInt(Math.pow(2,r)-1),l=Math.pow(2,r),p=BigInt(r),h=0;h<a;h++){var d=h*s,v=Number(i&f);i>>=p,v>s&&(v-=l,i+=Ae);var g=d,y=d+Math.abs(v)-1,b=h%2!=0,m=v<0;0===v?u=u.add(Re(b,n[g])):c=c.add(Re(m,n[y]))}return{p:c,f:u}},wNAFUnsafe:function(r,n,i){for(var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.ZERO,a=Be(r,t),s=a.windows,c=a.windowSize,u=BigInt(Math.pow(2,r)-1),f=Math.pow(2,r),l=BigInt(r),p=0;p<s;p++){var h=p*c;if(i===Pe)break;var d=Number(i&u);if(i>>=l,d>c&&(d-=f,i+=Ae),0!==d){var v=n[h+Math.abs(d)-1];d<0&&(v=v.negate()),o=o.add(v)}}return o},getPrecomputes:function(e,t,r){var n=Ce.get(t);return n||(n=this.precomputeWindow(t,e),1!==e&&Ce.set(t,r(n))),n},wNAFCached:function(e,t,r){var n=Ne(e);return this.wNAF(n,this.getPrecomputes(n,e,r),t)},wNAFCachedUnsafe:function(e,t,r,n){var i=Ne(e);return 1===i?this.unsafeLadder(e,t,n):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),t,n)},setWindowSize:function(e,r){Te(r,t),Ue.set(e,r),Ce.delete(e)}}}(w,8*c);function O(e){return xe(e,n)}function _(e){return O(ne(e))}function P(e){var t=r.BYTES;e=ae("private key",e,t);var n=ae("hashed private key",o(e),2*t),i=d(n.slice(0,t)),a=n.slice(t,2*t),s=_(i),c=E.multiply(s),u=c.toRawBytes();return{head:i,prefix:a,scalar:s,point:c,pointBytes:u}}function A(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Uint8Array,t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var a=se.apply(void 0,r);return _(o(v(a,ae("context",e),!!i)))}var R=qe;return E._setWindowSize(8),{CURVE:t,getPublicKey:function(e){return P(e).pointBytes},sign:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e=ae("message",e),i&&(e=i(e));var a=P(t),s=a.prefix,c=a.scalar,u=a.pointBytes,f=A(o.context,s,e),l=E.multiply(f).toRawBytes(),p=O(f+A(o.context,l,u,e)*c);return ue("signature.s",p,je,n),ae("result",se(l,oe(p,r.BYTES)),2*r.BYTES)},verify:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:R,a=o.context,s=o.zip215,c=r.BYTES;e=ae("signature",e,2*c),t=ae("message",t),n=ae("publicKey",n,c),void 0!==s&&Q("zip215",s),i&&(t=i(t));var u,f,l,p=ne(e.slice(c,2*c));try{u=w.fromHex(n,s),f=w.fromHex(e.slice(0,c),s),l=E.multiplyUnsafe(p)}catch(d){return!1}if(!s&&u.isSmallOrder())return!1;var h=A(a,f.toRawBytes(),u.toRawBytes(),t);return f.add(u.multiplyUnsafe(h)).subtract(l).clearCofactor().equals(w.ZERO)},ExtendedPoint:w,utils:{getExtendedPublicKey:P,randomPrivateKey:function(){return s(r.BYTES)},precompute:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.BASE;return t._setWindowSize(e),t.multiply(BigInt(3)),t}}}}({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:We,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:He,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:V,randomBytes:m,adjustScalarBytes:function(e){return e[0]&=248,e[31]&=127,e[31]|=64,e},uvRatio:function(e,t){var r=ze,n=xe(t*t*t,r),i=function(e){var t=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),o=ze,a=e*e%o*e%o,s=Ee(a,Ke,o)*a%o,c=Ee(s,Fe,o)*e%o,u=Ee(c,Ve,o)*c%o,f=Ee(u,t,o)*u%o,l=Ee(f,r,o)*f%o,p=Ee(l,n,o)*l%o,h=Ee(p,i,o)*p%o,d=Ee(h,i,o)*p%o,v=Ee(d,t,o)*u%o;return{pow_p_5_8:Ee(v,Ke,o)*e%o,b2:a}}(e*xe(n*n*t,r)).pow_p_5_8,o=xe(e*n*i,r),a=xe(t*o*o,r),s=o,c=xe(o*Ze,r),u=a===e,f=a===xe(-e,r),l=a===xe(-e*Ze,r);return u&&(o=s),(f||l)&&(o=c),function(e,t){return(xe(e,t)&ve)===ve}(o,r)&&(o=xe(-o,r)),{isValid:u||f,value:o}}}),Je="base64url",Ye="did",Qe="key",Xe="base58btc";function $e(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function et(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?$e(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function tt(e,t){t||(t=e.reduce(function(e,t){return e+t.length},0));var r,n=et(t),i=0,o=u(e);try{for(o.s();!(r=o.n()).done;){var a=r.value;n.set(a,i),i+=a.length}}catch(s){o.e(s)}finally{o.f()}return $e(n)}var rt=function(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},nt=function(){function e(t,r,n){k(this,e),this.name=t,this.prefix=r,this.baseEncode=n}return x(e,[{key:"encode",value:function(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}]),e}(),it=function(){function e(t,r,n){if(k(this,e),this.name=t,this.prefix=r,void 0===r.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}return x(e,[{key:"decode",value:function(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}},{key:"or",value:function(e){return at(this,e)}}]),e}(),ot=function(){function e(t){k(this,e),this.decoders=t}return x(e,[{key:"or",value:function(e){return at(this,e)}},{key:"decode",value:function(e){var t=this.decoders[e[0]];if(t)return t.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}]),e}(),at=function(e,t){return new ot(a(a({},e.decoders||c({},e.prefix,e)),t.decoders||c({},t.prefix,t)))},st=function(){function e(t,r,n,i){k(this,e),this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new nt(t,r,n),this.decoder=new it(t,r,i)}return x(e,[{key:"encode",value:function(e){return this.encoder.encode(e)}},{key:"decode",value:function(e){return this.decoder.decode(e)}}]),e}(),ct=function(e){var t=e.name,r=e.prefix,n=e.encode,i=e.decode;return new st(t,r,n,i)},ut=function(e){var t=e.prefix,r=e.name,n=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),a=o.charCodeAt(0);if(255!==r[a])throw new TypeError(o+" is ambiguous");r[a]=i}var s=e.length,c=e.charAt(0),u=Math.log(s)/Math.log(256),f=Math.log(256)/Math.log(s);function l(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var o=(e.length-t)*u+1>>>0,a=new Uint8Array(o);e[t];){var f=r[e.charCodeAt(t)];if(255===f)return;for(var l=0,p=o-1;(0!==f||l<i)&&-1!==p;p--,l++)a[p]=(f+=s*a[p]>>>0)%256>>>0,f=f/256>>>0;if(0!==f)throw new Error("Non-zero carry");i=l,t++}if(" "!==e[t]){for(var h=o-i;h!==o&&0===a[h];)h++;for(var d=new Uint8Array(n+(o-h)),v=n;h!==o;)d[v++]=a[h++];return d}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var a=(o-i)*f+1>>>0,u=new Uint8Array(a);i!==o;){for(var l=t[i],p=0,h=a-1;(0!==l||p<n)&&-1!==h;h--,p++)u[h]=(l+=256*u[h]>>>0)%s>>>0,l=l/s>>>0;if(0!==l)throw new Error("Non-zero carry");n=p,i++}for(var d=a-n;d!==a&&0===u[d];)d++;for(var v=c.repeat(r);d<a;++d)v+=e.charAt(u[d]);return v},decodeUnsafe:l,decode:function(e){var r=l(e);if(r)return r;throw new Error("Non-".concat(t," character"))}}}(e.alphabet,r),i=n.encode,o=n.decode;return ct({prefix:t,name:r,encode:i,decode:function(e){return rt(o(e))}})},ft=function(e){var t=e.name,r=e.prefix,n=e.bitsPerChar,i=e.alphabet;return ct({prefix:r,name:t,encode:function(e){return function(e,t,r){for(var n="="===t[t.length-1],i=(1<<r)-1,o="",a=0,s=0,c=0;c<e.length;++c)for(s=s<<8|e[c],a+=8;a>r;)o+=t[i&s>>(a-=r)];if(a&&(o+=t[i&s<<r-a]),n)for(;o.length*r&7;)o+="=";return o}(e,i,n)},decode:function(e){return function(e,t,r,n){for(var i={},o=0;o<t.length;++o)i[t[o]]=o;for(var a=e.length;"="===e[a-1];)--a;for(var s=new Uint8Array(a*r/8|0),c=0,u=0,f=0,l=0;l<a;++l){var p=i[e[l]];if(void 0===p)throw new SyntaxError("Non-".concat(n," character"));u=u<<r|p,(c+=r)>=8&&(c-=8,s[f++]=255&u>>c)}if(c>=r||255&u<<8-c)throw new SyntaxError("Unexpected end of data");return s}(e,i,n,t)}})},lt=ct({prefix:"\0",name:"identity",encode:function(e){return function(e){return(new TextDecoder).decode(e)}(e)},decode:function(e){return function(e){return(new TextEncoder).encode(e)}(e)}}),pt=Object.freeze({__proto__:null,identity:lt}),ht=ft({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),dt=Object.freeze({__proto__:null,base2:ht}),vt=ft({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),gt=Object.freeze({__proto__:null,base8:vt}),yt=ut({prefix:"9",name:"base10",alphabet:"0123456789"}),bt=Object.freeze({__proto__:null,base10:yt}),mt=ft({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),wt=ft({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),xt=Object.freeze({__proto__:null,base16:mt,base16upper:wt}),kt=ft({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Et=ft({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),It=ft({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),St=ft({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ot=ft({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),_t=ft({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Pt=ft({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),At=ft({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Rt=ft({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Tt=Object.freeze({__proto__:null,base32:kt,base32upper:Et,base32pad:It,base32padupper:St,base32hex:Ot,base32hexupper:_t,base32hexpad:Pt,base32hexpadupper:At,base32z:Rt}),Bt=ut({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Ct=ut({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Ut=Object.freeze({__proto__:null,base36:Bt,base36upper:Ct}),Nt=ut({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),jt=ut({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Lt=Object.freeze({__proto__:null,base58btc:Nt,base58flickr:jt}),Dt=ft({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Mt=ft({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),qt=ft({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),zt=ft({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Zt=Object.freeze({__proto__:null,base64:Dt,base64pad:Mt,base64url:qt,base64urlpad:zt}),Ft=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),Kt=Ft.reduce(function(e,t,r){return e[r]=t,e},[]),Vt=Ft.reduce(function(e,t,r){return e[t.codePointAt(0)]=r,e},[]),Ht=ct({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(function(e,t){return e+Kt[t]},"")},decode:function(e){var t,r=[],n=u(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,o=Vt[i.codePointAt(0)];if(void 0===o)throw new Error("Non-base256emoji character: ".concat(i));r.push(o)}}catch(a){n.e(a)}finally{n.f()}return new Uint8Array(r)}}),Wt=Object.freeze({__proto__:null,base256emoji:Ht}),Gt=Math.pow(2,31),Jt=Math.pow(2,7),Yt=Math.pow(2,14),Qt=Math.pow(2,21),Xt=Math.pow(2,28),$t=Math.pow(2,35),er=Math.pow(2,42),tr=Math.pow(2,49),rr=Math.pow(2,56),nr=Math.pow(2,63),ir=function e(t,r,n){r=r||[];for(var i=n=n||0;t>=Gt;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},or=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ir(e,t,r),t},ar=function(e){return function(e){return e<Jt?1:e<Yt?2:e<Qt?3:e<Xt?4:e<$t?5:e<er?6:e<tr?7:e<rr?8:e<nr?9:10}(e)},sr=function(e,t){var r=t.byteLength,n=ar(e),i=n+ar(r),o=new Uint8Array(i+r);return or(e,o,0),or(r,o,n),o.set(t,i),new cr(e,r,t,o)},cr=x(function e(t,r,n,i){k(this,e),this.code=t,this.size=r,this.digest=n,this.bytes=i}),ur=function(e){var t=e.name,r=e.code,n=e.encode;return new fr(t,r,n)},fr=function(){function e(t,r,n){k(this,e),this.name=t,this.code=r,this.encode=n}return x(e,[{key:"digest",value:function(e){var t=this;if(e instanceof Uint8Array){var r=this.encode(e);return r instanceof Uint8Array?sr(this.code,r):r.then(function(e){return sr(t.code,e)})}throw Error("Unknown type, must be binary type")}}]),e}(),lr=function(e){return function(){var t=(0,n.Z)(p().mark(function t(r){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Uint8Array,t.next=3,crypto.subtle.digest(e,r);case 3:return t.t1=t.sent,t.abrupt("return",new t.t0(t.t1));case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},pr=ur({name:"sha2-256",code:18,encode:lr("SHA-256")}),hr=ur({name:"sha2-512",code:19,encode:lr("SHA-512")});Object.freeze({__proto__:null,sha256:pr,sha512:hr});var dr=rt;Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:dr,digest:function(e){return sr(0,dr(e))}}}),new TextEncoder,new TextDecoder;var vr=a(a(a(a(a(a(a(a(a(a({},pt),dt),gt),bt),xt),Tt),Ut),Lt),Zt),Wt);function gr(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var yr=gr("utf8","u",function(e){return"u"+new TextDecoder("utf8").decode(e)},function(e){return(new TextEncoder).encode(e.substring(1))}),br=gr("ascii","a",function(e){for(var t="a",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},function(e){for(var t=et((e=e.substring(1)).length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),mr=a({utf8:yr,"utf-8":yr,hex:vr.base16,latin1:br,ascii:br,binary:br},vr);function wr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",r=mr[t];if(!r)throw new Error('Unsupported encoding "'.concat(t,'"'));return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}function xr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",r=mr[t];if(!r)throw new Error('Unsupported encoding "'.concat(t,'"'));return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode("".concat(r.prefix).concat(e)):$e(globalThis.Buffer.from(e,"utf-8"))}function kr(e){return(0,f.D)(wr(xr(e,Je),"utf8"))}function Er(e){return wr(xr((0,f.u)(e),"utf8"),Je)}function Ir(e){var t="z"+wr(tt([xr("K36",Xe),e]),Xe);return[Ye,Qe,t].join(":")}function Sr(e){return wr(e,Je)}function Or(e){return xr([Er(e.header),Er(e.payload)].join("."),"utf8")}function _r(e){return[Er(e.header),Er(e.payload),Sr(e.signature)].join(".")}function Pr(e){var t=e.split("."),r=kr(t[0]),n=kr(t[1]),i=function(e){return xr(e,Je)}(t[2]);return{header:r,payload:n,signature:i,data:xr(t.slice(0,2).join("."),"utf8")}}function Ar(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m(32),t=Ge.getPublicKey(e);return{secretKey:tt([e,t]),publicKey:t}}function Rr(e,t,r,n){return Tr.apply(this,arguments)}function Tr(){return(Tr=(0,n.Z)(function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(0,o.fromMiliseconds)(Date.now());return p().mark(function o(){var a,s,c;return p().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return a={alg:"EdDSA",typ:"JWT"},s={iss:Ir(n.publicKey),sub:e,aud:t,iat:i,exp:i+r},c=Or({header:a,payload:s}),o.abrupt("return",_r({header:a,payload:s,signature:Ge.sign(c,n.secretKey.slice(0,32))}));case 2:case"end":return o.stop()}},o)})()})).apply(this,arguments)}},80328:function(e,t,r){"use strict";function n(e){if("string"!=typeof e)throw new Error("Cannot safe json parse value of type "+typeof e);try{return function(e){var t=e.replace(/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,'$1"$2n"$3');return JSON.parse(t,function(e,t){return"string"==typeof t&&t.match(/^\d+n$/)?BigInt(t.substring(0,t.length-1)):t})}(e)}catch(t){return e}}function i(e){return"string"==typeof e?e:function(e){return JSON.stringify(e,function(e,t){return"bigint"==typeof t?t.toString()+"n":t})}(e)||""}r.d(t,{D:function(){return n},u:function(){return i}})},78847:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(80017);n.__exportStar(r(77662),t),n.__exportStar(r(45898),t)},77662:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_THOUSAND=t.ONE_HUNDRED=void 0,t.ONE_HUNDRED=100,t.ONE_THOUSAND=1e3},45898:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=5*t.ONE_MINUTE,t.TEN_MINUTES=10*t.ONE_MINUTE,t.THIRTY_MINUTES=30*t.ONE_MINUTE,t.SIXTY_MINUTES=60*t.ONE_MINUTE,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=3*t.ONE_HOUR,t.SIX_HOURS=6*t.ONE_HOUR,t.TWELVE_HOURS=12*t.ONE_HOUR,t.TWENTY_FOUR_HOURS=24*t.ONE_HOUR,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=3*t.ONE_DAY,t.FIVE_DAYS=5*t.ONE_DAY,t.SEVEN_DAYS=7*t.ONE_DAY,t.THIRTY_DAYS=30*t.ONE_DAY,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=2*t.ONE_WEEK,t.THREE_WEEKS=3*t.ONE_WEEK,t.FOUR_WEEKS=4*t.ONE_WEEK,t.ONE_YEAR=365*t.ONE_DAY},14611:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(80017);n.__exportStar(r(47344),t),n.__exportStar(r(1429),t),n.__exportStar(r(40214),t),n.__exportStar(r(78847),t)},40214:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(80017).__exportStar(r(47997),t)},47997:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IWatch=void 0,t.IWatch=function(){return x(function e(){k(this,e)})}()},45442:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromMiliseconds=t.toMiliseconds=void 0;var n=r(78847);t.toMiliseconds=function(e){return e*n.ONE_THOUSAND},t.fromMiliseconds=function(e){return Math.floor(e/n.ONE_THOUSAND)}},67406:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delay=void 0,t.delay=function(e){return new Promise(function(t){setTimeout(function(){t(!0)},e)})}},47344:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(80017);n.__exportStar(r(67406),t),n.__exportStar(r(45442),t)},1429:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Watch=void 0;var r=function(){function e(){k(this,e),this.timestamps=new Map}return x(e,[{key:"start",value:function(e){if(this.timestamps.has(e))throw new Error("Watch already started for label: ".concat(e));this.timestamps.set(e,{started:Date.now()})}},{key:"stop",value:function(e){var t=this.get(e);if(void 0!==t.elapsed)throw new Error("Watch already stopped for label: ".concat(e));var r=Date.now()-t.started;this.timestamps.set(e,{started:t.started,elapsed:r})}},{key:"get",value:function(e){var t=this.timestamps.get(e);if(void 0===t)throw new Error("No timestamp found for label: ".concat(e));return t}},{key:"elapsed",value:function(e){var t=this.get(e);return t.elapsed||Date.now()-t.started}}]),e}();t.Watch=r,t.default=r},37167:function(e,t){"use strict";function r(e){var t;return"undefined"!=typeof window&&void 0!==window[e]&&(t=window[e]),t}function n(e){var t=r(e);if(!t)throw new Error("".concat(e," is not defined in Window"));return t}Object.defineProperty(t,"__esModule",{value:!0}),t.getLocalStorage=t.getLocalStorageOrThrow=t.getCrypto=t.getCryptoOrThrow=t.getLocation=t.getLocationOrThrow=t.getNavigator=t.getNavigatorOrThrow=t.getDocument=t.getDocumentOrThrow=t.getFromWindowOrThrow=t.getFromWindow=void 0,t.getFromWindow=r,t.getFromWindowOrThrow=n,t.getDocumentOrThrow=function(){return n("document")},t.getDocument=function(){return r("document")},t.getNavigatorOrThrow=function(){return n("navigator")},t.getNavigator=function(){return r("navigator")},t.getLocationOrThrow=function(){return n("location")},t.getLocation=function(){return r("location")},t.getCryptoOrThrow=function(){return n("crypto")},t.getCrypto=function(){return r("crypto")},t.getLocalStorageOrThrow=function(){return n("localStorage")},t.getLocalStorage=function(){return r("localStorage")}},78359:function(e,t,r){"use strict";t.D=void 0;var n=r(37167);t.D=function(){var e,t;try{e=n.getDocumentOrThrow(),t=n.getLocationOrThrow()}catch(a){return null}function r(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var i=e.getElementsByTagName("meta"),o=function(e){var t=i[e],n=["itemprop","property","name"].map(function(e){return t.getAttribute(e)}).filter(function(e){return!!e&&r.includes(e)});if(n.length&&n){var o=t.getAttribute("content");if(o)return{v:o}}},a=0;a<i.length;a++){var s=o(a);if("object"==typeof s)return s.v}return""}var i,o=((i=r("name","og:site_name","og:title","twitter:title"))||(i=e.title),i);return{description:r("description","og:description","twitter:description","keywords"),url:t.origin,icons:function(){for(var r=e.getElementsByTagName("link"),n=[],i=0;i<r.length;i++){var o=r[i],a=o.getAttribute("rel");if(a&&a.toLowerCase().indexOf("icon")>-1){var s=o.getAttribute("href");if(s)if(-1===s.toLowerCase().indexOf("https:")&&-1===s.toLowerCase().indexOf("http:")&&0!==s.indexOf("//")){var c=t.protocol+"//"+t.host;if(0===s.indexOf("/"))c+=s;else{var u=t.pathname.split("/");u.pop(),c+=u.join("/")+"/"+s}n.push(c)}else 0===s.indexOf("//")?n.push(t.protocol+s):n.push(s)}}return n}(),name:o}}},49764:function(e,t,r){var n=r(29888);function i(e,t,r){var n=e[t]+e[r],i=e[t+1]+e[r+1];n>=4294967296&&i++,e[t]=n,e[t+1]=i}function o(e,t,r,n){var i=e[t]+r;r<0&&(i+=4294967296);var o=e[t+1]+n;i>=4294967296&&o++,e[t]=i,e[t+1]=o}function a(e,t){return e[t]^e[t+1]<<8^e[t+2]<<16^e[t+3]<<24}function s(e,t,r,n,a,s){var c=l[a],u=l[a+1],p=l[s],h=l[s+1];i(f,e,t),o(f,e,c,u);var d=f[n]^f[e],v=f[n+1]^f[e+1];f[n]=v,f[n+1]=d,i(f,r,n),d=f[t]^f[r],v=f[t+1]^f[r+1],f[t]=d>>>24^v<<8,f[t+1]=v>>>24^d<<8,i(f,e,t),o(f,e,p,h),d=f[n]^f[e],v=f[n+1]^f[e+1],f[n]=d>>>16^v<<16,f[n+1]=v>>>16^d<<16,i(f,r,n),d=f[t]^f[r],v=f[t+1]^f[r+1],f[t]=v>>>31^d<<1,f[t+1]=d>>>31^v<<1}var c=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),u=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map(function(e){return 2*e})),f=new Uint32Array(32),l=new Uint32Array(32);function p(e,t){var r=0;for(r=0;r<16;r++)f[r]=e.h[r],f[r+16]=c[r];for(f[24]=f[24]^e.t,f[25]=f[25]^e.t/4294967296,t&&(f[28]=~f[28],f[29]=~f[29]),r=0;r<32;r++)l[r]=a(e.b,4*r);for(r=0;r<12;r++)s(0,8,16,24,u[16*r+0],u[16*r+1]),s(2,10,18,26,u[16*r+2],u[16*r+3]),s(4,12,20,28,u[16*r+4],u[16*r+5]),s(6,14,22,30,u[16*r+6],u[16*r+7]),s(0,10,20,30,u[16*r+8],u[16*r+9]),s(2,12,22,24,u[16*r+10],u[16*r+11]),s(4,14,16,26,u[16*r+12],u[16*r+13]),s(6,8,18,28,u[16*r+14],u[16*r+15]);for(r=0;r<16;r++)e.h[r]=e.h[r]^f[r]^f[r+16]}var h=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function d(e,t,r,n){if(0===e||e>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(t&&t.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(r&&16!==r.length)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(n&&16!==n.length)throw new Error("Illegal personal, expected Uint8Array with length is 16");var i={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:e};h.fill(0),h[0]=e,t&&(h[1]=t.length),h[2]=1,h[3]=1,r&&h.set(r,32),n&&h.set(n,48);for(var o=0;o<16;o++)i.h[o]=c[o]^a(h,4*o);return t&&(v(i,t),i.c=128),i}function v(e,t){for(var r=0;r<t.length;r++)128===e.c&&(e.t+=e.c,p(e,!1),e.c=0),e.b[e.c++]=t[r]}function g(e){for(e.t+=e.c;e.c<128;)e.b[e.c++]=0;p(e,!0);for(var t=new Uint8Array(e.outlen),r=0;r<e.outlen;r++)t[r]=e.h[r>>2]>>8*(3&r);return t}function y(e,t,r,i,o){r=r||64,e=n.normalizeInput(e),i&&(i=n.normalizeInput(i)),o&&(o=n.normalizeInput(o));var a=d(r,t,i,o);return v(a,e),g(a)}e.exports={blake2b:y,blake2bHex:function(e,t,r,i,o){var a=y(e,t,r,i,o);return n.toHex(a)},blake2bInit:d,blake2bUpdate:v,blake2bFinal:g}},14471:function(e,t,r){var n=r(29888);function i(e,t){return e[t]^e[t+1]<<8^e[t+2]<<16^e[t+3]<<24}function o(e,t,r,n,i,o){u[e]=u[e]+u[t]+i,u[n]=a(u[n]^u[e],16),u[r]=u[r]+u[n],u[t]=a(u[t]^u[r],12),u[e]=u[e]+u[t]+o,u[n]=a(u[n]^u[e],8),u[r]=u[r]+u[n],u[t]=a(u[t]^u[r],7)}function a(e,t){return e>>>t^e<<32-t}var s=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),c=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),u=new Uint32Array(16),f=new Uint32Array(16);function l(e,t){var r=0;for(r=0;r<8;r++)u[r]=e.h[r],u[r+8]=s[r];for(u[12]^=e.t,u[13]^=e.t/4294967296,t&&(u[14]=~u[14]),r=0;r<16;r++)f[r]=i(e.b,4*r);for(r=0;r<10;r++)o(0,4,8,12,f[c[16*r+0]],f[c[16*r+1]]),o(1,5,9,13,f[c[16*r+2]],f[c[16*r+3]]),o(2,6,10,14,f[c[16*r+4]],f[c[16*r+5]]),o(3,7,11,15,f[c[16*r+6]],f[c[16*r+7]]),o(0,5,10,15,f[c[16*r+8]],f[c[16*r+9]]),o(1,6,11,12,f[c[16*r+10]],f[c[16*r+11]]),o(2,7,8,13,f[c[16*r+12]],f[c[16*r+13]]),o(3,4,9,14,f[c[16*r+14]],f[c[16*r+15]]);for(r=0;r<8;r++)e.h[r]^=u[r]^u[r+8]}function p(e,t){if(!(e>0&&e<=32))throw new Error("Incorrect output length, should be in [1, 32]");var r=t?t.length:0;if(t&&!(r>0&&r<=32))throw new Error("Incorrect key length, should be in [1, 32]");var n={h:new Uint32Array(s),b:new Uint8Array(64),c:0,t:0,outlen:e};return n.h[0]^=16842752^r<<8^e,r>0&&(h(n,t),n.c=64),n}function h(e,t){for(var r=0;r<t.length;r++)64===e.c&&(e.t+=e.c,l(e,!1),e.c=0),e.b[e.c++]=t[r]}function d(e){for(e.t+=e.c;e.c<64;)e.b[e.c++]=0;l(e,!0);for(var t=new Uint8Array(e.outlen),r=0;r<e.outlen;r++)t[r]=e.h[r>>2]>>8*(3&r)&255;return t}function v(e,t,r){r=r||32,e=n.normalizeInput(e);var i=p(r,t);return h(i,e),d(i)}e.exports={blake2s:v,blake2sHex:function(e,t,r){var i=v(e,t,r);return n.toHex(i)},blake2sInit:p,blake2sUpdate:h,blake2sFinal:d}},40187:function(e,t,r){var n=r(49764),i=r(14471);e.exports={blake2b:n.blake2b,blake2bHex:n.blake2bHex,blake2bInit:n.blake2bInit,blake2bUpdate:n.blake2bUpdate,blake2bFinal:n.blake2bFinal,blake2s:i.blake2s,blake2sHex:i.blake2sHex,blake2sInit:i.blake2sInit,blake2sUpdate:i.blake2sUpdate,blake2sFinal:i.blake2sFinal}},29888:function(e){function t(e){return(4294967296+e).toString(16).substring(1)}e.exports={normalizeInput:function(e){var t;if(e instanceof Uint8Array)t=e;else{if("string"!=typeof e)throw new Error("Input must be an string, Buffer or Uint8Array");t=(new TextEncoder).encode(e)}return t},toHex:function(e){return Array.prototype.map.call(e,function(e){return(e<16?"0":"")+e.toString(16)}).join("")},debugPrint:function(e,r,n){for(var i="\n"+e+" = ",o=0;o<r.length;o+=2){if(32===n)i+=t(r[o]).toUpperCase(),i+=" ",i+=t(r[o+1]).toUpperCase();else{if(64!==n)throw new Error("Invalid size "+n);i+=t(r[o+1]).toUpperCase(),i+=t(r[o]).toUpperCase()}o%6==4?i+="\n"+new Array(e.length+4).join(" "):o<r.length-2&&(i+=" ")}console.log(i)},testSpeed:function(e,t,r){for(var n=(new Date).getTime(),i=new Uint8Array(t),o=0;o<t;o++)i[o]=o%256;var a=(new Date).getTime();console.log("Generated random input in "+(a-n)+"ms"),n=a;for(var s=0;s<r;s++){var c=e(i),u=(new Date).getTime(),f=u-n;n=u,console.log("Hashed in "+f+"ms: "+c.substring(0,20)+"..."),console.log(Math.round(t/(1<<20)/(f/1e3)*100)/100+" MB PER SECOND")}}}},75630:function(e,t){var r,n="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||"undefined"!=typeof global&&global,i=function(){function e(){this.fetch=!1,this.DOMException=n.DOMException}return e.prototype=n,new e}();r=i,function(e){var t=void 0!==r&&r||"undefined"!=typeof self&&self||"undefined"!=typeof global&&global||{},n="URLSearchParams"in t,i="Symbol"in t&&"iterator"in Symbol,o="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(e){return!1}}(),a="FormData"in t,s="ArrayBuffer"in t;if(s)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(e){return e&&c.indexOf(Object.prototype.toString.call(e))>-1};function f(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function l(e){return"string"!=typeof e&&(e=String(e)),e}function p(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return i&&(t[Symbol.iterator]=function(){return t}),t}function h(e){this.map={},e instanceof h?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){if(2!=e.length)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function d(e){if(!e._noBody){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}}function v(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function g(e){var t=new FileReader,r=v(t);return t.readAsArrayBuffer(e),r}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(e){this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:o&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:a&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():s&&o&&function(e){return e&&DataView.prototype.isPrototypeOf(e)}(e)?(this._bodyArrayBuffer=y(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(e)||u(e))?this._bodyArrayBuffer=y(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var e=d(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer)return d(this)||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer));if(o)return this.blob().then(g);throw new Error("could not read as ArrayBuffer")},this.text=function(){var e=d(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,r=v(t),n=/charset=([A-Za-z0-9_-]+)/.exec(e.type);return t.readAsText(e,n?n[1]:"utf-8"),r}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a&&(this.formData=function(){return this.text().then(x)}),this.json=function(){return this.text().then(JSON.parse)},this}h.prototype.append=function(e,t){e=f(e),t=l(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},h.prototype.delete=function(e){delete this.map[f(e)]},h.prototype.get=function(e){return e=f(e),this.has(e)?this.map[e]:null},h.prototype.has=function(e){return this.map.hasOwnProperty(f(e))},h.prototype.set=function(e,t){this.map[f(e)]=l(t)},h.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},h.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),p(e)},h.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),p(e)},h.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),p(e)},i&&(h.prototype[Symbol.iterator]=h.prototype.entries);var m=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function w(e,r){if(!(this instanceof w))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n=(r=r||{}).body;if(e instanceof w){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,r.headers||(this.headers=new h(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,!n&&null!=e._bodyInit&&(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=r.credentials||this.credentials||"same-origin",(r.headers||!this.headers)&&(this.headers=new h(r.headers)),this.method=function(e){var t=e.toUpperCase();return m.indexOf(t)>-1?t:e}(r.method||this.method||"GET"),this.mode=r.mode||this.mode||null,this.signal=r.signal||this.signal||function(){if("AbortController"in t)return(new AbortController).signal}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(n),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==r.cache&&"no-cache"!==r.cache)){var i=/([?&])_=[^&]*/;i.test(this.url)?this.url=this.url.replace(i,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}function x(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}}),t}function k(e){var t=new h;return e.replace(/\r?\n[\t ]+/g," ").split("\r").map(function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e}).forEach(function(e){var r=e.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();try{t.append(n,i)}catch(o){console.warn("Response "+o.message)}}}),t}function E(e,t){if(!(this instanceof E))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new h(t.headers),this.url=t.url||"",this._initBody(e)}w.prototype.clone=function(){return new w(this,{body:this._bodyInit})},b.call(w.prototype),b.call(E.prototype),E.prototype.clone=function(){return new E(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},E.error=function(){var e=new E(null,{status:200,statusText:""});return e.ok=!1,e.status=0,e.type="error",e};var I=[301,302,303,307,308];E.redirect=function(e,t){if(-1===I.indexOf(t))throw new RangeError("Invalid status code");return new E(null,{status:t,headers:{location:e}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(O){e.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function S(r,n){return new Promise(function(i,a){var c=new w(r,n);if(c.signal&&c.signal.aborted)return a(new e.DOMException("Aborted","AbortError"));var u=new XMLHttpRequest;function p(){u.abort()}if(u.onload=function(){var e={statusText:u.statusText,headers:k(u.getAllResponseHeaders()||"")};e.status=0===c.url.indexOf("file://")&&(u.status<200||u.status>599)?200:u.status,e.url="responseURL"in u?u.responseURL:e.headers.get("X-Request-URL");var t="response"in u?u.response:u.responseText;setTimeout(function(){i(new E(t,e))},0)},u.onerror=function(){setTimeout(function(){a(new TypeError("Network request failed"))},0)},u.ontimeout=function(){setTimeout(function(){a(new TypeError("Network request timed out"))},0)},u.onabort=function(){setTimeout(function(){a(new e.DOMException("Aborted","AbortError"))},0)},u.open(c.method,function(e){try{return""===e&&t.location.href?t.location.href:e}catch(r){return e}}(c.url),!0),"include"===c.credentials?u.withCredentials=!0:"omit"===c.credentials&&(u.withCredentials=!1),"responseType"in u&&(o?u.responseType="blob":s&&(u.responseType="arraybuffer")),n&&"object"==typeof n.headers&&!(n.headers instanceof h||t.Headers&&n.headers instanceof t.Headers)){var d=[];Object.getOwnPropertyNames(n.headers).forEach(function(e){d.push(f(e)),u.setRequestHeader(e,l(n.headers[e]))}),c.headers.forEach(function(e,t){-1===d.indexOf(t)&&u.setRequestHeader(t,e)})}else c.headers.forEach(function(e,t){u.setRequestHeader(t,e)});c.signal&&(c.signal.addEventListener("abort",p),u.onreadystatechange=function(){4===u.readyState&&c.signal.removeEventListener("abort",p)}),u.send(void 0===c._bodyInit?null:c._bodyInit)})}S.polyfill=!0,t.fetch||(t.fetch=S,t.Headers=h,t.Request=w,t.Response=E),e.Headers=h,e.Request=w,e.Response=E,e.fetch=S,Object.defineProperty(e,"__esModule",{value:!0})}({}),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var o=n.fetch?n:i;(t=o.fetch).default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,e.exports=t},97057:function(e,t,r){"use strict";r.d(t,{qY:function(){return p}});var n=function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)(n||!(i in t))&&(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},i=function(e,t,r){this.name=e,this.version=t,this.os=r,this.type="browser"},o=function(e){this.version=e,this.type="node",this.name="node",this.os=process.platform},a=function(e,t,r,n){this.name=e,this.version=t,this.os=r,this.bot=n,this.type="bot-device"},s=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},c=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},u=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,f=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],l=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function p(e){return e?h(e):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new c:"undefined"!=typeof navigator?h(navigator.userAgent):"undefined"!=typeof process&&process.version?new o(process.version.slice(1)):null}function h(e){var t=function(e){return""!==e&&f.reduce(function(t,r){var n=r[0];if(t)return t;var i=r[1].exec(e);return!!i&&[n,i]},!1)}(e);if(!t)return null;var r=t[0],o=t[1];if("searchbot"===r)return new s;var c=o[1]&&o[1].split(".").join("_").split("_").slice(0,3);c?c.length<3&&(c=n(n([],c,!0),function(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}(3-c.length),!0)):c=[];var p=c.join("."),h=function(e){for(var t=0,r=l.length;t<r;t++){var n=l[t],i=n[0];if(n[1].exec(e))return i}return null}(e),d=u.exec(e);return d&&d[1]?new a(r,p,h,d[1]):new i(r,p,h)}},93105:function(e){"use strict";var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise(function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}v(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&v(e,"error",t,{once:!0})}(e,i)})},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var a=10;function s(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function u(e,t,r,n){var i,o,a;if(s(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),a=o[t]),void 0===a)a=o[t]=r,++e._eventsCount;else if("function"==typeof a?a=o[t]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),(i=c(e))>0&&a.length>i&&!a.warned){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=a.length,function(e){console&&console.warn&&console.warn(e)}(u)}return e}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=f.bind(n);return i.listener=r,n.wrapFn=i,i}function p(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):d(i,i.length)}function h(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function d(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function v(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function i(o){n.once&&e.removeEventListener(t,i),r(o)})}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),o.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)n(c,this,t);else{var u=c.length,f=d(c,u);for(r=0;r<u;++r)n(f[r],this,t)}return!0},o.prototype.on=o.prototype.addListener=function(e,t){return u(this,e,t,!1)},o.prototype.prependListener=function(e,t){return u(this,e,t,!0)},o.prototype.once=function(e,t){return s(t),this.on(e,l(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return s(t),this.prependListener(e,l(this,e,t)),this},o.prototype.off=o.prototype.removeListener=function(e,t){var r,n,i,o,a;if(s(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){a=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,a||t)}return this},o.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},o.prototype.listeners=function(e){return p(this,e,!0)},o.prototype.rawListeners=function(e){return p(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},o.prototype.listenerCount=h,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},33172:function(e,t,r){"use strict";r.r(t),r.d(t,{__extends:function(){return i},__assign:function(){return o},__rest:function(){return a},__decorate:function(){return s},__param:function(){return c},__metadata:function(){return u},__awaiter:function(){return f},__generator:function(){return l},__createBinding:function(){return p},__exportStar:function(){return h},__values:function(){return d},__read:function(){return v},__spread:function(){return g},__spreadArrays:function(){return y},__await:function(){return b},__asyncGenerator:function(){return m},__asyncDelegator:function(){return w},__asyncValues:function(){return x},__makeTemplateObject:function(){return k},__importStar:function(){return E},__importDefault:function(){return I},__classPrivateFieldGet:function(){return S},__classPrivateFieldSet:function(){return O}});var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function i(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function s(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function u(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{c(n.next(e))}catch(t){o(t)}}function s(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){e.done?i(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(a,s)}c((n=n.apply(e,t||[])).next())})}function l(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function p(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}function h(e,t){for(var r in e)"default"!==r&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function d(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}function g(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function y(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)n[i]=o[a];return n}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function m(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){i[e]&&(n[e]=function(t){return new Promise(function(r,n){o.push([e,t,r,n])>1||s(e,t)})})}function s(e,t){try{!function(e){e.value instanceof b?Promise.resolve(e.value.v).then(c,u):f(o[0][2],e)}(i[e](t))}catch(r){f(o[0][3],r)}}function c(e){s("next",e)}function u(e){s("throw",e)}function f(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function w(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:b(e[n](t)),done:"return"===n}:i?i(t):t}:i}}function x(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=d(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){!function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}(n,i,(t=e[r](t)).done,t.value)})}}}function k(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function I(e){return e&&e.__esModule?e:{default:e}}function S(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function O(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}},80017:function(e,t,r){"use strict";r.r(t),r.d(t,{__extends:function(){return i},__assign:function(){return o},__rest:function(){return a},__decorate:function(){return s},__param:function(){return c},__metadata:function(){return u},__awaiter:function(){return f},__generator:function(){return l},__createBinding:function(){return p},__exportStar:function(){return h},__values:function(){return d},__read:function(){return v},__spread:function(){return g},__spreadArrays:function(){return y},__await:function(){return b},__asyncGenerator:function(){return m},__asyncDelegator:function(){return w},__asyncValues:function(){return x},__makeTemplateObject:function(){return k},__importStar:function(){return E},__importDefault:function(){return I},__classPrivateFieldGet:function(){return S},__classPrivateFieldSet:function(){return O}});var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function i(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function s(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function u(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{c(n.next(e))}catch(t){o(t)}}function s(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){e.done?i(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(a,s)}c((n=n.apply(e,t||[])).next())})}function l(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function p(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}function h(e,t){for(var r in e)"default"!==r&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function d(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}function g(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function y(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)n[i]=o[a];return n}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function m(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){i[e]&&(n[e]=function(t){return new Promise(function(r,n){o.push([e,t,r,n])>1||s(e,t)})})}function s(e,t){try{!function(e){e.value instanceof b?Promise.resolve(e.value.v).then(c,u):f(o[0][2],e)}(i[e](t))}catch(r){f(o[0][3],r)}}function c(e){s("next",e)}function u(e){s("throw",e)}function f(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function w(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:b(e[n](t)),done:"return"===n}:i?i(t):t}:i}}function x(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=d(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){!function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}(n,i,(t=e[r](t)).done,t.value)})}}}function k(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function I(e){return e&&e.__esModule?e:{default:e}}function S(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function O(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}},24517:function(e,t,r){"use strict";function n(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function i(e,t){return!!Array.isArray(t)&&(0===t.length||t.every(e?function(e){return"string"==typeof e}:function(e){return Number.isSafeInteger(e)}))}function o(e){if("function"!=typeof e)throw new Error("function expected");return!0}function a(e,t){if("string"!=typeof t)throw new Error("".concat(e,": string expected"));return!0}function s(e){if(!Number.isSafeInteger(e))throw new Error("invalid integer: ".concat(e))}function c(e){if(!Array.isArray(e))throw new Error("array expected")}function f(e,t){if(!i(!0,t))throw new Error("".concat(e,": array of strings expected"))}function l(e,t){if(!i(!1,t))throw new Error("".concat(e,": array of numbers expected"))}function p(){for(var e=function(e){return e},t=function(e,t){return function(r){return e(t(r))}},r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return{encode:n.map(function(e){return e.encode}).reduceRight(t,e),decode:n.map(function(e){return e.decode}).reduce(t,e)}}function h(e){var t="string"==typeof e?e.split(""):e,r=t.length;f("alphabet",t);var n=new Map(t.map(function(e,t){return[e,t]}));return{encode:function(n){return c(n),n.map(function(n){if(!Number.isSafeInteger(n)||n<0||n>=r)throw new Error('alphabet.encode: digit index outside alphabet "'.concat(n,'". Allowed: ').concat(e));return t[n]})},decode:function(t){return c(t),t.map(function(t){a("alphabet.decode",t);var r=n.get(t);if(void 0===r)throw new Error('Unknown letter: "'.concat(t,'". Allowed: ').concat(e));return r})}}}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return a("join",e),{encode:function(t){return f("join.decode",t),t.join(e)},decode:function(t){return a("join.decode",t),t.split(e)}}}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"=";return s(e),a("padding",t),{encode:function(r){for(f("padding.encode",r);r.length*e%8;)r.push(t);return r},decode:function(r){f("padding.decode",r);var n=r.length;if(n*e%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;n>0&&r[n-1]===t;n--)if((n-1)*e%8==0)throw new Error("padding: invalid, string has too much padding");return r.slice(0,n)}}}function g(e){return o(e),{encode:function(e){return e},decode:function(t){return e(t)}}}function y(e,t,r){if(t<2)throw new Error("convertRadix: invalid from=".concat(t,", base cannot be less than 2"));if(r<2)throw new Error("convertRadix: invalid to=".concat(r,", base cannot be less than 2"));if(c(e),!e.length)return[];for(var n=0,i=[],o=Array.from(e,function(e){if(s(e),e<0||e>=t)throw new Error("invalid integer: ".concat(e));return e}),a=o.length;;){for(var u=0,f=!0,l=n;l<a;l++){var p=o[l],h=t*u,d=h+p;if(!Number.isSafeInteger(d)||h/t!==u||d-p!==h)throw new Error("convertRadix: carry overflow");u=d%r;var v=Math.floor(d/r);if(o[l]=v,!Number.isSafeInteger(v)||v*r+u!==d)throw new Error("convertRadix: carry overflow");f&&(v?f=!1:n=l)}if(i.push(u),f)break}for(var g=0;g<e.length-1&&0===e[g];g++)i.push(0);return i.reverse()}r.d(t,{pJ:function(){return I},Jq:function(){return _}});var b=function e(t,r){return 0===r?t:e(r,t%r)},m=function(e,t){return e+(t-b(e,t))},w=function(){for(var e=[],t=0;t<40;t++)e.push(Math.pow(2,t));return e}();function x(e,t,r,n){if(c(e),t<=0||t>32)throw new Error("convertRadix2: wrong from=".concat(t));if(r<=0||r>32)throw new Error("convertRadix2: wrong to=".concat(r));if(m(t,r)>32)throw new Error("convertRadix2: carry overflow from=".concat(t," to=").concat(r," carryBits=").concat(m(t,r)));var i,o=0,a=0,f=w[t],l=w[r]-1,p=[],h=u(e);try{for(h.s();!(i=h.n()).done;){var d=i.value;if(s(d),d>=f)throw new Error("convertRadix2: invalid data word=".concat(d," from=").concat(t));if(o=o<<t|d,a+t>32)throw new Error("convertRadix2: carry overflow pos=".concat(a," from=").concat(t));for(a+=t;a>=r;a-=r)p.push((o>>a-r&l)>>>0);var v=w[a];if(void 0===v)throw new Error("invalid carry");o&=v-1}}catch(g){h.e(g)}finally{h.f()}if(o=o<<r-a&l,!n&&a>=t)throw new Error("Excess padding");if(!n&&o>0)throw new Error("Non-zero padding: ".concat(o));return n&&a>0&&p.push(o>>>0),p}function k(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(s(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(m(8,e)>32||m(e,8)>32)throw new Error("radix2: carry overflow");return{encode:function(r){if(!n(r))throw new Error("radix2.encode input should be Uint8Array");return x(Array.from(r),8,e,!t)},decode:function(r){return l("radix2.decode",r),Uint8Array.from(x(r,e,8,t))}}}function E(e){return o(e),function(){try{for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.apply(null,r)}catch(i){}}}p(k(4),h("0123456789ABCDEF"),d(""));var I=p(k(5),h("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),v(5),d("")),S=(p(k(5),h("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),d("")),p(k(5),h("0123456789ABCDEFGHIJKLMNOPQRSTUV"),v(5),d("")),p(k(5),h("0123456789ABCDEFGHIJKLMNOPQRSTUV"),d("")),p(k(5),h("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),d(""),g(function(e){return e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")})),"function"==typeof Uint8Array.from([]).toBase64&&"function"==typeof Uint8Array.fromBase64),O=(S||p(k(6),h("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),v(6),d("")),p(k(6),h("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),d("")),S||p(k(6),h("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),v(6),d("")),p(k(6),h("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),d("")),function(e){return p((s(58),{encode:function(e){if(!n(e))throw new Error("radix.encode input should be Uint8Array");return y(Array.from(e),256,58)},decode:function(e){return l("radix.decode",e),Uint8Array.from(y(e,58,256))}}),h(e),d(""))}),_=O("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),P=(O("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),O("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz"),p(h("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),d(""))),A=[996825010,642813549,513874426,1027748829,705979059];function R(e){for(var t=e>>25,r=(33554431&e)<<5,n=0;n<A.length;n++)1==(t>>n&1)&&(r^=A[n]);return r}function T(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=e.length,i=1,o=0;o<n;o++){var a=e.charCodeAt(o);if(a<33||a>126)throw new Error("Invalid prefix (".concat(e,")"));i=R(i)^a>>5}i=R(i);for(var s=0;s<n;s++)i=R(i)^31&e.charCodeAt(s);var c,f=u(t);try{for(f.s();!(c=f.n()).done;){var l=c.value;i=R(i)^l}}catch(h){f.e(h)}finally{f.f()}for(var p=0;p<6;p++)i=R(i);return i^=r,P.encode(x([i%w[30]],30,5,!1))}function B(e){var t="bech32"===e?1:734539939,r=k(5),i=r.decode,o=r.encode,s=E(i);function c(e,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:90;a("bech32.encode prefix",e),n(r)&&(r=Array.from(r)),l("bech32.encode",r);var o=e.length;if(0===o)throw new TypeError("Invalid prefix length ".concat(o));var s=o+7+r.length;if(!1!==i&&s>i)throw new TypeError("Length ".concat(s," exceeds limit ").concat(i));var c=e.toLowerCase(),u=T(c,r,t);return"".concat(c,"1").concat(P.encode(r)).concat(u)}function u(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:90;a("bech32.decode input",e);var n=e.length;if(n<8||!1!==r&&n>r)throw new TypeError("invalid string length: ".concat(n," (").concat(e,"). Expected (8..").concat(r,")"));var i=e.toLowerCase();if(e!==i&&e!==e.toUpperCase())throw new Error("String must be lowercase or uppercase");var o=i.lastIndexOf("1");if(0===o||-1===o)throw new Error('Letter "1" must be present between prefix and data only');var s=i.slice(0,o),c=i.slice(o+1);if(c.length<6)throw new Error("Data must be at least 6 characters long");var u=P.decode(c).slice(0,-6),f=T(s,u,t);if(!c.endsWith(f))throw new Error("Invalid checksum in ".concat(e,': expected "').concat(f,'"'));return{prefix:s,words:u}}return{encode:c,decode:u,encodeFromBytes:function(e,t){return c(e,o(t))},decodeToBytes:function(e){var t=u(e,!1),r=t.prefix,n=t.words;return{prefix:r,words:n,bytes:i(n)}},decodeUnsafe:E(u),fromWords:i,fromWordsUnsafe:s,toWords:o}}B("bech32"),B("bech32m"),"function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex||p(k(4),h("0123456789abcdef"),d(""),g(function(e){if("string"!=typeof e||e.length%2!=0)throw new TypeError("hex.decode: expected string, got ".concat(typeof e," with length ").concat(e.length));return e.toLowerCase()}))},86202:function(e,t,n){"use strict";n.r(t),n.d(t,{EthereumProvider:function(){return Dh},OPTIONAL_EVENTS:function(){return Eh},OPTIONAL_METHODS:function(){return xh},REQUIRED_EVENTS:function(){return kh},REQUIRED_METHODS:function(){return wh},default:function(){return Lh}});var o=n(8239),f=n(93105),l=n(97057),d=n(14611),b=n(37167),m=n(78359),w=n(13324),E=n(4180),S=n(5640),O=n(48415),_=n(19663);function P(e){return"".concat(e<0?"-":"","0x").concat(Math.abs(e).toString(16).padStart(2,"0"))}var A=x(function e(t,r){k(this,e),I(this,"type"),I(this,"data"),this.type=t,this.data=r}),R=function(e){h(r,e);var t=v(r);function r(e){var n;k(this,r),n=t.call(this,e);var i=Object.create(r.prototype);return Object.setPrototypeOf(y(n),i),Object.defineProperty(y(n),"name",{configurable:!0,enumerable:!1,value:r.name}),n}return x(r)}(r(Error)),T=4294967295;function B(e,t,r){var n=Math.floor(r/4294967296),i=r;e.setUint32(t,n),e.setUint32(t+4,i)}function C(e,t){return 4294967296*e.getInt32(t)+e.getUint32(t+4)}var U={type:-1,encode:function(e){if(e instanceof Date){var t=function(e){var t=e.getTime(),r=Math.floor(t/1e3),n=1e6*(t-1e3*r),i=Math.floor(n/1e9);return{sec:r+i,nsec:n-1e9*i}}(e);return function(e){var t=e.sec,r=e.nsec;if(t>=0&&r>=0&&t<=17179869183){if(0===r&&t<=4294967295){var n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t),n}var i=t/4294967296,o=4294967295&t,a=new Uint8Array(8),s=new DataView(a.buffer);return s.setUint32(0,r<<2|3&i),s.setUint32(4,o),a}var c=new Uint8Array(12),u=new DataView(c.buffer);return u.setUint32(0,r),B(u,4,t),c}(t)}return null},decode:function(e){var t=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:t.getUint32(0),nsec:0};case 8:var r=t.getUint32(0);return{sec:4294967296*(3&r)+t.getUint32(4),nsec:r>>>2};case 12:return{sec:C(t,4),nsec:t.getUint32(0)};default:throw new R("Unrecognized data size for timestamp (expected 4, 8, or 12): ".concat(e.length))}}(e);return new Date(1e3*t.sec+t.nsec/1e6)}},N=function(){function e(){k(this,e),I(this,"__brand"),I(this,"builtInEncoders",[]),I(this,"builtInDecoders",[]),I(this,"encoders",[]),I(this,"decoders",[]),this.register(U)}return x(e,[{key:"register",value:function(e){var t=e.type,r=e.encode,n=e.decode;if(t>=0)this.encoders[t]=r,this.decoders[t]=n;else{var i=-1-t;this.builtInEncoders[i]=r,this.builtInDecoders[i]=n}}},{key:"tryToEncode",value:function(e,t){for(var r=0;r<this.builtInEncoders.length;r++){var n=this.builtInEncoders[r];if(null!=n){var i=n(e,t);if(null!=i)return new A(-1-r,i)}}for(var o=0;o<this.encoders.length;o++){var a=this.encoders[o];if(null!=a){var s=a(e,t);if(null!=s)return new A(o,s)}}return e instanceof A?e:null}},{key:"decode",value:function(e,t,r){var n=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return n?n(e,t,r):new A(t,e)}}]),e}(),j=N;I(j,"defaultCodec",new N);var L=new TextEncoder;function D(e,t,r){for(var n=t,i=n+r,o=[],a="";n<i;){var s=e[n++];if(0==(128&s))o.push(s);else if(192==(224&s)){var c=63&e[n++];o.push((31&s)<<6|c)}else if(224==(240&s)){var u=63&e[n++],f=63&e[n++];o.push((31&s)<<12|u<<6|f)}else if(240==(248&s)){var l=(7&s)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++];l>65535&&(l-=65536,o.push(l>>>10&1023|55296),l=56320|1023&l),o.push(l)}else o.push(s);o.length>=4096&&(a+=String.fromCharCode.apply(String,o),o.length=0)}return o.length>0&&(a+=String.fromCharCode.apply(String,o)),a}var M=new TextDecoder;function q(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):function(e){return e instanceof ArrayBuffer||"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer}(e)?new Uint8Array(e):Uint8Array.from(e)}function z(e){var t,r,n,i=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);i--;){if(r&&null!=(t=e[r]))return t.call(e);if(n&&null!=(t=e[n]))return new Z(t.call(e));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function Z(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return(Z=function(e){this.s=e,this.n=e.next}).prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var r=this.s.return;return void 0===r?Promise.resolve({value:e,done:!0}):t(r.apply(this.s,arguments))},throw:function(e){var r=this.s.return;return void 0===r?Promise.reject(e):t(r.apply(this.s,arguments))}},new Z(e)}var F="array",K="map_key",V="map_value",H=function(e){if("string"==typeof e||"number"==typeof e)return e;throw new R("The type of key must be string or number but "+typeof e)},W=function(){function e(){k(this,e),I(this,"stack",[]),I(this,"stackHeadPosition",-1)}return x(e,[{key:"length",get:function(){return this.stackHeadPosition+1}},{key:"top",value:function(){return this.stack[this.stackHeadPosition]}},{key:"pushArrayState",value:function(e){var t=this.getUninitializedStateFromPool();t.type=F,t.position=0,t.size=e,t.array=new Array(e)}},{key:"pushMapState",value:function(e){var t=this.getUninitializedStateFromPool();t.type=K,t.readCount=0,t.size=e,t.map={}}},{key:"getUninitializedStateFromPool",value:function(){return this.stackHeadPosition++,this.stackHeadPosition===this.stack.length&&this.stack.push({type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null}),this.stack[this.stackHeadPosition]}},{key:"release",value:function(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===F){var t=e;t.size=0,t.array=void 0,t.position=0,t.type=void 0}if(e.type===K||e.type===V){var r=e;r.size=0,r.map=void 0,r.readCount=0,r.type=void 0}this.stackHeadPosition--}},{key:"reset",value:function(){this.stack.length=0,this.stackHeadPosition=-1}}]),e}(),G=new DataView(new ArrayBuffer(0)),J=new Uint8Array(G.buffer);try{G.getInt8(0)}catch($t){if(!($t instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}var Y=new RangeError("Insufficient data"),Q=new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16;k(this,e),I(this,"hit",0),I(this,"miss",0),I(this,"caches"),I(this,"maxKeyLength"),I(this,"maxLengthPerKey"),this.maxKeyLength=t,this.maxLengthPerKey=r,this.caches=[];for(var n=0;n<this.maxKeyLength;n++)this.caches.push([])}return x(e,[{key:"canBeCached",value:function(e){return e>0&&e<=this.maxKeyLength}},{key:"find",value:function(e,t,r){var n,i=u(this.caches[r-1]);try{e:for(i.s();!(n=i.n()).done;){for(var o=n.value,a=o.bytes,s=0;s<r;s++)if(a[s]!==e[t+s])continue e;return o.str}}catch(c){i.e(c)}finally{i.f()}return null}},{key:"store",value:function(e,t){var r=this.caches[e.length-1],n={bytes:e,str:t};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=n:r.push(n)}},{key:"decode",value:function(e,t,r){var n=this.find(e,t,r);if(null!=n)return this.hit++,n;this.miss++;var i=D(e,t,r),o=Uint8Array.prototype.slice.call(e,t,t+r);return this.store(o,i),i}}]),e}()),X=function(){function e(t){var r,n,i,o,a,s,c,u,f;k(this,e),I(this,"extensionCodec"),I(this,"context"),I(this,"useBigInt64"),I(this,"rawStrings"),I(this,"maxStrLength"),I(this,"maxBinLength"),I(this,"maxArrayLength"),I(this,"maxMapLength"),I(this,"maxExtLength"),I(this,"keyDecoder"),I(this,"mapKeyConverter"),I(this,"totalPos",0),I(this,"pos",0),I(this,"view",G),I(this,"bytes",J),I(this,"headByte",-1),I(this,"stack",new W),I(this,"entered",!1),this.extensionCodec=null!==(r=null==t?void 0:t.extensionCodec)&&void 0!==r?r:j.defaultCodec,this.context=null==t?void 0:t.context,this.useBigInt64=null!==(n=null==t?void 0:t.useBigInt64)&&void 0!==n&&n,this.rawStrings=null!==(i=null==t?void 0:t.rawStrings)&&void 0!==i&&i,this.maxStrLength=null!==(o=null==t?void 0:t.maxStrLength)&&void 0!==o?o:T,this.maxBinLength=null!==(a=null==t?void 0:t.maxBinLength)&&void 0!==a?a:T,this.maxArrayLength=null!==(s=null==t?void 0:t.maxArrayLength)&&void 0!==s?s:T,this.maxMapLength=null!==(c=null==t?void 0:t.maxMapLength)&&void 0!==c?c:T,this.maxExtLength=null!==(u=null==t?void 0:t.maxExtLength)&&void 0!==u?u:T,this.keyDecoder=void 0!==(null==t?void 0:t.keyDecoder)?t.keyDecoder:Q,this.mapKeyConverter=null!==(f=null==t?void 0:t.mapKeyConverter)&&void 0!==f?f:H}return x(e,[{key:"clone",value:function(){return new e({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}},{key:"reinitializeState",value:function(){this.totalPos=0,this.headByte=-1,this.stack.reset()}},{key:"setBuffer",value:function(e){var t=q(e);this.bytes=t,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength),this.pos=0}},{key:"appendBuffer",value:function(e){if(-1!==this.headByte||this.hasRemaining(1)){var t=this.bytes.subarray(this.pos),r=q(e),n=new Uint8Array(t.length+r.length);n.set(t),n.set(r,t.length),this.setBuffer(n)}else this.setBuffer(e)}},{key:"hasRemaining",value:function(e){return this.view.byteLength-this.pos>=e}},{key:"createExtraByteError",value:function(e){var t=this.view,r=this.pos;return new RangeError("Extra ".concat(t.byteLength-r," of ").concat(t.byteLength," byte(s) found at buffer[").concat(e,"]"))}},{key:"decode",value:function(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);var t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t}finally{this.entered=!1}}},{key:"decodeMulti",value:p().mark(function e(t){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.entered){e.next=4;break}return e.delegateYield(this.clone().decodeMulti(t),"t0",2);case 2:e.next=14;break;case 4:e.prev=4,this.entered=!0,this.reinitializeState(),this.setBuffer(t);case 6:if(!this.hasRemaining(1)){e.next=11;break}return e.next=9,this.doDecodeSync();case 9:e.next=6;break;case 11:return e.prev=11,this.entered=!1,e.finish(11);case 14:case"end":return e.stop()}},e,this,[[4,,11,14]])})},{key:"decodeAsync",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){var n,i,o,a,s,c,u,f,l,h,d,v;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!t.entered){r.next=2;break}return r.abrupt("return",t.clone().decodeAsync(e));case 2:r.prev=2,t.entered=!0,i=!1,a=!0,s=!1,r.prev=6,f=z(e);case 8:return r.next=10,f.next();case 10:return a=(c=r.sent).done,r.next=13,c.value;case 13:if(u=r.sent,a){r.next=31;break}if(l=u,!i){r.next=18;break}throw t.entered=!1,t.createExtraByteError(t.totalPos);case 18:t.appendBuffer(l),r.prev=19,n=t.doDecodeSync(),i=!0,r.next=27;break;case 23:if(r.prev=23,r.t0=r.catch(19),r.t0 instanceof RangeError){r.next=27;break}throw r.t0;case 27:t.totalPos+=t.pos;case 28:a=!0,r.next=8;break;case 31:r.next=36;break;case 33:r.prev=33,r.t1=r.catch(6),s=!0,o=r.t1;case 36:if(r.prev=36,r.prev=37,r.t2=!a&&null!=f.return,!r.t2){r.next=42;break}return r.next=42,f.return();case 42:if(r.prev=42,!s){r.next=45;break}throw o;case 45:return r.finish(42);case 46:return r.finish(36);case 47:if(!i){r.next=51;break}if(!t.hasRemaining(1)){r.next=50;break}throw t.createExtraByteError(t.totalPos);case 50:return r.abrupt("return",n);case 51:throw h=t.headByte,d=t.pos,v=t.totalPos,new RangeError("Insufficient data in parsing ".concat(P(h)," at ").concat(v," (").concat(d," in the current buffer)"));case 53:return r.prev=53,t.entered=!1,r.finish(53);case 56:case"end":return r.stop()}},r,null,[[2,,53,56],[6,33,36,47],[19,23],[37,,42,46]])}))()}},{key:"decodeArrayStream",value:function(e){return this.decodeMultiAsync(e,!0)}},{key:"decodeStream",value:function(e){return this.decodeMultiAsync(e,!1)}},{key:"decodeMultiAsync",value:function(e,t){var r=this;return(0,S.Z)(p().mark(function n(){var i,o,a,s,c,u,f,l,h,d;return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!r.entered){n.next=5;break}return i=r.clone(),n.delegateYield((0,_.Z)(z(i.decodeMultiAsync(e,t)),O.Z),"t0",3);case 3:n.next=58;break;case 5:n.prev=5,r.entered=!0,o=t,a=-1,c=!0,u=!1,n.prev=9,h=z(e);case 11:return n.next=13,(0,O.Z)(h.next());case 13:return c=(f=n.sent).done,n.next=16,(0,O.Z)(f.value);case 16:if(l=n.sent,c){n.next=39;break}if(d=l,!t||0!==a){n.next=21;break}throw r.createExtraByteError(r.totalPos);case 21:r.appendBuffer(d),o&&(a=r.readArraySize(),o=!1,r.complete()),n.prev=22;case 23:return n.next=25,r.doDecodeSync();case 25:if(0==--a){n.next=29;break}case 27:n.next=23;break;case 29:n.next=35;break;case 31:if(n.prev=31,n.t1=n.catch(22),n.t1 instanceof RangeError){n.next=35;break}throw n.t1;case 35:r.totalPos+=r.pos;case 36:c=!0,n.next=11;break;case 39:n.next=44;break;case 41:n.prev=41,n.t2=n.catch(9),u=!0,s=n.t2;case 44:if(n.prev=44,n.prev=45,n.t3=!c&&null!=h.return,!n.t3){n.next=50;break}return n.next=50,(0,O.Z)(h.return());case 50:if(n.prev=50,!u){n.next=53;break}throw s;case 53:return n.finish(50);case 54:return n.finish(44);case 55:return n.prev=55,r.entered=!1,n.finish(55);case 58:case"end":return n.stop()}},n,null,[[5,,55,58],[9,41,44,55],[22,31],[45,,50,54]])}))()}},{key:"doDecodeSync",value:function(){e:for(;;){var e=this.readHeadByte(),t=void 0;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){var r=e-128;if(0!==r){this.pushMapState(r),this.complete();continue e}t={}}else if(e<160){var n=e-144;if(0!==n){this.pushArrayState(n),this.complete();continue e}t=[]}else t=this.decodeString(e-160,0);else if(192===e)t=null;else if(194===e)t=!1;else if(195===e)t=!0;else if(202===e)t=this.readF32();else if(203===e)t=this.readF64();else if(204===e)t=this.readU8();else if(205===e)t=this.readU16();else if(206===e)t=this.readU32();else if(207===e)t=this.useBigInt64?this.readU64AsBigInt():this.readU64();else if(208===e)t=this.readI8();else if(209===e)t=this.readI16();else if(210===e)t=this.readI32();else if(211===e)t=this.useBigInt64?this.readI64AsBigInt():this.readI64();else if(217===e){var i=this.lookU8();t=this.decodeString(i,1)}else if(218===e){var o=this.lookU16();t=this.decodeString(o,2)}else if(219===e){var a=this.lookU32();t=this.decodeString(a,4)}else if(220===e){var s=this.readU16();if(0!==s){this.pushArrayState(s),this.complete();continue e}t=[]}else if(221===e){var c=this.readU32();if(0!==c){this.pushArrayState(c),this.complete();continue e}t=[]}else if(222===e){var u=this.readU16();if(0!==u){this.pushMapState(u),this.complete();continue e}t={}}else if(223===e){var f=this.readU32();if(0!==f){this.pushMapState(f),this.complete();continue e}t={}}else if(196===e){var l=this.lookU8();t=this.decodeBinary(l,1)}else if(197===e){var p=this.lookU16();t=this.decodeBinary(p,2)}else if(198===e){var h=this.lookU32();t=this.decodeBinary(h,4)}else if(212===e)t=this.decodeExtension(1,0);else if(213===e)t=this.decodeExtension(2,0);else if(214===e)t=this.decodeExtension(4,0);else if(215===e)t=this.decodeExtension(8,0);else if(216===e)t=this.decodeExtension(16,0);else if(199===e){var d=this.lookU8();t=this.decodeExtension(d,1)}else if(200===e){var v=this.lookU16();t=this.decodeExtension(v,2)}else{if(201!==e)throw new R("Unrecognized type byte: ".concat(P(e)));var g=this.lookU32();t=this.decodeExtension(g,4)}this.complete();for(var y=this.stack;y.length>0;){var b=y.top();if(b.type===F){if(b.array[b.position]=t,b.position++,b.position!==b.size)continue e;t=b.array,y.release(b)}else{if(b.type===K){if("__proto__"===t)throw new R("The key __proto__ is not allowed");b.key=this.mapKeyConverter(t),b.type=V;continue e}if(b.map[b.key]=t,b.readCount++,b.readCount!==b.size){b.key=null,b.type=K;continue e}t=b.map,y.release(b)}}return t}}},{key:"readHeadByte",value:function(){return-1===this.headByte&&(this.headByte=this.readU8()),this.headByte}},{key:"complete",value:function(){this.headByte=-1}},{key:"readArraySize",value:function(){var e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:if(e<160)return e-144;throw new R("Unrecognized array type byte: ".concat(P(e)))}}},{key:"pushMapState",value:function(e){if(e>this.maxMapLength)throw new R("Max length exceeded: map length (".concat(e,") > maxMapLengthLength (").concat(this.maxMapLength,")"));this.stack.pushMapState(e)}},{key:"pushArrayState",value:function(e){if(e>this.maxArrayLength)throw new R("Max length exceeded: array length (".concat(e,") > maxArrayLength (").concat(this.maxArrayLength,")"));this.stack.pushArrayState(e)}},{key:"decodeString",value:function(e,t){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,t):this.decodeBinary(e,t)}},{key:"decodeUtf8String",value:function(e,t){var r;if(e>this.maxStrLength)throw new R("Max length exceeded: UTF-8 byte length (".concat(e,") > maxStrLength (").concat(this.maxStrLength,")"));if(this.bytes.byteLength<this.pos+t+e)throw Y;var n,i=this.pos+t;return n=this.stateIsMapKey()&&null!==(r=this.keyDecoder)&&void 0!==r&&r.canBeCached(e)?this.keyDecoder.decode(this.bytes,i,e):function(e,t,r){return r>200?function(e,t,r){var n=e.subarray(t,t+r);return M.decode(n)}(e,t,r):D(e,t,r)}(this.bytes,i,e),this.pos+=t+e,n}},{key:"stateIsMapKey",value:function(){return this.stack.length>0&&this.stack.top().type===K}},{key:"decodeBinary",value:function(e,t){if(e>this.maxBinLength)throw new R("Max length exceeded: bin length (".concat(e,") > maxBinLength (").concat(this.maxBinLength,")"));if(!this.hasRemaining(e+t))throw Y;var r=this.pos+t,n=this.bytes.subarray(r,r+e);return this.pos+=t+e,n}},{key:"decodeExtension",value:function(e,t){if(e>this.maxExtLength)throw new R("Max length exceeded: ext length (".concat(e,") > maxExtLength (").concat(this.maxExtLength,")"));var r=this.view.getInt8(this.pos+t),n=this.decodeBinary(e,t+1);return this.extensionCodec.decode(n,r,this.context)}},{key:"lookU8",value:function(){return this.view.getUint8(this.pos)}},{key:"lookU16",value:function(){return this.view.getUint16(this.pos)}},{key:"lookU32",value:function(){return this.view.getUint32(this.pos)}},{key:"readU8",value:function(){var e=this.view.getUint8(this.pos);return this.pos++,e}},{key:"readI8",value:function(){var e=this.view.getInt8(this.pos);return this.pos++,e}},{key:"readU16",value:function(){var e=this.view.getUint16(this.pos);return this.pos+=2,e}},{key:"readI16",value:function(){var e=this.view.getInt16(this.pos);return this.pos+=2,e}},{key:"readU32",value:function(){var e=this.view.getUint32(this.pos);return this.pos+=4,e}},{key:"readI32",value:function(){var e=this.view.getInt32(this.pos);return this.pos+=4,e}},{key:"readU64",value:function(){var e=function(e,t){return 4294967296*e.getUint32(t)+e.getUint32(t+4)}(this.view,this.pos);return this.pos+=8,e}},{key:"readI64",value:function(){var e=C(this.view,this.pos);return this.pos+=8,e}},{key:"readU64AsBigInt",value:function(){var e=this.view.getBigUint64(this.pos);return this.pos+=8,e}},{key:"readI64AsBigInt",value:function(){var e=this.view.getBigInt64(this.pos);return this.pos+=8,e}},{key:"readF32",value:function(){var e=this.view.getFloat32(this.pos);return this.pos+=4,e}},{key:"readF64",value:function(){var e=this.view.getFloat64(this.pos);return this.pos+=8,e}}]),e}(),$=function(){function e(t){var r,n,i,o,a,s,c,u;k(this,e),I(this,"extensionCodec"),I(this,"context"),I(this,"useBigInt64"),I(this,"maxDepth"),I(this,"initialBufferSize"),I(this,"sortKeys"),I(this,"forceFloat32"),I(this,"ignoreUndefined"),I(this,"forceIntegerToFloat"),I(this,"pos"),I(this,"view"),I(this,"bytes"),I(this,"entered",!1),this.extensionCodec=null!==(r=null==t?void 0:t.extensionCodec)&&void 0!==r?r:j.defaultCodec,this.context=null==t?void 0:t.context,this.useBigInt64=null!==(n=null==t?void 0:t.useBigInt64)&&void 0!==n&&n,this.maxDepth=null!==(i=null==t?void 0:t.maxDepth)&&void 0!==i?i:100,this.initialBufferSize=null!==(o=null==t?void 0:t.initialBufferSize)&&void 0!==o?o:2048,this.sortKeys=null!==(a=null==t?void 0:t.sortKeys)&&void 0!==a&&a,this.forceFloat32=null!==(s=null==t?void 0:t.forceFloat32)&&void 0!==s&&s,this.ignoreUndefined=null!==(c=null==t?void 0:t.ignoreUndefined)&&void 0!==c&&c,this.forceIntegerToFloat=null!==(u=null==t?void 0:t.forceIntegerToFloat)&&void 0!==u&&u,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return x(e,[{key:"clone",value:function(){return new e({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}},{key:"reinitializeState",value:function(){this.pos=0}},{key:"encodeSharedRef",value:function(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}},{key:"encode",value:function(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}},{key:"doEncode",value:function(e,t){if(t>this.maxDepth)throw new Error("Too deep objects in depth ".concat(t));null==e?this.encodeNil():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.useBigInt64&&"bigint"==typeof e?this.encodeBigInt64(e):this.encodeObject(e,t)}},{key:"ensureBufferSizeToWrite",value:function(e){var t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)}},{key:"resizeBuffer",value:function(e){var t=new ArrayBuffer(e),r=new Uint8Array(t),n=new DataView(t);r.set(this.bytes),this.view=n,this.bytes=r}},{key:"encodeNil",value:function(){this.writeU8(192)}},{key:"encodeBoolean",value:function(e){this.writeU8(!1===e?194:195)}},{key:"encodeNumber",value:function(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}},{key:"encodeNumberAsFloat",value:function(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}},{key:"encodeBigInt64",value:function(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}},{key:"writeStringHeader",value:function(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else{if(!(e<4294967296))throw new Error("Too long string: ".concat(e," bytes in UTF-8"));this.writeU8(219),this.writeU32(e)}}},{key:"encodeString",value:function(e){var t=function(e){for(var t=e.length,r=0,n=0;n<t;){var i=e.charCodeAt(n++);if(0!=(4294967168&i))if(0==(4294965248&i))r+=2;else{if(i>=55296&&i<=56319&&n<t){var o=e.charCodeAt(n);56320==(64512&o)&&(++n,i=((1023&i)<<10)+(1023&o)+65536)}r+=0==(4294901760&i)?3:4}else r++}return r}(e);this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),function(e,t,r){e.length>50?function(e,t,r){L.encodeInto(e,t.subarray(r))}(e,t,r):function(e,t,r){for(var n=e.length,i=r,o=0;o<n;){var a=e.charCodeAt(o++);if(0!=(4294967168&a)){if(0==(4294965248&a))t[i++]=a>>6&31|192;else{if(a>=55296&&a<=56319&&o<n){var s=e.charCodeAt(o);56320==(64512&s)&&(++o,a=((1023&a)<<10)+(1023&s)+65536)}0==(4294901760&a)?(t[i++]=a>>12&15|224,t[i++]=a>>6&63|128):(t[i++]=a>>18&7|240,t[i++]=a>>12&63|128,t[i++]=a>>6&63|128)}t[i++]=63&a|128}else t[i++]=a}}(e,t,r)}(e,this.bytes,this.pos),this.pos+=t}},{key:"encodeObject",value:function(e,t){var r=this.extensionCodec.tryToEncode(e,this.context);if(null!=r)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else{if("object"!=typeof e)throw new Error("Unrecognized object: ".concat(Object.prototype.toString.apply(e)));this.encodeMap(e,t)}}},{key:"encodeBinary",value:function(e){var t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large binary: ".concat(t));this.writeU8(198),this.writeU32(t)}var r=q(e);this.writeU8a(r)}},{key:"encodeArray",value:function(e,t){var r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else{if(!(r<4294967296))throw new Error("Too large array: ".concat(r));this.writeU8(221),this.writeU32(r)}var n,i=u(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;this.doEncode(o,t+1)}}catch(a){i.e(a)}finally{i.f()}}},{key:"countWithoutUndefined",value:function(e,t){var r,n=0,i=u(t);try{for(i.s();!(r=i.n()).done;){void 0!==e[r.value]&&n++}}catch(o){i.e(o)}finally{i.f()}return n}},{key:"encodeMap",value:function(e,t){var r=Object.keys(e);this.sortKeys&&r.sort();var n=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(n<16)this.writeU8(128+n);else if(n<65536)this.writeU8(222),this.writeU16(n);else{if(!(n<4294967296))throw new Error("Too large map object: ".concat(n));this.writeU8(223),this.writeU32(n)}for(var i=0,o=r;i<o.length;i++){var a=o[i],s=e[a];this.ignoreUndefined&&void 0===s||(this.encodeString(a),this.doEncode(s,t+1))}}},{key:"encodeExtension",value:function(e){if("function"==typeof e.data){var t=e.data(this.pos+6),r=t.length;if(r>=4294967296)throw new Error("Too large extension object: ".concat(r));return this.writeU8(201),this.writeU32(r),this.writeI8(e.type),void this.writeU8a(t)}var n=e.data.length;if(1===n)this.writeU8(212);else if(2===n)this.writeU8(213);else if(4===n)this.writeU8(214);else if(8===n)this.writeU8(215);else if(16===n)this.writeU8(216);else if(n<256)this.writeU8(199),this.writeU8(n);else if(n<65536)this.writeU8(200),this.writeU16(n);else{if(!(n<4294967296))throw new Error("Too large extension object: ".concat(n));this.writeU8(201),this.writeU32(n)}this.writeI8(e.type),this.writeU8a(e.data)}},{key:"writeU8",value:function(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}},{key:"writeU8a",value:function(e){var t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t}},{key:"writeI8",value:function(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}},{key:"writeU16",value:function(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}},{key:"writeI16",value:function(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}},{key:"writeU32",value:function(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}},{key:"writeI32",value:function(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}},{key:"writeF32",value:function(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}},{key:"writeF64",value:function(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}},{key:"writeU64",value:function(e){this.ensureBufferSizeToWrite(8),function(e,t,r){var n=r;e.setUint32(t,r/4294967296),e.setUint32(t+4,n)}(this.view,this.pos,e),this.pos+=8}},{key:"writeI64",value:function(e){this.ensureBufferSizeToWrite(8),B(this.view,this.pos,e),this.pos+=8}},{key:"writeBigUint64",value:function(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}},{key:"writeBigInt64",value:function(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}}]),e}(),ee=n(24517),te=n(29168),re=n(51462),ne=n(63840),ie=n(40187),oe=n(14616);function ae(e){var t=i(e.split(":"),2);return{namespace:t[0],reference:t[1]}}function se(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];return Object.keys(e).forEach(function(n){t.length&&!t.includes(n)||r.push.apply(r,s(e[n].accounts))}),r}function ce(e,t){return e.includes(":")?[e]:t.chains||[]}var ue=Object.defineProperty,fe=Object.defineProperties,le=Object.getOwnPropertyDescriptors,pe=Object.getOwnPropertySymbols,he=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable,ve=function(e,t,r){return t in e?ue(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},ge=function(e,t){for(var r in t||(t={}))he.call(t,r)&&ve(e,r,t[r]);if(pe){var n,i=u(pe(t));try{for(i.s();!(n=i.n()).done;){r=n.value;de.call(t,r)&&ve(e,r,t[r])}}catch(o){i.e(o)}finally{i.f()}}return e},ye=function(e,t,r){return ve(e,"symbol"!=typeof t?t+"":t,r)},be="js";function me(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function we(){return!(0,b.getDocument)()&&!!(0,b.getNavigator)()&&"ReactNative"===navigator.product}function xe(){return!me()&&!!(0,b.getNavigator)()&&!!(0,b.getDocument)()}function ke(){return we()?"react-native":me()?"node":xe()?"browser":"unknown"}function Ee(){var e;try{return we()&&typeof global<"u"&&typeof(null==global?void 0:global.Application)<"u"?null==(e=global.Application)?void 0:e.applicationId:void 0}catch(t){return}}function Ie(){return(0,m.D)()||{name:"",description:"",url:"",icons:[""]}}function Se(e,t,r){var n=function(){if("react-native"===ke()&&typeof global<"u"&&typeof(null==global?void 0:global.Platform)<"u"){var e=global.Platform;return[e.OS,e.Version].join("-")}var t=(0,l.qY)();if(null===t)return"unknown";var r=t.os?t.os.replace(" ","").toLowerCase():"unknown";return"browser"===t.type?[r,t.name,t.version].join("-"):[r,t.version].join("-")}(),i=function(){var e,t=ke();return"browser"===t?[t,(null==(e=(0,b.getLocation)())?void 0:e.host)||"unknown"].join(":"):t}();return[[e,t].join("-"),[be,r].join("-"),n,i].join("/")}function Oe(e,t){return e.filter(function(e){return t.includes(e)}).length===e.length}function _e(e){return Object.fromEntries(e.entries())}function Pe(e){return new Map(Object.entries(e))}function Ae(){var e,t,r,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d.FIVE_MINUTES,o=arguments.length>1?arguments[1]:void 0,a=(0,d.toMiliseconds)(i||d.FIVE_MINUTES);return{resolve:function(t){r&&e&&(clearTimeout(r),e(t),n=Promise.resolve(t))},reject:function(e){r&&t&&(clearTimeout(r),t(e))},done:function(){return new Promise(function(i,s){if(n)return i(n);r=setTimeout(function(){var e=new Error(o);n=Promise.reject(e),s(e)},a),e=i,t=s})}}}function Re(e,t,r){return new Promise(function(){var n=(0,o.Z)(p().mark(function n(i,o){var a;return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=setTimeout(function(){return o(new Error(r))},t),n.prev=1,n.t0=i,n.next=5,e;case 5:n.t1=n.sent,(0,n.t0)(n.t1),n.next=12;break;case 9:n.prev=9,n.t2=n.catch(1),o(n.t2);case 12:clearTimeout(a);case 13:case"end":return n.stop()}},n,null,[[1,9]])}));return function(e,t){return n.apply(this,arguments)}}())}function Te(e,t){if("string"==typeof t&&t.startsWith("".concat(e,":")))return t;if("topic"===e.toLowerCase()){if("string"!=typeof t)throw new Error('Value must be "string" for expirer target type: topic');return"topic:".concat(t)}if("id"===e.toLowerCase()){if("number"!=typeof t)throw new Error('Value must be "number" for expirer target type: id');return"id:".concat(t)}throw new Error("Unknown expirer target type: ".concat(e))}function Be(e){var t=i(e.split(":"),2),r=t[0],n=t[1],o={id:void 0,topic:void 0};if("topic"===r&&"string"==typeof n)o.topic=n;else{if("id"!==r||!Number.isInteger(Number(n)))throw new Error("Invalid target, expected id:number or topic:string, got ".concat(r,":").concat(n));o.id=Number(n)}return o}function Ce(e,t){return(0,d.fromMiliseconds)((t||Date.now())+(0,d.toMiliseconds)(e))}function Ue(e){return Date.now()>=(0,d.toMiliseconds)(e)}function Ne(e,t){return"".concat(e).concat(t?":".concat(t):"")}function je(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return s(new Set([].concat(s(e),s(t))))}function Le(){return(Le=(0,o.Z)(function(e){var t=e.id,r=e.topic,n=e.wcDeepLink;return p().mark(function e(){var i,o,a,s,c;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n){e.next=3;break}return e.abrupt("return");case 3:if("string"==typeof(a=null===(o="string"==typeof n?JSON.parse(n):n)||void 0===o?void 0:o.href)){e.next=6;break}return e.abrupt("return");case 6:if(s=De(a,t,r),"browser"!==(c=ke())){e.next=13;break}if(null!=(i=(0,b.getDocument)())&&i.hasFocus()){e.next=10;break}return e.abrupt("return",void console.warn("Document does not have focus, skipping deeplink."));case 10:Me(s),e.next=17;break;case 13:if(e.t0="react-native"===c&&typeof(null==global?void 0:global.Linking)<"u",!e.t0){e.next=17;break}return e.next=17,global.Linking.openURL(s);case 17:e.next=22;break;case 19:e.prev=19,e.t1=e.catch(0),console.error(e.t1);case 22:case"end":return e.stop()}},e,null,[[0,19]])})()})).apply(this,arguments)}function De(e,t,r){var n="requestId=".concat(t,"&sessionTopic=").concat(r);e.endsWith("/")&&(e=e.slice(0,-1));var i="".concat(e);return i=e.startsWith("https://t.me")?"".concat(i).concat(e.includes("?")?"&startapp=":"?startapp=").concat(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=Buffer.from(e).toString("base64");return t?r.replace(/[=]/g,""):r}(n,!0)):"".concat(i,"/wc?").concat(n),i}function Me(e){var t="_self";!function(){try{return window.self!==window.top}catch(e){return!1}}()?(typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)||e.startsWith("https://")||e.startsWith("http://"))&&(t="_blank"):t="_top",window.open(e,t,"noreferrer noopener")}function qe(){return(qe=(0,o.Z)(p().mark(function e(t,r){var n;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n="",e.prev=1,!xe()||!(n=localStorage.getItem(r))){e.next=4;break}return e.abrupt("return",n);case 4:return e.next=6,t.getItem(r);case 6:n=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}},e,null,[[1,9]])}))).apply(this,arguments)}function ze(e,t){if(!e.includes(t))return null;var r=e.split(/([&,?,=])/),n=r.indexOf(t);return r[n+2]}function Ze(){return typeof crypto<"u"&&null!=crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function Fe(){return typeof process<"u"&&"true"===process.env.IS_VITEST}function Ke(e){return Buffer.from(e,"base64").toString("utf-8")}var Ve=function(){function e(t){var r=t.limit;k(this,e),ye(this,"limit"),ye(this,"set"),this.limit=r,this.set=new Set}return x(e,[{key:"add",value:function(e){if(!this.set.has(e)){if(this.set.size>=this.limit){var t=this.set.values().next().value;t&&this.set.delete(t)}this.set.add(e)}}},{key:"has",value:function(e){return this.set.has(e)}}]),e}(),He=BigInt(Math.pow(2,32)-1),We=BigInt(32);function Ge(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?{h:Number(e&He),l:Number(e>>We&He)}:{h:0|Number(e>>We&He),l:0|Number(e&He)}}function Je(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.length,n=new Uint32Array(r),i=new Uint32Array(r),o=0;o<r;o++){var a=Ge(e[o],t),s=a.h,c=a.l,u=[s,c];n[o]=u[0],i[o]=u[1]}return[n,i]}var Ye=function(e,t,r){return e>>>r},Qe=function(e,t,r){return e<<32-r|t>>>r},Xe=function(e,t,r){return e>>>r|t<<32-r},$e=function(e,t,r){return e<<32-r|t>>>r},et=function(e,t,r){return e<<64-r|t>>>r-32},tt=function(e,t,r){return e>>>r-32|t<<64-r},rt=function(e,t){return t},nt=function(e,t){return e};function it(e,t,r,n){var i=(t>>>0)+(n>>>0);return{h:e+r+(i/Math.pow(2,32)|0)|0,l:0|i}}var ot=function(e,t,r){return(e>>>0)+(t>>>0)+(r>>>0)},at=function(e,t,r,n){return t+r+n+(e/Math.pow(2,32)|0)|0},st=function(e,t,r,n){return(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)},ct=function(e,t,r,n,i){return t+r+n+i+(e/Math.pow(2,32)|0)|0},ut=function(e,t,r,n,i){return(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0)},ft=function(e,t,r,n,i,o){return t+r+n+i+o+(e/Math.pow(2,32)|0)|0},lt="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function pt(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function ht(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function dt(e){if(!pt(e))throw new Error("Uint8Array expected");for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(r.length>0&&!r.includes(e.length))throw new Error("Uint8Array expected of length "+r+", got length="+e.length)}function vt(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.createHasher");ht(e.outputLen),ht(e.blockLen)}function gt(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function yt(e,t){dt(e);var r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function bt(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function mt(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0;n<t.length;n++)t[n].fill(0)}function wt(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function xt(e,t){return e<<32-t|e>>>t}var kt=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];function Et(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}var It=kt?function(e){return e}:function(e){return Et(e)},St=kt?function(e){return e}:function(e){for(var t=0;t<e.length;t++)e[t]=Et(e[t]);return e},Ot="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,_t=Array.from({length:256},function(e,t){return t.toString(16).padStart(2,"0")});function Pt(e){if(dt(e),Ot)return e.toHex();for(var t="",r=0;r<e.length;r++)t+=_t[e[r]];return t}function At(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}function Rt(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);if(Ot)return Uint8Array.fromHex(e);var t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);for(var n=new Uint8Array(r),i=0,o=0;i<r;i++,o+=2){var a=At(e.charCodeAt(o)),s=At(e.charCodeAt(o+1));if(void 0===a||void 0===s)throw new Error('hex string expected, got non-hex character "'+(e[o]+e[o+1])+'" at index '+o);n[i]=16*a+s}return n}function Tt(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}function Bt(e){return"string"==typeof e&&(e=Tt(e)),dt(e),e}function Ct(){for(var e=0,t=0;t<arguments.length;t++){var r=t<0||arguments.length<=t?void 0:arguments[t];dt(r),e+=r.length}for(var n=new Uint8Array(e),i=0,o=0;i<arguments.length;i++){var a=i<0||arguments.length<=i?void 0:arguments[i];n.set(a,o),o+=a.length}return n}var Ut=x(function e(){k(this,e)});function Nt(e){var t=function(t){return e().update(Bt(t)).digest()},r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=function(){return e()},t}function jt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(lt&&"function"==typeof lt.getRandomValues)return lt.getRandomValues(new Uint8Array(e));if(lt&&"function"==typeof lt.randomBytes)return Uint8Array.from(lt.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}for(var Lt=BigInt(0),Dt=BigInt(1),Mt=BigInt(2),qt=BigInt(7),zt=BigInt(256),Zt=BigInt(113),Ft=[],Kt=[],Vt=[],Ht=0,Wt=Dt,Gt=1,Jt=0;Ht<24;Ht++){var Yt;Gt=(Yt=[Jt,(2*Gt+3*Jt)%5])[0],Jt=Yt[1],Ft.push(2*(5*Jt+Gt)),Kt.push((Ht+1)*(Ht+2)/2%64);for(var Qt=Lt,Xt=0;Xt<7;Xt++)(Wt=(Wt<<Dt^(Wt>>qt)*Zt)%zt)&Mt&&(Qt^=Dt<<(Dt<<BigInt(Xt))-Dt);Vt.push(Qt)}var $t,er=Je(Vt,!0),tr=er[0],rr=er[1],nr=function(e,t,r){return r>32?function(e,t,r){return t<<r-32|e>>>64-r}(e,t,r):function(e,t,r){return e<<r|t>>>32-r}(e,t,r)},ir=function(e,t,r){return r>32?function(e,t,r){return e<<r-32|t>>>64-r}(e,t,r):function(e,t,r){return t<<r|e>>>32-r}(e,t,r)},or=function(e){h(r,e);var t=v(r);function r(e,n,i){var o,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:24;if(k(this,r),(o=t.call(this)).pos=0,o.posOut=0,o.finished=!1,o.destroyed=!1,o.enableXOF=!1,o.blockLen=e,o.suffix=n,o.outputLen=i,o.enableXOF=a,o.rounds=s,ht(i),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");return o.state=new Uint8Array(200),o.state32=bt(o.state),g(o)}return x(r,[{key:"clone",value:function(){return this._cloneInto()}},{key:"keccak",value:function(){St(this.state32),function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24,r=new Uint32Array(10),n=24-t;n<24;n++){for(var i=0;i<10;i++)r[i]=e[i]^e[i+10]^e[i+20]^e[i+30]^e[i+40];for(var o=0;o<10;o+=2)for(var a=(o+8)%10,s=(o+2)%10,c=r[s],u=r[s+1],f=nr(c,u,1)^r[a],l=ir(c,u,1)^r[a+1],p=0;p<50;p+=10)e[o+p]^=f,e[o+p+1]^=l;for(var h=e[2],d=e[3],v=0;v<24;v++){var g=Kt[v],y=nr(h,d,g),b=ir(h,d,g),m=Ft[v];h=e[m],d=e[m+1],e[m]=y,e[m+1]=b}for(var w=0;w<50;w+=10){for(var x=0;x<10;x++)r[x]=e[w+x];for(var k=0;k<10;k++)e[w+k]^=~r[(k+2)%10]&r[(k+4)%10]}e[0]^=tr[n],e[1]^=rr[n]}mt(r)}(this.state32,this.rounds),St(this.state32),this.posOut=0,this.pos=0}},{key:"update",value:function(e){gt(this),dt(e=Bt(e));for(var t=this.blockLen,r=this.state,n=e.length,i=0;i<n;){for(var o=Math.min(t-this.pos,n-i),a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}},{key:"finish",value:function(){if(!this.finished){this.finished=!0;var e=this.state,t=this.suffix,r=this.pos,n=this.blockLen;e[r]^=t,0!=(128&t)&&r===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}}},{key:"writeInto",value:function(e){gt(this,!1),dt(e),this.finish();for(var t=this.state,r=this.blockLen,n=0,i=e.length;n<i;){this.posOut>=r&&this.keccak();var o=Math.min(r-this.posOut,i-n);e.set(t.subarray(this.posOut,this.posOut+o),n),this.posOut+=o,n+=o}return e}},{key:"xofInto",value:function(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}},{key:"xof",value:function(e){return ht(e),this.xofInto(new Uint8Array(e))}},{key:"digestInto",value:function(e){if(yt(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}},{key:"digest",value:function(){return this.digestInto(new Uint8Array(this.outputLen))}},{key:"destroy",value:function(){this.destroyed=!0,mt(this.state)}},{key:"_cloneInto",value:function(e){var t=this.blockLen,n=this.suffix,i=this.outputLen,o=this.rounds,a=this.enableXOF;return e||(e=new r(t,n,i,a,o)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=o,e.suffix=n,e.outputLen=i,e.enableXOF=a,e.destroyed=this.destroyed,e}}]),r}(Ut),ar=($t=1,Nt(function(){return new or(136,1,32)}));function sr(e,t,r){return e&t^~e&r}function cr(e,t,r){return e&t^e&r^t&r}var ur=function(e){h(r,e);var t=v(r);function r(e,n,i,o){var a;return k(this,r),(a=t.call(this)).finished=!1,a.length=0,a.pos=0,a.destroyed=!1,a.blockLen=e,a.outputLen=n,a.padOffset=i,a.isLE=o,a.buffer=new Uint8Array(e),a.view=wt(a.buffer),a}return x(r,[{key:"update",value:function(e){gt(this),dt(e=Bt(e));for(var t=this.view,r=this.buffer,n=this.blockLen,i=e.length,o=0;o<i;){var a=Math.min(n-this.pos,i-o);if(a!==n)r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===n&&(this.process(t,0),this.pos=0);else for(var s=wt(e);n<=i-o;o+=n)this.process(s,o)}return this.length+=e.length,this.roundClean(),this}},{key:"digestInto",value:function(e){gt(this),yt(e,this),this.finished=!0;var t=this.buffer,r=this.view,n=this.blockLen,i=this.isLE,o=this.pos;t[o++]=128,mt(this.buffer.subarray(o)),this.padOffset>n-o&&(this.process(r,0),o=0);for(var a=o;a<n;a++)t[a]=0;(function(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);var i=BigInt(32),o=BigInt(4294967295),a=Number(r>>i&o),s=Number(r&o),c=n?0:4;e.setUint32(t+(n?4:0),a,n),e.setUint32(t+c,s,n)})(r,n-8,BigInt(8*this.length),i),this.process(r,0);var s=wt(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");var u=c/4,f=this.get();if(u>f.length)throw new Error("_sha2: outputLen bigger than state");for(var l=0;l<u;l++)s.setUint32(4*l,f[l],i)}},{key:"digest",value:function(){var e=this.buffer,t=this.outputLen;this.digestInto(e);var r=e.slice(0,t);return this.destroy(),r}},{key:"_cloneInto",value:function(e){var t;e||(e=new this.constructor),(t=e).set.apply(t,s(this.get()));var r=this.blockLen,n=this.buffer,i=this.length,o=this.finished,a=this.destroyed,c=this.pos;return e.destroyed=a,e.finished=o,e.length=i,e.pos=c,i%r&&e.buffer.set(n),e}},{key:"clone",value:function(){return this._cloneInto()}}]),r}(Ut),fr=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),lr=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),pr=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),hr=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),dr=new Uint32Array(64),vr=function(e){h(r,e);var t=v(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;return k(this,r),(e=t.call(this,64,n,8,!1)).A=0|fr[0],e.B=0|fr[1],e.C=0|fr[2],e.D=0|fr[3],e.E=0|fr[4],e.F=0|fr[5],e.G=0|fr[6],e.H=0|fr[7],e}return x(r,[{key:"get",value:function(){return[this.A,this.B,this.C,this.D,this.E,this.F,this.G,this.H]}},{key:"set",value:function(e,t,r,n,i,o,a,s){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|o,this.G=0|a,this.H=0|s}},{key:"process",value:function(e,t){for(var r=0;r<16;r++,t+=4)dr[r]=e.getUint32(t,!1);for(var n=16;n<64;n++){var i=dr[n-15],o=dr[n-2],a=xt(i,7)^xt(i,18)^i>>>3,s=xt(o,17)^xt(o,19)^o>>>10;dr[n]=s+dr[n-7]+a+dr[n-16]|0}var c=this.A,u=this.B,f=this.C,l=this.D,p=this.E,h=this.F,d=this.G,v=this.H;for(r=0;r<64;r++){o=v+(xt(p,6)^xt(p,11)^xt(p,25))+sr(p,h,d)+hr[r]+dr[r]|0,a=(xt(c,2)^xt(c,13)^xt(c,22))+cr(c,u,f)|0;v=d,d=h,h=p,p=l+o|0,l=f,f=u,u=c,c=o+a|0}c=c+this.A|0,u=u+this.B|0,f=f+this.C|0,l=l+this.D|0,p=p+this.E|0,h=h+this.F|0,d=d+this.G|0,v=v+this.H|0,this.set(c,u,f,l,p,h,d,v)}},{key:"roundClean",value:function(){mt(dr)}},{key:"destroy",value:function(){this.set(0,0,0,0,0,0,0,0),mt(this.buffer)}}]),r}(ur),gr=Je(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(function(e){return BigInt(e)})),yr=gr[0],br=gr[1],mr=new Uint32Array(80),wr=new Uint32Array(80),xr=function(e){h(r,e);var t=v(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:64;return k(this,r),(e=t.call(this,128,n,16,!1)).Ah=0|pr[0],e.Al=0|pr[1],e.Bh=0|pr[2],e.Bl=0|pr[3],e.Ch=0|pr[4],e.Cl=0|pr[5],e.Dh=0|pr[6],e.Dl=0|pr[7],e.Eh=0|pr[8],e.El=0|pr[9],e.Fh=0|pr[10],e.Fl=0|pr[11],e.Gh=0|pr[12],e.Gl=0|pr[13],e.Hh=0|pr[14],e.Hl=0|pr[15],e}return x(r,[{key:"get",value:function(){return[this.Ah,this.Al,this.Bh,this.Bl,this.Ch,this.Cl,this.Dh,this.Dl,this.Eh,this.El,this.Fh,this.Fl,this.Gh,this.Gl,this.Hh,this.Hl]}},{key:"set",value:function(e,t,r,n,i,o,a,s,c,u,f,l,p,h,d,v){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|o,this.Dh=0|a,this.Dl=0|s,this.Eh=0|c,this.El=0|u,this.Fh=0|f,this.Fl=0|l,this.Gh=0|p,this.Gl=0|h,this.Hh=0|d,this.Hl=0|v}},{key:"process",value:function(e,t){for(var r,n,i,o,a,s,c,u,f=0;f<16;f++,t+=4)mr[f]=e.getUint32(t),wr[f]=e.getUint32(t+=4);for(var l=16;l<80;l++){var p=0|mr[l-15],h=0|wr[l-15],d=Xe(p,h,1)^Xe(p,h,8)^Ye(p,0,7),v=$e(p,h,1)^$e(p,h,8)^Qe(p,h,7),g=0|mr[l-2],y=0|wr[l-2],b=Xe(g,y,19)^et(g,y,61)^Ye(g,0,6),m=$e(g,y,19)^tt(g,y,61)^Qe(g,y,6),w=st(v,m,wr[l-7],wr[l-16]),x=ct(w,d,b,mr[l-7],mr[l-16]);mr[l]=0|x,wr[l]=0|w}var k=this.Ah,E=this.Al,I=this.Bh,S=this.Bl,O=this.Ch,_=this.Cl,P=this.Dh,A=this.Dl,R=this.Eh,T=this.El,B=this.Fh,C=this.Fl,U=this.Gh,N=this.Gl,j=this.Hh,L=this.Hl;for(f=0;f<80;f++){p=Xe(R,T,14)^Xe(R,T,18)^et(R,T,41),h=$e(R,T,14)^$e(R,T,18)^tt(R,T,41),d=R&B^~R&U,g=ut(L,h,T&C^~T&N,br[f],wr[f]),y=ft(g,j,p,d,yr[f],mr[f]),b=0|g,m=Xe(k,E,28)^et(k,E,34)^et(k,E,39),w=$e(k,E,28)^tt(k,E,34)^tt(k,E,39),x=k&I^k&O^I&O;var D,M=E&S^E&_^S&_;j=0|U,L=0|N,U=0|B,N=0|C,B=0|R,C=0|T,R=(D=it(0|P,0|A,0|y,0|b)).h,T=D.l,P=0|O,A=0|_,O=0|I,_=0|S,I=0|k,S=0|E;var q=ot(b,w,M);k=at(q,y,m,x),E=0|q}k=(r=it(0|this.Ah,0|this.Al,0|k,0|E)).h,E=r.l,I=(n=it(0|this.Bh,0|this.Bl,0|I,0|S)).h,S=n.l,O=(i=it(0|this.Ch,0|this.Cl,0|O,0|_)).h,_=i.l,P=(o=it(0|this.Dh,0|this.Dl,0|P,0|A)).h,A=o.l,R=(a=it(0|this.Eh,0|this.El,0|R,0|T)).h,T=a.l,B=(s=it(0|this.Fh,0|this.Fl,0|B,0|C)).h,C=s.l,U=(c=it(0|this.Gh,0|this.Gl,0|U,0|N)).h,N=c.l,j=(u=it(0|this.Hh,0|this.Hl,0|j,0|L)).h,L=u.l,this.set(k,E,I,S,O,_,P,A,R,T,B,C,U,N,j,L)}},{key:"roundClean",value:function(){mt(mr,wr)}},{key:"destroy",value:function(){mt(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}]),r}(ur),kr=function(e){h(r,e);var t=v(r);function r(){var e;return k(this,r),(e=t.call(this,48)).Ah=0|lr[0],e.Al=0|lr[1],e.Bh=0|lr[2],e.Bl=0|lr[3],e.Ch=0|lr[4],e.Cl=0|lr[5],e.Dh=0|lr[6],e.Dl=0|lr[7],e.Eh=0|lr[8],e.El=0|lr[9],e.Fh=0|lr[10],e.Fl=0|lr[11],e.Gh=0|lr[12],e.Gl=0|lr[13],e.Hh=0|lr[14],e.Hl=0|lr[15],e}return x(r)}(xr),Er=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]),Ir=function(e){h(r,e);var t=v(r);function r(){var e;return k(this,r),(e=t.call(this,32)).Ah=0|Er[0],e.Al=0|Er[1],e.Bh=0|Er[2],e.Bl=0|Er[3],e.Ch=0|Er[4],e.Cl=0|Er[5],e.Dh=0|Er[6],e.Dl=0|Er[7],e.Eh=0|Er[8],e.El=0|Er[9],e.Fh=0|Er[10],e.Fl=0|Er[11],e.Gh=0|Er[12],e.Gl=0|Er[13],e.Hh=0|Er[14],e.Hl=0|Er[15],e}return x(r)}(xr),Sr=Nt(function(){return new vr}),Or=Nt(function(){return new xr}),_r=Nt(function(){return new kr}),Pr=Nt(function(){return new Ir}),Ar=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),Rr=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),Tr=new Uint32Array(32);function Br(e,t,r,n,i,o){var a,s,c,u,f,l=i[o+1],p=Tr[2*e],h=Tr[2*e+1],d=Tr[2*t],v=Tr[2*t+1],g=Tr[2*r],y=Tr[2*r+1],b=Tr[2*n],m=Tr[2*n+1],w=ot(p,d,i[o]);m=(a={Dh:m^(h=at(w,h,v,l)),Dl:b^(p=0|w)}).Dh,y=(c=it(y,g,m=(s={Dh:rt(0,b=a.Dl),Dl:nt(m)}).Dh,b=s.Dl)).h,g=c.l,v=(f={Bh:Xe(v=(u={Bh:v^y,Bl:d^g}).Bh,d=u.Bl,24),Bl:$e(v,d,24)}).Bh,d=f.Bl,Tr[2*e]=p,Tr[2*e+1]=h,Tr[2*t]=d,Tr[2*t+1]=v,Tr[2*r]=g,Tr[2*r+1]=y,Tr[2*n]=b,Tr[2*n+1]=m}function Cr(e,t,r,n,i,o){var a,s,c,u,f,l=i[o+1],p=Tr[2*e],h=Tr[2*e+1],d=Tr[2*t],v=Tr[2*t+1],g=Tr[2*r],y=Tr[2*r+1],b=Tr[2*n],m=Tr[2*n+1],w=ot(p,d,i[o]);h=at(w,h,v,l),y=(c=it(y,g,m=(s={Dh:Xe(m=(a={Dh:m^h,Dl:b^(p=0|w)}).Dh,b=a.Dl,16),Dl:$e(m,b,16)}).Dh,b=s.Dl)).h,g=c.l,v=(f={Bh:et(v=(u={Bh:v^y,Bl:d^g}).Bh,d=u.Bl,63),Bl:tt(v,d,63)}).Bh,d=f.Bl,Tr[2*e]=p,Tr[2*e+1]=h,Tr[2*t]=d,Tr[2*t+1]=v,Tr[2*r]=g,Tr[2*r+1]=y,Tr[2*n]=b,Tr[2*n+1]=m}var Ur=function(e){h(r,e);var t=v(r);function r(e,n){var i;return k(this,r),(i=t.call(this)).finished=!1,i.destroyed=!1,i.length=0,i.pos=0,ht(e),ht(n),i.blockLen=e,i.outputLen=n,i.buffer=new Uint8Array(e),i.buffer32=bt(i.buffer),i}return x(r,[{key:"update",value:function(e){gt(this),dt(e=Bt(e));for(var t=this.blockLen,r=this.buffer,n=this.buffer32,i=e.length,o=e.byteOffset,a=e.buffer,s=0;s<i;){this.pos===t&&(St(n),this.compress(n,0,!1),St(n),this.pos=0);var c=Math.min(t-this.pos,i-s),u=o+s;if(c!==t||u%4||!(s+c<i))r.set(e.subarray(s,s+c),this.pos),this.pos+=c,this.length+=c,s+=c;else{var f=new Uint32Array(a,u,Math.floor((i-s)/4));St(f);for(var l=0;s+t<i;l+=n.length,s+=t)this.length+=t,this.compress(f,l,!1);St(f)}}return this}},{key:"digestInto",value:function(e){gt(this),yt(e,this);var t=this.pos,r=this.buffer32;this.finished=!0,mt(this.buffer.subarray(t)),St(r),this.compress(r,0,!0),St(r);var n=bt(e);this.get().forEach(function(e,t){return n[t]=It(e)})}},{key:"digest",value:function(){var e=this.buffer,t=this.outputLen;this.digestInto(e);var r=e.slice(0,t);return this.destroy(),r}},{key:"_cloneInto",value:function(e){var t,r=this.buffer,n=this.length,i=this.finished,o=this.destroyed,a=this.outputLen,c=this.pos;return e||(e=new this.constructor({dkLen:a})),(t=e).set.apply(t,s(this.get())),e.buffer.set(r),e.destroyed=o,e.finished=i,e.length=n,e.pos=c,e.outputLen=a,e}},{key:"clone",value:function(){return this._cloneInto()}}]),r}(Ut),Nr=function(e){h(r,e);var t=v(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};k(this,r);var i=void 0===n.dkLen?64:n.dkLen;(e=t.call(this,128,i)).v0l=0|Rr[0],e.v0h=0|Rr[1],e.v1l=0|Rr[2],e.v1h=0|Rr[3],e.v2l=0|Rr[4],e.v2h=0|Rr[5],e.v3l=0|Rr[6],e.v3h=0|Rr[7],e.v4l=0|Rr[8],e.v4h=0|Rr[9],e.v5l=0|Rr[10],e.v5h=0|Rr[11],e.v6l=0|Rr[12],e.v6h=0|Rr[13],e.v7l=0|Rr[14],e.v7h=0|Rr[15],function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if(ht(r),e<0||e>r)throw new Error("outputLen bigger than keyLen");var o=t.key,a=t.salt,s=t.personalization;if(void 0!==o&&(o.length<1||o.length>r))throw new Error("key length must be undefined or 1.."+r);if(void 0!==a&&a.length!==n)throw new Error("salt must be undefined or "+n);if(void 0!==s&&s.length!==i)throw new Error("personalization must be undefined or "+i)}(i,n,64,16,16);var o=n.key,a=n.personalization,s=n.salt,c=0;if(void 0!==o&&(c=(o=Bt(o)).length),e.v0l^=e.outputLen|c<<8|65536|1<<24,void 0!==s){var u=bt(s=Bt(s));e.v4l^=It(u[0]),e.v4h^=It(u[1]),e.v5l^=It(u[2]),e.v5h^=It(u[3])}if(void 0!==a){var f=bt(a=Bt(a));e.v6l^=It(f[0]),e.v6h^=It(f[1]),e.v7l^=It(f[2]),e.v7h^=It(f[3])}if(void 0!==o){var l=new Uint8Array(e.blockLen);l.set(o),e.update(l)}return e}return x(r,[{key:"get",value:function(){return[this.v0l,this.v0h,this.v1l,this.v1h,this.v2l,this.v2h,this.v3l,this.v3h,this.v4l,this.v4h,this.v5l,this.v5h,this.v6l,this.v6h,this.v7l,this.v7h]}},{key:"set",value:function(e,t,r,n,i,o,a,s,c,u,f,l,p,h,d,v){this.v0l=0|e,this.v0h=0|t,this.v1l=0|r,this.v1h=0|n,this.v2l=0|i,this.v2h=0|o,this.v3l=0|a,this.v3h=0|s,this.v4l=0|c,this.v4h=0|u,this.v5l=0|f,this.v5h=0|l,this.v6l=0|p,this.v6h=0|h,this.v7l=0|d,this.v7h=0|v}},{key:"compress",value:function(e,t,r){this.get().forEach(function(e,t){return Tr[t]=e}),Tr.set(Rr,16);var n=Ge(BigInt(this.length)),i=n.h,o=n.l;Tr[24]=Rr[8]^o,Tr[25]=Rr[9]^i,r&&(Tr[28]=~Tr[28],Tr[29]=~Tr[29]);for(var a=0,s=Ar,c=0;c<12;c++)Br(0,4,8,12,e,t+2*s[a++]),Cr(0,4,8,12,e,t+2*s[a++]),Br(1,5,9,13,e,t+2*s[a++]),Cr(1,5,9,13,e,t+2*s[a++]),Br(2,6,10,14,e,t+2*s[a++]),Cr(2,6,10,14,e,t+2*s[a++]),Br(3,7,11,15,e,t+2*s[a++]),Cr(3,7,11,15,e,t+2*s[a++]),Br(0,5,10,15,e,t+2*s[a++]),Cr(0,5,10,15,e,t+2*s[a++]),Br(1,6,11,12,e,t+2*s[a++]),Cr(1,6,11,12,e,t+2*s[a++]),Br(2,7,8,13,e,t+2*s[a++]),Cr(2,7,8,13,e,t+2*s[a++]),Br(3,4,9,14,e,t+2*s[a++]),Cr(3,4,9,14,e,t+2*s[a++]);this.v0l^=Tr[0]^Tr[16],this.v0h^=Tr[1]^Tr[17],this.v1l^=Tr[2]^Tr[18],this.v1h^=Tr[3]^Tr[19],this.v2l^=Tr[4]^Tr[20],this.v2h^=Tr[5]^Tr[21],this.v3l^=Tr[6]^Tr[22],this.v3h^=Tr[7]^Tr[23],this.v4l^=Tr[8]^Tr[24],this.v4h^=Tr[9]^Tr[25],this.v5l^=Tr[10]^Tr[26],this.v5h^=Tr[11]^Tr[27],this.v6l^=Tr[12]^Tr[28],this.v6h^=Tr[13]^Tr[29],this.v7l^=Tr[14]^Tr[30],this.v7h^=Tr[15]^Tr[31],mt(Tr)}},{key:"destroy",value:function(){this.destroyed=!0,mt(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}]),r}(Ur),jr=function(e){var t=function(t,r){return e(r).update(Bt(t)).digest()},r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=function(t){return e(t)},t}(function(e){return new Nr(e)}),Lr="https://rpc.walletconnect.org/v1";function Dr(e){var t="\x19Ethereum Signed Message:\n".concat(e.length),r=(new TextEncoder).encode(t+e);return"0x"+Buffer.from(ar(r)).toString("hex")}function Mr(e,t,r,n,i,o){return qr.apply(this,arguments)}function qr(){return qr=(0,o.Z)(p().mark(function e(t,r,n,i,o,a){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n.t,e.next="eip191"===e.t0?3:"eip1271"===e.t0?6:9;break;case 3:return e.next=5,zr(t,r,n.s);case 5:case 8:return e.abrupt("return",e.sent);case 6:return e.next=8,Zr(t,r,n.s,i,o,a);case 9:throw new Error("verifySignature failed: Attempted to verify CacaoSignature with unknown type: ".concat(n.t));case 10:case"end":return e.stop()}},e)})),qr.apply(this,arguments)}function zr(e,t,r){var n=w.H_(r);return E.RJ({payload:Dr(t),signature:n}).toLowerCase()===e.toLowerCase()}function Zr(e,t,r,n,i,o){return Fr.apply(this,arguments)}function Fr(){return Fr=(0,o.Z)(p().mark(function e(t,r,n,i,o,a){var s,c,u,f,l,h,d,v;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((s=ae(i)).namespace&&s.reference){e.next=3;break}throw new Error("isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ".concat(i));case 3:return e.prev=3,c="0x1626ba7e","0000000000000000000000000000000000000000000000000000000000000040",u=n.substring(2),f=(u.length/2).toString(16).padStart(64,"0"),l=c+(r.startsWith("0x")?r:Dr(r)).substring(2)+"0000000000000000000000000000000000000000000000000000000000000040"+f+u,e.next=11,fetch("".concat(a||Lr,"/?chainId=").concat(i,"&projectId=").concat(o),{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:Kr(),jsonrpc:"2.0",method:"eth_call",params:[{to:t,data:l},"latest"]})});case 11:return h=e.sent,e.next=14,h.json();case 14:return d=e.sent,v=d.result,e.abrupt("return",!!v&&v.slice(0,c.length).toLowerCase()===c.toLowerCase());case 19:return e.prev=19,e.t0=e.catch(3),e.abrupt("return",(console.error("isValidEip1271Signature: ",e.t0),!1));case 22:case"end":return e.stop()}},e,null,[[3,19]])})),Fr.apply(this,arguments)}function Kr(){return Date.now()+Math.floor(1e3*Math.random())}function Vr(e){var t=new Uint8Array(Buffer.from(e,"base64")),r=Array.from("TransactionData::").map(function(e){return e.charCodeAt(0)}),n=new Uint8Array(r.length+t.length);n.set(r),n.set(t,r.length);var i=jr(n,{dkLen:32});return ee.Jq.encode(i)}function Hr(e){var t=new Uint8Array(Sr(function(e){if(e instanceof Uint8Array)return e;if(Array.isArray(e))return new Uint8Array(e);if("object"==typeof e&&null!=e&&e.data)return new Uint8Array(Object.values(e.data));if("object"==typeof e&&e)return new Uint8Array(Object.values(e));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}(e)));return ee.Jq.encode(t)}function Wr(e){var t=function(e,t){return new X(void 0).decode(e)}(Buffer.from(e,"base64")).txn;if(!t)throw new Error("Invalid signed transaction: missing 'txn' field");var r=function(e,t){return new $(void 0).encodeSharedRef(e)}(t),n=Buffer.from("TX"),i=Buffer.concat([n,Buffer.from(r)]),o=Pr(i);return ee.pJ.encode(o).replace(/=+$/,"")}function Gr(e){for(var t=[],r=BigInt(e);r>=BigInt(128);)t.push(Number(r&BigInt(127)|BigInt(128))),r>>=BigInt(7);return t.push(Number(r)),Buffer.from(t)}function Jr(e){var t=Buffer.from(e.signed.bodyBytes,"base64"),r=Buffer.from(e.signed.authInfoBytes,"base64"),n=Buffer.from(e.signature.signature,"base64"),i=[];i.push(Buffer.from([10])),i.push(Gr(t.length)),i.push(t),i.push(Buffer.from([18])),i.push(Gr(r.length)),i.push(r),i.push(Buffer.from([26])),i.push(Gr(n.length)),i.push(n);var o=Buffer.concat(i),a=Sr(o);return Buffer.from(a).toString("hex").toUpperCase()}var Yr=Object.defineProperty,Qr=Object.defineProperties,Xr=Object.getOwnPropertyDescriptors,$r=Object.getOwnPropertySymbols,en=Object.prototype.hasOwnProperty,tn=Object.prototype.propertyIsEnumerable,rn=function(e,t,r){return t in e?Yr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},nn="did:pkh:",on={eip155:"Ethereum",solana:"Solana",bip122:"Bitcoin"},an=function(e){return null==e?void 0:e.split(":")},sn=function(e){var t=e&&an(e);if(t)return t[2]+":"+t[3]},cn=function(e){var t=e&&an(e);if(t)return t.pop()};function un(e){return fn.apply(this,arguments)}function fn(){return fn=(0,o.Z)(p().mark(function e(t){var r,n,i,o,a,s;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.cacao,n=t.projectId,i=r.s,o=r.p,a=ln(o,o.iss),s=cn(o.iss),e.next=3,Mr(s,a,i,sn(o.iss),n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)})),fn.apply(this,arguments)}var ln=function(e,t){var r=function(e){var t=e&&an(e);if(t)return e.includes(nn)?t[2]:t[0]}(t);if(!r)throw new Error("Invalid issuer: "+t);var n="".concat(e.domain," wants you to sign in with your ").concat(function(e){return e?on[e]||e:""}(r)," account:"),i=cn(t);if(!e.aud&&!e.uri)throw new Error("Either `aud` or `uri` is required to construct the message");var o=e.statement||void 0,a="URI: ".concat(e.aud||e.uri),s="Version: ".concat(e.version),c="Chain ID: ".concat(function(e){var t=e&&an(e);if(t)return e.includes(nn)?t[3]:t[1]}(t)),u="Nonce: ".concat(e.nonce),f="Issued At: ".concat(e.iat),l=e.exp?"Expiration Time: ".concat(e.exp):void 0,p=e.nbf?"Not Before: ".concat(e.nbf):void 0,h=e.requestId?"Request ID: ".concat(e.requestId):void 0,d=e.resources?"Resources:".concat(e.resources.map(function(e){return"\n- ".concat(e)}).join("")):void 0,v=mn(e.resources);return v&&(o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;pn(t);var r="I further authorize the stated URI to perform the following actions on my behalf: ";if(e.includes(r))return e;var n=[],i=0;return Object.keys(t.att).forEach(function(e){var r=Object.keys(t.att[e]).map(function(e){return{ability:e.split("/")[0],action:e.split("/")[1]}});r.sort(function(e,t){return e.action.localeCompare(t.action)});var o={};r.forEach(function(e){o[e.ability]||(o[e.ability]=[]),o[e.ability].push(e.action)});var a=Object.keys(o).map(function(t){return i++,"(".concat(i,") '").concat(t,"': '").concat(o[t].join("', '"),"' for '").concat(e,"'.")});n.push(a.join(", ").replace(".,","."))}),"".concat(e?e+" ":"").concat(r).concat(n.join(" "))}(o,vn(v))),[n,i,"",o,"",a,s,c,u,f,l,p,h,d].filter(function(e){return null!=e}).join("\n")};function pn(e){if(!e)throw new Error("No recap provided, value is undefined");if(!e.att)throw new Error("No `att` property found");var t=Object.keys(e.att);if(null==t||!t.length)throw new Error("No resources found in `att` property");t.forEach(function(t){var r=e.att[t];if(Array.isArray(r))throw new Error("Resource must be an object: ".concat(t));if("object"!=typeof r)throw new Error("Resource must be an object: ".concat(t));if(!Object.keys(r).length)throw new Error("Resource object is empty: ".concat(t));Object.keys(r).forEach(function(e){var t=r[e];if(!Array.isArray(t))throw new Error("Ability limits ".concat(e," must be an array of objects, found: ").concat(t));if(!t.length)throw new Error("Value of ".concat(e," is empty array, must be an array with objects"));t.forEach(function(t){if("object"!=typeof t)throw new Error("Ability limits (".concat(e,") must be an array of objects, found: ").concat(t))})})})}function hn(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t=null===(r=t)||void 0===r?void 0:r.sort(function(e,t){return e.localeCompare(t)});var i=t.map(function(t){return c({},"".concat(e,"/").concat(t),[n])});return Object.assign.apply(Object,[{}].concat(s(i)))}function dn(e){return pn(e),"urn:recap:".concat(function(e){return Buffer.from(JSON.stringify(e)).toString("base64")}(e).replace(/=/g,""))}function vn(e){var t=function(e){return JSON.parse(Buffer.from(e,"base64").toString("utf-8"))}(e.replace("urn:recap:",""));return pn(t),t}function gn(e,t){var r=function(e,t){pn(e),pn(t);var r=Object.keys(e.att).concat(Object.keys(t.att)).sort(function(e,t){return e.localeCompare(t)}),n={att:{}};return r.forEach(function(r){var i,o;Object.keys((null==(i=e.att)?void 0:i[r])||{}).concat(Object.keys((null==(o=t.att)?void 0:o[r])||{})).sort(function(e,t){return e.localeCompare(t)}).forEach(function(i){var o,a;n.att[r]=function(e,t){return Qr(e,Xr(t))}(function(e,t){for(var r in t||(t={}))en.call(t,r)&&rn(e,r,t[r]);if($r){var n,i=u($r(t));try{for(i.s();!(n=i.n()).done;){r=n.value;tn.call(t,r)&&rn(e,r,t[r])}}catch(o){i.e(o)}finally{i.f()}}return e}({},n.att[r]),c({},i,(null==(o=e.att[r])?void 0:o[i])||(null==(a=t.att[r])?void 0:a[i])))})}),n}(vn(e),vn(t));return dn(r)}function yn(e){var t,r=vn(e);pn(r);var n=null==(t=r.att)?void 0:t.eip155;return n?Object.keys(n).map(function(e){return e.split("/")[1]}):[]}function bn(e){var t=vn(e);pn(t);var r=[];return Object.values(t.att).forEach(function(e){Object.values(e).forEach(function(e){var t;null!=(t=null==e?void 0:e[0])&&t.chains&&r.push(e[0].chains)})}),s(new Set(r.flat()))}function mn(e){if(e){var t=null==e?void 0:e[e.length-1];return function(e){return e&&e.includes("urn:recap:")}(t)?t:void 0}}function wn(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function xn(e){if("boolean"!=typeof e)throw new Error("boolean expected, not ".concat(e))}function kn(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function En(e){if(!wn(e))throw new Error("Uint8Array expected");for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(r.length>0&&!r.includes(e.length))throw new Error("Uint8Array expected of length "+r+", got length="+e.length)}function In(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Sn(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function On(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0;n<t.length;n++)t[n].fill(0)}var _n=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];function Pn(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}(e);else{if(!wn(e))throw new Error("Uint8Array expected, got "+typeof e);e=Tn(e)}return e}function An(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(r&&!function(e){return e.byteOffset%4==0}(t))throw new Error("invalid output, must be aligned");return t}function Rn(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);var i=BigInt(32),o=BigInt(4294967295),a=Number(r>>i&o),s=Number(r&o),c=n?0:4;e.setUint32(t+(n?4:0),a,n),e.setUint32(t+c,s,n)}function Tn(e){return Uint8Array.from(e)}var Bn=function(e){return Uint8Array.from(e.split("").map(function(e){return e.charCodeAt(0)}))},Cn=Bn("expand 16-byte k"),Un=Bn("expand 32-byte k"),Nn=Sn(Cn),jn=Sn(Un);function Ln(e,t){return e<<t|e>>>32-t}function Dn(e){return e.byteOffset%4==0}var Mn=Math.pow(2,32)-1,qn=new Uint32Array,zn=function(e,t){return 255&e[t++]|(255&e[t++])<<8},Zn=function(){function e(t){k(this,e),this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,En(t=Pn(t),32);var r=zn(t,0),n=zn(t,2),i=zn(t,4),o=zn(t,6),a=zn(t,8),s=zn(t,10),c=zn(t,12),u=zn(t,14);this.r[0]=8191&r,this.r[1]=8191&(r>>>13|n<<3),this.r[2]=7939&(n>>>10|i<<6),this.r[3]=8191&(i>>>7|o<<9),this.r[4]=255&(o>>>4|a<<12),this.r[5]=a>>>1&8190,this.r[6]=8191&(a>>>14|s<<2),this.r[7]=8065&(s>>>11|c<<5),this.r[8]=8191&(c>>>8|u<<8),this.r[9]=u>>>5&127;for(var f=0;f<8;f++)this.pad[f]=zn(t,16+2*f)}return x(e,[{key:"process",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=r?0:2048,i=this.h,o=this.r,a=o[0],s=o[1],c=o[2],u=o[3],f=o[4],l=o[5],p=o[6],h=o[7],d=o[8],v=o[9],g=zn(e,t+0),y=zn(e,t+2),b=zn(e,t+4),m=zn(e,t+6),w=zn(e,t+8),x=zn(e,t+10),k=zn(e,t+12),E=zn(e,t+14),I=i[0]+(8191&g),S=i[1]+(8191&(g>>>13|y<<3)),O=i[2]+(8191&(y>>>10|b<<6)),_=i[3]+(8191&(b>>>7|m<<9)),P=i[4]+(8191&(m>>>4|w<<12)),A=i[5]+(w>>>1&8191),R=i[6]+(8191&(w>>>14|x<<2)),T=i[7]+(8191&(x>>>11|k<<5)),B=i[8]+(8191&(k>>>8|E<<8)),C=i[9]+(E>>>5|n),U=0,N=U+I*a+S*(5*v)+O*(5*d)+_*(5*h)+P*(5*p);U=N>>>13,N&=8191;var j=(U+=(N+=A*(5*l)+R*(5*f)+T*(5*u)+B*(5*c)+C*(5*s))>>>13)+I*s+S*a+O*(5*v)+_*(5*d)+P*(5*h);U=j>>>13,j&=8191,U+=(j+=A*(5*p)+R*(5*l)+T*(5*f)+B*(5*u)+C*(5*c))>>>13,j&=8191;var L=U+I*c+S*s+O*a+_*(5*v)+P*(5*d);U=L>>>13,L&=8191,U+=(L+=A*(5*h)+R*(5*p)+T*(5*l)+B*(5*f)+C*(5*u))>>>13,L&=8191;var D=U+I*u+S*c+O*s+_*a+P*(5*v);U=D>>>13,D&=8191,U+=(D+=A*(5*d)+R*(5*h)+T*(5*p)+B*(5*l)+C*(5*f))>>>13,D&=8191;var M=U+I*f+S*u+O*c+_*s+P*a;U=M>>>13,M&=8191,U+=(M+=A*(5*v)+R*(5*d)+T*(5*h)+B*(5*p)+C*(5*l))>>>13,M&=8191;var q=U+I*l+S*f+O*u+_*c+P*s;U=q>>>13,q&=8191,U+=(q+=A*a+R*(5*v)+T*(5*d)+B*(5*h)+C*(5*p))>>>13,q&=8191;var z=U+I*p+S*l+O*f+_*u+P*c;U=z>>>13,z&=8191,U+=(z+=A*s+R*a+T*(5*v)+B*(5*d)+C*(5*h))>>>13,z&=8191;var Z=U+I*h+S*p+O*l+_*f+P*u;U=Z>>>13,Z&=8191,U+=(Z+=A*c+R*s+T*a+B*(5*v)+C*(5*d))>>>13,Z&=8191;var F=U+I*d+S*h+O*p+_*l+P*f;U=F>>>13,F&=8191,U+=(F+=A*u+R*c+T*s+B*a+C*(5*v))>>>13,F&=8191;var K=U+I*v+S*d+O*h+_*p+P*l;U=K>>>13,K&=8191,U+=(K+=A*f+R*u+T*c+B*s+C*a)>>>13,K&=8191,N=8191&(U=(U=(U<<2)+U|0)+(N&=8191)|0),j+=U>>>=13,i[0]=N,i[1]=j,i[2]=L,i[3]=D,i[4]=M,i[5]=q,i[6]=z,i[7]=Z,i[8]=F,i[9]=K}},{key:"finalize",value:function(){var e=this.h,t=this.pad,r=new Uint16Array(10),n=e[1]>>>13;e[1]&=8191;for(var i=2;i<10;i++)e[i]+=n,n=e[i]>>>13,e[i]&=8191;e[0]+=5*n,n=e[0]>>>13,e[0]&=8191,e[1]+=n,n=e[1]>>>13,e[1]&=8191,e[2]+=n,r[0]=e[0]+5,n=r[0]>>>13,r[0]&=8191;for(var o=1;o<10;o++)r[o]=e[o]+n,n=r[o]>>>13,r[o]&=8191;r[9]-=8192;for(var a=(1^n)-1,s=0;s<10;s++)r[s]&=a;a=~a;for(var c=0;c<10;c++)e[c]=e[c]&a|r[c];e[0]=65535&(e[0]|e[1]<<13),e[1]=65535&(e[1]>>>3|e[2]<<10),e[2]=65535&(e[2]>>>6|e[3]<<7),e[3]=65535&(e[3]>>>9|e[4]<<4),e[4]=65535&(e[4]>>>12|e[5]<<1|e[6]<<14),e[5]=65535&(e[6]>>>2|e[7]<<11),e[6]=65535&(e[7]>>>5|e[8]<<8),e[7]=65535&(e[8]>>>8|e[9]<<5);var u=e[0]+t[0];e[0]=65535&u;for(var f=1;f<8;f++)u=(e[f]+t[f]|0)+(u>>>16)|0,e[f]=65535&u;On(r)}},{key:"update",value:function(e){In(this),En(e=Pn(e));for(var t=this.buffer,r=this.blockLen,n=e.length,i=0;i<n;){var o=Math.min(r-this.pos,n-i);if(o!==r)t.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===r&&(this.process(t,0,!1),this.pos=0);else for(;r<=n-i;i+=r)this.process(e,i)}return this}},{key:"destroy",value:function(){On(this.h,this.r,this.buffer,this.pad)}},{key:"digestInto",value:function(e){In(this),function(e,t){En(e);var r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}(e,this),this.finished=!0;var t=this.buffer,r=this.h,n=this.pos;if(n){for(t[n++]=1;n<16;n++)t[n]=0;this.process(t,0,!0)}this.finalize();for(var i=0,o=0;o<8;o++)e[i++]=r[o]>>>0,e[i++]=r[o]>>>8;return e}},{key:"digest",value:function(){var e=this.buffer,t=this.outputLen;this.digestInto(e);var r=e.slice(0,t);return this.destroy(),r}}]),e}(),Fn=function(e){var t=function(t,r){return e(r).update(Pn(t)).digest()},r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=function(t){return e(t)},t}(function(e){return new Zn(e)}),Kn=function(e,t){var r=function(e,t){if(null==t||"object"!=typeof t)throw new Error("options must be defined");return Object.assign({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t)}(0,{counterRight:!1,counterLength:4,allowShortKeys:!1}),n=r.allowShortKeys,i=r.extendNonceFn,o=r.counterLength,a=r.counterRight,s=r.rounds;return kn(o),kn(s),xn(a),xn(n),function(t,r,c,u){var f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;En(t),En(r),En(c);var l=c.length;if(void 0===u&&(u=new Uint8Array(l)),En(u),kn(f),f<0||f>=Mn)throw new Error("arx: counter overflow");if(u.length<l)throw new Error("arx: output (".concat(u.length,") is shorter than data (").concat(l,")"));var p,h,d=[],v=t.length;if(32===v)d.push(p=Tn(t)),h=jn;else{if(16!==v||!n)throw new Error("arx: invalid 32-byte key, got length=".concat(v));(p=new Uint8Array(32)).set(t),p.set(t,16),h=Nn,d.push(p)}Dn(r)||d.push(r=Tn(r));var g=Sn(p);if(i){if(24!==r.length)throw new Error("arx: extended nonce must be 24 bytes");i(h,g,Sn(r.subarray(0,16)),g),r=r.subarray(16)}var y=16-o;if(y!==r.length)throw new Error("arx: nonce must be ".concat(y," or 16 bytes"));if(12!==y){var b=new Uint8Array(12);b.set(r,a?0:12-r.length),d.push(r=b)}var m=Sn(r);return function(e,t,r,n,i,o,a,s){for(var c=i.length,u=new Uint8Array(64),f=Sn(u),l=Dn(i)&&Dn(o),p=l?Sn(i):qn,h=l?Sn(o):qn,d=0;d<c;a++){if(e(t,r,n,f,a,s),a>=Mn)throw new Error("arx: counter overflow");var v=Math.min(64,c-d);if(l&&64===v){var g=d/4;if(d%4!=0)throw new Error("arx: invalid block position");for(var y,b=0;b<16;b++)h[y=g+b]=p[y]^f[b];d+=64}else{for(var m,w=0;w<v;w++)o[m=d+w]=i[m]^u[w];d+=v}}}(e,h,g,m,c,u,f,s),On.apply(void 0,d),u}}(function(e,t,r,n,i){for(var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:20,a=e[0],s=e[1],c=e[2],u=e[3],f=t[0],l=t[1],p=t[2],h=t[3],d=t[4],v=t[5],g=t[6],y=t[7],b=i,m=r[0],w=r[1],x=r[2],k=a,E=s,I=c,S=u,O=f,_=l,P=p,A=h,R=d,T=v,B=g,C=y,U=b,N=m,j=w,L=x,D=0;D<o;D+=2)U=Ln(U^(k=k+O|0),16),O=Ln(O^(R=R+U|0),12),U=Ln(U^(k=k+O|0),8),O=Ln(O^(R=R+U|0),7),N=Ln(N^(E=E+_|0),16),_=Ln(_^(T=T+N|0),12),N=Ln(N^(E=E+_|0),8),_=Ln(_^(T=T+N|0),7),j=Ln(j^(I=I+P|0),16),P=Ln(P^(B=B+j|0),12),j=Ln(j^(I=I+P|0),8),P=Ln(P^(B=B+j|0),7),L=Ln(L^(S=S+A|0),16),A=Ln(A^(C=C+L|0),12),L=Ln(L^(S=S+A|0),8),A=Ln(A^(C=C+L|0),7),L=Ln(L^(k=k+_|0),16),_=Ln(_^(B=B+L|0),12),L=Ln(L^(k=k+_|0),8),_=Ln(_^(B=B+L|0),7),U=Ln(U^(E=E+P|0),16),P=Ln(P^(C=C+U|0),12),U=Ln(U^(E=E+P|0),8),P=Ln(P^(C=C+U|0),7),N=Ln(N^(I=I+A|0),16),A=Ln(A^(R=R+N|0),12),N=Ln(N^(I=I+A|0),8),A=Ln(A^(R=R+N|0),7),j=Ln(j^(S=S+O|0),16),O=Ln(O^(T=T+j|0),12),j=Ln(j^(S=S+O|0),8),O=Ln(O^(T=T+j|0),7);var M=0;n[M++]=a+k|0,n[M++]=s+E|0,n[M++]=c+I|0,n[M++]=u+S|0,n[M++]=f+O|0,n[M++]=l+_|0,n[M++]=p+P|0,n[M++]=h+A|0,n[M++]=d+R|0,n[M++]=v+T|0,n[M++]=g+B|0,n[M++]=y+C|0,n[M++]=b+U|0,n[M++]=m+N|0,n[M++]=w+j|0,n[M++]=x+L|0}),Vn=new Uint8Array(16),Hn=function(e,t){e.update(t);var r=t.length%16;r&&e.update(Vn.subarray(r))},Wn=new Uint8Array(32);function Gn(e,t,r,n,i){var o=e(t,r,Wn),a=Fn.create(o);i&&Hn(a,i),Hn(a,n);var s=function(e,t,r){xn(r);var n=new Uint8Array(16),i=function(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}(n);return Rn(i,0,BigInt(t),r),Rn(i,8,BigInt(e),r),n}(n.length,i?i.length:0,!0);a.update(s);var c=a.digest();return On(o,s),c}var Jn=function(e,t){function r(r){if(En(r),!_n)throw new Error("Non little-endian hardware is not yet supported");for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];if(void 0!==e.nonceLength){var a=i[0];if(!a)throw new Error("nonce / iv required");e.varSizeNonce?En(a):En(a,e.nonceLength)}var s=e.tagLength;s&&void 0!==i[1]&&En(i[1]);var c=t.apply(void 0,[r].concat(i)),u=function(e,t){if(void 0!==t){if(2!==e)throw new Error("cipher output not supported");En(t)}},f=!1;return{encrypt:function(e,t){if(f)throw new Error("cannot encrypt() twice with same key + nonce");return f=!0,En(e),u(c.encrypt.length,t),c.encrypt(e,t)},decrypt:function(e,t){if(En(e),s&&e.length<s)throw new Error("invalid ciphertext length: smaller than tagLength="+s);return u(c.decrypt.length,t),c.decrypt(e,t)}}}return Object.assign(r,e),r}({blockSize:64,nonceLength:12,tagLength:16},function(e){return function(t,r,n){return{encrypt:function(i,o){var a=i.length;(o=An(a+16,o,!1)).set(i);var s=o.subarray(0,-16);e(t,r,s,s,1);var c=Gn(e,t,r,s,n);return o.set(c,a),On(c),o},decrypt:function(i,o){o=An(i.length-16,o,!1);var a=i.subarray(0,-16),s=i.subarray(-16),c=Gn(e,t,r,a,n);if(!function(e,t){if(e.length!==t.length)return!1;for(var r=0,n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r}(s,c))throw new Error("invalid tag");return o.set(i.subarray(0,-16)),e(t,r,o,o,1),On(c),o}}}}(Kn)),Yn=function(e){h(r,e);var t=v(r);function r(e,n){var i;k(this,r),(i=t.call(this)).finished=!1,i.destroyed=!1,vt(e);var o=Bt(n);if(i.iHash=e.create(),"function"!=typeof i.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");i.blockLen=i.iHash.blockLen,i.outputLen=i.iHash.outputLen;var a=i.blockLen,s=new Uint8Array(a);s.set(o.length>a?e.create().update(o).digest():o);for(var c=0;c<s.length;c++)s[c]^=54;i.iHash.update(s),i.oHash=e.create();for(var u=0;u<s.length;u++)s[u]^=106;return i.oHash.update(s),mt(s),i}return x(r,[{key:"update",value:function(e){return gt(this),this.iHash.update(e),this}},{key:"digestInto",value:function(e){gt(this),dt(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}},{key:"digest",value:function(){var e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}},{key:"_cloneInto",value:function(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));var t=this.oHash,r=this.iHash,n=this.finished,i=this.destroyed,o=this.blockLen,a=this.outputLen;return e.finished=n,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}},{key:"clone",value:function(){return this._cloneInto()}},{key:"destroy",value:function(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}]),r}(Ut),Qn=function(e,t,r){return new Yn(e,t).update(r).digest()};Qn.create=function(e,t){return new Yn(e,t)};var Xn=Uint8Array.from([0]),$n=Uint8Array.of(),ei=Sr,ti=BigInt(0),ri=BigInt(1);function ni(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if("boolean"!=typeof e)throw new Error((t&&'"'.concat(t,'"'))+"expected boolean, got type="+typeof e);return e}function ii(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=pt(e),i=null==e?void 0:e.length,o=void 0!==t;if(!n||o&&i!==t)throw new Error((r&&'"'.concat(r,'" '))+"expected Uint8Array"+(o?" of length ".concat(t):"")+", got "+(n?"length=".concat(i):"type="+typeof e));return e}function oi(e){var t=e.toString(16);return 1&t.length?"0"+t:t}function ai(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?ti:BigInt("0x"+e)}function si(e){return ai(Pt(e))}function ci(e){return dt(e),ai(Pt(Uint8Array.from(e).reverse()))}function ui(e,t){return Rt(e.toString(16).padStart(2*t,"0"))}function fi(e,t){return ui(e,t).reverse()}function li(e,t,r){var n;if("string"==typeof t)try{n=Rt(t)}catch(Xt){throw new Error(e+" must be hex string or Uint8Array, cause: "+Xt)}else{if(!pt(t))throw new Error(e+" must be hex string or Uint8Array");n=Uint8Array.from(t)}var i=n.length;if("number"==typeof r&&i!==r)throw new Error(e+" of length "+r+" expected, got "+i);return n}var pi=function(e){return"bigint"==typeof e&&ti<=e};function hi(e,t,r,n){if(!function(e,t,r){return pi(e)&&pi(t)&&pi(r)&&t<=e&&e<r}(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}function di(e){var t;for(t=0;e>ti;e>>=ri,t+=1);return t}var vi=function(e){return(ri<<BigInt(e))-ri};function gi(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||"object"!=typeof e)throw new Error("expected valid options object");function n(t,r,n){var i=e[t];if(!n||void 0!==i){var o=typeof i;if(o!==r||null===i)throw new Error('param "'.concat(t,'" is invalid: expected ').concat(r,", got ").concat(o))}}Object.entries(t).forEach(function(e){var t=i(e,2);return n(t[0],t[1],!1)}),Object.entries(r).forEach(function(e){var t=i(e,2);return n(t[0],t[1],!0)})}function yi(e){var t=new WeakMap;return function(r){var n=t.get(r);if(void 0!==n)return n;for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];var s=e.apply(void 0,[r].concat(o));return t.set(r,s),s}}var bi=BigInt(0),mi=BigInt(1),wi=BigInt(2),xi=BigInt(3),ki=BigInt(4),Ei=BigInt(5),Ii=BigInt(7),Si=BigInt(8),Oi=BigInt(9),_i=BigInt(16);function Pi(e,t){var r=e%t;return r>=bi?r:t+r}function Ai(e,t,r){for(var n=e;t-- >bi;)n*=n,n%=r;return n}function Ri(e,t){if(e===bi)throw new Error("invert: expected non-zero number");if(t<=bi)throw new Error("invert: expected positive modulus, got "+t);for(var r=Pi(e,t),n=t,i=bi,o=mi;r!==bi;){var a=n%r,s=i-o*(n/r);n=r,r=a,i=o,o=s}if(n!==mi)throw new Error("invert: does not exist");return Pi(i,t)}function Ti(e,t,r){if(!e.eql(e.sqr(t),r))throw new Error("Cannot find square root")}function Bi(e,t){var r=e.pow(t,(e.ORDER+mi)/ki);return Ti(e,r,t),r}function Ci(e,t){var r=(e.ORDER-Ei)/Si,n=e.mul(t,wi),i=e.pow(n,r),o=e.mul(t,i),a=e.mul(e.mul(o,wi),i),s=e.mul(o,e.sub(a,e.ONE));return Ti(e,s,t),s}function Ui(e){if(e<xi)throw new Error("sqrt is not defined for small field");for(var t=e-mi,r=0;t%wi===bi;)t/=wi,r++;for(var n=wi,i=Mi(e);1===Li(i,n);)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===r)return Bi;var o=i.pow(n,t),a=(t+mi)/wi;return function(e,n){if(e.is0(n))return n;if(1!==Li(e,n))throw new Error("Cannot find square root");for(var i=r,s=e.mul(e.ONE,o),c=e.pow(n,t),u=e.pow(n,a);!e.eql(c,e.ONE);){if(e.is0(c))return e.ZERO;for(var f=1,l=e.sqr(c);!e.eql(l,e.ONE);)if(f++,l=e.sqr(l),f===i)throw new Error("Cannot find square root");var p=mi<<BigInt(i-f-1),h=e.pow(s,p);i=f,s=e.sqr(h),c=e.mul(c,s),u=e.mul(u,h)}return u}}var Ni=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ji(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=new Array(t.length).fill(r?e.ZERO:void 0),i=t.reduce(function(t,r,i){return e.is0(r)?t:(n[i]=t,e.mul(t,r))},e.ONE),o=e.inv(i);return t.reduceRight(function(t,r,i){return e.is0(r)?t:(n[i]=e.mul(t,n[i]),e.mul(t,r))},o),n}function Li(e,t){var r=e.pow(t,(e.ORDER-mi)/wi),n=e.eql(r,e.ONE),i=e.eql(r,e.ZERO),o=e.eql(r,e.neg(e.ONE));if(!n&&!i&&!o)throw new Error("invalid Legendre symbol result");return n?1:i?0:-1}function Di(e,t){void 0!==t&&ht(t);var r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function Mi(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(e<=bi)throw new Error("invalid field: expected ORDER > 0, got "+e);var i,o,a,s=!1;if("object"==typeof t&&null!=t){if(n.sqrt||r)throw new Error("cannot specify opts in two arguments");var c=t;c.BITS&&(i=c.BITS),c.sqrt&&(o=c.sqrt),"boolean"==typeof c.isLE&&(r=c.isLE),"boolean"==typeof c.modFromBytes&&(s=c.modFromBytes),a=c.allowedLengths}else"number"==typeof t&&(i=t),n.sqrt&&(o=n.sqrt);var u,f=Di(e,i),l=f.nBitLength,p=f.nByteLength;if(p>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");var h=Object.freeze({ORDER:e,isLE:r,BITS:l,BYTES:p,MASK:vi(l),ZERO:bi,ONE:mi,allowedLengths:a,create:function(t){return Pi(t,e)},isValid:function(t){if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return bi<=t&&t<e},is0:function(e){return e===bi},isValidNot0:function(e){return!h.is0(e)&&h.isValid(e)},isOdd:function(e){return(e&mi)===mi},neg:function(t){return Pi(-t,e)},eql:function(e,t){return e===t},sqr:function(t){return Pi(t*t,e)},add:function(t,r){return Pi(t+r,e)},sub:function(t,r){return Pi(t-r,e)},mul:function(t,r){return Pi(t*r,e)},pow:function(e,t){return function(e,t,r){if(r<bi)throw new Error("invalid exponent, negatives unsupported");if(r===bi)return e.ONE;if(r===mi)return t;for(var n=e.ONE,i=t;r>bi;)r&mi&&(n=e.mul(n,i)),i=e.sqr(i),r>>=mi;return n}(h,e,t)},div:function(t,r){return Pi(t*Ri(r,e),e)},sqrN:function(e){return e*e},addN:function(e,t){return e+t},subN:function(e,t){return e-t},mulN:function(e,t){return e*t},inv:function(t){return Ri(t,e)},sqrt:o||function(t){return u||(u=function(e){return e%ki===xi?Bi:e%Si===Ei?Ci:e%_i===Oi?function(e){var t=Mi(e),r=Ui(e),n=r(t,t.neg(t.ONE)),i=r(t,n),o=r(t,t.neg(n)),a=(e+Ii)/_i;return function(e,t){var r=e.pow(t,a),s=e.mul(r,n),c=e.mul(r,i),u=e.mul(r,o),f=e.eql(e.sqr(s),t),l=e.eql(e.sqr(c),t);r=e.cmov(r,s,f),s=e.cmov(u,c,l);var p=e.eql(e.sqr(s),t),h=e.cmov(r,s,p);return Ti(e,h,t),h}}(e):Ui(e)}(e)),u(h,t)},toBytes:function(e){return r?fi(e,p):ui(e,p)},fromBytes:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(a){if(!a.includes(t.length)||t.length>p)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+t.length);var i=new Uint8Array(p);i.set(t,r?0:i.length-t.length),t=i}if(t.length!==p)throw new Error("Field.fromBytes: expected "+p+" bytes, got "+t.length);var o=r?ci(t):si(t);if(s&&(o=Pi(o,e)),!n&&!h.isValid(o))throw new Error("invalid field element: outside of range 0..ORDER");return o},invertBatch:function(e){return ji(h,e)},cmov:function(e,t,r){return r?t:e}});return Object.freeze(h)}function qi(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");var t=e.toString(2).length;return Math.ceil(t/8)}function zi(e){var t=qi(e);return t+Math.ceil(t/2)}var Zi=BigInt(0),Fi=BigInt(1);function Ki(e,t){var r=t.negate();return e?r:t}function Vi(e,t){var r=ji(e.Fp,t.map(function(e){return e.Z}));return t.map(function(t,n){return e.fromAffine(t.toAffine(r[n]))})}function Hi(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Wi(e,t){Hi(e,t);var r=Math.pow(2,e);return{windows:Math.ceil(t/e)+1,windowSize:Math.pow(2,e-1),mask:vi(e),maxNumber:r,shiftBy:BigInt(e)}}function Gi(e,t,r){var n=r.windowSize,i=r.mask,o=r.maxNumber,a=r.shiftBy,s=Number(e&i),c=e>>a;s>n&&(s-=o,c+=Fi);var u=t*n;return{nextN:c,offset:u+Math.abs(s)-1,isZero:0===s,isNeg:s<0,isNegF:t%2!=0,offsetF:u}}var Ji=new WeakMap,Yi=new WeakMap;function Qi(e){return Yi.get(e)||1}function Xi(e){if(e!==Zi)throw new Error("invalid wNAF")}var $i=function(){function e(t,r){k(this,e),this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=r}return x(e,[{key:"_unsafeLadder",value:function(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.ZERO,n=e;t>Zi;)t&Fi&&(r=r.add(n)),n=n.double(),t>>=Fi;return r}},{key:"precomputeWindow",value:function(e,t){for(var r=Wi(t,this.bits),n=r.windows,i=r.windowSize,o=[],a=e,s=a,c=0;c<n;c++){s=a,o.push(s);for(var u=1;u<i;u++)s=s.add(a),o.push(s);a=s.double()}return o}},{key:"wNAF",value:function(e,t,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");for(var n=this.ZERO,i=this.BASE,o=Wi(e,this.bits),a=0;a<o.windows;a++){var s=Gi(r,a,o),c=s.nextN,u=s.offset,f=s.isZero,l=s.isNeg,p=s.isNegF,h=s.offsetF;r=c,f?i=i.add(Ki(p,t[h])):n=n.add(Ki(l,t[u]))}return Xi(r),{p:n,f:i}}},{key:"wNAFUnsafe",value:function(e,t,r){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.ZERO,i=Wi(e,this.bits),o=0;o<i.windows&&r!==Zi;o++){var a=Gi(r,o,i),s=a.nextN,c=a.offset,u=a.isZero,f=a.isNeg;if(r=s,!u){var l=t[c];n=n.add(f?l.negate():l)}}return Xi(r),n}},{key:"getPrecomputes",value:function(e,t,r){var n=Ji.get(t);return n||(n=this.precomputeWindow(t,e),1!==e&&("function"==typeof r&&(n=r(n)),Ji.set(t,n))),n}},{key:"cached",value:function(e,t,r){var n=Qi(e);return this.wNAF(n,this.getPrecomputes(n,e,r),t)}},{key:"unsafe",value:function(e,t,r,n){var i=Qi(e);return 1===i?this._unsafeLadder(e,t,n):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),t,n)}},{key:"createCache",value:function(e,t){Hi(t,this.bits),Yi.set(e,t),Ji.delete(e)}},{key:"hasCache",value:function(e){return 1!==Qi(e)}}]),e}();function eo(e,t,r){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return function(e){gi(e,Ni.reduce(function(e,t){return e[t]="function",e},{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"}))}(t),t}return Mi(e,{isLE:r})}BigInt(0),BigInt(1),BigInt(2),BigInt(8),Tt("HashToScalar-");var to=BigInt(0),ro=BigInt(1),no=BigInt(2),io=BigInt(1),oo=BigInt(2),ao=BigInt(3),so=BigInt(5),co=(BigInt(8),BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"));function uo(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}var fo=Mi([co,BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")][0],{isLE:!0}),lo=function(){var e=fo.ORDER;return function(e){var t=function(e){return gi(e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze(a({},e))}(e),r=t.P,n=t.type,i=t.adjustScalarBytes,o=t.powPminus2,s=t.randomBytes,c="x25519"===n;if(!c&&"x448"!==n)throw new Error("invalid type");var u=s||jt,f=c?255:448,l=c?32:56,p=BigInt(c?9:5),h=BigInt(c?121665:39081),d=c?Math.pow(no,BigInt(254)):Math.pow(no,BigInt(447)),v=c?BigInt(8)*Math.pow(no,BigInt(251))-ro:BigInt(4)*Math.pow(no,BigInt(445))-ro,g=d+v+ro,y=function(e){return Pi(e,r)},b=m(p);function m(e){return fi(y(e),l)}function w(e,t){var n=function(e,t){var n,i;hi("u",e,to,r),hi("scalar",t,d,g);for(var a=t,s=e,c=ro,u=to,l=e,p=ro,v=to,b=BigInt(f-1);b>=to;b--){var m,w,x=a>>b&ro;c=(m=k(v^=x,c,l)).x_2,l=m.x_3,u=(w=k(v,u,p)).x_2,p=w.x_3,v=x;var E=c+u,I=y(E*E),S=c-u,O=y(S*S),_=I-O,P=l+p,A=y((l-p)*E),R=y(P*S),T=A+R,B=A-R;l=y(T*T),p=y(s*y(B*B)),c=y(I*O),u=y(_*(I+y(h*_)))}c=(n=k(v,c,l)).x_2,l=n.x_3,u=(i=k(v,u,p)).x_2,p=i.x_3;var C=o(u);return y(c*C)}(function(e){var t=li("u coordinate",e,l);return c&&(t[31]&=127),y(ci(t))}(t),function(e){return ci(i(li("scalar",e,l)))}(e));if(n===to)throw new Error("invalid private or public key received");return m(n)}function x(e){return w(e,b)}function k(e,t,r){var n=y(e*(t-r));return{x_2:t=y(t-n),x_3:r=y(r+n)}}var E={secretKey:l,publicKey:l,seed:l},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u(l);return dt(e,E.seed),e};return{keygen:function(e){var t=I(e);return{secretKey:t,publicKey:x(t)}},getSharedSecret:function(e,t){return w(e,t)},getPublicKey:function(e){return x(e)},scalarMult:w,scalarMultBase:x,utils:{randomSecretKey:I,randomPrivateKey:I},GuBytes:b.slice(),lengths:E}}({P:e,type:"x25519",powPminus2:function(t){var r=function(e){var t=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),o=co,a=e*e%o*e%o,s=Ai(a,oo,o)*a%o,c=Ai(s,io,o)*e%o,u=Ai(c,so,o)*c%o,f=Ai(u,t,o)*u%o,l=Ai(f,r,o)*f%o,p=Ai(l,n,o)*l%o,h=Ai(p,i,o)*p%o,d=Ai(h,i,o)*p%o,v=Ai(d,t,o)*u%o;return{pow_p_5_8:Ai(v,oo,o)*e%o,b2:a}}(t),n=r.pow_p_5_8,i=r.b2;return Pi(Ai(n,ao,e)*i,e)},adjustScalarBytes:uo})}(),po=function(e,t){return(e+(e>=0?t:-t)/wo)/t};function ho(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}function vo(e,t){for(var r={},n=0,i=Object.keys(t);n<i.length;n++){var o=i[n];r[o]=void 0===e[o]?t[o]:e[o]}return ni(r.lowS,"lowS"),ni(r.prehash,"prehash"),void 0!==r.format&&ho(r.format),r}var go=function(e){h(r,e);var t=v(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return k(this,r),t.call(this,e)}return x(r)}(r(Error)),yo={Err:go,_tlv:{encode:function(e,t){var r=yo.Err;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");var n=t.length/2,i=oi(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");var o=n>127?oi(i.length/2|128):"";return oi(e)+o+i+t},decode:function(e,t){var r=yo.Err,n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");var i=t[n++],o=0;if(128&i){var a=127&i;if(!a)throw new r("tlv.decode(long): indefinite length not supported");if(a>4)throw new r("tlv.decode(long): byte length is too big");var s=t.subarray(n,n+a);if(s.length!==a)throw new r("tlv.decode: length bytes not complete");if(0===s[0])throw new r("tlv.decode(long): zero leftmost byte");var c,f=u(s);try{for(f.s();!(c=f.n()).done;){o=o<<8|c.value}}catch(p){f.e(p)}finally{f.f()}if(n+=a,o<128)throw new r("tlv.decode(long): not minimal encoding")}else o=i;var l=t.subarray(n,n+o);if(l.length!==o)throw new r("tlv.decode: wrong value length");return{v:l,l:t.subarray(n+o)}}},_int:{encode:function(e){var t=yo.Err;if(e<bo)throw new t("integer: negative integers are not allowed");var r=oi(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode:function(e){var t=yo.Err;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return si(e)}},toSig:function(e){var t=yo.Err,r=yo._int,n=yo._tlv,i=li("signature",e),o=n.decode(48,i),a=o.v;if(o.l.length)throw new t("invalid signature: left bytes after parsing");var s=n.decode(2,a),c=s.v,u=s.l,f=n.decode(2,u),l=f.v;if(f.l.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(c),s:r.decode(l)}},hexFromSig:function(e){var t=yo._tlv,r=yo._int,n=t.encode(2,r.encode(e.r)),i=t.encode(2,r.encode(e.s));return t.encode(48,n+i)}},bo=BigInt(0),mo=BigInt(1),wo=BigInt(2),xo=BigInt(3),ko=BigInt(4);function Eo(e,t){var r,n=e.BYTES;if("bigint"==typeof t)r=t;else{var i=li("private key",t);try{r=e.fromBytes(i)}catch(o){throw new Error("invalid private key: expected ui8a of size ".concat(n,", got ").concat(typeof t))}}if(!e.isValidNot0(r))throw new Error("invalid private key: out of range [1..N-1]");return r}function Io(e){return Uint8Array.of(e?2:3)}function So(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function Oo(e){var t=function(e){var t=function(e){var t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r=e.Fp,n=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(function(e){return Math.ceil(e/2)}))):void 0;return{CURVE:t,curveOpts:{Fp:r,Fn:Mi(t.n,{BITS:e.nBitLength,allowedLengths:n,modFromBytes:e.wrapPrivateKey}),allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes}}}(e);return{CURVE:t.CURVE,curveOpts:t.curveOpts,hash:e.hash,ecdsaOpts:{hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN}}}(e),r=t.CURVE,n=t.curveOpts,o=t.hash,a=t.ecdsaOpts;return function(e,t){var r=t.Point;return Object.assign({},t,{ProjectivePoint:r,CURVE:Object.assign({},e,Di(r.Fn.ORDER,r.Fn.BITS))})}(e,function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};vt(t),gi(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});var n=r.randomBytes||jt,i=r.hmac||function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return Qn(t,e,Ct.apply(void 0,n))},o=e.Fp,a=e.Fn,s=a.ORDER,c=a.BITS,u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.Fn,n=t.randomBytes||jt,i=Object.assign(So(e.Fp,r),{seed:zi(r.ORDER)});function o(e){try{return!!Eo(r,e)}catch(t){return!1}}function a(){return function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e.length,i=qi(t),o=zi(t);if(n<16||n<o||n>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+n);var a=Pi(r?ci(e):si(e),t-mi)+mi;return r?fi(a,i):ui(a,i)}(ii(arguments.length>0&&void 0!==arguments[0]?arguments[0]:n(i.seed),i.seed,"seed"),r.ORDER)}function s(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.BASE.multiply(Eo(r,t)).toBytes(n)}function c(t){if("bigint"==typeof t)return!1;if(t instanceof e)return!0;var n=i.secretKey,o=i.publicKey,a=i.publicKeyUncompressed;if(!r.allowedLengths&&n!==o){var s=li("key",t).length;return s===o||s===a}}return Object.freeze({getPublicKey:s,getSharedSecret:function(t,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!0===c(t))throw new Error("first arg must be private key");if(!1===c(n))throw new Error("second arg must be public key");var o=Eo(r,t);return e.fromHex(n).multiply(o).toBytes(i)},keygen:function(e){var t=a(e);return{secretKey:t,publicKey:s(t)}},Point:e,utils:{isValidSecretKey:o,isValidPublicKey:function(t,r){var n=i.publicKey,o=i.publicKeyUncompressed;try{var a=t.length;return!(!0===r&&a!==n||!1===r&&a!==o||!e.fromBytes(t))}catch(s){return!1}},randomSecretKey:a,isValidPrivateKey:o,randomPrivateKey:a,normPrivateKeyToScalar:function(e){return Eo(r,e)},precompute:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.BASE).precompute(t,!1)}},lengths:i})}(e,r),f=u.keygen,l=u.getPublicKey,p=u.getSharedSecret,h=u.utils,d=u.lengths,v={prehash:!1,lowS:"boolean"==typeof r.lowS&&r.lowS,format:void 0,extraEntropy:!1},g="compact";function y(e){return e>s>>mo}function b(e,t){if(!a.isValidNot0(t))throw new Error("invalid signature ".concat(e,": out of range 1..Point.Fn.ORDER"));return t}var m=function(){function t(e,r,n){k(this,t),this.r=b("r",e),this.s=b("s",r),null!=n&&(this.recovery=n),Object.freeze(this)}return x(t,[{key:"addRecoveryBit",value:function(e){return new t(this.r,this.s,e)}},{key:"recoverPublicKey",value:function(t){var r=o.ORDER,n=this.r,i=this.s,c=this.recovery;if(null==c||![0,1,2,3].includes(c))throw new Error("recovery id invalid");if(s*wo<r&&c>1)throw new Error("recovery id is ambiguous for h>1 curve");var u=2===c||3===c?n+s:n;if(!o.isValid(u))throw new Error("recovery id 2 or 3 invalid");var f=o.toBytes(u),l=e.fromBytes(Ct(Io(0==(1&c)),f)),p=a.inv(u),h=E(li("msgHash",t)),d=a.create(-h*p),v=a.create(i*p),g=e.BASE.multiplyUnsafe(d).add(l.multiplyUnsafe(v));if(g.is0())throw new Error("point at infinify");return g.assertValidity(),g}},{key:"hasHighS",value:function(){return y(this.s)}},{key:"toBytes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g;if(ho(e),"der"===e)return Rt(yo.hexFromSig(this));var t=a.toBytes(this.r),r=a.toBytes(this.s);if("recovered"===e){if(null==this.recovery)throw new Error("recovery bit must be present");return Ct(Uint8Array.of(this.recovery),t,r)}return Ct(t,r)}},{key:"toHex",value:function(e){return Pt(this.toBytes(e))}},{key:"assertValidity",value:function(){}},{key:"normalizeS",value:function(){return this.hasHighS()?new t(this.r,a.neg(this.s),this.recovery):this}},{key:"toDERRawBytes",value:function(){return this.toBytes("der")}},{key:"toDERHex",value:function(){return Pt(this.toBytes("der"))}},{key:"toCompactRawBytes",value:function(){return this.toBytes("compact")}},{key:"toCompactHex",value:function(){return Pt(this.toBytes("compact"))}}],[{key:"fromBytes",value:function(e){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g;if(function(e,t){ho(t);var r=d.signature;ii(e,"compact"===t?r:"recovered"===t?r+1:void 0,"".concat(t," signature"))}(e,n),"der"===n){var i=yo.toSig(ii(e));return new t(i.r,i.s)}"recovered"===n&&(r=e[0],n="compact",e=e.subarray(1));var o=a.BYTES,s=e.subarray(0,o),c=e.subarray(o,2*o);return new t(a.fromBytes(s),a.fromBytes(c),r)}},{key:"fromHex",value:function(e,t){return this.fromBytes(Rt(e),t)}},{key:"fromCompact",value:function(e){return t.fromBytes(li("sig",e),"compact")}},{key:"fromDER",value:function(e){return t.fromBytes(li("sig",e),"der")}}]),t}(),w=r.bits2int||function(e){if(e.length>8192)throw new Error("input is too large");var t=si(e),r=8*e.length-c;return r>0?t>>BigInt(r):t},E=r.bits2int_modN||function(e){return a.create(w(e))},I=vi(c);function S(e){return hi("num < 2^"+c,e,bo,I),a.toBytes(e)}function O(e,r){return ii(e,void 0,"message"),r?ii(t(e),void 0,"prehashed message"):e}return Object.freeze({keygen:f,getPublicKey:l,getSharedSecret:p,utils:h,lengths:d,Point:e,sign:function(r,o){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=function(t,r,i){if(["recovered","canonical"].some(function(e){return e in i}))throw new Error("sign() legacy options not supported");var o=vo(i,v),s=o.lowS,c=o.prehash,u=o.extraEntropy;t=O(t,c);var f=E(t),l=Eo(a,r),p=[S(l),S(f)];if(null!=u&&!1!==u){var h=!0===u?n(d.secretKey):u;p.push(li("extraEntropy",h))}var g=Ct.apply(void 0,p),b=f;return{seed:g,k2sig:function(t){var r=w(t);if(a.isValidNot0(r)){var n=a.inv(r),i=e.BASE.multiply(r).toAffine(),o=a.create(i.x);if(o!==bo){var c=a.create(n*a.create(b+o*l));if(c!==bo){var u=(i.x===o?0:2)|Number(i.y&mo),f=c;return s&&y(c)&&(f=a.neg(c),u^=1),new m(o,f,u)}}}}}}(r=li("message",r),o,s),u=c.seed,f=c.k2sig;return function(e,t,r){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof r)throw new Error("hmacFn must be a function");var n=function(e){return new Uint8Array(e)},i=function(e){return Uint8Array.of(e)},o=n(e),a=n(e),s=0,c=function(){o.fill(1),a.fill(0),s=0},u=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.apply(void 0,[a,o].concat(t))},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n(0);a=u(i(0),e),o=u(),0!==e.length&&(a=u(i(1),e),o=u())},l=function(){if(s++>=1e3)throw new Error("drbg: tried 1000 values");for(var e=0,r=[];e<t;){var n=(o=u()).slice();r.push(n),e+=o.length}return Ct.apply(void 0,r)};return function(e,t){var r;for(c(),f(e);!(r=t(l()));)f();return c(),r}}(t.outputLen,a.BYTES,i)(u,f)},verify:function(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=vo(i,v),s=o.lowS,c=o.prehash,u=o.format;if(n=li("publicKey",n),r=O(li("message",r),c),"strict"in i)throw new Error("options.strict was renamed to lowS");var f=void 0===u?function(e){var t,r="string"==typeof e||pt(e),n=!r&&null!==e&&"object"==typeof e&&"bigint"==typeof e.r&&"bigint"==typeof e.s;if(!r&&!n)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(n)t=new m(e.r,e.s);else if(r){try{t=m.fromBytes(li("sig",e),"der")}catch(s){if(!(s instanceof yo.Err))throw s}if(!t)try{t=m.fromBytes(li("sig",e),"compact")}catch(i){return!1}}return t||!1}(t):m.fromBytes(li("sig",t),u);if(!1===f)return!1;try{var l=e.fromBytes(n);if(s&&f.hasHighS())return!1;var p=f.r,h=f.s,d=E(r),g=a.inv(h),y=a.create(d*g),b=a.create(p*g),w=e.BASE.multiplyUnsafe(y).add(l.multiplyUnsafe(b));return!w.is0()&&a.create(w.x)===p}catch(x){return!1}},recoverPublicKey:function(e,t){return t=O(t,vo(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},v).prehash),m.fromBytes(e,"recovered").recoverPublicKey(t).toBytes()},Signature:m,hash:t})}(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0;if(void 0===n&&(n="edwards"===e),!t||"object"!=typeof t)throw new Error("expected valid ".concat(e," CURVE object"));for(var i=0,o=["p","n","h"];i<o.length;i++){var a=o[i],s=t[a];if(!("bigint"==typeof s&&s>Zi))throw new Error("CURVE.".concat(a," must be positive bigint"))}for(var c=eo(t.p,r.Fp,n),u=eo(t.n,r.Fn,n),f=0,l=["Gx","Gy","a","weierstrass"===e?"b":"d"];f<l.length;f++){var p=l[f];if(!c.isValid(t[p]))throw new Error("CURVE.".concat(p," must be valid field element of CURVE.Fp"))}return{CURVE:t=Object.freeze(Object.assign({},t)),Fp:c,Fn:u}}("weierstrass",e,t),n=r.Fp,o=r.Fn,a=r.CURVE,s=a.h,c=a.n;gi(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});var u=t.endo;if(u&&(!n.is0(a.a)||"bigint"!=typeof u.beta||!Array.isArray(u.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');var f=So(n,o);function l(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}var p=t.toBytes||function(e,t,r){var i=t.toAffine(),o=i.x,a=i.y,s=n.toBytes(o);return ni(r,"isCompressed"),r?(l(),Ct(Io(!n.isOdd(a)),s)):Ct(Uint8Array.of(4),s,n.toBytes(a))},h=t.fromBytes||function(e){ii(e,void 0,"Point");var t=f.publicKey,r=f.publicKeyUncompressed,i=e.length,o=e[0],a=e.subarray(1);if(i!==t||2!==o&&3!==o){if(i===r&&4===o){var s=n.BYTES,c=n.fromBytes(a.subarray(0,s)),u=n.fromBytes(a.subarray(s,2*s));if(!v(c,u))throw new Error("bad point: is not on curve");return{x:c,y:u}}throw new Error("bad point: got length ".concat(i,", expected compressed=").concat(t," or uncompressed=").concat(r))}var p=n.fromBytes(a);if(!n.isValid(p))throw new Error("bad point: is not on curve, wrong x");var h,g=d(p);try{h=n.sqrt(g)}catch(b){var y=b instanceof Error?": "+b.message:"";throw new Error("bad point: is not on curve, sqrt error"+y)}return l(),1==(1&o)!==n.isOdd(h)&&(h=n.neg(h)),{x:p,y:h}};function d(e){var t=n.sqr(e),r=n.mul(t,e);return n.add(n.add(r,n.mul(e,a.a)),a.b)}function v(e,t){var r=n.sqr(t),i=d(e);return n.eql(r,i)}if(!v(a.Gx,a.Gy))throw new Error("bad curve params: generator point");var g=n.mul(n.pow(a.a,xo),ko),y=n.mul(n.sqr(a.b),BigInt(27));if(n.is0(n.add(g,y)))throw new Error("bad curve params: a or b");function b(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!n.isValid(t)||r&&n.is0(t))throw new Error("bad point coordinate ".concat(e));return t}function m(e){if(!(e instanceof O))throw new Error("ProjectivePoint expected")}function w(e){if(!u||!u.basises)throw new Error("no endo");return function(e,t,r){var n=i(t,2),o=i(n[0],2),a=o[0],s=o[1],c=i(n[1],2),u=c[0],f=c[1],l=po(f*e,r),p=po(-s*e,r),h=e-l*a-p*u,d=-l*s-p*f,v=h<bo,g=d<bo;v&&(h=-h),g&&(d=-d);var y=vi(Math.ceil(di(r)/2))+mo;if(h<bo||h>=y||d<bo||d>=y)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:v,k1:h,k2neg:g,k2:d}}(e,u.basises,o.ORDER)}var E=yi(function(e,t){var r=e.X,i=e.Y,o=e.Z;if(n.eql(o,n.ONE))return{x:r,y:i};var a=e.is0();null==t&&(t=a?n.ONE:n.inv(o));var s=n.mul(r,t),c=n.mul(i,t),u=n.mul(o,t);if(a)return{x:n.ZERO,y:n.ZERO};if(!n.eql(u,n.ONE))throw new Error("invZ was invalid");return{x:s,y:c}}),I=yi(function(e){if(e.is0()){if(t.allowInfinityPoint&&!n.is0(e.Y))return;throw new Error("bad point: ZERO")}var r=e.toAffine(),i=r.x,o=r.y;if(!n.isValid(i)||!n.isValid(o))throw new Error("bad point: x or y not field elements");if(!v(i,o))throw new Error("bad point: equation left != right");if(!e.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function S(e,t,r,i,o){return r=new O(n.mul(r.X,e),r.Y,r.Z),t=Ki(i,t),r=Ki(o,r),t.add(r)}var O=function(){function e(t,r,n){k(this,e),this.X=b("x",t),this.Y=b("y",r,!0),this.Z=b("z",n),Object.freeze(this)}return x(e,[{key:"x",get:function(){return this.toAffine().x}},{key:"y",get:function(){return this.toAffine().y}},{key:"precompute",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return P.createCache(this,e),t||this.multiply(xo),this}},{key:"assertValidity",value:function(){I(this)}},{key:"hasEvenY",value:function(){var e=this.toAffine().y;if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(e)}},{key:"equals",value:function(e){m(e);var t=this.X,r=this.Y,i=this.Z,o=e.X,a=e.Y,s=e.Z,c=n.eql(n.mul(t,s),n.mul(o,i)),u=n.eql(n.mul(r,s),n.mul(a,i));return c&&u}},{key:"negate",value:function(){return new e(this.X,n.neg(this.Y),this.Z)}},{key:"double",value:function(){var t=a.a,r=a.b,i=n.mul(r,xo),o=this.X,s=this.Y,c=this.Z,u=n.ZERO,f=n.ZERO,l=n.ZERO,p=n.mul(o,o),h=n.mul(s,s),d=n.mul(c,c),v=n.mul(o,s);return v=n.add(v,v),l=n.mul(o,c),l=n.add(l,l),u=n.mul(t,l),f=n.mul(i,d),f=n.add(u,f),u=n.sub(h,f),f=n.add(h,f),f=n.mul(u,f),u=n.mul(v,u),l=n.mul(i,l),d=n.mul(t,d),v=n.sub(p,d),v=n.mul(t,v),v=n.add(v,l),l=n.add(p,p),p=n.add(l,p),p=n.add(p,d),p=n.mul(p,v),f=n.add(f,p),d=n.mul(s,c),d=n.add(d,d),p=n.mul(d,v),u=n.sub(u,p),l=n.mul(d,h),l=n.add(l,l),new e(u,f,l=n.add(l,l))}},{key:"add",value:function(t){m(t);var r=this.X,i=this.Y,o=this.Z,s=t.X,c=t.Y,u=t.Z,f=n.ZERO,l=n.ZERO,p=n.ZERO,h=a.a,d=n.mul(a.b,xo),v=n.mul(r,s),g=n.mul(i,c),y=n.mul(o,u),b=n.add(r,i),w=n.add(s,c);b=n.mul(b,w),w=n.add(v,g),b=n.sub(b,w),w=n.add(r,o);var x=n.add(s,u);return w=n.mul(w,x),x=n.add(v,y),w=n.sub(w,x),x=n.add(i,o),f=n.add(c,u),x=n.mul(x,f),f=n.add(g,y),x=n.sub(x,f),p=n.mul(h,w),f=n.mul(d,y),p=n.add(f,p),f=n.sub(g,p),p=n.add(g,p),l=n.mul(f,p),g=n.add(v,v),g=n.add(g,v),y=n.mul(h,y),w=n.mul(d,w),g=n.add(g,y),y=n.sub(v,y),y=n.mul(h,y),w=n.add(w,y),v=n.mul(g,w),l=n.add(l,v),v=n.mul(x,w),f=n.mul(b,f),f=n.sub(f,v),v=n.mul(b,g),p=n.mul(x,p),new e(f,l,p=n.add(p,v))}},{key:"subtract",value:function(e){return this.add(e.negate())}},{key:"is0",value:function(){return this.equals(e.ZERO)}},{key:"multiply",value:function(r){var n,i,a=this,s=t.endo;if(!o.isValidNot0(r))throw new Error("invalid scalar: out of range");var c=function(t){return P.cached(a,t,function(t){return Vi(e,t)})};if(s){var u=w(r),f=u.k1neg,l=u.k1,p=u.k2neg,h=u.k2,d=c(l),v=d.p,g=d.f,y=c(h),b=y.p,m=y.f;i=g.add(m),n=S(s.beta,v,b,f,p)}else{var x=c(r);n=x.p,i=x.f}return Vi(e,[n,i])[0]}},{key:"multiplyUnsafe",value:function(r){var n=t.endo,i=this;if(!o.isValid(r))throw new Error("invalid scalar: out of range");if(r===bo||i.is0())return e.ZERO;if(r===mo)return i;if(P.hasCache(this))return this.multiply(r);if(n){var a=w(r),s=a.k1neg,c=a.k1,u=a.k2neg,f=function(e,t,r,n){for(var i=t,o=e.ZERO,a=e.ZERO;r>Zi||n>Zi;)r&Fi&&(o=o.add(i)),n&Fi&&(a=a.add(i)),i=i.double(),r>>=Fi,n>>=Fi;return{p1:o,p2:a}}(e,i,c,a.k2),l=f.p1,p=f.p2;return S(n.beta,l,p,s,u)}return P.unsafe(i,r)}},{key:"multiplyAndAddUnsafe",value:function(e,t,r){var n=this.multiplyUnsafe(t).add(e.multiplyUnsafe(r));return n.is0()?void 0:n}},{key:"toAffine",value:function(e){return E(this,e)}},{key:"isTorsionFree",value:function(){var r=t.isTorsionFree;return s===mo||(r?r(e,this):P.unsafe(this,c).is0())}},{key:"clearCofactor",value:function(){var r=t.clearCofactor;return s===mo?this:r?r(e,this):this.multiplyUnsafe(s)}},{key:"isSmallOrder",value:function(){return this.multiplyUnsafe(s).is0()}},{key:"toBytes",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return ni(t,"isCompressed"),this.assertValidity(),p(e,this,t)}},{key:"toHex",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return Pt(this.toBytes(e))}},{key:"toString",value:function(){return"<Point ".concat(this.is0()?"ZERO":this.toHex(),">")}},{key:"px",get:function(){return this.X}},{key:"py",get:function(){return this.X}},{key:"pz",get:function(){return this.Z}},{key:"toRawBytes",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.toBytes(e)}},{key:"_setWindowSize",value:function(e){this.precompute(e)}}],[{key:"CURVE",value:function(){return a}},{key:"fromAffine",value:function(t){var r=t||{},i=r.x,o=r.y;if(!t||!n.isValid(i)||!n.isValid(o))throw new Error("invalid affine point");if(t instanceof e)throw new Error("projective point not allowed");return n.is0(i)&&n.is0(o)?e.ZERO:new e(i,o,n.ONE)}},{key:"fromBytes",value:function(t){var r=e.fromAffine(h(ii(t,void 0,"point")));return r.assertValidity(),r}},{key:"fromHex",value:function(t){return e.fromBytes(li("pointHex",t))}},{key:"normalizeZ",value:function(t){return Vi(e,t)}},{key:"msm",value:function(t,r){return function(e,t,r,n){(function(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach(function(e,r){if(!(e instanceof t))throw new Error("invalid point at index "+r)})})(r,e),function(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach(function(e,r){if(!t.isValid(e))throw new Error("invalid scalar at index "+r)})}(n,t);var i=r.length,o=n.length;if(i!==o)throw new Error("arrays of points and scalars must have equal length");var a=e.ZERO,s=di(BigInt(i)),c=1;s>12?c=s-3:s>4?c=s-2:s>0&&(c=2);for(var u=vi(c),f=new Array(Number(u)+1).fill(a),l=a,p=Math.floor((t.BITS-1)/c)*c;p>=0;p-=c){f.fill(a);for(var h=0;h<o;h++){var d=Number(n[h]>>BigInt(p)&u);f[d]=f[d].add(r[h])}for(var v=a,g=f.length-1,y=a;g>0;g--)y=y.add(f[g]),v=v.add(y);if(l=l.add(v),0!==p)for(var b=0;b<c;b++)l=l.double()}return l}(e,o,t,r)}},{key:"fromPrivateKey",value:function(t){return e.BASE.multiply(Eo(o,t))}}]),e}();O.BASE=new O(a.Gx,a.Gy,n.ONE),O.ZERO=new O(n.ZERO,n.ONE,n.ZERO),O.Fp=n,O.Fn=o;var _=o.BITS,P=new $i(O,t.endo?Math.ceil(_/2):_);return O.BASE.precompute(8),O}(r,n),o,a))}function _o(e,t){var r=function(t){return Oo(a(a({},e),{},{hash:t}))};return a(a({},r(t)),{},{create:r})}var Po={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},Ao={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},Ro={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},To=Mi(Po.p),Bo=Mi(Ao.p),Co=Mi(Ro.p),Uo=_o(a(a({},Po),{},{Fp:To,lowS:!1}),Sr);_o(a(a({},Ao),{},{Fp:Bo,lowS:!1}),_r),_o(a(a({},Ro),{},{Fp:Co,lowS:!1,allowedPrivateKeyLengths:[130,131,132]}),Or);var No=Uo,jo="base16",Lo="base64pad",Do="base64url",Mo="utf8";function qo(){var e=jt(32);return(0,re.BB)(e,jo)}function zo(e){var t=ei((0,re.mL)(e,jo));return(0,re.BB)(t,jo)}function Zo(e){var t=ei((0,re.mL)(e,Mo));return(0,re.BB)(t,jo)}function Fo(e){return(0,re.mL)("".concat(e),"base10")}function Ko(e){return Number((0,re.BB)(e,"base10"))}function Vo(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function Ho(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");return t+"=".repeat((4-t.length%4)%4)}function Wo(e){if(2===Ko(e.type))return(0,re.BB)((0,re.zo)([e.type,e.sealed]),Lo);if(1===Ko(e.type)){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return(0,re.BB)((0,re.zo)([e.type,e.senderPublicKey,e.iv,e.sealed]),Lo)}return(0,re.BB)((0,re.zo)([e.type,e.iv,e.sealed]),Lo)}function Go(e){var t=(e.encoding||Lo)===Do?Ho(e.encoded):e.encoded,r=(0,re.mL)(t,Lo),n=r.slice(0,1);if(1===Ko(n)){var i=r.slice(1,33),o=r.slice(33,45);return{type:n,sealed:r.slice(45),iv:o,senderPublicKey:i}}if(2===Ko(n))return{type:n,sealed:r.slice(1),iv:jt(12)};var a=r.slice(1,13);return{type:n,sealed:r.slice(13),iv:a}}function Jo(e){var t=(null==e?void 0:e.type)||0;if(1===t){if(typeof(null==e?void 0:e.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(null==e?void 0:e.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:null==e?void 0:e.senderPublicKey,receiverPublicKey:null==e?void 0:e.receiverPublicKey}}function Yo(e){return 1===e.type&&"string"==typeof e.senderPublicKey&&"string"==typeof e.receiverPublicKey}function Qo(e){return 2===e.type}function Xo(e){return(null==e?void 0:e.relay)||{protocol:"irn"}}function $o(e){var t=ne.iO[e];if(typeof t>"u")throw new Error("Relay Protocol not supported: ".concat(e));return t}var ea=Object.defineProperty,ta=Object.defineProperties,ra=Object.getOwnPropertyDescriptors,na=Object.getOwnPropertySymbols,ia=Object.prototype.hasOwnProperty,oa=Object.prototype.propertyIsEnumerable,aa=function(e,t,r){return t in e?ea(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},sa=function(e,t){for(var r in t||(t={}))ia.call(t,r)&&aa(e,r,t[r]);if(na){var n,i=u(na(t));try{for(i.s();!(n=i.n()).done;){r=n.value;oa.call(t,r)&&aa(e,r,t[r])}}catch(o){i.e(o)}finally{i.f()}}return e};function ca(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",r={},n="relay"+t;return Object.keys(e).forEach(function(t){if(t.startsWith(n)){var i=t.replace(n,"");r[i]=e[t]}}),r}function ua(e){if(!e.includes("wc:")){var t=Ke(e);null!=t&&t.includes("wc:")&&(e=t)}var r=(e=(e=e.includes("wc://")?e.replace("wc://",""):e).includes("wc:")?e.replace("wc:",""):e).indexOf(":"),n=-1!==e.indexOf("?")?e.indexOf("?"):void 0,i=e.substring(0,r),o=e.substring(r+1,n).split("@"),a=typeof n<"u"?e.substring(n):"",s=new URLSearchParams(a),c=Object.fromEntries(s.entries()),u="string"==typeof c.methods?c.methods.split(","):void 0;return{protocol:i,topic:fa(o[0]),version:parseInt(o[1],10),symKey:c.symKey,relay:ca(c),methods:u,expiryTimestamp:c.expiryTimestamp?parseInt(c.expiryTimestamp,10):void 0}}function fa(e){return e.startsWith("//")?e.substring(2):e}function la(e){var t=new URLSearchParams,r=sa(sa(function(e,t){return ta(e,ra(t))}(sa({},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",r={};return Object.keys(e).forEach(function(n){e[n]&&(r["relay"+t+n]=e[n])}),r}(e.relay)),{symKey:e.symKey}),e.expiryTimestamp&&{expiryTimestamp:e.expiryTimestamp.toString()}),e.methods&&{methods:e.methods.join(",")});return Object.entries(r).sort(function(e,t){var r=i(e,1)[0],n=i(t,1)[0];return r.localeCompare(n)}).forEach(function(e){var r=i(e,2),n=r[0],o=r[1];void 0!==o&&t.append(n,String(o))}),"".concat(e.protocol,":").concat(e.topic,"@").concat(e.version,"?").concat(t)}function pa(e,t,r){return"".concat(e,"?wc_ev=").concat(r,"&topic=").concat(t)}var ha=Object.defineProperty,da=Object.defineProperties,va=Object.getOwnPropertyDescriptors,ga=Object.getOwnPropertySymbols,ya=Object.prototype.hasOwnProperty,ba=Object.prototype.propertyIsEnumerable,ma=function(e,t,r){return t in e?ha(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},wa=function(e,t){for(var r in t||(t={}))ya.call(t,r)&&ma(e,r,t[r]);if(ga){var n,i=u(ga(t));try{for(i.s();!(n=i.n()).done;){r=n.value;ba.call(t,r)&&ma(e,r,t[r])}}catch(o){i.e(o)}finally{i.f()}}return e},xa=function(e,t){return da(e,va(t))};function ka(e){var t=[];return e.forEach(function(e){var r=i(e.split(":"),2),n=r[0],o=r[1];t.push("".concat(n,":").concat(o))}),t}function Ea(e){var t=[];return Object.values(e).forEach(function(e){t.push.apply(t,s(ka(e.accounts)))}),s(new Set(t))}function Ia(e){return e.includes(":")}function Sa(e){return Ia(e)?e.split(":")[0]:e}function Oa(e){var t,r,n,o={};if(!Ca(e))return o;for(var a=0,s=Object.entries(e);a<s.length;a++){var c=i(s[a],2),u=c[0],f=c[1],l=Ia(u)?[u]:f.chains,p=f.methods||[],h=f.events||[],d=Sa(u);o[d]=xa(wa({},o[d]),{chains:je(l,null==(t=o[d])?void 0:t.chains),methods:je(p,null==(r=o[d])?void 0:r.methods),events:je(h,null==(n=o[d])?void 0:n.events)})}return o}function _a(e,t){for(var r=function(e){var t={};return null!=e&&e.forEach(function(e){var r,n=i(e.split(":"),2),o=n[0],a=n[1];t[o]||(t[o]={accounts:[],chains:[],events:[],methods:[]}),t[o].accounts.push(e),null==(r=t[o].chains)||r.push("".concat(o,":").concat(a))}),t}(t=t.map(function(e){return e.replace("did:pkh:","")})),n=0,o=Object.entries(r);n<o.length;n++){var a=i(o[n],2),s=(a[0],a[1]);s.methods=s.methods?je(s.methods,e):e,s.events=["chainChanged","accountsChanged"]}return r}var Pa={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Aa={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Ra(e,t){var r=Aa[e],n=r.message,i=r.code;return{message:t?"".concat(n," ").concat(t):n,code:i}}function Ta(e,t){var r=Pa[e],n=r.message,i=r.code;return{message:t?"".concat(n," ").concat(t):n,code:i}}function Ba(e,t){return!!Array.isArray(e)&&(!(typeof t<"u"&&e.length)||e.every(t))}function Ca(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function Ua(e){return typeof e>"u"}function Na(e,t){return!(!t||!Ua(e))||"string"==typeof e&&!!e.trim().length}function ja(e,t){return!(!t||!Ua(e))||"number"==typeof e&&!isNaN(e)}function La(e){return!(!Na(e,!1)||!e.includes(":"))&&2===e.split(":").length}function Da(e){var t=!0;return Ba(e)?e.length&&(t=e.every(function(e){return Na(e,!1)})):t=!1,t}function Ma(e,t){var r=null;return Object.values(e).forEach(function(e){if(!r){var n=function(e,t){var r=null;return Da(null==e?void 0:e.methods)?Da(null==e?void 0:e.events)||(r=Ta("UNSUPPORTED_EVENTS","".concat(t,", events should be an array of strings or empty array for no events"))):r=Ta("UNSUPPORTED_METHODS","".concat(t,", methods should be an array of strings or empty array for no methods")),r}(e,"".concat(t,", namespace"));n&&(r=n)}}),r}function qa(e,t){var r=null;if(e&&Ca(e)){var n=Ma(e,t);n&&(r=n);var i=function(e,t){var r=null;return Object.values(e).forEach(function(e){if(!r){var n=function(e,t){var r=null;return Ba(e)?e.forEach(function(e){r||function(e){if(Na(e,!1)&&e.includes(":")){var t=e.split(":");if(3===t.length){var r=t[0]+":"+t[1];return!!t[2]&&La(r)}}return!1}(e)||(r=Ta("UNSUPPORTED_ACCOUNTS","".concat(t,", account ").concat(e,' should be a string and conform to "namespace:chainId:address" format')))}):r=Ta("UNSUPPORTED_ACCOUNTS","".concat(t,', accounts should be an array of strings conforming to "namespace:chainId:address" format')),r}(null==e?void 0:e.accounts,"".concat(t," namespace"));n&&(r=n)}}),r}(e,t);i&&(r=i)}else r=Ra("MISSING_OR_INVALID","".concat(t,", namespaces should be an object with data"));return r}function za(e){return Na(e.protocol,!0)}function Za(e){return typeof e<"u"&&null!==typeof e}function Fa(e,t){return!(!La(t)||!Ea(e).includes(t))}function Ka(e,t,r){var n=null,i=function(e){var t={};return Object.keys(e).forEach(function(r){var n;r.includes(":")?t[r]=e[r]:null==(n=e[r].chains)||n.forEach(function(n){t[n]={methods:e[r].methods,events:e[r].events}})}),t}(e),o=function(e){var t={};return Object.keys(e).forEach(function(r){var n;r.includes(":")?t[r]=e[r]:null===(n=ka(e[r].accounts))||void 0===n||n.forEach(function(n){t[n]={accounts:e[r].accounts.filter(function(e){return e.includes("".concat(n,":"))}),methods:e[r].methods,events:e[r].events}})}),t}(t),a=Object.keys(i),s=Object.keys(o),c=Va(Object.keys(e)),u=Va(Object.keys(t)),f=c.filter(function(e){return!u.includes(e)});return f.length&&(n=Ra("NON_CONFORMING_NAMESPACES","".concat(r," namespaces keys don't satisfy requiredNamespaces.\n      Required: ").concat(f.toString(),"\n      Received: ").concat(Object.keys(t).toString()))),Oe(a,s)||(n=Ra("NON_CONFORMING_NAMESPACES","".concat(r," namespaces chains don't satisfy required namespaces.\n      Required: ").concat(a.toString(),"\n      Approved: ").concat(s.toString()))),Object.keys(t).forEach(function(e){if(e.includes(":")&&!n){var i=ka(t[e].accounts);i.includes(e)||(n=Ra("NON_CONFORMING_NAMESPACES","".concat(r," namespaces accounts don't satisfy namespace accounts for ").concat(e,"\n        Required: ").concat(e,"\n        Approved: ").concat(i.toString())))}}),a.forEach(function(e){n||(Oe(i[e].methods,o[e].methods)?Oe(i[e].events,o[e].events)||(n=Ra("NON_CONFORMING_NAMESPACES","".concat(r," namespaces events don't satisfy namespace events for ").concat(e))):n=Ra("NON_CONFORMING_NAMESPACES","".concat(r," namespaces methods don't satisfy namespace methods for ").concat(e)))}),n}function Va(e){return s(new Set(e.map(function(e){return e.includes(":")?e.split(":")[0]:e})))}function Ha(){var e=ke();return new Promise(function(t){var r;switch(e){case"browser":t(xe()&&(null===(r=navigator)||void 0===r?void 0:r.onLine));break;case"react-native":t(function(){return Wa.apply(this,arguments)}());break;default:t(!0)}})}function Wa(){return(Wa=(0,o.Z)(p().mark(function e(){var t;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!(we()&&typeof global<"u"&&null!=global&&global.NetInfo),e.t0){e.next=14;break}return e.next=4,null==global?void 0:global.NetInfo.fetch();case 4:if(e.t2=t=e.sent,e.t1=null===e.t2,e.t1){e.next=8;break}e.t1=void 0===t;case 8:if(!e.t1){e.next=12;break}e.t3=void 0,e.next=13;break;case 12:e.t3=t.isConnected;case 13:e.t0=e.t3;case 14:return e.abrupt("return",e.t0);case 15:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Ga={},Ja=function(){function e(){k(this,e)}return x(e,null,[{key:"get",value:function(e){return Ga[e]}},{key:"set",value:function(e,t){Ga[e]=t}},{key:"delete",value:function(e){delete Ga[e]}}]),e}();function Ya(e){return new Uint8Array(e.replace(/^0x/,"").match(/.{1,2}/g).map(function(e){return parseInt(e,16)}))}function Qa(e){var t=Uint8Array.from(Buffer.from(e.signature,"hex")),r=function(e){var t=ee.Jq.decode(e);if(t.length<33)throw new Error("Too short to contain a public key");return t.slice(1,33)}(e.transaction.address),n=function(e){var t,r=e.publicKey,n=e.signature,i=e.payload,o=Ya(i.method),a=128|parseInt((null==(t=i.version)?void 0:t.toString())||"4"),c=function(e){var t=ee.Jq.decode(e)[0];return 42===t?0:60===t?2:1}(i.address),u="00"===i.era?new Uint8Array([0]):Ya(i.era);if(1!==u.length&&2!==u.length)throw new Error("Invalid era length");var f=parseInt(i.nonce,16),l=new Uint8Array([255&f,f>>8&255]),p=BigInt("0x".concat(function(e){return e.startsWith("0x")?e.slice(2):e}(i.tip))),h=function(e){if(e<BigInt(1)<<BigInt(6))return new Uint8Array([Number(e<<BigInt(2))]);if(e<BigInt(1)<<BigInt(14)){var t=e<<BigInt(2)|BigInt(1);return new Uint8Array([Number(t&BigInt(255)),Number(t>>BigInt(8)&BigInt(255))])}if(e<BigInt(1)<<BigInt(30)){var r=e<<BigInt(2)|BigInt(2);return new Uint8Array([Number(r&BigInt(255)),Number(r>>BigInt(8)&BigInt(255)),Number(r>>BigInt(16)&BigInt(255)),Number(r>>BigInt(24)&BigInt(255))])}throw new Error("BigInt compact encoding not supported > 2^30")}(p),d=new Uint8Array([0].concat(s(r),[c],s(n),s(u),s(l),s(h),s(o))),v=function(e){if(e<64)return new Uint8Array([e<<2]);if(e<16384){var t=e<<2|1;return new Uint8Array([255&t,t>>8&255])}if(e<1<<30){var r=e<<2|2;return new Uint8Array([255&r,r>>8&255,r>>16&255,r>>24&255])}throw new Error("Compact encoding > 2^30 not supported")}(d.length+1);return new Uint8Array([].concat(s(v),[a],s(d)))}({publicKey:r,signature:t,payload:e.transaction});return function(e){var t=Ya(e),r=(0,ie.blake2b)(t,void 0,32);return"0x"+Buffer.from(r).toString("hex")}(Buffer.from(n).toString("hex"))}function Xa(e){var t=e.logger,r=e.name,n="string"==typeof t?(0,oe.Rt)({opts:{level:t,name:r}}).logger:t;return n.level="string"==typeof t?t:t.level,n}var $a=n(59093),es=n(39927),ts=n(52399),rs=Object.defineProperty,ns=function(e,t,r){return function(e,t,r){return t in e?rs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r}(e,"symbol"!=typeof t?t+"":t,r)},is=function(e){h(r,e);var t=v(r);function r(e){var n;return k(this,r),(n=t.call(this)).opts=e,ns(y(n),"protocol","wc"),ns(y(n),"version",2),n}return x(r)}(ts.q),os=Object.defineProperty,as=function(e){h(r,e);var t=v(r);function r(e,n){var i;return k(this,r),(i=t.call(this)).core=e,i.logger=n,function(e,t,r){!function(e,t,r){t in e?os(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r}(e,t+"",new Map)}(y(i),"records"),i}return x(r)}(ts.q),ss=function(e){h(r,e);var t=v(r);function r(e,n){var i;return k(this,r),(i=t.call(this)).relayer=e,i.logger=n,i}return x(r)}(ts.q),cs=function(e){h(r,e);var t=v(r);function r(e){return k(this,r),t.call(this)}return x(r)}(ts.q),us=function(e){h(r,e);var t=v(r);function r(e,n){var i;return k(this,r),(i=t.call(this)).relayer=e,i.logger=n,i}return x(r)}(ts.q),fs=function(e){h(r,e);var t=v(r);function r(e,n){var i;return k(this,r),(i=t.call(this)).core=e,i.logger=n,i}return x(r)}(ts.q),ls=Object.defineProperty,ps=function(e,t,r){return function(e,t,r){return t in e?ls(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r}(e,"symbol"!=typeof t?t+"":t,r)},hs=n(80328),ds=n(2517),vs=n(22339),gs=n(70213),ys="wc@2:core:",bs={database:":memory:"},ms="client_ed25519_seed",ws=d.ONE_DAY,xs=d.SIX_HOURS,ks="wss://relay.walletconnect.org",Es="relayer_publish",Is="2.23.6",Ss="link_mode",Os="relay",_s="WALLETCONNECT_LINK_MODE_APPS",Ps="subscription_created",As="subscription_deleted",Rs={wc_pairingDelete:{req:{ttl:d.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:d.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:d.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:d.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:d.ONE_DAY,prompt:!1,tag:0},res:{ttl:d.ONE_DAY,prompt:!1,tag:0}}},Ts="expirer_expired",Bs="https://verify.walletconnect.org",Cs=Bs,Us="".concat(Cs,"/v3"),Ns=["https://verify.walletconnect.com",Bs],js=function(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},Ls=function(){function e(t,r,n){k(this,e),this.name=t,this.prefix=r,this.baseEncode=n}return x(e,[{key:"encode",value:function(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}]),e}(),Ds=function(){function e(t,r,n){if(k(this,e),this.name=t,this.prefix=r,void 0===r.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}return x(e,[{key:"decode",value:function(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}},{key:"or",value:function(e){return qs(this,e)}}]),e}(),Ms=function(){function e(t){k(this,e),this.decoders=t}return x(e,[{key:"or",value:function(e){return qs(this,e)}},{key:"decode",value:function(e){var t=this.decoders[e[0]];if(t)return t.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}]),e}(),qs=function(e,t){return new Ms(a(a({},e.decoders||c({},e.prefix,e)),t.decoders||c({},t.prefix,t)))},zs=function(){function e(t,r,n,i){k(this,e),this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Ls(t,r,n),this.decoder=new Ds(t,r,i)}return x(e,[{key:"encode",value:function(e){return this.encoder.encode(e)}},{key:"decode",value:function(e){return this.decoder.decode(e)}}]),e}(),Zs=function(e){var t=e.name,r=e.prefix,n=e.encode,i=e.decode;return new zs(t,r,n,i)},Fs=function(e){var t=e.prefix,r=e.name,n=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),a=o.charCodeAt(0);if(255!==r[a])throw new TypeError(o+" is ambiguous");r[a]=i}var s=e.length,c=e.charAt(0),u=Math.log(s)/Math.log(256),f=Math.log(256)/Math.log(s);function l(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var o=(e.length-t)*u+1>>>0,a=new Uint8Array(o);e[t];){var f=r[e.charCodeAt(t)];if(255===f)return;for(var l=0,p=o-1;(0!==f||l<i)&&-1!==p;p--,l++)a[p]=(f+=s*a[p]>>>0)%256>>>0,f=f/256>>>0;if(0!==f)throw new Error("Non-zero carry");i=l,t++}if(" "!==e[t]){for(var h=o-i;h!==o&&0===a[h];)h++;for(var d=new Uint8Array(n+(o-h)),v=n;h!==o;)d[v++]=a[h++];return d}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var a=(o-i)*f+1>>>0,u=new Uint8Array(a);i!==o;){for(var l=t[i],p=0,h=a-1;(0!==l||p<n)&&-1!==h;h--,p++)u[h]=(l+=256*u[h]>>>0)%s>>>0,l=l/s>>>0;if(0!==l)throw new Error("Non-zero carry");n=p,i++}for(var d=a-n;d!==a&&0===u[d];)d++;for(var v=c.repeat(r);d<a;++d)v+=e.charAt(u[d]);return v},decodeUnsafe:l,decode:function(e){var r=l(e);if(r)return r;throw new Error("Non-".concat(t," character"))}}}(e.alphabet,r),i=n.encode,o=n.decode;return Zs({prefix:t,name:r,encode:i,decode:function(e){return js(o(e))}})},Ks=function(e){var t=e.name,r=e.prefix,n=e.bitsPerChar,i=e.alphabet;return Zs({prefix:r,name:t,encode:function(e){return function(e,t,r){for(var n="="===t[t.length-1],i=(1<<r)-1,o="",a=0,s=0,c=0;c<e.length;++c)for(s=s<<8|e[c],a+=8;a>r;)o+=t[i&s>>(a-=r)];if(a&&(o+=t[i&s<<r-a]),n)for(;o.length*r&7;)o+="=";return o}(e,i,n)},decode:function(e){return function(e,t,r,n){for(var i={},o=0;o<t.length;++o)i[t[o]]=o;for(var a=e.length;"="===e[a-1];)--a;for(var s=new Uint8Array(a*r/8|0),c=0,u=0,f=0,l=0;l<a;++l){var p=i[e[l]];if(void 0===p)throw new SyntaxError("Non-".concat(n," character"));u=u<<r|p,(c+=r)>=8&&(c-=8,s[f++]=255&u>>c)}if(c>=r||255&u<<8-c)throw new SyntaxError("Unexpected end of data");return s}(e,i,n,t)}})},Vs=Zs({prefix:"\0",name:"identity",encode:function(e){return function(e){return(new TextDecoder).decode(e)}(e)},decode:function(e){return function(e){return(new TextEncoder).encode(e)}(e)}}),Hs=Object.freeze({__proto__:null,identity:Vs}),Ws=Ks({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Gs=Object.freeze({__proto__:null,base2:Ws}),Js=Ks({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Ys=Object.freeze({__proto__:null,base8:Js}),Qs=Fs({prefix:"9",name:"base10",alphabet:"0123456789"}),Xs=Object.freeze({__proto__:null,base10:Qs}),$s=Ks({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),ec=Ks({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),tc=Object.freeze({__proto__:null,base16:$s,base16upper:ec}),rc=Ks({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),nc=Ks({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ic=Ks({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),oc=Ks({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ac=Ks({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),sc=Ks({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),cc=Ks({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),uc=Ks({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),fc=Ks({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),lc=Object.freeze({__proto__:null,base32:rc,base32upper:nc,base32pad:ic,base32padupper:oc,base32hex:ac,base32hexupper:sc,base32hexpad:cc,base32hexpadupper:uc,base32z:fc}),pc=Fs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),hc=Fs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),dc=Object.freeze({__proto__:null,base36:pc,base36upper:hc}),vc=Fs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),gc=Fs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),yc=Object.freeze({__proto__:null,base58btc:vc,base58flickr:gc}),bc=Ks({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),mc=Ks({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),wc=Ks({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),xc=Ks({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),kc=Object.freeze({__proto__:null,base64:bc,base64pad:mc,base64url:wc,base64urlpad:xc}),Ec=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),Ic=Ec.reduce(function(e,t,r){return e[r]=t,e},[]),Sc=Ec.reduce(function(e,t,r){return e[t.codePointAt(0)]=r,e},[]),Oc=Zs({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(function(e,t){return e+Ic[t]},"")},decode:function(e){var t,r=[],n=u(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,o=Sc[i.codePointAt(0)];if(void 0===o)throw new Error("Non-base256emoji character: ".concat(i));r.push(o)}}catch(a){n.e(a)}finally{n.f()}return new Uint8Array(r)}}),_c=Object.freeze({__proto__:null,base256emoji:Oc}),Pc=Math.pow(2,31),Ac=Math.pow(2,7),Rc=Math.pow(2,14),Tc=Math.pow(2,21),Bc=Math.pow(2,28),Cc=Math.pow(2,35),Uc=Math.pow(2,42),Nc=Math.pow(2,49),jc=Math.pow(2,56),Lc=Math.pow(2,63),Dc={encode:function e(t,r,n){r=r||[];for(var i=n=n||0;t>=Pc;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},decode:function e(t,r){var n,i=0,o=0,a=r=r||0,s=t.length;do{if(a>=s)throw e.bytes=0,new RangeError("Could not decode varint");n=t[a++],i+=o<28?(127&n)<<o:(127&n)*Math.pow(2,o),o+=7}while(n>=128);return e.bytes=a-r,i},encodingLength:function(e){return e<Ac?1:e<Rc?2:e<Tc?3:e<Bc?4:e<Cc?5:e<Uc?6:e<Nc?7:e<jc?8:e<Lc?9:10}},Mc=Dc,qc=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Mc.encode(e,t,r),t},zc=function(e){return Mc.encodingLength(e)},Zc=function(e,t){var r=t.byteLength,n=zc(e),i=n+zc(r),o=new Uint8Array(i+r);return qc(e,o,0),qc(r,o,n),o.set(t,i),new Fc(e,r,t,o)},Fc=x(function e(t,r,n,i){k(this,e),this.code=t,this.size=r,this.digest=n,this.bytes=i}),Kc=function(e){var t=e.name,r=e.code,n=e.encode;return new Vc(t,r,n)},Vc=function(){function e(t,r,n){k(this,e),this.name=t,this.code=r,this.encode=n}return x(e,[{key:"digest",value:function(e){var t=this;if(e instanceof Uint8Array){var r=this.encode(e);return r instanceof Uint8Array?Zc(this.code,r):r.then(function(e){return Zc(t.code,e)})}throw Error("Unknown type, must be binary type")}}]),e}(),Hc=function(e){return function(){var t=(0,o.Z)(p().mark(function t(r){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Uint8Array,t.next=3,crypto.subtle.digest(e,r);case 3:return t.t1=t.sent,t.abrupt("return",new t.t0(t.t1));case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},Wc=Kc({name:"sha2-256",code:18,encode:Hc("SHA-256")}),Gc=Kc({name:"sha2-512",code:19,encode:Hc("SHA-512")});Object.freeze({__proto__:null,sha256:Wc,sha512:Gc});var Jc=js;Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:Jc,digest:function(e){return Zc(0,Jc(e))}}}),new TextEncoder,new TextDecoder;var Yc=a(a(a(a(a(a(a(a(a(a({},Hs),Gs),Ys),Xs),tc),lc),dc),yc),kc),_c);function Qc(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Xc(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var $c=Xc("utf8","u",function(e){return"u"+new TextDecoder("utf8").decode(e)},function(e){return(new TextEncoder).encode(e.substring(1))}),eu=Xc("ascii","a",function(e){for(var t="a",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},function(e){for(var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?Qc(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}((e=e.substring(1)).length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),tu=a({utf8:$c,"utf-8":$c,hex:Yc.base16,latin1:eu,ascii:eu,binary:eu},Yc),ru=Object.defineProperty,nu=function(e,t,r){return function(e,t,r){return t in e?ru(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r}(e,"symbol"!=typeof t?t+"":t,r)},iu=function(){function e(t,r){var n=this;k(this,e);var i=this;this.core=t,this.logger=r,nu(this,"keychain",new Map),nu(this,"name","keychain"),nu(this,"version","0.3"),nu(this,"initialized",!1),nu(this,"storagePrefix",ys),nu(this,"init",(0,o.Z)(p().mark(function e(){var t;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.initialized){e.next=5;break}return e.next=3,i.getKeyChain();case 3:typeof(t=e.sent)<"u"&&(i.keychain=t),i.initialized=!0;case 5:case"end":return e.stop()}},e)}))),nu(this,"has",function(e){return n.isInitialized(),n.keychain.has(e)}),nu(this,"set",function(){var e=(0,o.Z)(p().mark(function e(t,r){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i.isInitialized(),i.keychain.set(t,r),e.next=4,i.persist();case 4:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()),nu(this,"get",function(e){n.isInitialized();var t=n.keychain.get(e);if(typeof t>"u"){var r=Ra("NO_MATCHING_KEY","".concat(n.name,": ").concat(e)).message;throw new Error(r)}return t}),nu(this,"del",function(){var e=(0,o.Z)(p().mark(function e(t){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i.isInitialized(),i.keychain.delete(t),e.next=4,i.persist();case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),this.core=t,this.logger=(0,oe.Ep)(r,this.name)}return x(e,[{key:"context",get:function(){return(0,oe.Fd)(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}},{key:"setKeyChain",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.core.storage.setItem(t.storageKey,_e(e));case 2:case"end":return r.stop()}},r)}))()}},{key:"getKeyChain",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){var r;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.core.storage.getItem(e.storageKey);case 2:return r=t.sent,t.abrupt("return",typeof r<"u"?Pe(r):void 0);case 4:case"end":return t.stop()}},t)}))()}},{key:"persist",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setKeyChain(e.keychain);case 2:case"end":return t.stop()}},t)}))()}},{key:"isInitialized",value:function(){if(!this.initialized){var e=Ra("NOT_INITIALIZED",this.name).message;throw new Error(e)}}}]),e}(),ou=Object.defineProperty,au=function(e,t,r){return function(e,t,r){return t in e?ou(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r}(e,"symbol"!=typeof t?t+"":t,r)},su=function(){function e(t,r,n){var i=this;k(this,e);var a=this;this.core=t,this.logger=r,au(this,"name","crypto"),au(this,"keychain"),au(this,"randomSessionIdentifier",qo()),au(this,"initialized",!1),au(this,"clientId"),au(this,"init",(0,o.Z)(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=a.initialized,e.t0){e.next=5;break}return e.next=4,a.keychain.init();case 4:a.initialized=!0;case 5:case"end":return e.stop()}},e)}))),au(this,"hasKeys",function(e){return i.isInitialized(),i.keychain.has(e)}),au(this,"getClientId",(0,o.Z)(p().mark(function e(){var t,r,n;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.isInitialized(),!a.clientId){e.next=2;break}return e.abrupt("return",a.clientId);case 2:return e.next=4,a.getClientSeed();case 4:return t=e.sent,r=te.Au(t),n=te.bG(r.publicKey),e.abrupt("return",(a.clientId=n,n));case 8:case"end":return e.stop()}},e)}))),au(this,"generateKeyPair",function(){i.isInitialized();var e=function(){var e=lo.utils.randomPrivateKey(),t=lo.getPublicKey(e);return{privateKey:(0,re.BB)(e,jo),publicKey:(0,re.BB)(t,jo)}}();return i.setPrivateKey(e.publicKey,e.privateKey)}),au(this,"signJWT",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.isInitialized(),e.next=3,a.getClientSeed();case 3:return r=e.sent,n=te.Au(r),i=a.randomSessionIdentifier,o=ws,e.next=9,te.vf(i,t,o,n);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),au(this,"generateSharedKey",function(e,t,r){i.isInitialized();var n=function(e,t){var r=lo.getSharedSecret((0,re.mL)(e,jo),(0,re.mL)(t,jo)),n=function(e,t,r,n,i){return function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32;vt(e),ht(n);var i=e.outputLen;if(n>255*i)throw new Error("Length should be <= 255*HashLen");var o=Math.ceil(n/i);void 0===r&&(r=$n);for(var a=new Uint8Array(o*i),s=Qn.create(e,t),c=s._cloneInto(),u=new Uint8Array(s.outputLen),f=0;f<o;f++)Xn[0]=f+1,c.update(0===f?$n:u).update(r).update(Xn).digestInto(u),a.set(u,i*f),s._cloneInto(c);return s.destroy(),c.destroy(),mt(u,Xn),a.slice(0,n)}(e,function(e,t,r){return vt(e),void 0===r&&(r=new Uint8Array(e.outputLen)),Qn(e,Bt(r),Bt(t))}(e,t,void 0),void 0,32)}(ei,r);return(0,re.BB)(n,jo)}(i.getPrivateKey(e),t);return i.setSymKey(n,r)}),au(this,"setSymKey",function(){var e=(0,o.Z)(p().mark(function e(t,r){var n;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.isInitialized(),n=r||zo(t),e.next=4,a.keychain.set(n,t);case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()),au(this,"deleteKeyPair",function(){var e=(0,o.Z)(p().mark(function e(t){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.isInitialized(),e.next=3,a.keychain.del(t);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),au(this,"deleteSymKey",function(){var e=(0,o.Z)(p().mark(function e(t){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.isInitialized(),e.next=3,a.keychain.del(t);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),au(this,"encode",function(){var e=(0,o.Z)(p().mark(function e(t,r,n){var i,o,s,c,u,f,l;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.isInitialized(),i=Jo(n),o=(0,hs.u)(r),!Qo(i)){e.next=4;break}return e.abrupt("return",function(e,t){var r=Fo(2),n=jt(12),i=Wo({type:r,sealed:(0,re.mL)(e,Mo),iv:n});return t===Do?Vo(i):i}(o,null==n?void 0:n.encoding));case 4:if(!Yo(i)){e.next=9;break}return s=i.senderPublicKey,c=i.receiverPublicKey,e.next=8,a.generateSharedKey(s,c);case 8:t=e.sent;case 9:return u=a.getSymKey(t),f=i.type,l=i.senderPublicKey,e.abrupt("return",function(e){var t=Fo(typeof e.type<"u"?e.type:0);if(1===Ko(t)&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");var r=typeof e.senderPublicKey<"u"?(0,re.mL)(e.senderPublicKey,jo):void 0,n=typeof e.iv<"u"?(0,re.mL)(e.iv,jo):jt(12),i=(0,re.mL)(e.symKey,jo),o=Wo({type:t,sealed:Jn(i,n).encrypt((0,re.mL)(e.message,Mo)),iv:n,senderPublicKey:r});return e.encoding===Do?Vo(o):o}({type:f,symKey:u,message:o,senderPublicKey:l,encoding:null==n?void 0:n.encoding}));case 11:case"end":return e.stop()}},e)}));return function(t,r,n){return e.apply(this,arguments)}}()),au(this,"decode",function(){var e=(0,o.Z)(p().mark(function e(t,r,n){var i,o,s,c,u;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.isInitialized(),i=function(e,t){var r=Go({encoded:e,encoding:null==t?void 0:t.encoding});return Jo({type:Ko(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?(0,re.BB)(r.senderPublicKey,jo):void 0,receiverPublicKey:null==t?void 0:t.receiverPublicKey})}(r,n),!Qo(i)){e.next=5;break}return o=function(e,t){var r=Go({encoded:e,encoding:t}).sealed;return(0,re.BB)(r,Mo)}(r,null==n?void 0:n.encoding),e.abrupt("return",(0,hs.D)(o));case 5:if(!Yo(i)){e.next=10;break}return s=i.receiverPublicKey,c=i.senderPublicKey,e.next=9,a.generateSharedKey(s,c);case 9:t=e.sent;case 10:return e.prev=10,u=function(e){var t=(0,re.mL)(e.symKey,jo),r=Go({encoded:e.encoded,encoding:e.encoding}),n=r.sealed,i=r.iv,o=Jn(t,i).decrypt(n);if(null===o)throw new Error("Failed to decrypt");return(0,re.BB)(o,Mo)}({symKey:a.getSymKey(t),encoded:r,encoding:null==n?void 0:n.encoding}),e.abrupt("return",(0,hs.D)(u));case 15:return e.prev=15,e.t0=e.catch(10),e.t1=a.logger,e.t2="Failed to decode message from topic: '".concat(t,"', clientId: '"),e.next=21,a.getClientId();case 21:e.t3=e.sent,e.t4=e.t2.concat.call(e.t2,e.t3,"'"),e.t1.error.call(e.t1,e.t4),a.logger.error(e.t0);case 25:case"end":return e.stop()}},e,null,[[10,15]])}));return function(t,r,n){return e.apply(this,arguments)}}()),au(this,"getPayloadType",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Lo;return Ko(Go({encoded:e,encoding:t}).type)}),au(this,"getPayloadSenderPublicKey",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Lo,r=Go({encoded:e,encoding:t});return r.senderPublicKey?(0,re.BB)(r.senderPublicKey,jo):void 0}),this.core=t,this.logger=(0,oe.Ep)(r,this.name),this.keychain=n||new iu(this.core,this.logger)}return x(e,[{key:"context",get:function(){return(0,oe.Fd)(this.logger)}},{key:"setPrivateKey",value:function(e,t){var r=this;return(0,o.Z)(p().mark(function n(){return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.keychain.set(e,t);case 2:return n.abrupt("return",e);case 3:case"end":return n.stop()}},n)}))()}},{key:"getPrivateKey",value:function(e){return this.keychain.get(e)}},{key:"getClientSeed",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){var r;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r="",t.prev=1,r=e.keychain.get(ms),t.next=10;break;case 5:return t.prev=5,t.t0=t.catch(1),r=qo(),t.next=10,e.keychain.set(ms,r);case 10:return t.abrupt("return",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",r=tu[t];if(!r)throw new Error('Unsupported encoding "'.concat(t,'"'));return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode("".concat(r.prefix).concat(e)):Qc(globalThis.Buffer.from(e,"utf-8"))}(r,"base16"));case 11:case"end":return t.stop()}},t,null,[[1,5]])}))()}},{key:"getSymKey",value:function(e){return this.keychain.get(e)}},{key:"isInitialized",value:function(){if(!this.initialized){var e=Ra("NOT_INITIALIZED",this.name).message;throw new Error(e)}}}]),e}(),cu=Object.defineProperty,uu=Object.defineProperties,fu=Object.getOwnPropertyDescriptors,lu=Object.getOwnPropertySymbols,pu=Object.prototype.hasOwnProperty,hu=Object.prototype.propertyIsEnumerable,du=function(e,t,r){return t in e?cu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},vu=function(e,t,r){return du(e,"symbol"!=typeof t?t+"":t,r)},gu=function(e){h(r,e);var t=v(r);function r(e,n){var i,a;return k(this,r),i=t.call(this,e,n),a=y(i),i.logger=e,i.core=n,vu(y(i),"messages",new Map),vu(y(i),"messagesWithoutClientAck",new Map),vu(y(i),"name","messages"),vu(y(i),"version","0.3"),vu(y(i),"initialized",!1),vu(y(i),"storagePrefix",ys),vu(y(i),"init",(0,o.Z)(p().mark(function e(){var t,r;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.initialized){e.next=19;break}return a.logger.trace("Initialized"),e.prev=2,e.next=5,a.getRelayerMessages();case 5:return typeof(t=e.sent)<"u"&&(a.messages=t),e.next=9,a.getRelayerMessagesWithoutClientAck();case 9:typeof(r=e.sent)<"u"&&(a.messagesWithoutClientAck=r),a.logger.debug("Successfully Restored records for ".concat(a.name)),a.logger.trace({type:"method",method:"restore",size:a.messages.size}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),a.logger.debug("Failed to Restore records for ".concat(a.name)),a.logger.error(e.t0);case 16:return e.prev=16,a.initialized=!0,e.finish(16);case 19:case"end":return e.stop()}},e,null,[[2,13,16,19]])}))),vu(y(i),"set",function(){var e=(0,o.Z)(p().mark(function e(t,r,n){var i,o,s;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.isInitialized(),i=Zo(r),typeof(o=a.messages.get(t))>"u"&&(o={}),!(typeof o[i]<"u")){e.next=5;break}return e.abrupt("return",i);case 5:return o[i]=r,a.messages.set(t,o),"inbound"===n&&(s=a.messagesWithoutClientAck.get(t)||{},a.messagesWithoutClientAck.set(t,function(e,t){return uu(e,fu(t))}(function(e,t){for(var r in t||(t={}))pu.call(t,r)&&du(e,r,t[r]);if(lu){var n,i=u(lu(t));try{for(i.s();!(n=i.n()).done;){r=n.value;hu.call(t,r)&&du(e,r,t[r])}}catch(o){i.e(o)}finally{i.f()}}return e}({},s),c({},i,r)))),e.next=8,a.persist();case 8:return e.abrupt("return",i);case 9:case"end":return e.stop()}},e)}));return function(t,r,n){return e.apply(this,arguments)}}()),vu(y(i),"get",function(e){i.isInitialized();var t=i.messages.get(e);return typeof t>"u"&&(t={}),t}),vu(y(i),"getWithoutAck",function(e){i.isInitialized();var t,r={},n=u(e);try{for(n.s();!(t=n.n()).done;){var o=t.value,a=i.messagesWithoutClientAck.get(o)||{};r[o]=Object.values(a)}}catch(s){n.e(s)}finally{n.f()}return r}),vu(y(i),"has",function(e,t){return i.isInitialized(),typeof i.get(e)[Zo(t)]<"u"}),vu(y(i),"ack",function(){var e=(0,o.Z)(p().mark(function e(t,r){var n;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.isInitialized(),n=a.messagesWithoutClientAck.get(t),e.t0=typeof n>"u",e.t0){e.next=8;break}return delete n[Zo(r)],0===Object.keys(n).length?a.messagesWithoutClientAck.delete(t):a.messagesWithoutClientAck.set(t,n),e.next=8,a.persist();case 8:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()),vu(y(i),"del",function(){var e=(0,o.Z)(p().mark(function e(t){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.isInitialized(),a.messages.delete(t),a.messagesWithoutClientAck.delete(t),e.next=5,a.persist();case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),i.logger=(0,oe.Ep)(e,i.name),i.core=n,i}return x(r,[{key:"context",get:function(){return(0,oe.Fd)(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}},{key:"storageKeyWithoutClientAck",get:function(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}},{key:"setRelayerMessages",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.core.storage.setItem(t.storageKey,_e(e));case 2:case"end":return r.stop()}},r)}))()}},{key:"setRelayerMessagesWithoutClientAck",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.core.storage.setItem(t.storageKeyWithoutClientAck,_e(e));case 2:case"end":return r.stop()}},r)}))()}},{key:"getRelayerMessages",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){var r;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.core.storage.getItem(e.storageKey);case 2:return r=t.sent,t.abrupt("return",typeof r<"u"?Pe(r):void 0);case 4:case"end":return t.stop()}},t)}))()}},{key:"getRelayerMessagesWithoutClientAck",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){var r;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.core.storage.getItem(e.storageKeyWithoutClientAck);case 2:return r=t.sent,t.abrupt("return",typeof r<"u"?Pe(r):void 0);case 4:case"end":return t.stop()}},t)}))()}},{key:"persist",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setRelayerMessages(e.messages);case 2:return t.next=4,e.setRelayerMessagesWithoutClientAck(e.messagesWithoutClientAck);case 4:case"end":return t.stop()}},t)}))()}},{key:"isInitialized",value:function(){if(!this.initialized){var e=Ra("NOT_INITIALIZED",this.name).message;throw new Error(e)}}}]),r}(function(){return x(function e(t,r){k(this,e),this.logger=t,this.core=r})}()),yu=Object.defineProperty,bu=Object.defineProperties,mu=Object.getOwnPropertyDescriptors,wu=Object.getOwnPropertySymbols,xu=Object.prototype.hasOwnProperty,ku=Object.prototype.propertyIsEnumerable,Eu=function(e,t,r){return t in e?yu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Iu=function(e,t){for(var r in t||(t={}))xu.call(t,r)&&Eu(e,r,t[r]);if(wu){var n,i=u(wu(t));try{for(i.s();!(n=i.n()).done;){r=n.value;ku.call(t,r)&&Eu(e,r,t[r])}}catch(o){i.e(o)}finally{i.f()}}return e},Su=function(e,t){return bu(e,mu(t))},Ou=function(e,t,r){return Eu(e,"symbol"!=typeof t?t+"":t,r)},_u=function(e){h(r,e);var t=v(r);function r(e,n){var i,a;return k(this,r),i=t.call(this,e,n),a=y(i),i.relayer=e,i.logger=n,Ou(y(i),"events",new f.EventEmitter),Ou(y(i),"name","publisher"),Ou(y(i),"queue",new Map),Ou(y(i),"publishTimeout",(0,d.toMiliseconds)(d.ONE_MINUTE)),Ou(y(i),"initialPublishTimeout",(0,d.toMiliseconds)(15*d.ONE_SECOND)),Ou(y(i),"needsTransportRestart",!1),Ou(y(i),"publish",function(){var e=(0,o.Z)(p().mark(function e(t,r,n){var i,s,c,u,f,l,h,d,v,g,y,b,m;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.logger.debug("Publishing Payload"),a.logger.trace({type:"method",method:"publish",params:{topic:t,message:r,opts:n}}),l=(null==n?void 0:n.ttl)||xs,h=(null==n?void 0:n.prompt)||!1,d=(null==n?void 0:n.tag)||0,v=(null==n?void 0:n.id)||(0,vs.getBigIntRpcId)().toString(),g=$o(Xo().protocol),y={id:v,method:(null==n?void 0:n.publishMethod)||g.publish,params:Iu({topic:t,message:r,ttl:l,prompt:h,tag:d,attestation:null==n?void 0:n.attestation},null==n?void 0:n.tvf)},b="Failed to publish payload, please try again. id:".concat(v," tag:").concat(d),e.prev=2,Ua(null==(i=y.params)?void 0:i.prompt)&&(null==(s=y.params)||delete s.prompt),Ua(null==(c=y.params)?void 0:c.tag)&&(null==(u=y.params)||delete u.tag),m=new Promise(function(){var e=(0,o.Z)(p().mark(function e(t){var r,i;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=function e(r){var n,i=r.id;(null==(n=y.id)?void 0:n.toString())===i.toString()&&(a.removeRequestFromQueue(i),a.relayer.events.removeListener(Es,e),t())},a.relayer.events.on(Es,r),i=Re(new Promise(function(e,t){a.rpcPublish(y,n).then(e).catch(function(e){a.logger.warn(e,null==e?void 0:e.message),t(e)})}),a.initialPublishTimeout,"Failed initial publish, retrying.... id:".concat(v," tag:").concat(d)),e.prev=3,e.next=6,i;case 6:a.events.removeListener(Es,r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),a.queue.set(v,{request:y,opts:n,attempt:1}),a.logger.warn(e.t0,null===e.t0||void 0===e.t0?void 0:e.t0.message);case 12:case"end":return e.stop()}},e,null,[[3,9]])}));return function(t){return e.apply(this,arguments)}}()),a.logger.trace({type:"method",method:"publish",params:{id:v,topic:t,message:r,opts:n}}),e.next=8,Re(m,a.publishTimeout,b);case 8:e.next=14;break;case 10:if(e.prev=10,e.t0=e.catch(2),a.logger.debug("Failed to Publish Payload"),a.logger.error(e.t0),null==(f=null==n?void 0:n.internal)||!f.throwOnFailedPublish){e.next=14;break}throw e.t0;case 14:return e.prev=14,a.queue.delete(v),e.finish(14);case 17:case"end":return e.stop()}},e,null,[[2,10,14,17]])}));return function(t,r,n){return e.apply(this,arguments)}}()),Ou(y(i),"publishCustom",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,s,c,u,f,l,h,v,g,y,b,m,w,x,k,E,I,S,O;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.logger.debug("Publishing custom payload"),a.logger.trace({type:"method",method:"publishCustom",params:t}),u=t.payload,f=t.opts,h=(l=void 0===f?{}:f).attestation,v=l.tvf,g=l.publishMethod,y=l.prompt,b=l.tag,m=l.ttl,w=void 0===m?d.FIVE_MINUTES:m,x=l.id||(0,vs.getBigIntRpcId)().toString(),k=$o(Xo().protocol),E=g||k.publish,I={id:x,method:E,params:Iu(Su(Iu({},u),{ttl:w,prompt:y,tag:b,attestation:h}),v)},S="Failed to publish custom payload, please try again. id:".concat(x," tag:").concat(b),e.prev=2,Ua(null==(r=I.params)?void 0:r.prompt)&&(null==(n=I.params)||delete n.prompt),Ua(null==(i=I.params)?void 0:i.tag)&&(null==(s=I.params)||delete s.tag),O=new Promise(function(){var e=(0,o.Z)(p().mark(function e(t){var r,n;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=function e(r){var n,i=r.id;(null==(n=I.id)?void 0:n.toString())===i.toString()&&(a.removeRequestFromQueue(i),a.relayer.events.removeListener(Es,e),t())},a.relayer.events.on(Es,r),n=Re(new Promise(function(e,t){a.rpcPublish(I,l).then(e).catch(function(e){a.logger.warn(e,null==e?void 0:e.message),t(e)})}),a.initialPublishTimeout,"Failed initial custom payload publish, retrying.... method:".concat(E," id:").concat(x," tag:").concat(b)),e.prev=3,e.next=6,n;case 6:a.events.removeListener(Es,r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),a.queue.set(x,{request:I,opts:l,attempt:1}),a.logger.warn(e.t0,null===e.t0||void 0===e.t0?void 0:e.t0.message);case 12:case"end":return e.stop()}},e,null,[[3,9]])}));return function(t){return e.apply(this,arguments)}}()),a.logger.trace({type:"method",method:"publish",params:{id:x,payload:u,opts:l}}),e.next=8,Re(O,a.publishTimeout,S);case 8:e.next=14;break;case 10:if(e.prev=10,e.t0=e.catch(2),a.logger.debug("Failed to Publish Payload"),a.logger.error(e.t0),null==(c=null==l?void 0:l.internal)||!c.throwOnFailedPublish){e.next=14;break}throw e.t0;case 14:return e.prev=14,a.queue.delete(x),e.finish(14);case 17:case"end":return e.stop()}},e,null,[[2,10,14,17]])}));return function(t){return e.apply(this,arguments)}}()),Ou(y(i),"on",function(e,t){i.events.on(e,t)}),Ou(y(i),"once",function(e,t){i.events.once(e,t)}),Ou(y(i),"off",function(e,t){i.events.off(e,t)}),Ou(y(i),"removeListener",function(e,t){i.events.removeListener(e,t)}),i.relayer=e,i.logger=(0,oe.Ep)(n,i.name),i.registerEventListeners(),i}return x(r,[{key:"context",get:function(){return(0,oe.Fd)(this.logger)}},{key:"rpcPublish",value:function(e,t){var r=this;return(0,o.Z)(p().mark(function n(){var i;return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r.logger.debug("Outgoing Relay Payload"),r.logger.trace({type:"message",direction:"outgoing",request:e}),n.next=3,r.relayer.request(e);case 3:return i=n.sent,n.abrupt("return",(r.relayer.events.emit(Es,Iu(Iu({},e),t)),r.logger.debug("Successfully Published Payload"),i));case 5:case"end":return n.stop()}},n)}))()}},{key:"removeRequestFromQueue",value:function(e){this.queue.delete(e)}},{key:"checkQueue",value:function(){var e=this;this.queue.forEach(function(){var t=(0,o.Z)(p().mark(function t(r,n){var i,o;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=r.attempt+1,e.queue.set(n,Su(Iu({},r),{attempt:o})),e.logger.warn({},"Publisher: queue->publishing: ".concat(r.request.id,", tag: ").concat(null==(i=r.request.params)?void 0:i.tag,", attempt: ").concat(o)),t.next=5,e.rpcPublish(r.request,r.opts);case 5:e.logger.warn({},"Publisher: queue->published: ".concat(r.request.id));case 6:case"end":return t.stop()}},t)}));return function(e,r){return t.apply(this,arguments)}}())}},{key:"registerEventListeners",value:function(){var e=this;this.relayer.core.heartbeat.on($a.Lx.pulse,function(){if(e.needsTransportRestart)return e.needsTransportRestart=!1,void e.relayer.events.emit("relayer_connection_stalled");e.checkQueue()}),this.relayer.on("relayer_message_ack",function(t){e.removeRequestFromQueue(t.id.toString())})}}]),r}(ss),Pu=Object.defineProperty,Au=function(e,t,r){return function(e,t,r){return t in e?Pu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r}(e,"symbol"!=typeof t?t+"":t,r)},Ru=function(){function e(){var t=this;k(this,e),Au(this,"map",new Map),Au(this,"set",function(e,r){var n=t.get(e);t.exists(e,r)||t.map.set(e,[].concat(s(n),[r]))}),Au(this,"get",function(e){return t.map.get(e)||[]}),Au(this,"exists",function(e,r){return t.get(e).includes(r)}),Au(this,"delete",function(e,r){if(typeof r>"u")t.map.delete(e);else if(t.map.has(e)){var n=t.get(e);if(t.exists(e,r)){var i=n.filter(function(e){return e!==r});i.length?t.map.set(e,i):t.map.delete(e)}}}),Au(this,"clear",function(){t.map.clear()})}return x(e,[{key:"topics",get:function(){return Array.from(this.map.keys())}}]),e}(),Tu=Object.defineProperty,Bu=Object.defineProperties,Cu=Object.getOwnPropertyDescriptors,Uu=Object.getOwnPropertySymbols,Nu=Object.prototype.hasOwnProperty,ju=Object.prototype.propertyIsEnumerable,Lu=function(e,t,r){return t in e?Tu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Du=function(e,t){for(var r in t||(t={}))Nu.call(t,r)&&Lu(e,r,t[r]);if(Uu){var n,i=u(Uu(t));try{for(i.s();!(n=i.n()).done;){r=n.value;ju.call(t,r)&&Lu(e,r,t[r])}}catch(o){i.e(o)}finally{i.f()}}return e},Mu=function(e,t){return Bu(e,Cu(t))},qu=function(e,t,r){return Lu(e,"symbol"!=typeof t?t+"":t,r)},zu=function(e){h(r,e);var t=v(r);function r(e,n){var i,a;return k(this,r),i=t.call(this,e,n),a=y(i),i.relayer=e,i.logger=n,qu(y(i),"subscriptions",new Map),qu(y(i),"topicMap",new Ru),qu(y(i),"events",new f.EventEmitter),qu(y(i),"name","subscription"),qu(y(i),"version","0.3"),qu(y(i),"pending",new Map),qu(y(i),"cached",[]),qu(y(i),"initialized",!1),qu(y(i),"storagePrefix",ys),qu(y(i),"subscribeTimeout",(0,d.toMiliseconds)(d.ONE_MINUTE)),qu(y(i),"initialSubscribeTimeout",(0,d.toMiliseconds)(15*d.ONE_SECOND)),qu(y(i),"clientId"),qu(y(i),"batchSubscribeTopicsLimit",500),qu(y(i),"init",(0,o.Z)(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=a.initialized,e.t0){e.next=6;break}return a.logger.trace("Initialized"),a.registerEventListeners(),e.next=6,a.restore();case 6:a.initialized=!0;case 7:case"end":return e.stop()}},e)}))),qu(y(i),"subscribe",function(){var e=(0,o.Z)(p().mark(function e(t,r){var n,i,o,s;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.isInitialized(),a.logger.debug("Subscribing Topic"),a.logger.trace({type:"method",method:"subscribe",params:{topic:t,opts:r}}),e.prev=1,i=Xo(r),o={topic:t,relay:i,transportType:null==r?void 0:r.transportType},null!=(n=null==r?void 0:r.internal)&&n.skipSubscribe||a.pending.set(t,o),e.next=6,a.rpcSubscribe(t,i,r);case 6:return s=e.sent,e.abrupt("return",("string"==typeof s&&(a.onSubscribe(s,o),a.logger.debug("Successfully Subscribed Topic"),a.logger.trace({type:"method",method:"subscribe",params:{topic:t,opts:r}})),s));case 10:throw e.prev=10,e.t0=e.catch(1),a.logger.debug("Failed to Subscribe Topic"),a.logger.error(e.t0),e.t0;case 13:case"end":return e.stop()}},e,null,[[1,10]])}));return function(t,r){return e.apply(this,arguments)}}()),qu(y(i),"unsubscribe",function(){var e=(0,o.Z)(p().mark(function e(t,r){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.isInitialized(),!(typeof(null==r?void 0:r.id)<"u")){e.next=6;break}return e.next=4,a.unsubscribeById(t,r.id,r);case 4:e.next=8;break;case 6:return e.next=8,a.unsubscribeByTopic(t,r);case 8:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()),qu(y(i),"isSubscribed",function(e){return new Promise(function(t){t(i.topicMap.topics.includes(e))})}),qu(y(i),"isKnownTopic",function(e){return new Promise(function(t){t(i.topicMap.topics.includes(e)||i.pending.has(e)||i.cached.some(function(t){return t.topic===e}))})}),qu(y(i),"on",function(e,t){i.events.on(e,t)}),qu(y(i),"once",function(e,t){i.events.once(e,t)}),qu(y(i),"off",function(e,t){i.events.off(e,t)}),qu(y(i),"removeListener",function(e,t){i.events.removeListener(e,t)}),qu(y(i),"start",(0,o.Z)(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.onConnect();case 2:case"end":return e.stop()}},e)}))),qu(y(i),"stop",(0,o.Z)(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.onDisconnect();case 2:case"end":return e.stop()}},e)}))),qu(y(i),"restart",(0,o.Z)(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.restore();case 2:return e.next=4,a.onRestart();case 4:case"end":return e.stop()}},e)}))),qu(y(i),"checkPending",(0,o.Z)(p().mark(function e(){var t;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==a.pending.size||a.initialized&&a.relayer.connected){e.next=2;break}return e.abrupt("return");case 2:return t=[],a.pending.forEach(function(e){t.push(e)}),e.next=6,a.batchSubscribe(t);case 6:case"end":return e.stop()}},e)}))),qu(y(i),"registerEventListeners",function(){i.relayer.core.heartbeat.on($a.Lx.pulse,(0,o.Z)(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.checkPending();case 2:case"end":return e.stop()}},e)}))),i.events.on(Ps,function(){var e=(0,o.Z)(p().mark(function e(t){var r;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Ps,a.logger.info("Emitting ".concat(r)),a.logger.debug({type:"event",event:r,data:t}),e.next=5,a.persist();case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),i.events.on(As,function(){var e=(0,o.Z)(p().mark(function e(t){var r;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=As,a.logger.info("Emitting ".concat(r)),a.logger.debug({type:"event",event:r,data:t}),e.next=5,a.persist();case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}),i.relayer=e,i.logger=(0,oe.Ep)(n,i.name),i.clientId="",i}return x(r,[{key:"context",get:function(){return(0,oe.Fd)(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}},{key:"length",get:function(){return this.subscriptions.size}},{key:"ids",get:function(){return Array.from(this.subscriptions.keys())}},{key:"values",get:function(){return Array.from(this.subscriptions.values())}},{key:"topics",get:function(){return this.topicMap.topics}},{key:"hasAnyTopics",get:function(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}},{key:"hasSubscription",value:function(e,t){var r=!1;try{r=this.getSubscription(e).topic===t}catch(n){}return r}},{key:"reset",value:function(){this.cached=[],this.initialized=!0}},{key:"onDisable",value:function(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}},{key:"unsubscribeByTopic",value:function(e,t){var r=this;return(0,o.Z)(p().mark(function n(){var i;return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i=r.topicMap.get(e),n.next=3,Promise.all(i.map(function(){var n=(0,o.Z)(p().mark(function n(i){return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.unsubscribeById(e,i,t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()));case 3:case"end":return n.stop()}},n)}))()}},{key:"unsubscribeById",value:function(e,t,r){var n=this;return(0,o.Z)(p().mark(function i(){var o,a;return p().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n.logger.debug("Unsubscribing Topic"),n.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}}),i.prev=1,o=Xo(r),i.next=5,n.restartToComplete({topic:e,id:t,relay:o});case 5:return i.next=7,n.rpcUnsubscribe(e,t,o);case 7:return a=Ta("USER_DISCONNECTED","".concat(n.name,", ").concat(e)),i.next=10,n.onUnsubscribe(e,t,a);case 10:n.logger.debug("Successfully Unsubscribed Topic"),n.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}}),i.next=17;break;case 14:throw i.prev=14,i.t0=i.catch(1),n.logger.debug("Failed to Unsubscribe Topic"),n.logger.error(i.t0),i.t0;case 17:case"end":return i.stop()}},i,null,[[1,14]])}))()}},{key:"rpcSubscribe",value:function(e,t,r){var n=this;return(0,o.Z)(p().mark(function i(){var a,s,c,u,f,l,h;return p().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,n.getSubscriptionId(e);case 2:if(c=i.sent,null==(a=null==r?void 0:r.internal)||!a.skipSubscribe){i.next=5;break}return i.abrupt("return",c);case 5:if(i.t0=!r||(null==r?void 0:r.transportType)===Os,!i.t0){i.next=9;break}return i.next=9,n.restartToComplete({topic:e,id:e,relay:t});case 9:if(u={method:$o(t.protocol).subscribe,params:{topic:e}},n.logger.debug("Outgoing Relay Payload"),n.logger.trace({type:"payload",direction:"outgoing",request:u}),f=null==(s=null==r?void 0:r.internal)?void 0:s.throwOnFailedPublish,i.prev=12,(null==r?void 0:r.transportType)!==Ss){i.next=15;break}return i.abrupt("return",(setTimeout(function(){(n.relayer.connected||n.relayer.connecting)&&n.relayer.request(u).catch(function(e){return n.logger.warn(e)})},(0,d.toMiliseconds)(d.ONE_SECOND)),c));case 15:return l=new Promise(function(){var t=(0,o.Z)(p().mark(function t(r){var i,o;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=function t(i){i.topic===e&&(n.events.removeListener(Ps,t),r(i.id))},n.events.on(Ps,i),t.prev=2,t.next=5,Re(new Promise(function(e,t){n.relayer.request(u).catch(function(e){n.logger.warn(e,null==e?void 0:e.message),t(e)}).then(e)}),n.initialSubscribeTimeout,"Subscribing to ".concat(e," failed, please try again"));case 5:o=t.sent,n.events.removeListener(Ps,i),r(o),t.next=11;break;case 9:t.prev=9,t.t0=t.catch(2);case 11:case"end":return t.stop()}},t,null,[[2,9]])}));return function(e){return t.apply(this,arguments)}}()),i.next=18,Re(l,n.subscribeTimeout,"Subscribing to ".concat(e," failed, please try again"));case 18:if((h=i.sent)||!f){i.next=21;break}throw new Error("Subscribing to ".concat(e," failed, please try again"));case 21:return i.abrupt("return",h?c:null);case 24:if(i.prev=24,i.t1=i.catch(12),n.logger.debug("Outgoing Relay Subscribe Payload stalled"),n.relayer.events.emit("relayer_connection_stalled"),!f){i.next=28;break}throw i.t1;case 28:return i.abrupt("return",null);case 29:case"end":return i.stop()}},i,null,[[12,24]])}))()}},{key:"rpcBatchSubscribe",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){var n;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e.length){r.next=2;break}return r.abrupt("return",!0);case 2:return n={method:$o(e[0].relay.protocol).batchSubscribe,params:{topics:e.map(function(e){return e.topic})}},t.logger.debug("Outgoing Relay Payload"),t.logger.trace({type:"payload",direction:"outgoing",request:n}),r.prev=4,r.next=7,Re(new Promise(function(e,r){t.relayer.request(n).then(e).catch(function(e){t.logger.warn(e),r(e)})}),t.subscribeTimeout,"rpcBatchSubscribe failed, please try again");case 7:return r.abrupt("return",!0);case 10:return r.prev=10,r.t0=r.catch(4),r.abrupt("return",(t.relayer.events.emit("relayer_connection_stalled"),!1));case 13:case"end":return r.stop()}},r,null,[[4,10]])}))()}},{key:"rpcBatchFetchMessages",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){var n,i;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e.length){r.next=2;break}return r.abrupt("return");case 2:return n={method:$o(e[0].relay.protocol).batchFetchMessages,params:{topics:e.map(function(e){return e.topic})}},t.logger.debug("Outgoing Relay Payload"),t.logger.trace({type:"payload",direction:"outgoing",request:n}),r.prev=4,r.next=7,Re(new Promise(function(e,r){t.relayer.request(n).catch(function(e){t.logger.warn(e),r(e)}).then(e)}),t.subscribeTimeout,"rpcBatchFetchMessages failed, please try again");case 7:return r.next=9,r.sent;case 9:i=r.sent,r.next=15;break;case 12:r.prev=12,r.t0=r.catch(4),t.relayer.events.emit("relayer_connection_stalled");case 15:return r.abrupt("return",i);case 16:case"end":return r.stop()}},r,null,[[4,12]])}))()}},{key:"rpcUnsubscribe",value:function(e,t,r){var n={method:$o(r.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.request(n)}},{key:"onSubscribe",value:function(e,t){this.setSubscription(e,Mu(Du({},t),{id:e})),this.pending.delete(t.topic)}},{key:"onBatchSubscribe",value:function(e){var t=this;e.length&&e.forEach(function(e){t.setSubscription(e.id,Du({},e)),t.pending.delete(e.topic)})}},{key:"onUnsubscribe",value:function(e,t,r){var n=this;return(0,o.Z)(p().mark(function i(){return p().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n.events.removeAllListeners(t),n.hasSubscription(t,e)&&n.deleteSubscription(t,r),i.next=4,n.relayer.messages.del(e);case 4:case"end":return i.stop()}},i)}))()}},{key:"setRelayerSubscriptions",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.relayer.core.storage.setItem(t.storageKey,e);case 2:case"end":return r.stop()}},r)}))()}},{key:"getRelayerSubscriptions",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.relayer.core.storage.getItem(e.storageKey);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}))()}},{key:"setSubscription",value:function(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}},{key:"addSubscription",value:function(e,t){this.subscriptions.set(e,Du({},t)),this.topicMap.set(t.topic,e),this.events.emit(Ps,t)}},{key:"getSubscription",value:function(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});var t=this.subscriptions.get(e);if(!t){var r=Ra("NO_MATCHING_KEY","".concat(this.name,": ").concat(e)).message;throw new Error(r)}return t}},{key:"deleteSubscription",value:function(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});var r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(As,Mu(Du({},r),{reason:t}))}},{key:"persist",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setRelayerSubscriptions(e.values);case 2:e.events.emit("subscription_sync");case 3:case"end":return t.stop()}},t)}))()}},{key:"onRestart",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){var r,n,i,o;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.cached.length){t.next=10;break}r=s(e.cached),n=Math.ceil(e.cached.length/e.batchSubscribeTopicsLimit),i=0;case 3:if(!(i<n)){t.next=10;break}return o=r.splice(0,e.batchSubscribeTopicsLimit),t.next=7,e.batchSubscribe(o);case 7:i++,t.next=3;break;case 10:e.events.emit("subscription_resubscribed");case 11:case"end":return t.stop()}},t)}))()}},{key:"restore",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){var r,n,i;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getRelayerSubscriptions();case 3:if(!(typeof(r=t.sent)>"u")&&r.length){t.next=6;break}return t.abrupt("return");case 6:if(!e.subscriptions.size||r.every(function(t){var r;return t.topic===(null==(r=e.subscriptions.get(t.id))?void 0:r.topic)})){t.next=9;break}throw n=Ra("RESTORE_WILL_OVERRIDE",e.name),i=n.message,e.logger.error(i),e.logger.error("".concat(e.name,": ").concat(JSON.stringify(e.values))),new Error(i);case 9:e.cached=r,e.logger.debug("Successfully Restored subscriptions for ".concat(e.name)),e.logger.trace({type:"method",method:"restore",subscriptions:e.values}),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),e.logger.debug("Failed to Restore subscriptions for ".concat(e.name)),e.logger.error(t.t0);case 15:case"end":return t.stop()}},t,null,[[0,12]])}))()}},{key:"batchSubscribe",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!e.length){r.next=10;break}return r.next=3,t.rpcBatchSubscribe(e);case 3:if(r.sent){r.next=5;break}return r.abrupt("return",(t.logger.warn("Batch subscribe failed for ".concat(e.length," topics, adding to pending for retry")),void e.forEach(function(e){t.pending.set(e.topic,e)})));case 5:return r.t0=t,r.next=8,Promise.all(e.map(function(){var e=(0,o.Z)(p().mark(function e(r){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Mu,e.t1=Du({},r),e.next=4,t.getSubscriptionId(r.topic);case 4:return e.t2=e.sent,e.t3={id:e.t2},e.abrupt("return",(0,e.t0)(e.t1,e.t3));case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 8:r.t1=r.sent,r.t0.onBatchSubscribe.call(r.t0,r.t1);case 10:case"end":return r.stop()}},r)}))()}},{key:"batchFetchMessages",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){var n;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e.length){r.next=2;break}return r.abrupt("return");case 2:return t.logger.trace("Fetching batch messages for ".concat(e.length," subscriptions")),r.next=5,t.rpcBatchFetchMessages(e);case 5:if(n=r.sent,r.t0=n&&n.messages,!r.t0){r.next=12;break}return r.next=10,function(e){return new Promise(function(t){return setTimeout(t,e)})}((0,d.toMiliseconds)(d.ONE_SECOND));case 10:return r.next=12,t.relayer.handleBatchMessageEvents(n.messages);case 12:case"end":return r.stop()}},r)}))()}},{key:"onConnect",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.restart();case 2:e.reset();case 3:case"end":return t.stop()}},t)}))()}},{key:"onDisconnect",value:function(){this.onDisable()}},{key:"isInitialized",value:function(){if(!this.initialized){var e=Ra("NOT_INITIALIZED",this.name).message;throw new Error(e)}}},{key:"restartToComplete",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=!t.relayer.connected&&!t.relayer.connecting,!r.t0){r.next=5;break}return t.cached.push(e),r.next=5,t.relayer.transportOpen();case 5:case"end":return r.stop()}},r)}))()}},{key:"getClientId",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.clientId,t.t0){t.next=5;break}return t.next=4,e.relayer.core.crypto.getClientId();case 4:e.clientId=t.sent;case 5:return t.abrupt("return",e.clientId);case 6:case"end":return t.stop()}},t)}))()}},{key:"getSubscriptionId",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=Zo,r.t1=e,r.next=4,t.getClientId();case 4:return r.t2=r.sent,r.t3=r.t1+r.t2,r.abrupt("return",(0,r.t0)(r.t3));case 7:case"end":return r.stop()}},r)}))()}}]),r}(us),Zu=Object.defineProperty,Fu=Object.getOwnPropertySymbols,Ku=Object.prototype.hasOwnProperty,Vu=Object.prototype.propertyIsEnumerable,Hu=function(e,t,r){return t in e?Zu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Wu=function(e,t){for(var r in t||(t={}))Ku.call(t,r)&&Hu(e,r,t[r]);if(Fu){var n,i=u(Fu(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Vu.call(t,r)&&Hu(e,r,t[r])}}catch(o){i.e(o)}finally{i.f()}}return e},Gu=function(e,t,r){return Hu(e,"symbol"!=typeof t?t+"":t,r)},Ju=function(e){h(r,e);var t=v(r);function r(e){var n,i,a;return k(this,r),n=t.call(this,e),i=y(n),Gu(y(n),"protocol","wc"),Gu(y(n),"version",2),Gu(y(n),"core"),Gu(y(n),"logger"),Gu(y(n),"events",new f.EventEmitter),Gu(y(n),"provider"),Gu(y(n),"messages"),Gu(y(n),"subscriber"),Gu(y(n),"publisher"),Gu(y(n),"name","relayer"),Gu(y(n),"transportExplicitlyClosed",!1),Gu(y(n),"initialized",!1),Gu(y(n),"connectionAttemptInProgress",!1),Gu(y(n),"relayUrl"),Gu(y(n),"projectId"),Gu(y(n),"packageName"),Gu(y(n),"bundleId"),Gu(y(n),"hasExperiencedNetworkDisruption",!1),Gu(y(n),"pingTimeout"),Gu(y(n),"heartBeatTimeout",(0,d.toMiliseconds)(d.THIRTY_SECONDS+d.FIVE_SECONDS)),Gu(y(n),"reconnectTimeout"),Gu(y(n),"connectPromise"),Gu(y(n),"reconnectInProgress",!1),Gu(y(n),"requestsInFlight",[]),Gu(y(n),"connectTimeout",(0,d.toMiliseconds)(15*d.ONE_SECOND)),Gu(y(n),"stalledRestartInProgress",!1),Gu(y(n),"stalledRestartTimeout"),Gu(y(n),"stalledRestartBackoff",0),Gu(y(n),"stalledRestartBaseInterval",(0,d.toMiliseconds)(2*d.ONE_SECOND)),Gu(y(n),"stalledRestartMaxInterval",(0,d.toMiliseconds)(d.THIRTY_SECONDS)),Gu(y(n),"request",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,o,a,s;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i.logger.debug("Publishing Request Payload"),o=t.id||(0,vs.getBigIntRpcId)().toString(),e.next=4,i.toEstablishConnection();case 4:return e.prev=4,i.logger.trace({id:o,method:t.method,topic:null==(r=t.params)?void 0:r.topic},"relayer.request - publishing..."),a="".concat(o,":").concat((null==(n=t.params)?void 0:n.tag)||""),i.requestsInFlight.push(a),e.next=10,i.provider.request(t);case 10:return s=e.sent,e.abrupt("return",(i.requestsInFlight=i.requestsInFlight.filter(function(e){return e!==a}),s));case 14:throw e.prev=14,e.t0=e.catch(4),i.logger.debug("Failed to Publish Request: ".concat(o)),e.t0;case 17:case"end":return e.stop()}},e,null,[[4,14]])}));return function(t){return e.apply(this,arguments)}}()),Gu(y(n),"resetPingTimeout",function(){me()&&(clearTimeout(n.pingTimeout),n.pingTimeout=setTimeout(function(){var e,t,r,i;try{n.logger.debug({},"pingTimeout: Connection stalled, terminating..."),null==(i=null==(r=null==(t=null==(e=n.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.terminate)||i.call(r)}catch(o){n.logger.warn(o,null==o?void 0:o.message)}},n.heartBeatTimeout))}),Gu(y(n),"onPayloadHandler",function(e){n.onProviderPayload(e),n.resetPingTimeout()}),Gu(y(n),"onConnectHandler",function(){n.logger.warn({},"Relayer connected \ud83d\udedc"),n.startPingTimeout(),n.events.emit("relayer_connect")}),Gu(y(n),"onDisconnectHandler",function(){n.logger.warn({},"Relayer disconnected \ud83d\uded1"),n.requestsInFlight=[],n.onProviderDisconnect()}),Gu(y(n),"onProviderErrorHandler",function(e){n.logger.fatal("Fatal socket error: ".concat(e.message)),n.events.emit("relayer_error",e),n.logger.fatal("Fatal socket error received, closing transport"),n.transportExplicitlyClosed=!0,clearTimeout(n.reconnectTimeout),n.reconnectTimeout=void 0,n.reconnectInProgress=!1,n.transportClose().catch(function(e){return n.logger.warn(e)})}),Gu(y(n),"registerProviderListeners",function(){n.provider.on("payload",n.onPayloadHandler),n.provider.on("connect",n.onConnectHandler),n.provider.on("disconnect",n.onDisconnectHandler),n.provider.on("error",n.onProviderErrorHandler)}),n.core=e.core,n.logger=Xa({logger:null!=(a=e.logger)?a:"error",name:n.name}),n.messages=new gu(n.logger,e.core),n.subscriber=new zu(y(n),n.logger),n.publisher=new _u(y(n),n.logger),n.projectId=null==e?void 0:e.projectId,n.relayUrl=(null==e?void 0:e.relayUrl)||ks,we()&&typeof global<"u"&&typeof(null==global?void 0:global.Platform)<"u"&&"android"===(null==global?void 0:global.Platform.OS)?n.packageName=Ee():we()&&typeof global<"u"&&typeof(null==global?void 0:global.Platform)<"u"&&"ios"===(null==global?void 0:global.Platform.OS)&&(n.bundleId=Ee()),n.provider={},n}return x(r,[{key:"init",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.logger.trace("Initialized"),e.registerEventListeners(),t.next=4,Promise.all([e.messages.init(),e.subscriber.init()]);case 4:e.initialized=!0,e.transportOpen().catch(function(t){return e.logger.warn(t,null==t?void 0:t.message)});case 6:case"end":return t.stop()}},t)}))()}},{key:"context",get:function(){return(0,oe.Fd)(this.logger)}},{key:"connected",get:function(){var e,t,r;return 1===(null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.readyState)||!1}},{key:"connecting",get:function(){var e,t,r;return 0===(null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.readyState)||void 0!==this.connectPromise||!1}},{key:"publish",value:function(e,t,r){var n=this;return(0,o.Z)(p().mark(function i(){return p().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n.isInitialized(),i.next=3,n.publisher.publish(e,t,r);case 3:return i.next=5,n.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:Os},"outbound");case 5:case"end":return i.stop()}},i)}))()}},{key:"publishCustom",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t.isInitialized(),r.next=3,t.publisher.publishCustom(e);case 3:case"end":return r.stop()}},r)}))()}},{key:"subscribe",value:function(e,t){var r=this;return(0,o.Z)(p().mark(function n(){var i,a,s,c,u,f,l;return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r.isInitialized(),n.t0=null==t||!t.transportType||"relay"===(null==t?void 0:t.transportType),!n.t0){n.next=5;break}return n.next=5,r.toEstablishConnection();case 5:return c=typeof(null==(i=null==t?void 0:t.internal)?void 0:i.throwOnFailedPublish)>"u"||(null==(a=null==t?void 0:t.internal)?void 0:a.throwOnFailedPublish),f=(null==(s=r.subscriber.topicMap.get(e))?void 0:s[0])||"",l=function t(n){n.topic===e&&(r.subscriber.off(Ps,t),u())},n.next=10,Promise.all([new Promise(function(e){u=e,r.subscriber.on(Ps,l)}),new Promise(function(){var n=(0,o.Z)(p().mark(function n(i,o){return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.subscriber.subscribe(e,Wu({internal:{throwOnFailedPublish:c}},t)).catch(function(e){c&&o(e)});case 2:if(n.t0=n.sent,n.t0){n.next=5;break}n.t0=f;case 5:f=n.t0,i();case 7:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}())]);case 10:return n.abrupt("return",f);case 11:case"end":return n.stop()}},n)}))()}},{key:"unsubscribe",value:function(e,t){var r=this;return(0,o.Z)(p().mark(function n(){return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r.isInitialized(),n.next=3,r.subscriber.unsubscribe(e,t);case 3:case"end":return n.stop()}},n)}))()}},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"once",value:function(e,t){this.events.once(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"removeListener",value:function(e,t){this.events.removeListener(e,t)}},{key:"transportDisconnect",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.provider.disconnect||!e.hasExperiencedNetworkDisruption&&!e.connected){t.next=5;break}return t.next=3,Re(e.provider.disconnect(),2e3,"provider.disconnect()").catch(function(){return e.onProviderDisconnect()});case 3:t.next=6;break;case 5:e.onProviderDisconnect();case 6:case"end":return t.stop()}},t)}))()}},{key:"transportClose",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.transportExplicitlyClosed=!0,clearTimeout(e.stalledRestartTimeout),e.stalledRestartInProgress=!1,e.stalledRestartBackoff=0,t.next=6,e.resetTransport();case 6:case"end":return t.stop()}},t)}))()}},{key:"transportOpen",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!t.subscriber.hasAnyTopics){r.next=15;break}if(!t.connectPromise){r.next=8;break}return t.logger.debug({},"Waiting for existing connection attempt to resolve..."),r.next=5,t.connectPromise;case 5:t.logger.debug({},"Existing connection attempt resolved"),r.next=11;break;case 8:return t.connectPromise=new Promise(function(){var r=(0,o.Z)(p().mark(function r(n,i){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.connect(e).then(n).catch(i).finally(function(){t.connectPromise=void 0});case 2:case"end":return r.stop()}},r)}));return function(e,t){return r.apply(this,arguments)}}()),r.next=11,t.connectPromise;case 11:if(t.connected){r.next=13;break}throw new Error("Couldn't establish socket connection to the relay server: ".concat(t.relayUrl));case 13:r.next=16;break;case 15:t.logger.info("Starting WS connection skipped because the client has no topics to work with.");case 16:case"end":return r.stop()}},r)}))()}},{key:"restartTransport",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t.logger.debug({},"Restarting transport..."),r.t0=!t.connectionAttemptInProgress,!r.t0){r.next=10;break}return t.relayUrl=e||t.relayUrl,r.next=6,t.confirmOnlineStateOrThrow();case 6:return r.next=8,t.resetTransport();case 8:return r.next=10,t.transportOpen();case 10:case"end":return r.stop()}},r)}))()}},{key:"resetTransport",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.reconnectInProgress=!0,clearTimeout(e.reconnectTimeout),e.reconnectTimeout=void 0,t.next=5,e.transportDisconnect();case 5:return t.next=7,e.subscriber.stop();case 7:e.reconnectInProgress=!1;case 8:case"end":return t.stop()}},t)}))()}},{key:"confirmOnlineStateOrThrow",value:function(){return(0,o.Z)(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ha();case 2:if(e.sent){e.next=4;break}throw new Error("No internet connection detected. Please restart your network and try again.");case 4:case"end":return e.stop()}},e)}))()}},{key:"handleBatchMessageEvents",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){var n,i,o,a;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(0!==(null==e?void 0:e.length)){r.next=2;break}return r.abrupt("return",void t.logger.trace("Batch message events is empty. Ignoring..."));case 2:n=e.sort(function(e,t){return e.publishedAt-t.publishedAt}),t.logger.debug("Batch of ".concat(n.length," message events sorted")),i=u(n),r.prev=5,i.s();case 7:if((o=i.n()).done){r.next=19;break}return a=o.value,r.prev=9,r.next=12,t.onMessageEvent(a);case 12:r.next=17;break;case 14:r.prev=14,r.t0=r.catch(9),t.logger.warn(r.t0,"Error while processing batch message event: "+(null===r.t0||void 0===r.t0?void 0:r.t0.message));case 17:r.next=7;break;case 19:r.next=24;break;case 21:r.prev=21,r.t1=r.catch(5),i.e(r.t1);case 24:return r.prev=24,i.f(),r.finish(24);case 27:t.logger.trace("Batch of ".concat(n.length," message events processed"));case 28:case"end":return r.stop()}},r,null,[[5,21,24,27],[9,14]])}))()}},{key:"onLinkMessageEvent",value:function(e,t){var r=this;return(0,o.Z)(p().mark(function n(){var i,o;return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=e.topic,t.sessionExists){n.next=5;break}return o={topic:i,expiry:Ce(d.FIVE_MINUTES),relay:{protocol:"irn"},active:!1},n.next=5,r.core.pairing.pairings.set(i,o);case 5:return r.events.emit("relayer_message",e),n.next=8,r.recordMessageEvent(e,"inbound");case 8:case"end":return n.stop()}},n)}))()}},{key:"connect",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){var n;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.confirmOnlineStateOrThrow();case 2:if(r.t0=e&&e!==t.relayUrl,!r.t0){r.next=7;break}return t.relayUrl=e,r.next=7,t.transportDisconnect();case 7:t.connectionAttemptInProgress=!0,t.transportExplicitlyClosed=!1,n=1;case 10:if(!(n<6)){r.next=38;break}if(r.prev=11,!t.transportExplicitlyClosed){r.next=14;break}return r.abrupt("break",38);case 14:return t.logger.debug({},"Connecting to ".concat(t.relayUrl,", attempt: ").concat(n,"...")),r.next=17,t.createProvider();case 17:return r.next=19,new Promise(function(){var e=(0,o.Z)(p().mark(function e(r,n){var i;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=function(){n(new Error("Connection interrupted while trying to connect"))},t.provider.once("disconnect",i),e.next=4,Re(new Promise(function(e,r){t.provider.connect().then(e).catch(r)}),t.connectTimeout,"Socket stalled when trying to connect to ".concat(t.relayUrl)).catch(function(e){n(e)}).finally(function(){t.provider.off("disconnect",i),clearTimeout(t.reconnectTimeout)});case 4:return e.next=6,new Promise(function(){var e=(0,o.Z)(p().mark(function e(r,i){var o;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=function(){n(new Error("Connection interrupted while trying to subscribe"))},t.provider.once("disconnect",o),e.next=4,t.subscriber.start().then(r).catch(i).finally(function(){t.provider.off("disconnect",o)});case 4:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}());case 6:t.hasExperiencedNetworkDisruption=!1,r();case 8:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}());case 19:r.next=27;break;case 21:return r.prev=21,r.t1=r.catch(11),r.next=25,t.subscriber.stop();case 25:t.logger.warn({},r.t1.message),t.hasExperiencedNetworkDisruption=!0;case 27:return r.prev=27,t.connectionAttemptInProgress=!1,r.finish(27);case 30:if(!t.connected){r.next=33;break}return t.logger.debug({},"Connected to ".concat(t.relayUrl," successfully on attempt: ").concat(n)),r.abrupt("break",38);case 33:return r.next=35,new Promise(function(e){return setTimeout(e,(0,d.toMiliseconds)(1*n))});case 35:n++;case 36:r.next=10;break;case 38:case"end":return r.stop()}},r,null,[[11,21,27,30]])}))()}},{key:"startPingTimeout",value:function(){var e,t,r,n,i,o=this;if(me())try{null!=(t=null==(e=this.provider)?void 0:e.connection)&&t.socket&&(null==(i=null==(n=null==(r=this.provider)?void 0:r.connection)?void 0:n.socket)||i.on("ping",function(){o.resetPingTimeout()})),this.resetPingTimeout()}catch(a){this.logger.warn(a,null==a?void 0:a.message)}}},{key:"createProvider",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){var r;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.provider.connection&&e.unregisterProviderListeners(),t.next=3,e.core.crypto.signJWT(e.relayUrl);case 3:r=t.sent,e.provider=new ds.r(new gs.Z(function(e){var t=e.protocol,r=e.version,n=e.sdkVersion,o=e.auth,a=e.projectId,s=e.useOnCloseEvent,c=e.bundleId,u=e.packageName,f=e.relayUrl.split("?"),l=Se(t,r,n),p=function(e,t){var r=new URLSearchParams(e);return Object.entries(t).sort(function(e,t){var r=i(e,1)[0],n=i(t,1)[0];return r.localeCompare(n)}).forEach(function(e){var t=i(e,2),n=t[0],o=t[1];null!=o&&r.set(n,String(o))}),r.toString()}(f[1]||"",{auth:o,ua:l,projectId:a,useOnCloseEvent:s||void 0,packageName:u||void 0,bundleId:c||void 0});return f[0]+"?"+p}({sdkVersion:Is,protocol:e.protocol,version:e.version,relayUrl:e.relayUrl,projectId:e.projectId,auth:r,useOnCloseEvent:!0,bundleId:e.bundleId,packageName:e.packageName}))),e.registerProviderListeners();case 5:case"end":return t.stop()}},t)}))()}},{key:"recordMessageEvent",value:function(e,t){var r=this;return(0,o.Z)(p().mark(function n(){var i,o;return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i=e.topic,o=e.message,n.next=3,r.messages.set(i,o,t);case 3:case"end":return n.stop()}},n)}))()}},{key:"shouldIgnoreMessageEvent",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){var n,i,o;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.topic,(i=e.message)&&0!==i.length){r.next=3;break}return r.abrupt("return",(t.logger.warn("Ignoring invalid/empty message: ".concat(i)),!0));case 3:return r.next=5,t.subscriber.isKnownTopic(n);case 5:if(r.sent){r.next=7;break}return r.abrupt("return",(t.logger.warn("Ignoring message for unknown topic ".concat(n)),!0));case 7:return o=t.messages.has(n,i),r.abrupt("return",(o&&t.logger.warn("Ignoring duplicate message: ".concat(i)),o));case 9:case"end":return r.stop()}},r)}))()}},{key:"onProviderPayload",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){var n,i,o,a,s,c,u;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t.logger.debug("Incoming Relay Payload"),t.logger.trace({type:"payload",direction:"incoming",payload:e}),!(0,vs.isJsonRpcRequest)(e)){r.next=13;break}if(e.method.endsWith("_subscription")){r.next=3;break}return r.abrupt("return");case 3:return n=e.params,i=n.data,o=i.topic,a=i.message,s=i.publishedAt,c=i.attestation,u={topic:o,message:a,publishedAt:s,transportType:Os,attestation:c},t.logger.debug("Emitting Relayer Payload"),t.logger.trace(Wu({type:"event",event:n.id},u)),t.events.emit(n.id,u),r.next=9,t.acknowledgePayload(e);case 9:return r.next=11,t.onMessageEvent(u);case 11:r.next=14;break;case 13:(0,vs.isJsonRpcResponse)(e)&&t.events.emit("relayer_message_ack",e);case 14:case"end":return r.stop()}},r)}))()}},{key:"onMessageEvent",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.shouldIgnoreMessageEvent(e);case 2:if(r.t0=r.sent,r.t0){r.next=7;break}return r.next=6,t.recordMessageEvent(e,"inbound");case 6:t.events.emit("relayer_message",e);case 7:case"end":return r.stop()}},r)}))()}},{key:"acknowledgePayload",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){var n;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=(0,vs.formatJsonRpcResult)(e.id,!0),r.next=3,t.provider.connection.send(n);case 3:case"end":return r.stop()}},r)}))()}},{key:"unregisterProviderListeners",value:function(){this.provider.off("payload",this.onPayloadHandler),this.provider.off("connect",this.onConnectHandler),this.provider.off("disconnect",this.onDisconnectHandler),this.provider.off("error",this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}},{key:"registerEventListeners",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){var r;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ha();case 2:r=t.sent,function(e){switch(ke()){case"browser":!function(e){!we()&&xe()&&(window.addEventListener("online",function(){return e(!0)}),window.addEventListener("offline",function(){return e(!1)}))}(e);break;case"react-native":!function(e){var t;we()&&typeof global<"u"&&null!=global&&global.NetInfo&&(null===(t=global)||void 0===t||t.NetInfo.addEventListener(function(t){return e(null==t?void 0:t.isConnected)}))}(e)}}(function(){var t=(0,o.Z)(p().mark(function t(n){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=r!==n,!t.t0){t.next=12;break}if(r=n,!n){t.next=8;break}return t.next=6,e.transportOpen().catch(function(t){return e.logger.error(t,null==t?void 0:t.message)});case 6:t.next=12;break;case 8:return e.hasExperiencedNetworkDisruption=!0,t.next=11,e.transportDisconnect();case 11:e.transportExplicitlyClosed=!1;case 12:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),e.core.heartbeat.on($a.Lx.pulse,(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.transportExplicitlyClosed||e.connected||!function(){var e;return!xe()||!(0,b.getDocument)()||"visible"===(null==(e=(0,b.getDocument)())?void 0:e.visibilityState)}()){t.next=11;break}return t.prev=1,t.next=4,e.confirmOnlineStateOrThrow();case 4:return t.next=6,e.transportOpen();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),e.logger.warn(t.t0,null===t.t0||void 0===t.t0?void 0:t.t0.message);case 11:case"end":return t.stop()}},t,null,[[1,8]])}))),e.events.on("relayer_connection_stalled",function(){if(!e.transportExplicitlyClosed&&!e.stalledRestartInProgress){e.stalledRestartInProgress=!0;var t=0===e.stalledRestartBackoff?0:Math.min(Math.pow(2,e.stalledRestartBackoff-1)*e.stalledRestartBaseInterval,e.stalledRestartMaxInterval);e.stalledRestartBackoff++,e.logger.warn("Connection stalled, restarting transport".concat(t?" in ".concat(t,"ms"):"","...")),e.stalledRestartTimeout=setTimeout((0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e.transportExplicitlyClosed){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,e.restartTransport();case 5:t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),e.logger.error(t.t0,null===t.t0||void 0===t.t0?void 0:t.t0.message);case 10:return t.prev=10,e.stalledRestartInProgress=!1,t.finish(10);case 13:case"end":return t.stop()}},t,null,[[0,7,10,13]])})),t)}});case 4:case"end":return t.stop()}},t)}))()}},{key:"onProviderDisconnect",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(clearTimeout(e.pingTimeout),e.events.emit("relayer_disconnect"),e.connectionAttemptInProgress=!1,t.t0=!e.reconnectInProgress,!t.t0){t.next=9;break}return e.reconnectInProgress=!0,t.next=8,e.subscriber.stop();case 8:e.subscriber.hasAnyTopics&&(e.transportExplicitlyClosed||(e.reconnectTimeout=setTimeout((0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.transportOpen().catch(function(t){return e.logger.error(t,null==t?void 0:t.message)});case 2:e.reconnectTimeout=void 0,e.reconnectInProgress=!1;case 4:case"end":return t.stop()}},t)})),(0,d.toMiliseconds)(.1))));case 9:case"end":return t.stop()}},t)}))()}},{key:"isInitialized",value:function(){if(!this.initialized){var e=Ra("NOT_INITIALIZED",this.name).message;throw new Error(e)}}},{key:"toEstablishConnection",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.confirmOnlineStateOrThrow();case 2:if(e.connected){t.next=9;break}if(!e.connectPromise){t.next=7;break}return t.next=6,e.connectPromise;case 6:return t.abrupt("return",void t.sent);case 7:return t.next=9,e.connect();case 9:case"end":return t.stop()}},t)}))()}}]),r}(cs);function Yu(e){return Object.getOwnPropertySymbols(e).filter(function(t){return Object.prototype.propertyIsEnumerable.call(e,t)})}function Qu(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}var Xu="[object Arguments]",$u="[object Object]";function ef(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&"[object Object]"===Object.prototype.toString.call(e)}function tf(e,t,r,n,i,o,a){var s=a(e,t,r,n,i,o);if(void 0!==s)return s;if(typeof e==typeof t)switch(typeof e){case"bigint":case"string":case"boolean":case"symbol":case"undefined":case"function":return e===t;case"number":return e===t||Object.is(e,t);case"object":return rf(e,t,o,a)}return rf(e,t,o,a)}function rf(e,t,r,n){var o;if(Object.is(e,t))return!0;var a=Qu(e),c=Qu(t);if(a===Xu&&(a=$u),c===Xu&&(c=$u),a!==c)return!1;switch(a){case"[object String]":return e.toString()===t.toString();case"[object Number]":return function(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}(e.valueOf(),t.valueOf());case"[object Boolean]":case"[object Date]":case"[object Symbol]":return Object.is(e.valueOf(),t.valueOf());case"[object RegExp]":return e.source===t.source&&e.flags===t.flags;case"[object Function]":return e===t}var f=(r=null!==(o=r)&&void 0!==o?o:new Map).get(e),l=r.get(t);if(null!=f&&null!=l)return f===t;r.set(e,t),r.set(t,e);try{switch(a){case"[object Map]":if(e.size!==t.size)return!1;var p,h=u(e.entries());try{for(h.s();!(p=h.n()).done;){var d=i(p.value,2),v=d[0],g=d[1];if(!t.has(v)||!tf(g,t.get(v),v,e,t,r,n))return!1}}catch(P){h.e(P)}finally{h.f()}return!0;case"[object Set]":if(e.size!==t.size)return!1;for(var y=Array.from(e.values()),b=Array.from(t.values()),m=function(i){var o=y[i],a=b.findIndex(function(i){return tf(o,i,void 0,e,t,r,n)});if(-1===a)return{v:!1};b.splice(a,1)},w=0;w<y.length;w++){var x=m(w);if("object"==typeof x)return x.v}return!0;case"[object Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":case"[object BigUint64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object BigInt64Array]":case"[object Float32Array]":case"[object Float64Array]":if(typeof Buffer<"u"&&Buffer.isBuffer(e)!==Buffer.isBuffer(t)||e.length!==t.length)return!1;for(var k=0;k<e.length;k++)if(!tf(e[k],t[k],k,e,t,r,n))return!1;return!0;case"[object ArrayBuffer]":return e.byteLength===t.byteLength&&rf(new Uint8Array(e),new Uint8Array(t),r,n);case"[object DataView]":return e.byteLength===t.byteLength&&e.byteOffset===t.byteOffset&&rf(new Uint8Array(e),new Uint8Array(t),r,n);case"[object Error]":return e.name===t.name&&e.message===t.message;case $u:if(!(rf(e.constructor,t.constructor,r,n)||ef(e)&&ef(t)))return!1;var E=[].concat(s(Object.keys(e)),s(Yu(e))),I=[].concat(s(Object.keys(t)),s(Yu(t)));if(E.length!==I.length)return!1;for(var S=0;S<E.length;S++){var O=E[S],_=e[O];if(!Object.hasOwn(t,O))return!1;if(!tf(_,t[O],O,e,t,r,n))return!1}return!0;default:return!1}}finally{r.delete(e),r.delete(t)}}function nf(){}var of=Object.defineProperty,af=Object.getOwnPropertySymbols,sf=Object.prototype.hasOwnProperty,cf=Object.prototype.propertyIsEnumerable,uf=function(e,t,r){return t in e?of(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},ff=function(e,t){for(var r in t||(t={}))sf.call(t,r)&&uf(e,r,t[r]);if(af){var n,i=u(af(t));try{for(i.s();!(n=i.n()).done;){r=n.value;cf.call(t,r)&&uf(e,r,t[r])}}catch(o){i.e(o)}finally{i.f()}}return e},lf=function(e,t,r){return uf(e,"symbol"!=typeof t?t+"":t,r)},pf=function(e){h(r,e);var t=v(r);function r(e,n,i){var a,s,c,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ys,f=arguments.length>4?arguments[4]:void 0;return k(this,r),a=t.call(this,e,n,i,u),s=y(a),a.core=e,a.logger=n,a.name=i,lf(y(a),"map",new Map),lf(y(a),"version","0.3"),lf(y(a),"cached",[]),lf(y(a),"initialized",!1),lf(y(a),"getKey"),lf(y(a),"storagePrefix",ys),lf(y(a),"recentlyDeleted",[]),lf(y(a),"recentlyDeletedLimit",200),lf(y(a),"init",(0,o.Z)(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=s.initialized,e.t0){e.next=8;break}return s.logger.trace("Initialized"),e.next=5,s.restore();case 5:s.cached.forEach(function(e){s.getKey&&null!==e&&!Ua(e)?s.map.set(s.getKey(e),e):function(e){var t;return null==(t=null==e?void 0:e.proposer)?void 0:t.publicKey}(e)?s.map.set(e.id,e):function(e){return null==e?void 0:e.topic}(e)&&s.map.set(e.topic,e)}),s.cached=[],s.initialized=!0;case 8:case"end":return e.stop()}},e)}))),lf(y(a),"set",(c=(0,o.Z)(p().mark(function e(t,r){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s.isInitialized(),!s.map.has(t)){e.next=6;break}return e.next=4,s.update(t,r);case 4:e.next=11;break;case 6:return s.logger.debug("Setting value"),s.logger.trace({type:"method",method:"set",key:t,value:r}),s.map.set(t,r),e.next=11,s.persist();case 11:case"end":return e.stop()}},e)})),function(e,t){return c.apply(this,arguments)})),lf(y(a),"get",function(e){return a.isInitialized(),a.logger.debug("Getting value"),a.logger.trace({type:"method",method:"get",key:e}),a.getData(e)}),lf(y(a),"getAll",function(e){return a.isInitialized(),e?a.values.filter(function(t){return Object.keys(e).every(function(r){return function(e,t){return function(e,t,r){return tf(e,t,void 0,void 0,void 0,void 0,r)}(e,t,nf)}(t[r],e[r])})}):a.values}),lf(y(a),"update",function(){var e=(0,o.Z)(p().mark(function e(t,r){var n;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s.isInitialized(),s.logger.debug("Updating value"),s.logger.trace({type:"method",method:"update",key:t,update:r}),n=ff(ff({},s.getData(t)),r),s.map.set(t,n),e.next=5,s.persist();case 5:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()),lf(y(a),"delete",function(){var e=(0,o.Z)(p().mark(function e(t,r){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s.isInitialized(),e.t0=s.map.has(t),!e.t0){e.next=9;break}return s.logger.debug("Deleting value"),s.logger.trace({type:"method",method:"delete",key:t,reason:r}),s.map.delete(t),s.addToRecentlyDeleted(t),e.next=9,s.persist();case 9:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()),a.logger=(0,oe.Ep)(n,a.name),a.storagePrefix=u,a.getKey=f,a}return x(r,[{key:"context",get:function(){return(0,oe.Fd)(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}},{key:"length",get:function(){return this.map.size}},{key:"keys",get:function(){return Array.from(this.map.keys())}},{key:"values",get:function(){return Array.from(this.map.values())}},{key:"addToRecentlyDeleted",value:function(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}},{key:"setDataStore",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.core.storage.setItem(t.storageKey,e);case 2:case"end":return r.stop()}},r)}))()}},{key:"getDataStore",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.core.storage.getItem(e.storageKey);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}))()}},{key:"getData",value:function(e){var t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){var r=Ra("MISSING_OR_INVALID","Record was recently deleted - ".concat(this.name,": ").concat(e)).message;throw this.logger.error(r),new Error(r)}var n=Ra("NO_MATCHING_KEY","".concat(this.name,": ").concat(e)).message;throw this.logger.error(n),new Error(n)}return t}},{key:"persist",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setDataStore(e.values);case 2:case"end":return t.stop()}},t)}))()}},{key:"restore",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){var r,n,i;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getDataStore();case 3:if(!(typeof(r=t.sent)>"u")&&r.length){t.next=6;break}return t.abrupt("return");case 6:if(!e.map.size){t.next=9;break}throw n=Ra("RESTORE_WILL_OVERRIDE",e.name),i=n.message,e.logger.error(i),new Error(i);case 9:e.cached=r,e.logger.debug("Successfully Restored value for ".concat(e.name)),e.logger.trace({type:"method",method:"restore",value:e.values}),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),e.logger.debug("Failed to Restore value for ".concat(e.name)),e.logger.error(t.t0);case 15:case"end":return t.stop()}},t,null,[[0,12]])}))()}},{key:"isInitialized",value:function(){if(!this.initialized){var e=Ra("NOT_INITIALIZED",this.name).message;throw new Error(e)}}}]),r}(function(){return x(function e(t,r,n,i){k(this,e),this.core=t,this.logger=r,this.name=n})}()),hf=Object.defineProperty,df=function(e,t,r){return function(e,t,r){return t in e?hf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r}(e,"symbol"!=typeof t?t+"":t,r)},vf=function(){function e(t,r){var n=this;k(this,e);var i=this;this.core=t,this.logger=r,df(this,"name","pairing"),df(this,"version","0.3"),df(this,"events",new f),df(this,"pairings"),df(this,"initialized",!1),df(this,"storagePrefix",ys),df(this,"ignoredPayloadTypes",[1]),df(this,"registeredMethods",[]),df(this,"init",(0,o.Z)(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=i.initialized,e.t0){e.next=10;break}return e.next=4,i.pairings.init();case 4:return e.next=6,i.cleanup();case 6:i.registerRelayerEvents(),i.registerExpirerEvents(),i.initialized=!0,i.logger.trace("Initialized");case 10:case"end":return e.stop()}},e)}))),df(this,"register",function(e){var t=e.methods;n.isInitialized(),n.registeredMethods=s(new Set([].concat(s(n.registeredMethods),s(t))))}),df(this,"create",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,o,a,s,c;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i.isInitialized(),r=qo(),e.next=4,i.core.crypto.setSymKey(r);case 4:return n=e.sent,o=Ce(d.FIVE_MINUTES),s={topic:n,expiry:o,relay:a={protocol:"irn"},active:!1,methods:null==t?void 0:t.methods},c=la({protocol:i.core.protocol,version:i.core.version,topic:n,symKey:r,relay:a,expiryTimestamp:o,methods:null==t?void 0:t.methods}),i.events.emit("pairing_create",s),i.core.expirer.set(n,o),e.next=13,i.pairings.set(n,s);case 13:return e.next=15,i.core.relayer.subscribe(n,{transportType:null==t?void 0:t.transportType,internal:null==t?void 0:t.internal});case 15:return e.abrupt("return",{topic:n,uri:c});case 16:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),df(this,"pair",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,o,a,s,c,u,f,l,h;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.isInitialized(),r=i.core.eventClient.createEvent({properties:{topic:null==t?void 0:t.uri,trace:["pairing_started"]}}),i.isValidPair(t,r),n=ua(t.uri),o=n.topic,a=n.symKey,s=n.relay,c=n.expiryTimestamp,u=n.methods,r.props.properties.topic=o,r.addTrace("pairing_uri_validation_success"),r.addTrace("pairing_uri_not_expired"),!i.pairings.keys.includes(o)){e.next=8;break}if(f=i.pairings.get(o),r.addTrace("existing_pairing"),!f.active){e.next=7;break}throw r.setError("active_pairing_already_exists"),new Error("Pairing already exists: ".concat(o,". Please try again with a new connection URI."));case 7:r.addTrace("pairing_not_expired");case 8:return l=c||Ce(d.FIVE_MINUTES),h={topic:o,relay:s,expiry:l,active:!1,methods:u},i.core.expirer.set(o,l),e.next=12,i.pairings.set(o,h);case 12:if(r.addTrace("store_new_pairing"),e.t0=t.activatePairing,!e.t0){e.next=17;break}return e.next=17,i.activate({topic:o});case 17:if(i.events.emit("pairing_create",h),r.addTrace("emit_inactive_pairing"),e.t1=i.core.crypto.keychain.has(o),e.t1){e.next=23;break}return e.next=23,i.core.crypto.setSymKey(a,o);case 23:return r.addTrace("subscribing_pairing_topic"),e.prev=24,e.next=27,i.core.relayer.confirmOnlineStateOrThrow();case 27:e.next=32;break;case 29:e.prev=29,e.t2=e.catch(24),r.setError("no_internet_connection");case 32:return e.prev=32,e.next=35,i.core.relayer.subscribe(o,{relay:s});case 35:e.next=40;break;case 37:throw e.prev=37,e.t3=e.catch(32),r.setError("subscribe_pairing_topic_failure"),e.t3;case 40:return e.abrupt("return",(r.addTrace("subscribe_pairing_topic_success"),h));case 41:case"end":return e.stop()}},e,null,[[24,29],[32,37]])}));return function(t){return e.apply(this,arguments)}}()),df(this,"activate",function(){var e=(0,o.Z)(function(e){var t=e.topic;return p().mark(function e(){var r;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i.isInitialized(),r=Ce(d.FIVE_MINUTES),i.core.expirer.set(t,r),e.next=5,i.pairings.update(t,{active:!0,expiry:r});case 5:case"end":return e.stop()}},e)})()});return function(t){return e.apply(this,arguments)}}()),df(this,"ping",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,o,a,s,c;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i.isInitialized(),e.next=3,i.isValidPing(t);case 3:if(i.logger.warn("ping() is deprecated and will be removed in the next major release."),r=t.topic,!i.pairings.keys.includes(r)){e.next=16;break}return e.next=8,i.sendRequest(r,"wc_pairingPing",{});case 8:return n=e.sent,o=Ae(),a=o.done,s=o.resolve,c=o.reject,i.events.once(Ne("pairing_ping",n),function(e){var t=e.error;t?c(t):s()}),e.next=16,a();case 16:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),df(this,"updateExpiry",function(){var e=(0,o.Z)(function(e){var t=e.topic,r=e.expiry;return p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i.isInitialized(),e.next=3,i.pairings.update(t,{expiry:r});case 3:case"end":return e.stop()}},e)})()});return function(t){return e.apply(this,arguments)}}()),df(this,"updateMetadata",function(){var e=(0,o.Z)(function(e){var t=e.topic,r=e.metadata;return p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i.isInitialized(),e.next=3,i.pairings.update(t,{peerMetadata:r});case 3:case"end":return e.stop()}},e)})()});return function(t){return e.apply(this,arguments)}}()),df(this,"getPairings",function(){return n.isInitialized(),n.pairings.values}),df(this,"disconnect",function(){var e=(0,o.Z)(p().mark(function e(t){var r;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i.isInitialized(),e.next=3,i.isValidDisconnect(t);case 3:if(r=t.topic,e.t0=i.pairings.keys.includes(r),!e.t0){e.next=10;break}return e.next=8,i.sendRequest(r,"wc_pairingDelete",Ta("USER_DISCONNECTED"));case 8:return e.next=10,i.deletePairing(r);case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),df(this,"formatUriFromPairing",function(e){n.isInitialized();var t=e.topic,r=e.relay,i=e.expiry,o=e.methods,a=n.core.crypto.keychain.get(t);return la({protocol:n.core.protocol,version:n.core.version,topic:t,symKey:a,relay:r,expiryTimestamp:i,methods:o})}),df(this,"sendRequest",function(){var e=(0,o.Z)(p().mark(function e(t,r,n){var o,a,s;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,vs.formatJsonRpcRequest)(r,n),e.next=3,i.core.crypto.encode(t,o);case 3:return a=e.sent,s=Rs[r].req,e.abrupt("return",(i.core.history.set(t,o),i.core.relayer.publish(t,a,s),o.id));case 6:case"end":return e.stop()}},e)}));return function(t,r,n){return e.apply(this,arguments)}}()),df(this,"sendResult",function(){var e=(0,o.Z)(p().mark(function e(t,r,n){var o,a,s,c;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,vs.formatJsonRpcResult)(t,n),e.next=3,i.core.crypto.encode(r,o);case 3:return a=e.sent,e.next=6,i.core.history.get(r,t);case 6:return s=e.sent.request.method,c=Rs[s].res,e.next=10,i.core.relayer.publish(r,a,c);case 10:return e.next=12,i.core.history.resolve(o);case 12:case"end":return e.stop()}},e)}));return function(t,r,n){return e.apply(this,arguments)}}()),df(this,"sendError",function(){var e=(0,o.Z)(p().mark(function e(t,r,n){var o,a,s,c;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,vs.formatJsonRpcError)(t,n),e.next=3,i.core.crypto.encode(r,o);case 3:return a=e.sent,e.next=6,i.core.history.get(r,t);case 6:return s=e.sent.request.method,c=Rs[s]?Rs[s].res:Rs.unregistered_method.res,e.next=10,i.core.relayer.publish(r,a,c);case 10:return e.next=12,i.core.history.resolve(o);case 12:case"end":return e.stop()}},e)}));return function(t,r,n){return e.apply(this,arguments)}}()),df(this,"deletePairing",function(){var e=(0,o.Z)(p().mark(function e(t,r){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.core.relayer.unsubscribe(t);case 2:return e.next=4,Promise.all([i.pairings.delete(t,Ta("USER_DISCONNECTED")),i.core.crypto.deleteSymKey(t),r?Promise.resolve():i.core.expirer.del(t)]);case 4:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()),df(this,"cleanup",(0,o.Z)(p().mark(function e(){var t;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.pairings.getAll().filter(function(e){return Ue(e.expiry)}),e.next=3,Promise.all(t.map(function(e){return i.deletePairing(e.topic)}));case 3:case"end":return e.stop()}},e)}))),df(this,"onRelayEventRequest",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=t.topic,n=t.payload,e.t0=n.method,e.next="wc_pairingPing"===e.t0?4:"wc_pairingDelete"===e.t0?7:10;break;case 4:return e.next=6,i.onPairingPingRequest(r,n);case 6:case 9:case 12:return e.abrupt("return",e.sent);case 7:return e.next=9,i.onPairingDeleteRequest(r,n);case 10:return e.next=12,i.onUnknownRpcMethodRequest(r,n);case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),df(this,"onRelayEventResponse",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,o;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.topic,n=t.payload,e.next=4,i.core.history.get(r,n.id);case 4:return o=e.sent.request.method,e.abrupt("return","wc_pairingPing"===o?i.onPairingPingResponse(r,n):i.onUnknownRpcMethodResponse(o));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),df(this,"onPairingPingRequest",function(){var e=(0,o.Z)(p().mark(function e(t,r){var n;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.id,e.prev=1,i.isValidPing({topic:t}),e.next=5,i.sendResult(n,t,!0);case 5:i.events.emit("pairing_ping",{id:n,topic:t}),e.next=13;break;case 8:return e.prev=8,e.t0=e.catch(1),e.next=12,i.sendError(n,t,e.t0);case 12:i.logger.error(e.t0);case 13:case"end":return e.stop()}},e,null,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}()),df(this,"onPairingPingResponse",function(e,t){var r=t.id;setTimeout(function(){(0,vs.isJsonRpcResult)(t)?n.events.emit(Ne("pairing_ping",r),{}):(0,vs.isJsonRpcError)(t)&&n.events.emit(Ne("pairing_ping",r),{error:t.error})},500)}),df(this,"onPairingDeleteRequest",function(){var e=(0,o.Z)(p().mark(function e(t,r){var n;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.id,e.prev=1,i.isValidDisconnect({topic:t}),e.next=5,i.deletePairing(t);case 5:i.events.emit("pairing_delete",{id:n,topic:t}),e.next=13;break;case 8:return e.prev=8,e.t0=e.catch(1),e.next=12,i.sendError(n,t,e.t0);case 12:i.logger.error(e.t0);case 13:case"end":return e.stop()}},e,null,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}()),df(this,"onUnknownRpcMethodRequest",function(){var e=(0,o.Z)(p().mark(function e(t,r){var n,o,a;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.id,o=r.method,e.prev=1,!i.registeredMethods.includes(o)){e.next=4;break}return e.abrupt("return");case 4:return a=Ta("WC_METHOD_UNSUPPORTED",o),e.next=7,i.sendError(n,t,a);case 7:i.logger.error(a),e.next=15;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,i.sendError(n,t,e.t0);case 14:i.logger.error(e.t0);case 15:case"end":return e.stop()}},e,null,[[1,10]])}));return function(t,r){return e.apply(this,arguments)}}()),df(this,"onUnknownRpcMethodResponse",function(e){n.registeredMethods.includes(e)||n.logger.error(Ta("WC_METHOD_UNSUPPORTED",e))}),df(this,"isValidPair",function(e,t){var r;if(!Za(e)){var n=Ra("MISSING_OR_INVALID","pair() params: ".concat(e)).message;throw t.setError("malformed_pairing_uri"),new Error(n)}if(!function(e){function t(e){try{return typeof new URL(e)<"u"}catch(t){return!1}}try{if(Na(e,!1))return!!t(e)||t(Ke(e))}catch(r){}return!1}(e.uri)){var i=Ra("MISSING_OR_INVALID","pair() uri: ".concat(e.uri)).message;throw t.setError("malformed_pairing_uri"),new Error(i)}var o=ua(null==e?void 0:e.uri);if(null==(r=null==o?void 0:o.relay)||!r.protocol){var a=Ra("MISSING_OR_INVALID","pair() uri#relay-protocol").message;throw t.setError("malformed_pairing_uri"),new Error(a)}if(null==o||!o.symKey){var s=Ra("MISSING_OR_INVALID","pair() uri#symKey").message;throw t.setError("malformed_pairing_uri"),new Error(s)}if(null!=o&&o.expiryTimestamp&&(0,d.toMiliseconds)(null==o?void 0:o.expiryTimestamp)<Date.now()){t.setError("pairing_expired");var c=Ra("EXPIRED","pair() URI has expired. Please try again with a new connection URI.").message;throw new Error(c)}}),df(this,"isValidPing",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,o;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Za(t)){e.next=3;break}throw r=Ra("MISSING_OR_INVALID","ping() params: ".concat(t)),n=r.message,new Error(n);case 3:return o=t.topic,e.next=6,i.isValidPairingTopic(o);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),df(this,"isValidDisconnect",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,o;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Za(t)){e.next=3;break}throw r=Ra("MISSING_OR_INVALID","disconnect() params: ".concat(t)),n=r.message,new Error(n);case 3:return o=t.topic,e.next=6,i.isValidPairingTopic(o);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),df(this,"isValidPairingTopic",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,o,a,s,c;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Na(t,!1)){e.next=3;break}throw r=Ra("MISSING_OR_INVALID","pairing topic should be a string: ".concat(t)),n=r.message,new Error(n);case 3:if(i.pairings.keys.includes(t)){e.next=6;break}throw o=Ra("NO_MATCHING_KEY","pairing topic doesn't exist: ".concat(t)),a=o.message,new Error(a);case 6:if(!Ue(i.pairings.get(t).expiry)){e.next=11;break}return e.next=9,i.deletePairing(t);case 9:throw s=Ra("EXPIRED","pairing topic: ".concat(t)),c=s.message,new Error(c);case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),this.core=t,this.logger=(0,oe.Ep)(r,this.name),this.pairings=new pf(this.core,this.logger,this.name,this.storagePrefix)}return x(e,[{key:"context",get:function(){return(0,oe.Fd)(this.logger)}},{key:"isInitialized",value:function(){if(!this.initialized){var e=Ra("NOT_INITIALIZED",this.name).message;throw new Error(e)}}},{key:"registerRelayerEvents",value:function(){var e=this;this.core.relayer.on("relayer_message",function(){var t=(0,o.Z)(p().mark(function t(r){var n,i,o,a;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.topic,i=r.message,o=r.transportType,!e.pairings.keys.includes(n)||o===Ss||e.ignoredPayloadTypes.includes(e.core.crypto.getPayloadType(i))){t.next=26;break}return t.prev=2,t.next=5,e.core.crypto.decode(n,i);case 5:if(a=t.sent,!(0,vs.isJsonRpcRequest)(a)){t.next=12;break}return e.core.history.set(n,a),t.next=10,e.onRelayEventRequest({topic:n,payload:a});case 10:t.next=19;break;case 12:if(t.t0=(0,vs.isJsonRpcResponse)(a),!t.t0){t.next=19;break}return t.next=16,e.core.history.resolve(a);case 16:return t.next=18,e.onRelayEventResponse({topic:n,payload:a});case 18:e.core.history.delete(n,a.id);case 19:return t.next=21,e.core.relayer.messages.ack(n,i);case 21:t.next=26;break;case 23:t.prev=23,t.t1=t.catch(2),e.logger.error(t.t1);case 26:case"end":return t.stop()}},t,null,[[2,23]])}));return function(e){return t.apply(this,arguments)}}())}},{key:"registerExpirerEvents",value:function(){var e=this;this.core.expirer.on(Ts,function(){var t=(0,o.Z)(p().mark(function t(r){var n,i;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=Be(r.target),i=n.topic,t.t0=i&&e.pairings.keys.includes(i),!t.t0){t.next=6;break}return t.next=5,e.deletePairing(i,!0);case 5:e.events.emit("pairing_expire",{topic:i});case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())}}]),e}(),gf=Object.defineProperty,yf=function(e,t,r){return function(e,t,r){return t in e?gf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r}(e,"symbol"!=typeof t?t+"":t,r)},bf=function(e){h(r,e);var t=v(r);function r(e,n){var i,a;return k(this,r),i=t.call(this,e,n),a=y(i),i.core=e,i.logger=n,yf(y(i),"records",new Map),yf(y(i),"events",new f.EventEmitter),yf(y(i),"name","history"),yf(y(i),"version","0.3"),yf(y(i),"cached",[]),yf(y(i),"initialized",!1),yf(y(i),"storagePrefix",ys),yf(y(i),"init",(0,o.Z)(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=a.initialized,e.t0){e.next=9;break}return a.logger.trace("Initialized"),e.next=5,a.restore();case 5:a.cached.forEach(function(e){return a.records.set(e.id,e)}),a.cached=[],a.registerEventListeners(),a.initialized=!0;case 9:case"end":return e.stop()}},e)}))),yf(y(i),"set",function(e,t,r){if(i.isInitialized(),i.logger.debug("Setting JSON-RPC request history record"),i.logger.trace({type:"method",method:"set",topic:e,request:t,chainId:r}),!i.records.has(t.id)){var n={id:t.id,topic:e,request:{method:t.method,params:t.params||null},chainId:r,expiry:Ce(d.THIRTY_DAYS)};i.records.set(n.id,n),i.persist(),i.events.emit("history_created",n)}}),yf(y(i),"resolve",function(){var e=(0,o.Z)(p().mark(function e(t){var r;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.isInitialized(),a.logger.debug("Updating JSON-RPC response history record"),a.logger.trace({type:"method",method:"update",response:t}),a.records.has(t.id)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,a.getRecord(t.id);case 4:typeof(r=e.sent).response>"u"&&(r.response=(0,vs.isJsonRpcError)(t)?{error:t.error}:{result:t.result},a.records.set(r.id,r),a.persist(),a.events.emit("history_updated",r));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),yf(y(i),"get",function(){var e=(0,o.Z)(p().mark(function e(t,r){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.isInitialized(),a.logger.debug("Getting record"),a.logger.trace({type:"method",method:"get",topic:t,id:r}),e.next=5,a.getRecord(r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()),yf(y(i),"delete",function(e,t){i.isInitialized(),i.logger.debug("Deleting record"),i.logger.trace({type:"method",method:"delete",id:t}),i.values.forEach(function(r){if(r.topic===e){if(typeof t<"u"&&r.id!==t)return;i.records.delete(r.id),i.events.emit("history_deleted",r)}}),i.persist()}),yf(y(i),"exists",function(){var e=(0,o.Z)(p().mark(function e(t,r){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.isInitialized(),e.t0=!!a.records.has(r),!e.t0){e.next=8;break}return e.next=5,a.getRecord(r);case 5:e.t1=e.sent.topic,e.t2=t,e.t0=e.t1===e.t2;case 8:return e.abrupt("return",e.t0);case 9:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()),yf(y(i),"on",function(e,t){i.events.on(e,t)}),yf(y(i),"once",function(e,t){i.events.once(e,t)}),yf(y(i),"off",function(e,t){i.events.off(e,t)}),yf(y(i),"removeListener",function(e,t){i.events.removeListener(e,t)}),i.logger=(0,oe.Ep)(n,i.name),i}return x(r,[{key:"context",get:function(){return(0,oe.Fd)(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}},{key:"size",get:function(){return this.records.size}},{key:"keys",get:function(){return Array.from(this.records.keys())}},{key:"values",get:function(){return Array.from(this.records.values())}},{key:"pending",get:function(){var e=[];return this.values.forEach(function(t){if(!(typeof t.response<"u")){var r={topic:t.topic,request:(0,vs.formatJsonRpcRequest)(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(r)}}),e}},{key:"setJsonRpcRecords",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.core.storage.setItem(t.storageKey,e);case 2:case"end":return r.stop()}},r)}))()}},{key:"getJsonRpcRecords",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.core.storage.getItem(e.storageKey);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}))()}},{key:"getRecord",value:function(e){this.isInitialized();var t=this.records.get(e);if(!t){var r=Ra("NO_MATCHING_KEY","".concat(this.name,": ").concat(e)).message;throw new Error(r)}return t}},{key:"persist",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setJsonRpcRecords(e.values);case 2:e.events.emit("history_sync");case 3:case"end":return t.stop()}},t)}))()}},{key:"restore",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){var r,n,i;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getJsonRpcRecords();case 3:if(!(typeof(r=t.sent)>"u")&&r.length){t.next=6;break}return t.abrupt("return");case 6:if(!e.records.size){t.next=9;break}throw n=Ra("RESTORE_WILL_OVERRIDE",e.name),i=n.message,e.logger.error(i),new Error(i);case 9:e.cached=r,e.logger.debug("Successfully Restored records for ".concat(e.name)),e.logger.trace({type:"method",method:"restore",records:e.values}),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),e.logger.debug("Failed to Restore records for ".concat(e.name)),e.logger.error(t.t0);case 15:case"end":return t.stop()}},t,null,[[0,12]])}))()}},{key:"registerEventListeners",value:function(){var e=this;this.events.on("history_created",function(t){var r="history_created";e.logger.info("Emitting ".concat(r)),e.logger.debug({type:"event",event:r,record:t})}),this.events.on("history_updated",function(t){var r="history_updated";e.logger.info("Emitting ".concat(r)),e.logger.debug({type:"event",event:r,record:t})}),this.events.on("history_deleted",function(t){var r="history_deleted";e.logger.info("Emitting ".concat(r)),e.logger.debug({type:"event",event:r,record:t})}),this.core.heartbeat.on($a.Lx.pulse,function(){e.cleanup()})}},{key:"cleanup",value:function(){var e=this;try{this.isInitialized();var t=!1;this.records.forEach(function(r){(0,d.toMiliseconds)(r.expiry||0)-Date.now()<=0&&(e.logger.info("Deleting expired history log: ".concat(r.id)),e.records.delete(r.id),e.events.emit("history_deleted",r,!1),t=!0)}),t&&this.persist()}catch(Wt){this.logger.warn(Wt)}}},{key:"isInitialized",value:function(){if(!this.initialized){var e=Ra("NOT_INITIALIZED",this.name).message;throw new Error(e)}}}]),r}(as),mf=Object.defineProperty,wf=function(e,t,r){return function(e,t,r){return t in e?mf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r}(e,"symbol"!=typeof t?t+"":t,r)},xf=function(e){h(r,e);var t=v(r);function r(e,n){var i,a;return k(this,r),i=t.call(this,e,n),a=y(i),i.core=e,i.logger=n,wf(y(i),"expirations",new Map),wf(y(i),"events",new f.EventEmitter),wf(y(i),"name","expirer"),wf(y(i),"version","0.3"),wf(y(i),"cached",[]),wf(y(i),"initialized",!1),wf(y(i),"storagePrefix",ys),wf(y(i),"init",(0,o.Z)(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=a.initialized,e.t0){e.next=9;break}return a.logger.trace("Initialized"),e.next=5,a.restore();case 5:a.cached.forEach(function(e){return a.expirations.set(e.target,e)}),a.cached=[],a.registerEventListeners(),a.initialized=!0;case 9:case"end":return e.stop()}},e)}))),wf(y(i),"has",function(e){try{var t=i.formatTarget(e);return typeof i.getExpiration(t)<"u"}catch(r){return!1}}),wf(y(i),"set",function(e,t){i.isInitialized();var r=i.formatTarget(e),n={target:r,expiry:t};i.expirations.set(r,n),i.checkExpiry(r,n),i.events.emit("expirer_created",{target:r,expiration:n})}),wf(y(i),"get",function(e){i.isInitialized();var t=i.formatTarget(e);return i.getExpiration(t)}),wf(y(i),"del",function(e){if(i.isInitialized(),i.has(e)){var t=i.formatTarget(e),r=i.getExpiration(t);i.expirations.delete(t),i.events.emit("expirer_deleted",{target:t,expiration:r})}}),wf(y(i),"on",function(e,t){i.events.on(e,t)}),wf(y(i),"once",function(e,t){i.events.once(e,t)}),wf(y(i),"off",function(e,t){i.events.off(e,t)}),wf(y(i),"removeListener",function(e,t){i.events.removeListener(e,t)}),i.logger=(0,oe.Ep)(n,i.name),i}return x(r,[{key:"context",get:function(){return(0,oe.Fd)(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}},{key:"length",get:function(){return this.expirations.size}},{key:"keys",get:function(){return Array.from(this.expirations.keys())}},{key:"values",get:function(){return Array.from(this.expirations.values())}},{key:"formatTarget",value:function(e){if("string"==typeof e)return function(e){return Te("topic",e)}(e);if("number"==typeof e)return function(e){return Te("id",e)}(e);var t=Ra("UNKNOWN_TYPE","Target type: "+typeof e).message;throw new Error(t)}},{key:"setExpirations",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.core.storage.setItem(t.storageKey,e);case 2:case"end":return r.stop()}},r)}))()}},{key:"getExpirations",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.core.storage.getItem(e.storageKey);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}))()}},{key:"persist",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setExpirations(e.values);case 2:e.events.emit("expirer_sync");case 3:case"end":return t.stop()}},t)}))()}},{key:"restore",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){var r,n,i;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getExpirations();case 3:if(!(typeof(r=t.sent)>"u")&&r.length){t.next=6;break}return t.abrupt("return");case 6:if(!e.expirations.size){t.next=9;break}throw n=Ra("RESTORE_WILL_OVERRIDE",e.name),i=n.message,e.logger.error(i),new Error(i);case 9:e.cached=r,e.logger.debug("Successfully Restored expirations for ".concat(e.name)),e.logger.trace({type:"method",method:"restore",expirations:e.values}),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),e.logger.debug("Failed to Restore expirations for ".concat(e.name)),e.logger.error(t.t0);case 15:case"end":return t.stop()}},t,null,[[0,12]])}))()}},{key:"getExpiration",value:function(e){var t=this.expirations.get(e);if(!t){var r=Ra("NO_MATCHING_KEY","".concat(this.name,": ").concat(e)).message;throw this.logger.warn(r),new Error(r)}return t}},{key:"checkExpiry",value:function(e,t){var r=t.expiry;(0,d.toMiliseconds)(r)-Date.now()<=0&&this.expire(e,t)}},{key:"expire",value:function(e,t){this.expirations.delete(e),this.events.emit(Ts,{target:e,expiration:t})}},{key:"checkExpirations",value:function(){var e=this;this.core.relayer.connected&&this.expirations.forEach(function(t,r){return e.checkExpiry(r,t)})}},{key:"registerEventListeners",value:function(){var e=this;this.core.heartbeat.on($a.Lx.pulse,function(){return e.checkExpirations()}),this.events.on("expirer_created",function(t){var r="expirer_created";e.logger.info("Emitting ".concat(r)),e.logger.debug({type:"event",event:r,data:t}),e.persist()}),this.events.on(Ts,function(t){var r=Ts;e.logger.info("Emitting ".concat(r)),e.logger.debug({type:"event",event:r,data:t}),e.persist()}),this.events.on("expirer_deleted",function(t){var r="expirer_deleted";e.logger.info("Emitting ".concat(r)),e.logger.debug({type:"event",event:r,data:t}),e.persist()})}},{key:"isInitialized",value:function(){if(!this.initialized){var e=Ra("NOT_INITIALIZED",this.name).message;throw new Error(e)}}}]),r}(fs),kf=Object.defineProperty,Ef=function(e,t,r){return function(e,t,r){return t in e?kf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r}(e,"symbol"!=typeof t?t+"":t,r)},If=function(e){h(r,e);var t=v(r);function r(e,n,a){var s,c;return k(this,r),s=t.call(this,e,n,a),c=y(s),s.core=e,s.logger=n,s.store=a,Ef(y(s),"name","verify-api"),Ef(y(s),"abortController"),Ef(y(s),"isDevEnv"),Ef(y(s),"verifyUrlV3",Us),Ef(y(s),"storagePrefix",ys),Ef(y(s),"version",2),Ef(y(s),"publicKey"),Ef(y(s),"fetchPromise"),Ef(y(s),"init",(0,o.Z)(p().mark(function e(){var t;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=c.isDevEnv,e.t0){e.next=10;break}return e.next=4,c.store.getItem(c.storeKey);case 4:if(c.publicKey=e.sent,e.t1=c.publicKey&&(0,d.toMiliseconds)(null==(t=c.publicKey)?void 0:t.expiresAt)<Date.now(),!e.t1){e.next=10;break}return c.logger.debug("verify v2 public key expired"),e.next=10,c.removePublicKey();case 10:case"end":return e.stop()}},e)}))),Ef(y(s),"register",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,a,s,u;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(xe()&&!c.isDevEnv){e.next=2;break}return e.abrupt("return");case 2:return r=window.location.origin,n=t.id,i=t.decryptedId,o="".concat(c.verifyUrlV3,"/attestation?projectId=").concat(c.core.projectId,"&origin=").concat(r,"&id=").concat(n,"&decryptedId=").concat(i),e.prev=3,a=(0,b.getDocument)(),s=c.startAbortTimer(5*d.ONE_SECOND),e.next=8,new Promise(function(e,t){var r=function(){window.removeEventListener("message",u),a.body.removeChild(i),t("attestation aborted")};c.abortController.signal.addEventListener("abort",r);var i=a.createElement("iframe");i.src=o,i.style.display="none",i.addEventListener("error",r,{signal:c.abortController.signal});var u=function t(o){if(o.data&&"string"==typeof o.data)try{var u=JSON.parse(o.data);if("verify_attestation"===u.type){if((0,te.xp)(u.attestation).payload.id!==n)return;clearInterval(s),a.body.removeChild(i),c.abortController.signal.removeEventListener("abort",r),window.removeEventListener("message",t),e(null===u.attestation?"":u.attestation)}}catch(u){c.logger.warn(u)}};a.body.appendChild(i),window.addEventListener("message",u,{signal:c.abortController.signal})});case 8:return u=e.sent,e.abrupt("return",(c.logger.debug(u,"jwt attestation"),u));case 12:e.prev=12,e.t0=e.catch(3),c.logger.warn(e.t0);case 15:return e.abrupt("return","");case 16:case"end":return e.stop()}},e,null,[[3,12]])}));return function(t){return e.apply(this,arguments)}}()),Ef(y(s),"resolve",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,a;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.isDevEnv){e.next=2;break}return e.abrupt("return","");case 2:if(r=t.attestationId,n=t.hash,i=t.encryptedId,""!==r){e.next=5;break}return e.abrupt("return",void c.logger.debug("resolve: attestationId is empty, skipping"));case 5:if(!r){e.next=13;break}if((0,te.xp)(r).payload.id===i){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,c.isValidJwtAttestation(r);case 10:if(!(o=e.sent)){e.next=13;break}return e.abrupt("return",o.isVerified?o:void c.logger.warn("resolve: jwt attestation: origin url not verified"));case 13:if(n){e.next=15;break}return e.abrupt("return");case 15:return a=c.getVerifyUrl(null==t?void 0:t.verifyUrl),e.abrupt("return",c.fetchAttestation(n,a));case 17:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Ef(y(s),"fetchAttestation",function(){var e=(0,o.Z)(p().mark(function e(t,r){var n,i;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c.logger.debug("resolving attestation: ".concat(t," from url: ").concat(r)),n=c.startAbortTimer(5*d.ONE_SECOND),e.next=4,fetch("".concat(r,"/attestation/").concat(t,"?v2Supported=true"),{signal:c.abortController.signal});case 4:if(i=e.sent,clearTimeout(n),200!==i.status){e.next=12;break}return e.next=9,i.json();case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=void 0;case 13:return e.abrupt("return",e.t0);case 14:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()),Ef(y(s),"getVerifyUrl",function(e){var t=e||Cs;return Ns.includes(t)||(s.logger.info("verify url: ".concat(t,", not included in trusted list, assigning default: ").concat(Cs)),t=Cs),t}),Ef(y(s),"fetchPublicKey",(0,o.Z)(p().mark(function e(){var t,r;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c.logger.debug("fetching public key from: ".concat(c.verifyUrlV3)),t=c.startAbortTimer(d.FIVE_SECONDS),e.next=5,fetch("".concat(c.verifyUrlV3,"/public-key"),{signal:c.abortController.signal});case 5:return r=e.sent,clearTimeout(t),e.next=9,r.json();case 9:return e.abrupt("return",e.sent);case 12:e.prev=12,e.t0=e.catch(0),c.logger.warn(e.t0);case 15:case"end":return e.stop()}},e,null,[[0,12]])}))),Ef(y(s),"persistPublicKey",function(){var e=(0,o.Z)(p().mark(function e(t){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c.logger.debug(t,"persisting public key to local storage"),e.next=3,c.store.setItem(c.storeKey,t);case 3:c.publicKey=t;case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Ef(y(s),"removePublicKey",(0,o.Z)(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c.logger.debug("removing verify v2 public key from storage"),e.next=3,c.store.removeItem(c.storeKey);case 3:c.publicKey=void 0;case 4:case"end":return e.stop()}},e)}))),Ef(y(s),"isValidJwtAttestation",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.getPublicKey();case 2:if(r=e.sent,e.prev=3,!r){e.next=6;break}return e.abrupt("return",c.validateAttestation(t,r));case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),c.logger.error(e.t0),c.logger.warn("error validating attestation");case 11:return e.next=13,c.fetchAndPersistPublicKey();case 13:if(n=e.sent,e.prev=14,!n){e.next=17;break}return e.abrupt("return",c.validateAttestation(t,n));case 17:e.next=22;break;case 19:e.prev=19,e.t1=e.catch(14),c.logger.error(e.t1),c.logger.warn("error validating attestation");case 22:case"end":return e.stop()}},e,null,[[3,8],[14,19]])}));return function(t){return e.apply(this,arguments)}}()),Ef(y(s),"getPublicKey",(0,o.Z)(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.publicKey){e.next=4;break}e.t0=c.publicKey,e.next=7;break;case 4:return e.next=6,c.fetchAndPersistPublicKey();case 6:e.t0=e.sent;case 7:return e.abrupt("return",e.t0);case 8:case"end":return e.stop()}},e)}))),Ef(y(s),"fetchAndPersistPublicKey",(0,o.Z)(p().mark(function e(){var t;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.fetchPromise){e.next=4;break}return e.next=3,c.fetchPromise;case 3:return e.abrupt("return",c.publicKey);case 4:return c.fetchPromise=new Promise(function(){var e=(0,o.Z)(p().mark(function e(t){var r;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.fetchPublicKey();case 2:if(r=e.sent,e.t0=r,!e.t0){e.next=8;break}return e.next=7,c.persistPublicKey(r);case 7:t(r);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),e.next=7,c.fetchPromise;case 7:return t=e.sent,e.abrupt("return",(c.fetchPromise=void 0,t));case 9:case"end":return e.stop()}},e)}))),Ef(y(s),"validateAttestation",function(e,t){var r=function(e,t){var r=i(e.split("."),3),n=r[0],o=r[1],a=r[2],s=Buffer.from(Ho(a),"base64");if(64!==s.length)throw new Error("Invalid signature length");var c=s.slice(0,32),u=s.slice(32,64),f=ei("".concat(n,".").concat(o)),l=function(e){var t=Buffer.from(e.x,"base64"),r=Buffer.from(e.y,"base64");return(0,re.zo)([new Uint8Array([4]),t,r])}(t);if(!No.verify((0,re.zo)([c,u]),f,l))throw new Error("Invalid signature");return(0,te.xp)(e).payload}(e,t.publicKey),n={hasExpired:(0,d.toMiliseconds)(r.exp)<Date.now(),payload:r};if(n.hasExpired)throw s.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:n.payload.origin,isScam:n.payload.isScam,isVerified:n.payload.isVerified}}),s.logger=(0,oe.Ep)(n,s.name),s.abortController=new AbortController,s.isDevEnv=Fe(),s.init(),s}return x(r,[{key:"storeKey",get:function(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}},{key:"context",get:function(){return(0,oe.Fd)(this.logger)}},{key:"startAbortTimer",value:function(e){var t=this;return this.abortController=new AbortController,setTimeout(function(){return t.abortController.abort()},(0,d.toMiliseconds)(e))}}]),r}(function(){return x(function e(t,r,n){k(this,e),this.core=t,this.logger=r,this.store=n})}()),Sf=Object.defineProperty,Of=function(e,t,r){return function(e,t,r){return t in e?Sf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r}(e,"symbol"!=typeof t?t+"":t,r)},_f=function(e){h(r,e);var t=v(r);function r(e,n){var i,a;return k(this,r),i=t.call(this,e,n),a=y(i),i.projectId=e,i.logger=n,Of(y(i),"context","echo"),Of(y(i),"registerDeviceToken",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s,c;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.clientId,n=t.token,i=t.notificationType,o=t.enableEncrypted,s=void 0!==o&&o,c="https://echo.walletconnect.com/".concat(a.projectId,"/clients"),e.next=3,fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:r,type:i,token:n,always_raw:s})});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),i.logger=(0,oe.Ep)(n,i.context),i}return x(r)}(function(){return x(function e(t,r){k(this,e),this.projectId=t,this.logger=r})}()),Pf=Object.defineProperty,Af=Object.getOwnPropertySymbols,Rf=Object.prototype.hasOwnProperty,Tf=Object.prototype.propertyIsEnumerable,Bf=function(e,t,r){return t in e?Pf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Cf=function(e,t){for(var r in t||(t={}))Rf.call(t,r)&&Bf(e,r,t[r]);if(Af){var n,i=u(Af(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Tf.call(t,r)&&Bf(e,r,t[r])}}catch(o){i.e(o)}finally{i.f()}}return e},Uf=function(e,t,r){return Bf(e,"symbol"!=typeof t?t+"":t,r)},Nf=function(e){h(r,e);var t=v(r);function r(e,n){var a,s,c=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return k(this,r),a=t.call(this,e,n,c),s=y(a),a.core=e,a.logger=n,Uf(y(a),"context","event-client"),Uf(y(a),"storagePrefix",ys),Uf(y(a),"storageVersion",.1),Uf(y(a),"events",new Map),Uf(y(a),"shouldPersist",!1),Uf(y(a),"init",(0,o.Z)(p().mark(function e(){var t;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Fe()){e.next=19;break}return e.prev=1,e.t0=Ze(),e.t1=Date.now(),e.t2=s.getAppDomain(),e.next=7,s.core.crypto.getClientId();case 7:return e.t3=e.sent,e.t4=Se(s.core.relayer.protocol,s.core.relayer.version,Is),e.t5={client_id:e.t3,user_agent:e.t4},e.t6={event:"INIT",type:"",properties:e.t5},t={eventId:e.t0,timestamp:e.t1,domain:e.t2,props:e.t6},e.next=14,s.sendEvent([t]);case 14:e.next=19;break;case 16:e.prev=16,e.t7=e.catch(1),s.logger.warn(e.t7);case 19:case"end":return e.stop()}},e,null,[[1,16]])}))),Uf(y(a),"createEvent",function(e){var t=e.event,r=void 0===t?"ERROR":t,n=e.type,i=void 0===n?"":n,o=e.properties,s=o.topic,c=o.trace,u=Ze(),f=a.core.projectId||"",l=Date.now(),p=Cf({eventId:u,timestamp:l,props:{event:r,type:i,properties:{topic:s,trace:c}},bundleId:f,domain:a.getAppDomain()},a.setMethods(u));return a.telemetryEnabled&&(a.events.set(u,p),a.shouldPersist=!0),p}),Uf(y(a),"getEvent",function(e){var t=e.eventId,r=e.topic;if(t)return a.events.get(t);var n=Array.from(a.events.values()).find(function(e){return e.props.properties.topic===r});return n?Cf(Cf({},n),a.setMethods(n.eventId)):void 0}),Uf(y(a),"deleteEvent",function(e){var t=e.eventId;a.events.delete(t),a.shouldPersist=!0}),Uf(y(a),"setEventListeners",function(){a.core.heartbeat.on($a.Lx.pulse,(0,o.Z)(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=s.shouldPersist,!e.t0){e.next=4;break}return e.next=4,s.persist();case 4:s.events.forEach(function(e){(0,d.fromMiliseconds)(Date.now())-(0,d.fromMiliseconds)(e.timestamp)>86400&&(s.events.delete(e.eventId),s.shouldPersist=!0)});case 5:case"end":return e.stop()}},e)})))}),Uf(y(a),"setMethods",function(e){return{addTrace:function(t){return a.addTrace(e,t)},setError:function(t){return a.setError(e,t)}}}),Uf(y(a),"addTrace",function(e,t){var r=a.events.get(e);r&&(r.props.properties.trace.push(t),a.events.set(e,r),a.shouldPersist=!0)}),Uf(y(a),"setError",function(e,t){var r=a.events.get(e);r&&(r.props.type=t,r.timestamp=Date.now(),a.events.set(e,r),a.shouldPersist=!0)}),Uf(y(a),"persist",(0,o.Z)(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.core.storage.setItem(s.storageKey,Array.from(s.events.values()));case 2:s.shouldPersist=!1;case 3:case"end":return e.stop()}},e)}))),Uf(y(a),"restore",(0,o.Z)(p().mark(function e(){var t;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.core.storage.getItem(s.storageKey);case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0=[];case 6:if((t=e.t0).length){e.next=9;break}return e.abrupt("return");case 9:t.forEach(function(e){s.events.set(e.eventId,Cf(Cf({},e),s.setMethods(e.eventId)))}),e.next=15;break;case 12:e.prev=12,e.t1=e.catch(0),s.logger.warn(e.t1);case 15:case"end":return e.stop()}},e,null,[[0,12]])}))),Uf(y(a),"submit",(0,o.Z)(p().mark(function e(){var t,r,n,o,a,c,f,l;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s.telemetryEnabled&&0!==s.events.size){e.next=2;break}return e.abrupt("return");case 2:t=[],r=u(s.events);try{for(r.s();!(n=r.n()).done;)o=i(n.value,2),o[0],(a=o[1]).props.type&&t.push(a)}catch(p){r.e(p)}finally{r.f()}if(0===t.length){e.next=17;break}return e.prev=6,e.next=9,s.sendEvent(t);case 9:if(!e.sent.ok){e.next=12;break}c=u(t);try{for(c.s();!(f=c.n()).done;)l=f.value,s.events.delete(l.eventId),s.shouldPersist=!0}catch(p){c.e(p)}finally{c.f()}case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(6),s.logger.warn(e.t0);case 17:case"end":return e.stop()}},e,null,[[6,14]])}))),Uf(y(a),"sendEvent",function(){var e=(0,o.Z)(p().mark(function e(t){var r;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.getAppDomain()?"":"&sp=desktop",e.next=3,fetch("https://pulse.walletconnect.org/batch?projectId=".concat(s.core.projectId,"&st=events_sdk&sv=js-").concat(Is).concat(r),{method:"POST",body:JSON.stringify(t)});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Uf(y(a),"getAppDomain",function(){return Ie().url}),a.logger=(0,oe.Ep)(n,a.context),a.telemetryEnabled=c,c?a.restore().then((0,o.Z)(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.submit();case 2:s.setEventListeners();case 3:case"end":return e.stop()}},e)}))):a.persist(),a}return x(r,[{key:"storageKey",get:function(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}]),r}(function(){return x(function e(t,r,n){k(this,e),this.core=t,this.logger=r,this.telemetryEnabled=n})}()),jf=Object.defineProperty,Lf=Object.getOwnPropertySymbols,Df=Object.prototype.hasOwnProperty,Mf=Object.prototype.propertyIsEnumerable,qf=function(e,t,r){return t in e?jf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},zf=function(e,t){for(var r in t||(t={}))Df.call(t,r)&&qf(e,r,t[r]);if(Lf){var n,i=u(Lf(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Mf.call(t,r)&&qf(e,r,t[r])}}catch(o){i.e(o)}finally{i.f()}}return e},Zf=function(e,t,r){return qf(e,"symbol"!=typeof t?t+"":t,r)},Ff=function(e){h(r,e);var t=v(r);function r(e){var n,i,a;k(this,r),n=t.call(this,e),i=y(n),Zf(y(n),"protocol","wc"),Zf(y(n),"version",2),Zf(y(n),"name","core"),Zf(y(n),"relayUrl"),Zf(y(n),"projectId"),Zf(y(n),"customStoragePrefix"),Zf(y(n),"events",new f.EventEmitter),Zf(y(n),"logger"),Zf(y(n),"heartbeat"),Zf(y(n),"relayer"),Zf(y(n),"crypto"),Zf(y(n),"storage"),Zf(y(n),"history"),Zf(y(n),"expirer"),Zf(y(n),"pairing"),Zf(y(n),"verify"),Zf(y(n),"echoClient"),Zf(y(n),"linkModeSupportedApps"),Zf(y(n),"eventClient"),Zf(y(n),"initialized",!1),Zf(y(n),"logChunkController"),Zf(y(n),"on",function(e,t){return n.events.on(e,t)}),Zf(y(n),"once",function(e,t){return n.events.once(e,t)}),Zf(y(n),"off",function(e,t){return n.events.off(e,t)}),Zf(y(n),"removeListener",function(e,t){return n.events.removeListener(e,t)}),Zf(y(n),"dispatchEnvelope",function(e){var t=e.topic,r=e.message,i=e.sessionExists;if(t&&r){var o={topic:t,message:r,publishedAt:Date.now(),transportType:Ss};n.relayer.onLinkMessageEvent(o,{sessionExists:i})}});var s=n.getGlobalCore(null==e?void 0:e.customStoragePrefix);if(s)try{return g(n,(n.customStoragePrefix=s.customStoragePrefix,n.logger=s.logger,n.heartbeat=s.heartbeat,n.crypto=s.crypto,n.history=s.history,n.expirer=s.expirer,n.storage=s.storage,n.relayer=s.relayer,n.pairing=s.pairing,n.verify=s.verify,n.echoClient=s.echoClient,n.linkModeSupportedApps=s.linkModeSupportedApps,n.eventClient=s.eventClient,n.initialized=s.initialized,n.logChunkController=s.logChunkController,s))}catch(d){console.warn("Failed to copy global core",d)}n.projectId=null==e?void 0:e.projectId,n.relayUrl=(null==e?void 0:e.relayUrl)||ks,n.customStoragePrefix=null!=e&&e.customStoragePrefix?":".concat(e.customStoragePrefix):"";var c=(0,oe.jI)({level:"string"==typeof(null==e?void 0:e.logger)&&e.logger?e.logger:"error",name:"core"}),u=(0,oe.Rt)({opts:c,maxSizeInBytes:null==e?void 0:e.maxLogBlobSizeInBytes,loggerOverride:null==e?void 0:e.logger}),l=u.logger,h=u.chunkLoggerController;return n.logChunkController=h,null!=(a=n.logChunkController)&&a.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=(0,o.Z)(p().mark(function e(){var t,r;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=null!=(t=i.logChunkController)&&t.downloadLogsBlobInBrowser,!e.t0){e.next=10;break}if(e.t1=null==(r=i.logChunkController),e.t1){e.next=10;break}return e.t2=r,e.next=7,i.crypto.getClientId();case 7:e.t3=e.sent,e.t4={clientId:e.t3},e.t2.downloadLogsBlobInBrowser.call(e.t2,e.t4);case 10:case"end":return e.stop()}},e)}))),n.logger=(0,oe.Ep)(l,n.name),n.heartbeat=new $a.C$,n.crypto=new su(y(n),n.logger,null==e?void 0:e.keychain),n.history=new bf(y(n),n.logger),n.expirer=new xf(y(n),n.logger),n.storage=null!=e&&e.storage?e.storage:new es.Z(zf(zf({},bs),null==e?void 0:e.storageOptions)),n.relayer=new Ju({core:y(n),logger:n.logger,relayUrl:n.relayUrl,projectId:n.projectId}),n.pairing=new vf(y(n),n.logger),n.verify=new If(y(n),n.logger,n.storage),n.echoClient=new _f(n.projectId||"",n.logger),n.linkModeSupportedApps=[],n.eventClient=new Nf(y(n),n.logger,null==e?void 0:e.telemetryEnabled),n.setGlobalCore(y(n)),n}return x(r,[{key:"context",get:function(){return(0,oe.Fd)(this.logger)}},{key:"start",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.initialized,t.t0){t.next=4;break}return t.next=4,e.initialize();case 4:case"end":return t.stop()}},t)}))()}},{key:"getLogsBlob",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){var r;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(r=e.logChunkController)){t.next=4;break}t.t0=void 0,t.next=10;break;case 4:return t.t1=r,t.next=7,e.crypto.getClientId();case 7:t.t2=t.sent,t.t3={clientId:t.t2},t.t0=t.t1.logsToBlob.call(t.t1,t.t3);case 10:return t.abrupt("return",t.t0);case 11:case"end":return t.stop()}},t)}))()}},{key:"addLinkModeSupportedApp",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=t.linkModeSupportedApps.includes(e),r.t0){r.next=5;break}return t.linkModeSupportedApps.push(e),r.next=5,t.storage.setItem(_s,t.linkModeSupportedApps);case 5:case"end":return r.stop()}},r)}))()}},{key:"initialize",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.logger.trace("Initialized"),t.prev=1,t.next=4,e.crypto.init();case 4:return t.next=6,e.history.init();case 6:return t.next=8,e.expirer.init();case 8:return t.next=10,e.relayer.init();case 10:return t.next=12,e.heartbeat.init();case 12:return t.next=14,e.pairing.init();case 14:return t.next=16,e.storage.getItem(_s);case 16:if(t.t0=t.sent,t.t0){t.next=19;break}t.t0=[];case 19:e.linkModeSupportedApps=t.t0,e.initialized=!0,e.logger.info("Core Initialization Success"),t.next=27;break;case 24:throw t.prev=24,t.t1=t.catch(1),e.logger.warn(t.t1,"Core Initialization Failure at epoch ".concat(Date.now())),e.logger.error(t.t1.message),t.t1;case 27:case"end":return t.stop()}},t,null,[[1,24]])}))()}},{key:"getGlobalCore",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{if(this.isGlobalCoreDisabled())return;var t="_walletConnectCore_".concat(e),r="".concat(t,"_count");return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn("WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ".concat(globalThis[r]," times.")),globalThis[t]}catch(t){return void console.warn("Failed to get global WalletConnect core",t)}}},{key:"setGlobalCore",value:function(e){var t;try{if(this.isGlobalCoreDisabled())return;var r="_walletConnectCore_".concat((null==(t=e.opts)?void 0:t.customStoragePrefix)||"");globalThis[r]=e}catch(Jt){console.warn("Failed to set global WalletConnect core",Jt)}}},{key:"isGlobalCoreDisabled",value:function(){try{return typeof process<"u"&&"true"===process.env.DISABLE_GLOBAL_CORE}catch(e){return!0}}}],[{key:"init",value:function(e){return(0,o.Z)(p().mark(function t(){var n,i;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new r(e),t.next=3,n.initialize();case 3:return t.next=5,n.crypto.getClientId();case 5:return i=t.sent,t.next=8,n.storage.setItem("WALLETCONNECT_CLIENT_ID",i);case 8:return t.abrupt("return",n);case 9:case"end":return t.stop()}},t)}))()}}]),r}(is),Kf=Ff,Vf="wc@2:client:",Hf="WALLETCONNECT_DEEPLINK_CHOICE",Wf="Proposal expired",Gf=d.SEVEN_DAYS,Jf={wc_sessionPropose:{req:{ttl:d.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:d.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:d.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:d.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:d.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:d.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:d.ONE_DAY,prompt:!1,tag:1104},res:{ttl:d.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:d.ONE_DAY,prompt:!1,tag:1106},res:{ttl:d.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:d.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:d.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:d.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:d.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:d.ONE_DAY,prompt:!1,tag:1112},res:{ttl:d.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:d.ONE_DAY,prompt:!1,tag:1114},res:{ttl:d.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:d.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:d.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:d.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:d.FIVE_MINUTES,prompt:!1,tag:1119}}},Yf={min:d.FIVE_MINUTES,max:d.SEVEN_DAYS},Qf={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},Xf=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],$f="wc@1.5:auth:",el="".concat($f,":PUB_KEY"),tl=Object.defineProperty,rl=Object.defineProperties,nl=Object.getOwnPropertyDescriptors,il=Object.getOwnPropertySymbols,ol=Object.prototype.hasOwnProperty,al=Object.prototype.propertyIsEnumerable,sl=function(e,t,r){return t in e?tl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},cl=function(e,t){for(var r in t||(t={}))ol.call(t,r)&&sl(e,r,t[r]);if(il){var n,i=u(il(t));try{for(i.s();!(n=i.n()).done;){r=n.value;al.call(t,r)&&sl(e,r,t[r])}}catch(o){i.e(o)}finally{i.f()}}return e},ul=function(e,t){return rl(e,nl(t))},fl=function(e,t,r){return sl(e,"symbol"!=typeof t?t+"":t,r)},ll=function(e){h(r,e);var t=v(r);function r(e){var n,a;return k(this,r),n=t.call(this,e),a=y(n),fl(y(n),"name","engine"),fl(y(n),"events",new f),fl(y(n),"initialized",!1),fl(y(n),"requestQueue",{state:"IDLE",queue:[]}),fl(y(n),"sessionRequestQueue",{state:"IDLE",queue:[]}),fl(y(n),"emittedSessionRequests",new Ve({limit:500})),fl(y(n),"requestQueueDelay",d.ONE_SECOND),fl(y(n),"expectedPairingMethodMap",new Map),fl(y(n),"recentlyDeletedMap",new Map),fl(y(n),"recentlyDeletedLimit",200),fl(y(n),"relayMessageCache",[]),fl(y(n),"pendingSessions",new Map),fl(y(n),"init",(0,o.Z)(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=a.initialized,e.t0){e.next=12;break}return e.next=4,a.cleanup();case 4:return a.registerRelayerEvents(),a.registerExpirerEvents(),a.registerPairingEvents(),e.next=9,a.registerLinkModeListeners();case 9:a.client.core.pairing.register({methods:Object.keys(Jf)}),a.initialized=!0,setTimeout((0,o.Z)(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.processPendingMessageEvents();case 2:a.sessionRequestQueue.queue=a.getPendingSessionRequests(),a.processSessionRequestQueue();case 4:case"end":return e.stop()}},e)})),(0,d.toMiliseconds)(a.requestQueueDelay));case 12:case"end":return e.stop()}},e)}))),fl(y(n),"connect",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s,c,f,l,h,v,g,y,b,m,w,x,k,E,I,S,O,_,P,A,R,T,B,C,U;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.isInitialized(),e.next=3,a.confirmOnlineStateOrThrow();case 3:return n=ul(cl({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}}),e.next=6,a.isValidConnect(n);case 6:n.optionalNamespaces=function(e,t){var r,n,i,o,a,s,c,f=Oa(e),l=Oa(t),p={},h=u(Object.keys(f).concat(Object.keys(l)));try{for(h.s();!(c=h.n()).done;){var d=c.value;p[d]={chains:je(null==(r=f[d])?void 0:r.chains,null==(n=l[d])?void 0:n.chains),methods:je(null==(i=f[d])?void 0:i.methods,null==(o=l[d])?void 0:o.methods),events:je(null==(a=f[d])?void 0:a.events,null==(s=l[d])?void 0:s.events)}}}catch(v){h.e(v)}finally{h.f()}return p}(n.requiredNamespaces,n.optionalNamespaces),n.requiredNamespaces={},i=n.pairingTopic,o=n.requiredNamespaces,s=n.optionalNamespaces,c=n.sessionProperties,f=n.scopedProperties,l=n.relays,h=n.authentication,v=n.walletPay,g=(null==(r=null==h?void 0:h[0])?void 0:r.ttl)||Jf.wc_sessionPropose.req.ttl||d.FIVE_MINUTES,a.validateRequestExpiry(g),b=i,m=!1,e.prev=11,b&&(w=a.client.core.pairing.pairings.get(b),a.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),m=w.active),e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(11),a.client.logger.error("connect() -> pairing.get(".concat(b,") failed")),e.t0;case 18:if(b&&m){e.next=25;break}return e.next=21,a.client.core.pairing.create({internal:{skipSubscribe:!0}});case 21:x=e.sent,k=x.topic,E=x.uri,b=k,y=E;case 25:if(b){e.next=28;break}throw I=Ra("NO_MATCHING_KEY","connect() pairing topic: ".concat(b)),S=I.message,new Error(S);case 28:return e.next=30,a.client.core.crypto.generateKeyPair();case 30:return O=e.sent,_=Ce(g),P=cl(ul(cl(cl({requiredNamespaces:o,optionalNamespaces:s,relays:null!=l?l:[{protocol:"irn"}],proposer:{publicKey:O,metadata:a.client.metadata},expiryTimestamp:_,pairingTopic:b},c&&{sessionProperties:c}),f&&{scopedProperties:f}),{id:(0,vs.payloadId)()}),(h||v)&&{requests:{authentication:null==h?void 0:h.map(function(e){var t=e.domain,r=e.chains,n=e.nonce,i=e.uri,o=e.exp,a=e.nbf,s=e.type,c=e.statement,u=e.requestId,f=e.resources,l=e.signatureTypes;return{domain:t,chains:r,nonce:n,type:null!=s?s:"caip122",aud:i,version:"1",iat:(new Date).toISOString(),exp:o,nbf:a,statement:c,requestId:u,resources:f,signatureTypes:l}}),walletPay:v}}),A=Ne("session_connect",P.id),R=Ae(g,Wf),T=R.reject,B=R.resolve,C=R.done,U=function e(t){t.id===P.id&&(a.client.events.off("proposal_expire",e),a.pendingSessions.delete(P.id),a.events.emit(A,{error:{message:Wf,code:0}}))},a.client.events.on("proposal_expire",U),a.events.once(A,function(e){var t=e.error,r=e.session;a.client.events.off("proposal_expire",U),t?T(t):r&&B(r)}),e.next=43,a.setProposal(P.id,P);case 43:return e.next=45,a.sendProposeSession({proposal:P,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:P.id}}}).catch(function(e){throw a.deleteProposal(P.id),e});case 45:return e.abrupt("return",{uri:y,approval:C});case 46:case"end":return e.stop()}},e,null,[[11,15]])}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"pair",function(){var e=(0,o.Z)(p().mark(function e(t){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.isInitialized(),e.next=3,a.confirmOnlineStateOrThrow();case 3:return e.prev=3,e.next=6,a.client.core.pairing.pair(t);case 6:return e.abrupt("return",e.sent);case 9:throw e.prev=9,e.t0=e.catch(3),a.client.logger.error("pair() failed"),e.t0;case 12:case"end":return e.stop()}},e,null,[[3,9]])}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"approve",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s,c,u,f,l,h,d,v,g,y,b,m,w,x,k,E,I,S,O;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.client.core.eventClient.createEvent({properties:{topic:null==(r=null==t?void 0:t.id)?void 0:r.toString(),trace:["session_approve_started"]}}),e.prev=1,a.isInitialized(),e.next=5,a.confirmOnlineStateOrThrow();case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(1),o.setError("no_internet_connection"),e.t0;case 10:return e.prev=10,e.next=13,a.isValidProposalId(null==t?void 0:t.id);case 13:e.next=18;break;case 15:throw e.prev=15,e.t1=e.catch(10),a.client.logger.error("approve() -> proposal.get(".concat(null==t?void 0:t.id,") failed")),o.setError("proposal_not_found"),e.t1;case 18:return e.prev=18,e.next=21,a.isValidApprove(t);case 21:e.next=26;break;case 23:throw e.prev=23,e.t2=e.catch(18),a.client.logger.error("approve() -> isValidApprove() failed"),o.setError("session_approve_namespace_validation_failure"),e.t2;case 26:return s=t.id,c=t.relayProtocol,u=t.namespaces,f=t.sessionProperties,l=t.scopedProperties,h=t.sessionConfig,d=t.proposalRequestsResponses,v=a.client.proposal.get(s),a.client.core.eventClient.deleteEvent({eventId:o.eventId}),g=v.pairingTopic,y=v.proposer,b=v.requiredNamespaces,m=v.optionalNamespaces,(w=null==(n=a.client.core.eventClient)?void 0:n.getEvent({topic:g}))||(w=null==(i=a.client.core.eventClient)?void 0:i.createEvent({type:"session_approve_started",properties:{topic:g,trace:["session_approve_started","session_namespaces_validation_success"]}})),e.next=33,a.client.core.crypto.generateKeyPair();case 33:return x=e.sent,k=y.publicKey,e.next=37,a.client.core.crypto.generateSharedKey(x,k);case 37:return E=e.sent,I=ul(cl(cl(cl({relay:{protocol:null!=c?c:"irn"},namespaces:u,controller:{publicKey:x,metadata:a.client.metadata},expiry:Ce(Gf)},f&&{sessionProperties:f}),l&&{scopedProperties:l}),h&&{sessionConfig:h}),{proposalRequestsResponses:d}),S=Os,w.addTrace("subscribing_session_topic"),e.prev=41,e.next=44,a.client.core.relayer.subscribe(E,{transportType:S,internal:{skipSubscribe:!0}});case 44:e.next=49;break;case 46:throw e.prev=46,e.t3=e.catch(41),w.setError("subscribe_session_topic_failure"),e.t3;case 49:return w.addTrace("subscribe_session_topic_success"),O=ul(cl({},I),{topic:E,requiredNamespaces:b,optionalNamespaces:m,pairingTopic:g,acknowledged:!1,self:I.controller,peer:{publicKey:y.publicKey,metadata:y.metadata},controller:x,transportType:Os,authentication:null==d?void 0:d.authentication,walletPayResult:null==d?void 0:d.walletPay}),e.next=53,a.client.session.set(E,O);case 53:return w.addTrace("store_session"),e.prev=54,e.next=57,a.sendApproveSession({sessionTopic:E,proposal:v,pairingProposalResponse:{relay:{protocol:null!=c?c:"irn"},responderPublicKey:x},sessionSettleRequest:I,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:cl({correlationId:s},a.getTVFApproveParams(O))}});case 57:w.addTrace("session_approve_publish_success"),e.next=67;break;case 60:return e.prev=60,e.t4=e.catch(54),a.client.logger.error(e.t4),a.client.session.delete(E,Ta("USER_DISCONNECTED")),e.next=66,a.client.core.relayer.unsubscribe(E);case 66:throw e.t4;case 67:return a.client.core.eventClient.deleteEvent({eventId:w.eventId}),e.next=70,a.client.core.pairing.updateMetadata({topic:g,metadata:y.metadata});case 70:return e.next=72,a.deleteProposal(s);case 72:return e.next=74,a.client.core.pairing.activate({topic:g});case 74:return e.next=76,a.setExpiry(E,Ce(Gf));case 76:return e.abrupt("return",{topic:E,acknowledged:function(){return Promise.resolve(a.client.session.get(E))}});case 77:case"end":return e.stop()}},e,null,[[1,7],[10,15],[18,23],[41,46],[54,60]])}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"reject",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.isInitialized(),e.next=3,a.confirmOnlineStateOrThrow();case 3:return e.prev=3,e.next=6,a.isValidReject(t);case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(3),a.client.logger.error("reject() -> isValidReject() failed"),e.t0;case 11:r=t.id,n=t.reason,e.prev=12,i=a.client.proposal.get(r).pairingTopic,e.next=19;break;case 16:throw e.prev=16,e.t1=e.catch(12),a.client.logger.error("reject() -> proposal.get(".concat(r,") failed")),e.t1;case 19:if(e.t2=i,!e.t2){e.next=23;break}return e.next=23,a.sendError({id:r,topic:i,error:n,rpcOpts:Jf.wc_sessionPropose.reject});case 23:return e.next=25,a.deleteProposal(r);case 25:case"end":return e.stop()}},e,null,[[3,8],[12,16]])}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"update",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s,c,u,f,l;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.isInitialized(),e.next=3,a.confirmOnlineStateOrThrow();case 3:return e.prev=3,e.next=6,a.isValidUpdate(t);case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(3),a.client.logger.error("update() -> isValidUpdate() failed"),e.t0;case 11:return r=t.topic,n=t.namespaces,i=Ae(d.FIVE_MINUTES,"Session update request expired without receiving any acknowledgement"),o=i.done,s=i.resolve,c=i.reject,u=(0,vs.payloadId)(),f=(0,vs.getBigIntRpcId)().toString(),l=a.client.session.get(r).namespaces,a.events.once(Ne("session_update",u),function(e){var t=e.error;t?c(t):s()}),e.next=15,a.client.session.update(r,{namespaces:n});case 15:return e.next=17,a.sendRequest({topic:r,method:"wc_sessionUpdate",params:{namespaces:n},throwOnFailedPublish:!0,clientRpcId:u,relayRpcId:f}).catch(function(e){a.client.logger.error(e),a.client.session.update(r,{namespaces:l}),c(e)});case 17:return e.abrupt("return",{acknowledged:o});case 18:case"end":return e.stop()}},e,null,[[3,8]])}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"extend",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s,c;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.isInitialized(),e.next=3,a.confirmOnlineStateOrThrow();case 3:return e.prev=3,e.next=6,a.isValidExtend(t);case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(3),a.client.logger.error("extend() -> isValidExtend() failed"),e.t0;case 11:return r=t.topic,n=(0,vs.payloadId)(),i=Ae(d.FIVE_MINUTES,"Session extend request expired without receiving any acknowledgement"),o=i.done,s=i.resolve,c=i.reject,a.events.once(Ne("session_extend",n),function(e){var t=e.error;t?c(t):s()}),e.next=15,a.setExpiry(r,Ce(Gf));case 15:return a.sendRequest({topic:r,method:"wc_sessionExtend",params:{},clientRpcId:n,throwOnFailedPublish:!0}).catch(function(e){c(e)}),e.abrupt("return",{acknowledged:o});case 17:case"end":return e.stop()}},e,null,[[3,8]])}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"request",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,s,c,u,f,l,h,d,v,g,y,b,m;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.isInitialized(),e.prev=1,e.next=4,a.isValidRequest(t);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(1),a.client.logger.error("request() -> isValidRequest() failed"),e.t0;case 9:if(r=t.chainId,n=t.request,i=t.topic,s=t.expiry,c=void 0===s?Jf.wc_sessionRequest.req.ttl:s,u=a.client.session.get(i),e.t1=(null==u?void 0:u.transportType)===Os,!e.t1){e.next=14;break}return e.next=14,a.confirmOnlineStateOrThrow();case 14:if(f=(0,vs.payloadId)(),l=(0,vs.getBigIntRpcId)().toString(),h=Ae(c,"Request expired. Please try again."),d=h.done,v=h.resolve,g=h.reject,a.events.once(Ne("session_request",f),function(e){var t=e.error,r=e.result;t?g(t):v(r)}),y="wc_sessionRequest",!(b=a.getAppLinkIfEnabled(u.peer.metadata,u.transportType))){e.next=24;break}return e.next=20,a.sendRequest({clientRpcId:f,relayRpcId:l,topic:i,method:y,params:{request:ul(cl({},n),{expiryTimestamp:Ce(c)}),chainId:r},expiry:c,throwOnFailedPublish:!0,appLink:b}).catch(function(e){return g(e)});case 20:return a.client.events.emit("session_request_sent",{topic:i,request:n,chainId:r,id:f}),e.next=23,d();case 23:case 27:return e.abrupt("return",e.sent);case 24:return m={request:ul(cl({},n),{expiryTimestamp:Ce(c)}),chainId:r},e.next=27,Promise.all([new Promise(function(){var e=(0,o.Z)(p().mark(function e(t){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.sendRequest({clientRpcId:f,relayRpcId:l,topic:i,method:y,params:m,expiry:c,throwOnFailedPublish:!0,tvf:a.getTVFParams(f,m)}).catch(function(e){return g(e)});case 2:a.client.events.emit("session_request_sent",{topic:i,request:n,chainId:r,id:f}),t();case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),new Promise(function(){var e=(0,o.Z)(p().mark(function e(t){var r,n;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(r=u.sessionConfig)&&r.disableDeepLink){e.next=6;break}return e.next=3,function(e,t){return qe.apply(this,arguments)}(a.client.core.storage,Hf);case 3:return n=e.sent,e.next=6,function(e){return Le.apply(this,arguments)}({id:f,topic:i,wcDeepLink:n});case 6:t();case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),d()]).then(function(e){return e[2]});case 28:case"end":return e.stop()}},e,null,[[1,6]])}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"respond",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s,c,u,f;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.isInitialized(),i=a.client.core.eventClient.createEvent({properties:{topic:(null==t?void 0:t.topic)||(null==(n=null==(r=null==t?void 0:t.response)?void 0:r.id)?void 0:n.toString()),trace:["session_request_response_started"]}}),e.prev=2,e.next=5,a.isValidRespond(t);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(2),i.addTrace(null===e.t0||void 0===e.t0?void 0:e.t0.message),i.setError("session_request_response_validation_failure"),e.t0;case 10:if(i.addTrace("session_request_response_validation_success"),o=t.topic,s=t.response,c=s.id,u=a.client.session.get(o),e.t1=u.transportType===Os,!e.t1){e.next=16;break}return e.next=16,a.confirmOnlineStateOrThrow();case 16:if(f=a.getAppLinkIfEnabled(u.peer.metadata,u.transportType),e.prev=17,i.addTrace("session_request_response_publish_started"),!(0,vs.isJsonRpcResult)(s)){e.next=24;break}return e.next=22,a.sendResult({id:c,topic:o,result:s.result,throwOnFailedPublish:!0,appLink:f});case 22:e.next=28;break;case 24:if(e.t2=(0,vs.isJsonRpcError)(s),!e.t2){e.next=28;break}return e.next=28,a.sendError({id:c,topic:o,error:s.error,appLink:f});case 28:a.cleanupAfterResponse(t),e.next=34;break;case 31:throw e.prev=31,e.t3=e.catch(17),i.addTrace(null===e.t3||void 0===e.t3?void 0:e.t3.message),i.setError("session_request_response_publish_failure"),e.t3;case 34:case"end":return e.stop()}},e,null,[[2,7],[17,31]])}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"ping",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s,c,u;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.isInitialized(),e.next=3,a.confirmOnlineStateOrThrow();case 3:return e.prev=3,e.next=6,a.isValidPing(t);case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(3),a.client.logger.error("ping() -> isValidPing() failed"),e.t0;case 11:if(r=t.topic,!a.client.session.keys.includes(r)){e.next=19;break}return n=(0,vs.payloadId)(),i=(0,vs.getBigIntRpcId)().toString(),o=Ae(d.FIVE_MINUTES,"Ping request expired without receiving any acknowledgement"),s=o.done,c=o.resolve,u=o.reject,a.events.once(Ne("session_ping",n),function(e){var t=e.error;t?u(t):c()}),e.next=17,Promise.all([a.sendRequest({topic:r,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:n,relayRpcId:i}),s()]);case 17:e.next=24;break;case 19:if(e.t1=a.client.core.pairing.pairings.keys.includes(r),!e.t1){e.next=24;break}return a.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),e.next=24,a.client.core.pairing.ping({topic:r});case 24:case"end":return e.stop()}},e,null,[[3,8]])}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"emit",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.isInitialized(),e.next=3,a.confirmOnlineStateOrThrow();case 3:return e.next=5,a.isValidEmit(t);case 5:return r=t.topic,n=t.event,i=t.chainId,o=(0,vs.getBigIntRpcId)().toString(),s=(0,vs.payloadId)(),e.next=8,a.sendRequest({topic:r,method:"wc_sessionEvent",params:{event:n,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:s});case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"disconnect",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.isInitialized(),e.next=3,a.confirmOnlineStateOrThrow();case 3:return e.next=5,a.isValidDisconnect(t);case 5:if(r=t.topic,!a.client.session.keys.includes(r)){e.next=13;break}return e.next=9,a.sendRequest({topic:r,method:"wc_sessionDelete",params:Ta("USER_DISCONNECTED"),throwOnFailedPublish:!0});case 9:return e.next=11,a.deleteSession({topic:r,emitEvent:!1});case 11:e.next=18;break;case 13:if(a.client.core.pairing.pairings.keys.includes(r)){e.next=16;break}throw n=Ra("MISMATCHED_TOPIC","Session or pairing topic not found: ".concat(r)),i=n.message,new Error(i);case 16:return e.next=18,a.client.core.pairing.disconnect({topic:r});case 18:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"find",function(e){return n.isInitialized(),n.client.session.getAll().filter(function(t){return function(e,t){var r=t.requiredNamespaces,n=Object.keys(e.namespaces),i=Object.keys(r),o=!0;return!!Oe(i,n)&&(n.forEach(function(t){var n=e.namespaces[t],i=n.accounts,a=n.methods,s=n.events,c=ka(i),u=r[t];Oe(ce(t,u),c)&&Oe(u.methods,a)&&Oe(u.events,s)||(o=!1)}),o)}(t,e)})}),fl(y(n),"getPendingSessionRequests",function(){return n.client.pendingRequest.getAll()}),fl(y(n),"authenticate",function(){var e=(0,o.Z)(p().mark(function e(t,r){var n,i,f,l,h,d,v,g,y,b,m,w,x,k,E,I,S,O,_,P,A,R,T,B,C,U,N,j,L,D,M,q,z,Z,F,K,V,H,W;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.isInitialized(),a.isValidAuthenticate(t),f=r&&a.client.core.linkModeSupportedApps.includes(r)&&(null==(i=a.client.metadata.redirect)?void 0:i.linkMode),l=f?Ss:Os,e.t0=l===Os,!e.t0){e.next=6;break}return e.next=6,a.confirmOnlineStateOrThrow();case 6:return h=t.chains,d=t.statement,v=void 0===d?"":d,g=t.uri,y=t.domain,b=t.nonce,m=t.type,w=t.exp,x=t.nbf,k=t.methods,E=void 0===k?[]:k,I=t.expiry,S=s(t.resources||[]),e.next=21,a.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:l});case 21:return O=e.sent,_=O.topic,P=O.uri,a.client.logger.info({message:"Generated new pairing",pairing:{topic:_,uri:P}}),e.next=27,a.client.core.crypto.generateKeyPair();case 27:return A=e.sent,R=zo(A),e.next=31,Promise.all([a.client.auth.authKeys.set(el,{responseTopic:R,publicKey:A}),a.client.auth.pairingTopics.set(R,{topic:R,pairingTopic:_})]);case 31:return e.next=33,a.client.core.relayer.subscribe(R,{transportType:l});case 33:if(a.client.logger.info("sending request to new pairing topic: ".concat(_)),!(E.length>0)){e.next=38;break}T=ae(h[0]),B=T.namespace,C=function(e,t,r){var n=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return null!=r&&r.sort(function(e,t){return e.localeCompare(t)}),{att:c({},e,hn(t,r,n))}}(e,"request",r);return dn(n)}(B,0,E),mn(S)&&(C=gn(C,S.pop())),S.push(C);case 38:if(U=I&&I>Jf.wc_sessionAuthenticate.req.ttl?I:Jf.wc_sessionAuthenticate.req.ttl,N={authPayload:{type:null!=m?m:"caip122",chains:h,statement:v,aud:g,domain:y,version:"1",nonce:b,iat:(new Date).toISOString(),exp:w,nbf:x,resources:S},requester:{publicKey:A,metadata:a.client.metadata},expiryTimestamp:Ce(U)},j={requiredNamespaces:{},optionalNamespaces:{eip155:{chains:h,methods:s(new Set(["personal_sign"].concat(s(E)))),events:["chainChanged","accountsChanged"]}},relays:[{protocol:"irn"}],pairingTopic:_,proposer:{publicKey:A,metadata:a.client.metadata},expiryTimestamp:Ce(Jf.wc_sessionPropose.req.ttl),id:(0,vs.payloadId)()},L=Ae(U,"Request expired"),D=L.done,M=L.resolve,q=L.reject,z=(0,vs.payloadId)(),Z=Ne("session_connect",j.id),F=Ne("session_request",z),K=function(){var e=(0,o.Z)(function(e){var t=e.error,r=e.session;return p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.events.off(F,V),t?q(t):r&&M({session:r});case 1:case"end":return e.stop()}},e)})()});return function(t){return e.apply(this,arguments)}}(),V=function(){var e=(0,o.Z)(p().mark(function e(t){var n,i,o,c,f,h,d,v,g,y,b,m,w,x,k,E,I,S,O,P,R,T;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.deletePendingAuthRequest(z,{message:"fulfilled",code:0});case 2:if(!t.error){e.next=5;break}return c=Ta("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate"),e.abrupt("return",t.error.code===c.code?void 0:(a.events.off(Z,K),q(t.error.message)));case 5:return e.next=7,a.deleteProposal(j.id);case 7:a.events.off(Z,K),f=t.result,h=f.cacaos,d=f.responder,v=[],g=[],y=u(h),e.prev=10,y.s();case 12:if((b=y.n()).done){e.next=24;break}return c=b.value,e.next=16,un({cacao:c,projectId:a.client.core.projectId});case 16:if(e.t0=e.sent,e.t0){e.next=19;break}a.client.logger.error(c,"Signature verification failed"),q(Ta("SESSION_SETTLEMENT_FAILED","Signature verification failed"));case 19:for(m=c.p,w=mn(m.resources),x=[sn(m.iss)],k=cn(m.iss),w&&(E=yn(w),I=bn(w),v.push.apply(v,s(E)),x.push.apply(x,s(I))),S=0,O=x;S<O.length;S++)P=O[S],g.push("".concat(P,":").concat(k));case 22:e.next=12;break;case 24:e.next=29;break;case 26:e.prev=26,e.t1=e.catch(10),y.e(e.t1);case 29:return e.prev=29,y.f(),e.finish(29);case 32:return e.next=34,a.client.core.crypto.generateSharedKey(A,d.publicKey);case 34:if(R=e.sent,e.t2=v.length>0,!e.t2){e.next=47;break}return T={topic:R,acknowledged:!0,self:{publicKey:A,metadata:a.client.metadata},peer:d,controller:d.publicKey,expiry:Ce(Gf),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:_,namespaces:_a(s(new Set(v)),s(new Set(g))),transportType:l},e.next=40,a.client.core.relayer.subscribe(R,{transportType:l});case 40:return e.next=42,a.client.session.set(R,T);case 42:if(e.t3=_,!e.t3){e.next=46;break}return e.next=46,a.client.core.pairing.updateMetadata({topic:_,metadata:d.metadata});case 46:T=a.client.session.get(R);case 47:null!=(n=a.client.metadata.redirect)&&n.linkMode&&null!=(i=d.metadata.redirect)&&i.linkMode&&null!=(o=d.metadata.redirect)&&o.universal&&r&&(a.client.core.addLinkModeSupportedApp(d.metadata.redirect.universal),a.client.session.update(R,{transportType:Ss})),M({auths:h,session:T});case 49:case"end":return e.stop()}},e,null,[[10,26,29,32]])}));return function(t){return e.apply(this,arguments)}}(),a.events.once(Z,K),a.events.once(F,V),e.prev=40,!f){e.next=50;break}return W=(0,vs.formatJsonRpcRequest)("wc_sessionAuthenticate",N,z),a.client.core.history.set(_,W),e.next=46,a.client.core.crypto.encode("",W,{type:2,encoding:Do});case 46:C=e.sent,H=pa(r,_,C),e.next=52;break;case 50:return e.next=52,Promise.all([a.sendRequest({topic:_,method:"wc_sessionAuthenticate",params:N,expiry:t.expiry,throwOnFailedPublish:!0,clientRpcId:z}),a.sendRequest({topic:_,method:"wc_sessionPropose",params:j,expiry:Jf.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:j.id})]);case 52:e.next=57;break;case 54:throw e.prev=54,e.t1=e.catch(40),a.events.off(Z,K),a.events.off(F,V),e.t1;case 57:return e.next=59,a.setProposal(j.id,j);case 59:return e.next=61,a.setAuthRequest(z,{request:ul(cl({},N),{verifyContext:{}}),pairingTopic:_,transportType:l});case 61:return e.abrupt("return",{uri:null!==(n=H)&&void 0!==n?n:P,response:D});case 62:case"end":return e.stop()}},e,null,[[40,54]])}));return function(t,r){return e.apply(this,arguments)}}()),fl(y(n),"approveSessionAuthenticate",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,c,f,l,h,d,v,g,y,b,m,w,x,k,E,I,S,O,_,P,A,R,T;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=t.id,n=t.auths,i=a.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:["authenticated_session_approve_started"]}}),e.prev=1,a.isInitialized(),e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(1),i.setError("no_internet_connection"),e.t0;case 8:if(o=a.getPendingAuthRequest(r)){e.next=11;break}throw i.setError("authenticated_session_pending_request_not_found"),new Error("Could not find pending auth request with id ".concat(r));case 11:if(c=o.transportType||Os,e.t1=c===Os,!e.t1){e.next=16;break}return e.next=16,a.confirmOnlineStateOrThrow();case 16:return f=o.requester.publicKey,e.next=19,a.client.core.crypto.generateKeyPair();case 19:l=e.sent,h=zo(f),d={type:1,receiverPublicKey:f,senderPublicKey:l},v=[],g=[],y=u(n),e.prev=25,y.s();case 27:if((b=y.n()).done){e.next=43;break}return m=b.value,e.next=31,un({cacao:m,projectId:a.client.core.projectId});case 31:if(e.sent){e.next=37;break}return i.setError("invalid_cacao"),w=Ta("SESSION_SETTLEMENT_FAILED","Signature verification failed"),e.next=36,a.sendError({id:r,topic:h,error:w,encodeOpts:d});case 36:throw new Error(w.message);case 37:for(i.addTrace("cacaos_verified"),x=m.p,k=mn(x.resources),E=[sn(x.iss)],I=cn(x.iss),k&&(S=yn(k),O=bn(k),v.push.apply(v,s(S)),E.push.apply(E,s(O))),_=0,P=E;_<P.length;_++)A=P[_],g.push("".concat(A,":").concat(I));case 41:e.next=27;break;case 43:e.next=48;break;case 45:e.prev=45,e.t2=e.catch(25),y.e(e.t2);case 48:return e.prev=48,y.f(),e.finish(48);case 51:return e.next=53,a.client.core.crypto.generateSharedKey(l,f);case 53:if(R=e.sent,i.addTrace("create_authenticated_session_topic"),!((null==v?void 0:v.length)>0)){e.next=70;break}return T={topic:R,acknowledged:!0,self:{publicKey:l,metadata:a.client.metadata},peer:{publicKey:f,metadata:o.requester.metadata},controller:f,expiry:Ce(Gf),authentication:n,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:_a(s(new Set(v)),s(new Set(g))),transportType:c},i.addTrace("subscribing_authenticated_session_topic"),e.prev=56,e.next=59,a.client.core.relayer.subscribe(R,{transportType:c});case 59:e.next=64;break;case 61:throw e.prev=61,e.t3=e.catch(56),i.setError("subscribe_authenticated_session_topic_failure"),e.t3;case 64:return i.addTrace("subscribe_authenticated_session_topic_success"),e.next=67,a.client.session.set(R,T);case 67:return i.addTrace("store_authenticated_session"),e.next=70,a.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata});case 70:return i.addTrace("publishing_authenticated_session_approve"),e.prev=71,e.next=74,a.sendResult({topic:h,id:r,result:{cacaos:n,responder:{publicKey:l,metadata:a.client.metadata}},encodeOpts:d,throwOnFailedPublish:!0,appLink:a.getAppLinkIfEnabled(o.requester.metadata,c)});case 74:e.next=79;break;case 76:throw e.prev=76,e.t4=e.catch(71),i.setError("authenticated_session_approve_publish_failure"),e.t4;case 79:return e.next=81,a.client.auth.requests.delete(r,{message:"fulfilled",code:0});case 81:return e.next=83,a.client.core.pairing.activate({topic:o.pairingTopic});case 83:return a.client.core.eventClient.deleteEvent({eventId:i.eventId}),e.abrupt("return",{session:T});case 85:case"end":return e.stop()}},e,null,[[1,5],[25,45,48,51],[56,61],[71,76]])}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"rejectSessionAuthenticate",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s,c,u;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.isInitialized(),r=t.id,n=t.reason,i=a.getPendingAuthRequest(r)){e.next=4;break}throw new Error("Could not find pending auth request with id ".concat(r));case 4:if(e.t0=i.transportType===Os,!e.t0){e.next=8;break}return e.next=8,a.confirmOnlineStateOrThrow();case 8:return o=i.requester.publicKey,e.next=11,a.client.core.crypto.generateKeyPair();case 11:return s=e.sent,c=zo(o),u={type:1,receiverPublicKey:o,senderPublicKey:s},e.next=16,a.sendError({id:r,topic:c,error:n,encodeOpts:u,rpcOpts:Jf.wc_sessionAuthenticate.reject,appLink:a.getAppLinkIfEnabled(i.requester.metadata,i.transportType)});case 16:return e.next=18,a.client.auth.requests.delete(r,{message:"rejected",code:0});case 18:return e.next=20,a.deleteProposal(r);case 20:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"formatAuthMessage",function(e){n.isInitialized();var t=e.request,r=e.iss;return ln(t,r)}),fl(y(n),"processRelayMessageCache",function(){setTimeout((0,o.Z)(p().mark(function e(){var t;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0===a.relayMessageCache.length){e.next=15;break}case 1:if(!(a.relayMessageCache.length>0)){e.next=15;break}if(e.prev=2,t=a.relayMessageCache.shift(),e.t0=t,!e.t0){e.next=8;break}return e.next=8,a.onRelayMessage(t);case 8:e.next=13;break;case 10:e.prev=10,e.t1=e.catch(2),a.client.logger.error(e.t1);case 13:e.next=1;break;case 15:case"end":return e.stop()}},e,null,[[2,10]])})),50)}),fl(y(n),"cleanupDuplicatePairings",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.pairingTopic){e.next=14;break}if(e.prev=1,r=a.client.core.pairing.pairings.get(t.pairingTopic),0!==(n=a.client.core.pairing.pairings.getAll().filter(function(e){var n,i;return(null==(n=e.peerMetadata)?void 0:n.url)&&(null==(i=e.peerMetadata)?void 0:i.url)===t.peer.metadata.url&&e.topic&&e.topic!==r.topic})).length){e.next=5;break}return e.abrupt("return");case 5:return a.client.logger.info("Cleaning up ".concat(n.length," duplicate pairing(s)")),e.next=8,Promise.all(n.map(function(e){return a.client.core.pairing.disconnect({topic:e.topic})}));case 8:a.client.logger.info("Duplicate pairings clean up finished"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),a.client.logger.error(e.t0);case 14:case"end":return e.stop()}},e,null,[[1,11]])}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"deleteSession",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s,c,u,f,l,h;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.topic,i=t.expirerHasDeleted,o=void 0!==i&&i,s=t.emitEvent,c=void 0===s||s,u=t.id,f=void 0===u?0:u,l=a.client.session.get(n),h=l.self,e.next=3,a.client.core.relayer.unsubscribe(n);case 3:return e.next=5,a.client.session.delete(n,Ta("USER_DISCONNECTED"));case 5:if(a.addToRecentlyDeleted(n,"session"),e.t0=a.client.core.crypto.keychain.has(h.publicKey),!e.t0){e.next=10;break}return e.next=10,a.client.core.crypto.deleteKeyPair(h.publicKey);case 10:if(e.t1=a.client.core.crypto.keychain.has(n),!e.t1){e.next=14;break}return e.next=14,a.client.core.crypto.deleteSymKey(n);case 14:return o||a.client.core.expirer.del(n),a.client.core.storage.removeItem(Hf).catch(function(e){return a.client.logger.warn(e)}),n===(null==(r=a.sessionRequestQueue.queue[0])?void 0:r.topic)&&(a.sessionRequestQueue.state="IDLE"),e.next=19,Promise.all(a.getPendingSessionRequests().filter(function(e){return e.topic===n}).map(function(e){return a.deletePendingSessionRequest(e.id,Ta("USER_DISCONNECTED"))}));case 19:c&&a.client.events.emit("session_delete",{id:f,topic:n});case 20:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"deleteProposal",function(){var e=(0,o.Z)(p().mark(function e(t,r){var n,i;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r)try{i=a.client.proposal.get(t),null===(n=a.client.core.eventClient.getEvent({topic:i.pairingTopic}))||void 0===n||n.setError("proposal_expired")}catch(o){}return e.next=3,Promise.all([a.client.proposal.delete(t,Ta("USER_DISCONNECTED")),r?Promise.resolve():a.client.core.expirer.del(t)]);case 3:a.addToRecentlyDeleted(t,"proposal");case 4:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()),fl(y(n),"deletePendingSessionRequest",function(){var e=(0,o.Z)(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return p().mark(function n(){return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([a.client.pendingRequest.delete(e,t),r?Promise.resolve():a.client.core.expirer.del(e)]);case 2:a.addToRecentlyDeleted(e,"request"),a.sessionRequestQueue.queue=a.sessionRequestQueue.queue.filter(function(t){return t.id!==e}),r&&(a.sessionRequestQueue.state="IDLE",a.client.events.emit("session_request_expire",{id:e}));case 5:case"end":return n.stop()}},n)})()});return function(t,r){return e.apply(this,arguments)}}()),fl(y(n),"deletePendingAuthRequest",function(){var e=(0,o.Z)(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return p().mark(function n(){return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([a.client.auth.requests.delete(e,t),r?Promise.resolve():a.client.core.expirer.del(e)]);case 2:case"end":return n.stop()}},n)})()});return function(t,r){return e.apply(this,arguments)}}()),fl(y(n),"setExpiry",function(){var e=(0,o.Z)(p().mark(function e(t,r){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=a.client.session.keys.includes(t),!e.t0){e.next=5;break}return a.client.core.expirer.set(t,r),e.next=5,a.client.session.update(t,{expiry:r});case 5:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()),fl(y(n),"setProposal",function(){var e=(0,o.Z)(p().mark(function e(t,r){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.client.core.expirer.set(t,Ce(Jf.wc_sessionPropose.req.ttl)),e.next=3,a.client.proposal.set(t,r);case 3:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()),fl(y(n),"setAuthRequest",function(){var e=(0,o.Z)(p().mark(function e(t,r){var n,i,o,s;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.request,i=r.pairingTopic,o=r.transportType,s=void 0===o?Os:o,a.client.core.expirer.set(t,n.expiryTimestamp),e.next=4,a.client.auth.requests.set(t,{authPayload:n.authPayload,requester:n.requester,expiryTimestamp:n.expiryTimestamp,id:t,pairingTopic:i,verifyContext:n.verifyContext,transportType:s});case 4:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()),fl(y(n),"setPendingSessionRequest",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.id,n=t.topic,i=t.params,o=t.verifyContext,s=i.request.expiryTimestamp||Ce(Jf.wc_sessionRequest.req.ttl),a.client.core.expirer.set(r,s),e.next=4,a.client.pendingRequest.set(r,{id:r,topic:n,params:i,verifyContext:o});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"sendRequest",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s,c,u,f,l,h,d,v,g,y,b,m,w,x,k,E;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.topic,n=t.method,i=t.params,o=t.expiry,s=t.relayRpcId,c=t.clientRpcId,u=t.throwOnFailedPublish,f=t.appLink,l=t.tvf,h=t.publishOpts,d=void 0===h?{}:h,v=(0,vs.formatJsonRpcRequest)(n,i,c),y=!!f,e.prev=2,b=y?Do:Lo,e.next=6,a.client.core.crypto.encode(r,v,{encoding:b});case 6:g=e.sent,e.next=15;break;case 9:return e.prev=9,e.t0=e.catch(2),e.next=13,a.cleanup();case 13:throw a.client.logger.error("sendRequest() -> core.crypto.encode() for topic ".concat(r," failed")),e.t0;case 15:if(!Xf.includes(n)){e.next=20;break}return w=Zo(JSON.stringify(v)),x=Zo(g),e.next=19,a.client.core.verify.register({id:x,decryptedId:w});case 19:m=e.sent;case 20:if((k=cl(cl({},Jf[n].req),d)).attestation=m,o&&(k.ttl=o),s&&(k.id=s),a.client.core.history.set(r,v),!y){e.next=27;break}return E=pa(f,r,g),e.next=25,global.Linking.openURL(E,a.client.name);case 25:e.next=35;break;case 27:if(k.tvf=ul(cl({},l),{correlationId:v.id}),!u){e.next=34;break}return k.internal=ul(cl({},k.internal),{throwOnFailedPublish:!0}),e.next=32,a.client.core.relayer.publish(r,g,k);case 32:e.next=35;break;case 34:a.client.core.relayer.publish(r,g,k).catch(function(e){return a.client.logger.error(e)});case 35:return e.abrupt("return",v.id);case 36:case"end":return e.stop()}},e,null,[[2,9]])}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"sendProposeSession",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s,c,u;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.proposal,n=t.publishOpts,i=(0,vs.formatJsonRpcRequest)("wc_sessionPropose",r,r.id),a.client.core.history.set(r.pairingTopic,i),e.next=4,a.client.core.crypto.encode(r.pairingTopic,i,{encoding:Lo});case 4:return o=e.sent,s=Zo(JSON.stringify(i)),c=Zo(o),e.next=9,a.client.core.verify.register({id:c,decryptedId:s});case 9:return u=e.sent,e.next=12,a.client.core.relayer.publishCustom({payload:{pairingTopic:r.pairingTopic,sessionProposal:o},opts:ul(cl({},n),{publishMethod:"wc_proposeSession",attestation:u})});case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"sendApproveSession",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s,c,u,f,l;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.sessionTopic,n=t.pairingProposalResponse,i=t.proposal,o=t.sessionSettleRequest,s=t.publishOpts,c=(0,vs.formatJsonRpcResult)(i.id,n),e.next=8,a.client.core.crypto.encode(i.pairingTopic,c,{encoding:Lo});case 8:return u=e.sent,f=(0,vs.formatJsonRpcRequest)("wc_sessionSettle",o,null==s?void 0:s.id),e.next=12,a.client.core.crypto.encode(r,f,{encoding:Lo});case 12:return l=e.sent,a.client.core.history.set(r,f),e.next=16,a.client.core.relayer.publishCustom({payload:{sessionTopic:r,pairingTopic:i.pairingTopic,sessionProposalResponse:u,sessionSettlementRequest:l},opts:ul(cl({},s),{publishMethod:"wc_approveSession"})});case 16:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"sendResult",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s,c,u,f,l,h,d,v,g,y,b;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.id,n=t.topic,i=t.result,o=t.throwOnFailedPublish,s=t.encodeOpts,c=t.appLink,u=(0,vs.formatJsonRpcResult)(r,i),l=c&&typeof(null==global?void 0:global.Linking)<"u",e.prev=2,h=l?Do:Lo,e.next=6,a.client.core.crypto.encode(n,u,ul(cl({},s||{}),{encoding:h}));case 6:f=e.sent,e.next=15;break;case 9:return e.prev=9,e.t0=e.catch(2),e.next=13,a.cleanup();case 13:throw a.client.logger.error("sendResult() -> core.crypto.encode() for topic ".concat(n," failed")),e.t0;case 15:return e.prev=15,e.next=18,a.client.core.history.get(n,r);case 18:d=e.sent,g=d.request;try{v=a.getTVFParams(r,g.params,i)}catch(p){a.client.logger.warn("sendResult() -> getTVFParams() failed: ".concat(null==p?void 0:p.message))}e.next=26;break;case 23:throw e.prev=23,e.t1=e.catch(15),a.client.logger.error("sendResult() -> history.get(".concat(n,", ").concat(r,") failed")),e.t1;case 26:if(!l){e.next=32;break}return y=pa(c,n,f),e.next=30,global.Linking.openURL(y,a.client.name);case 30:e.next=41;break;case 32:if((b=Jf[d.request.method].res).tvf=ul(cl({},v),{correlationId:r}),!o){e.next=40;break}return b.internal=ul(cl({},b.internal),{throwOnFailedPublish:!0}),e.next=38,a.client.core.relayer.publish(n,f,b);case 38:e.next=41;break;case 40:a.client.core.relayer.publish(n,f,b).catch(function(e){return a.client.logger.error(e)});case 41:return e.next=43,a.client.core.history.resolve(u);case 43:case"end":return e.stop()}},e,null,[[2,9],[15,23]])}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"sendError",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s,c,u,f,l,h,d,v,g;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.id,n=t.topic,i=t.error,o=t.encodeOpts,s=t.rpcOpts,c=t.appLink,u=(0,vs.formatJsonRpcError)(r,i),l=c&&typeof(null==global?void 0:global.Linking)<"u",e.prev=2,h=l?Do:Lo,e.next=6,a.client.core.crypto.encode(n,u,ul(cl({},o||{}),{encoding:h}));case 6:f=e.sent,e.next=15;break;case 9:return e.prev=9,e.t0=e.catch(2),e.next=13,a.cleanup();case 13:throw a.client.logger.error("sendError() -> core.crypto.encode() for topic ".concat(n," failed")),e.t0;case 15:return e.prev=15,e.next=18,a.client.core.history.get(n,r);case 18:d=e.sent,e.next=24;break;case 21:throw e.prev=21,e.t1=e.catch(15),a.client.logger.error("sendError() -> history.get(".concat(n,", ").concat(r,") failed")),e.t1;case 24:if(!l){e.next=30;break}return v=pa(c,n,f),e.next=28,global.Linking.openURL(v,a.client.name);case 28:e.next=32;break;case 30:g=d.request.method,a.client.core.relayer.publish(n,f,s||Jf[g].res);case 32:return e.next=34,a.client.core.history.resolve(u);case 34:case"end":return e.stop()}},e,null,[[2,9],[15,21]])}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"cleanup",(0,o.Z)(p().mark(function e(){var t,r;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],r=[],a.client.session.getAll().forEach(function(e){var r=!1;Ue(e.expiry)&&(r=!0),a.client.core.crypto.keychain.has(e.topic)||(r=!0),r&&t.push(e.topic)}),a.client.proposal.getAll().forEach(function(e){Ue(e.expiryTimestamp)&&r.push(e.id)}),e.next=5,Promise.all([].concat(s(t.map(function(e){return a.deleteSession({topic:e})})),s(r.map(function(e){return a.deleteProposal(e)}))));case 5:case"end":return e.stop()}},e)}))),fl(y(n),"onProviderMessageEvent",function(){var e=(0,o.Z)(p().mark(function e(t){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.initialized&&!(a.relayMessageCache.length>0)){e.next=4;break}a.relayMessageCache.push(t),e.next=6;break;case 4:return e.next=6,a.onRelayMessage(t);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"onRelayEventRequest",function(){var e=(0,o.Z)(p().mark(function e(t){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.requestQueue.queue.push(t),e.next=3,a.processRequestsQueue();case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"processRequestsQueue",(0,o.Z)(p().mark(function e(){var t;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("ACTIVE"===a.requestQueue.state){e.next=19;break}a.client.logger.info("Request queue starting with ".concat(a.requestQueue.queue.length," requests"));case 2:if(!(a.requestQueue.queue.length>0)){e.next=16;break}if(a.requestQueue.state="ACTIVE",!(t=a.requestQueue.queue.shift())){e.next=14;break}return e.prev=6,e.next=9,a.processRequest(t);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(6),a.client.logger.warn(e.t0);case 14:e.next=2;break;case 16:a.requestQueue.state="IDLE",e.next=20;break;case 19:a.client.logger.info("Request queue already active, skipping...");case 20:case"end":return e.stop()}},e,null,[[6,11]])}))),fl(y(n),"processRequest",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s,c;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.topic,n=t.payload,i=t.attestation,o=t.transportType,s=t.encryptedId,c=n.method,a.shouldIgnorePairingRequest({topic:r,requestMethod:c})){e.next=33;break}e.t0=c,e.next="wc_sessionPropose"===e.t0?5:"wc_sessionSettle"===e.t0?8:"wc_sessionUpdate"===e.t0?11:"wc_sessionExtend"===e.t0?14:"wc_sessionPing"===e.t0?17:"wc_sessionDelete"===e.t0?20:"wc_sessionRequest"===e.t0?23:"wc_sessionEvent"===e.t0?26:"wc_sessionAuthenticate"===e.t0?29:32;break;case 5:return e.next=7,a.onSessionProposeRequest({topic:r,payload:n,attestation:i,encryptedId:s});case 7:case 10:case 13:case 16:case 19:case 22:case 25:case 28:case 31:return e.abrupt("return",e.sent);case 8:return e.next=10,a.onSessionSettleRequest(r,n);case 11:return e.next=13,a.onSessionUpdateRequest(r,n);case 14:return e.next=16,a.onSessionExtendRequest(r,n);case 17:return e.next=19,a.onSessionPingRequest(r,n);case 20:return e.next=22,a.onSessionDeleteRequest(r,n);case 23:return e.next=25,a.onSessionRequest({topic:r,payload:n,attestation:i,encryptedId:s,transportType:o});case 26:return e.next=28,a.onSessionEventRequest(r,n);case 29:return e.next=31,a.onSessionAuthenticateRequest({topic:r,payload:n,attestation:i,encryptedId:s,transportType:o});case 32:return e.abrupt("return",a.client.logger.info("Unsupported request method ".concat(c)));case 33:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"onRelayEventResponse",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.topic,n=t.payload,i=t.transportType,e.next=5,a.client.core.history.get(r,n.id);case 5:o=e.sent.request.method,e.t0=o,e.next="wc_sessionPropose"===e.t0?9:"wc_sessionSettle"===e.t0?10:"wc_sessionUpdate"===e.t0?11:"wc_sessionExtend"===e.t0?12:"wc_sessionPing"===e.t0?13:"wc_sessionRequest"===e.t0?14:"wc_sessionAuthenticate"===e.t0?15:16;break;case 9:return e.abrupt("return",a.onSessionProposeResponse(r,n,i));case 10:return e.abrupt("return",a.onSessionSettleResponse(r,n));case 11:return e.abrupt("return",a.onSessionUpdateResponse(r,n));case 12:return e.abrupt("return",a.onSessionExtendResponse(r,n));case 13:return e.abrupt("return",a.onSessionPingResponse(r,n));case 14:return e.abrupt("return",a.onSessionRequestResponse(r,n));case 15:return e.abrupt("return",a.onSessionAuthenticateResponse(r,n));case 16:return e.abrupt("return",a.client.logger.info("Unsupported response method ".concat(o)));case 17:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"onRelayEventUnknownPayload",function(e){var t=e.topic,r=Ra("MISSING_OR_INVALID","Decoded payload on topic ".concat(t," is not identifiable as a JSON-RPC request or a response.")).message;throw new Error(r)}),fl(y(n),"shouldIgnorePairingRequest",function(e){var t=e.topic,r=e.requestMethod,i=n.expectedPairingMethodMap.get(t);return!(!i||i.includes(r)||!(i.includes("wc_sessionAuthenticate")&&n.client.events.listenerCount("session_authenticate")>0))}),fl(y(n),"onSessionProposeRequest",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s,c,u,f,l,h;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.topic,n=t.payload,i=t.attestation,o=t.encryptedId,s=n.params,c=n.id,e.prev=1,u=a.client.core.eventClient.getEvent({topic:r}),0===a.client.events.listenerCount("session_proposal")&&(console.warn("No listener for session_proposal event"),null!=u&&u.setError("proposal_listener_not_found")),a.isValidConnect(cl({},n.params)),f=s.expiryTimestamp||Ce(Jf.wc_sessionPropose.req.ttl),l=cl({id:c,pairingTopic:r,expiryTimestamp:f,attestation:i,encryptedId:o},s),e.next=7,a.setProposal(c,l);case 7:return e.next=9,a.getVerifyContext({attestationId:i,hash:Zo(JSON.stringify(n)),encryptedId:o,metadata:l.proposer.metadata});case 9:h=e.sent,null!=u&&u.addTrace("emit_session_proposal"),a.client.events.emit("session_proposal",{id:c,params:l,verifyContext:h}),e.next=18;break;case 13:return e.prev=13,e.t0=e.catch(1),e.next=17,a.sendError({id:c,topic:r,error:e.t0,rpcOpts:Jf.wc_sessionPropose.autoReject});case 17:a.client.logger.error(e.t0);case 18:case"end":return e.stop()}},e,null,[[1,13]])}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"onSessionProposeResponse",function(){var e=(0,o.Z)(p().mark(function e(t,r,n){var i,o,s,c,u,f,l,h;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.id,!(0,vs.isJsonRpcResult)(r)){e.next=22;break}return o=r.result,a.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o}),s=a.client.proposal.get(i),a.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:s}),c=s.proposer.publicKey,a.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c}),u=o.responderPublicKey,a.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:u}),e.next=12,a.client.core.crypto.generateSharedKey(c,u);case 12:return f=e.sent,a.pendingSessions.set(i,{sessionTopic:f,pairingTopic:t,proposalId:i,publicKey:c}),e.next=16,a.client.core.relayer.subscribe(f,{transportType:n});case 16:return l=e.sent,a.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:l}),e.next=20,a.client.core.pairing.activate({topic:t});case 20:e.next=29;break;case 22:if(!(0,vs.isJsonRpcError)(r)){e.next=29;break}return e.next=25,a.deleteProposal(i);case 25:if(h=Ne("session_connect",i),0!==a.events.listenerCount(h)){e.next=28;break}throw new Error("emitting ".concat(h," without any listeners, 954"));case 28:a.events.emit(h,{error:r.error});case 29:case"end":return e.stop()}},e)}));return function(t,r,n){return e.apply(this,arguments)}}()),fl(y(n),"onSessionSettleRequest",function(){var e=(0,o.Z)(p().mark(function e(t,r){var n,i,o,c,u,f,l,h,d,v,g,y,b,m;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.id,i=r.params,e.prev=1,a.isValidSessionSettleRequest(i),o=r.params,c=o.relay,u=o.controller,f=o.expiry,l=o.namespaces,h=o.sessionProperties,d=o.scopedProperties,v=o.sessionConfig,g=o.proposalRequestsResponses,y=s(a.pendingSessions.values()).find(function(e){return e.sessionTopic===t})){e.next=6;break}return e.abrupt("return",a.client.logger.error("Pending session not found for topic ".concat(t)));case 6:return b=a.client.proposal.get(y.proposalId),m=ul(cl(cl(cl({topic:t,relay:c,expiry:f,namespaces:l,acknowledged:!0,pairingTopic:y.pairingTopic,requiredNamespaces:b.requiredNamespaces,optionalNamespaces:b.optionalNamespaces,controller:u.publicKey,self:{publicKey:y.publicKey,metadata:a.client.metadata},peer:{publicKey:u.publicKey,metadata:u.metadata}},h&&{sessionProperties:h}),d&&{scopedProperties:d}),v&&{sessionConfig:v}),{transportType:Os,authentication:null==g?void 0:g.authentication,walletPayResult:null==g?void 0:g.walletPay}),e.next=9,a.client.session.set(m.topic,m);case 9:return e.next=11,a.setExpiry(m.topic,m.expiry);case 11:return e.next=13,a.client.core.pairing.updateMetadata({topic:y.pairingTopic,metadata:m.peer.metadata});case 13:return a.pendingSessions.delete(y.proposalId),a.deleteProposal(y.proposalId,!1),a.cleanupDuplicatePairings(m),e.next=18,a.sendResult({id:r.id,topic:t,throwOnFailedPublish:!0,result:!0});case 18:a.client.events.emit("session_connect",{session:m}),a.events.emit(Ne("session_connect",y.proposalId),{session:m}),e.next=27;break;case 22:return e.prev=22,e.t0=e.catch(1),e.next=26,a.sendError({id:n,topic:t,error:e.t0});case 26:a.client.logger.error(e.t0);case 27:case"end":return e.stop()}},e,null,[[1,22]])}));return function(t,r){return e.apply(this,arguments)}}()),fl(y(n),"onSessionSettleResponse",function(){var e=(0,o.Z)(p().mark(function e(t,r){var n;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.id,!(0,vs.isJsonRpcResult)(r)){e.next=7;break}return e.next=4,a.client.session.update(t,{acknowledged:!0});case 4:a.events.emit(Ne("session_approve",n),{}),e.next=12;break;case 7:if(e.t0=(0,vs.isJsonRpcError)(r),!e.t0){e.next=12;break}return e.next=11,a.client.session.delete(t,Ta("USER_DISCONNECTED"));case 11:a.events.emit(Ne("session_approve",n),{error:r.error});case 12:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()),fl(y(n),"onSessionUpdateRequest",function(){var e=(0,o.Z)(p().mark(function e(t,r){var n,i,o,s;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.params,i=r.id,e.prev=1,o="".concat(t,"_session_update"),!(s=Ja.get(o))||!a.isRequestOutOfSync(s,i)){e.next=5;break}return e.abrupt("return",(a.client.logger.warn("Discarding out of sync request - ".concat(i)),void a.sendError({id:i,topic:t,error:Ta("INVALID_UPDATE_REQUEST")})));case 5:return a.isValidUpdate(cl({topic:t},n)),e.prev=6,Ja.set(o,i),e.next=10,a.client.session.update(t,{namespaces:n.namespaces});case 10:return e.next=12,a.sendResult({id:i,topic:t,result:!0});case 12:e.next=17;break;case 14:throw e.prev=14,e.t0=e.catch(6),Ja.delete(o),e.t0;case 17:a.client.events.emit("session_update",{id:i,topic:t,params:n}),e.next=25;break;case 20:return e.prev=20,e.t1=e.catch(1),e.next=24,a.sendError({id:i,topic:t,error:e.t1});case 24:a.client.logger.error(e.t1);case 25:case"end":return e.stop()}},e,null,[[1,20],[6,14]])}));return function(t,r){return e.apply(this,arguments)}}()),fl(y(n),"isRequestOutOfSync",function(e,t){return t.toString().slice(0,-3)<e.toString().slice(0,-3)}),fl(y(n),"onSessionUpdateResponse",function(e,t){var r=t.id,i=Ne("session_update",r);if(0===n.events.listenerCount(i))throw new Error("emitting ".concat(i," without any listeners"));(0,vs.isJsonRpcResult)(t)?n.events.emit(Ne("session_update",r),{}):(0,vs.isJsonRpcError)(t)&&n.events.emit(Ne("session_update",r),{error:t.error})}),fl(y(n),"onSessionExtendRequest",function(){var e=(0,o.Z)(p().mark(function e(t,r){var n;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.id,e.prev=1,a.isValidExtend({topic:t}),e.next=5,a.setExpiry(t,Ce(Gf));case 5:return e.next=7,a.sendResult({id:n,topic:t,result:!0});case 7:a.client.events.emit("session_extend",{id:n,topic:t}),e.next=15;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,a.sendError({id:n,topic:t,error:e.t0});case 14:a.client.logger.error(e.t0);case 15:case"end":return e.stop()}},e,null,[[1,10]])}));return function(t,r){return e.apply(this,arguments)}}()),fl(y(n),"onSessionExtendResponse",function(e,t){var r=t.id,i=Ne("session_extend",r);if(0===n.events.listenerCount(i))throw new Error("emitting ".concat(i," without any listeners"));(0,vs.isJsonRpcResult)(t)?n.events.emit(Ne("session_extend",r),{}):(0,vs.isJsonRpcError)(t)&&n.events.emit(Ne("session_extend",r),{error:t.error})}),fl(y(n),"onSessionPingRequest",function(){var e=(0,o.Z)(p().mark(function e(t,r){var n;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.id,e.prev=1,a.isValidPing({topic:t}),e.next=5,a.sendResult({id:n,topic:t,result:!0,throwOnFailedPublish:!0});case 5:a.client.events.emit("session_ping",{id:n,topic:t}),e.next=13;break;case 8:return e.prev=8,e.t0=e.catch(1),e.next=12,a.sendError({id:n,topic:t,error:e.t0});case 12:a.client.logger.error(e.t0);case 13:case"end":return e.stop()}},e,null,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}()),fl(y(n),"onSessionPingResponse",function(e,t){var r=t.id,i=Ne("session_ping",r);setTimeout(function(){if(0===n.events.listenerCount(i))throw new Error("emitting ".concat(i," without any listeners 2176"));(0,vs.isJsonRpcResult)(t)?n.events.emit(Ne("session_ping",r),{}):(0,vs.isJsonRpcError)(t)&&n.events.emit(Ne("session_ping",r),{error:t.error})},500)}),fl(y(n),"onSessionDeleteRequest",function(){var e=(0,o.Z)(p().mark(function e(t,r){var n;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.id,e.prev=1,e.next=4,a.isValidDisconnect({topic:t,reason:r.params});case 4:return a.cleanupPendingSentRequestsForTopic({topic:t,error:Ta("USER_DISCONNECTED")}),e.next=7,a.deleteSession({topic:t,id:n});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),a.client.logger.error(e.t0);case 12:case"end":return e.stop()}},e,null,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}()),fl(y(n),"onSessionRequest",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s,c,u,f,l,h,d,v;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.topic,s=t.payload,c=t.attestation,u=t.encryptedId,f=t.transportType,l=s.id,h=s.params,e.prev=1,e.next=4,a.isValidRequest(cl({topic:o},h));case 4:return d=a.client.session.get(o),e.t0=l,e.t1=o,e.t2=h,e.next=10,a.getVerifyContext({attestationId:c,hash:Zo(JSON.stringify((0,vs.formatJsonRpcRequest)("wc_sessionRequest",h,l))),encryptedId:u,metadata:d.peer.metadata,transportType:f});case 10:return e.t3=e.sent,v={id:e.t0,topic:e.t1,params:e.t2,verifyContext:e.t3},e.next=14,a.setPendingSessionRequest(v);case 14:f===Ss&&null!=(r=d.peer.metadata.redirect)&&r.universal&&a.client.core.addLinkModeSupportedApp(null==(n=d.peer.metadata.redirect)?void 0:n.universal),null!=(i=a.client.signConfig)&&i.disableRequestQueue?a.emitSessionRequest(v):(a.addSessionRequestToSessionRequestQueue(v),a.processSessionRequestQueue()),e.next=23;break;case 18:return e.prev=18,e.t4=e.catch(1),e.next=22,a.sendError({id:l,topic:o,error:e.t4});case 22:a.client.logger.error(e.t4);case 23:case"end":return e.stop()}},e,null,[[1,18]])}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"onSessionRequestResponse",function(e,t){var r=t.id,i=Ne("session_request",r);if(0===n.events.listenerCount(i))throw new Error("emitting ".concat(i," without any listeners"));(0,vs.isJsonRpcResult)(t)?n.events.emit(Ne("session_request",r),{result:t.result}):(0,vs.isJsonRpcError)(t)&&n.events.emit(Ne("session_request",r),{error:t.error})}),fl(y(n),"onSessionEventRequest",function(){var e=(0,o.Z)(p().mark(function e(t,r){var n,i,o,s;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.id,i=r.params,e.prev=1,o="".concat(t,"_session_event_").concat(i.event.name),!(s=Ja.get(o))||!a.isRequestOutOfSync(s,n)){e.next=5;break}return e.abrupt("return",void a.client.logger.info("Discarding out of sync request - ".concat(n)));case 5:a.isValidEmit(cl({topic:t},i)),a.client.events.emit("session_event",{id:n,topic:t,params:i}),Ja.set(o,n),e.next=13;break;case 8:return e.prev=8,e.t0=e.catch(1),e.next=12,a.sendError({id:n,topic:t,error:e.t0});case 12:a.client.logger.error(e.t0);case 13:case"end":return e.stop()}},e,null,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}()),fl(y(n),"onSessionAuthenticateResponse",function(e,t){var r=t.id;n.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:e,payload:t}),(0,vs.isJsonRpcResult)(t)?n.events.emit(Ne("session_request",r),{result:t.result}):(0,vs.isJsonRpcError)(t)&&n.events.emit(Ne("session_request",r),{error:t.error})}),fl(y(n),"onSessionAuthenticateRequest",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s,c,u,f,l,h,d,v,g,y,b,m;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.topic,i=t.payload,o=t.attestation,s=t.encryptedId,c=t.transportType,e.prev=1,u=i.params,f=u.requester,l=u.authPayload,h=u.expiryTimestamp,e.next=8,a.getVerifyContext({attestationId:o,hash:Zo(JSON.stringify(i)),encryptedId:s,metadata:f.metadata,transportType:c});case 8:return d=e.sent,v={requester:f,pairingTopic:n,id:i.id,authPayload:l,verifyContext:d,expiryTimestamp:h},e.next=12,a.setAuthRequest(i.id,{request:v,pairingTopic:n,transportType:c});case 12:c===Ss&&null!=(r=f.metadata.redirect)&&r.universal&&a.client.core.addLinkModeSupportedApp(f.metadata.redirect.universal),a.client.events.emit("session_authenticate",{topic:n,params:i.params,id:i.id,verifyContext:d}),e.next=27;break;case 16:return e.prev=16,e.t0=e.catch(1),a.client.logger.error(e.t0),g=i.params.requester.publicKey,e.next=22,a.client.core.crypto.generateKeyPair();case 22:return y=e.sent,b=a.getAppLinkIfEnabled(i.params.requester.metadata,c),m={type:1,receiverPublicKey:g,senderPublicKey:y},e.next=27,a.sendError({id:i.id,topic:n,error:e.t0,encodeOpts:m,rpcOpts:Jf.wc_sessionAuthenticate.autoReject,appLink:b});case 27:case"end":return e.stop()}},e,null,[[1,16]])}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"addSessionRequestToSessionRequestQueue",function(e){n.sessionRequestQueue.queue.push(e)}),fl(y(n),"cleanupAfterResponse",function(e){n.deletePendingSessionRequest(e.response.id,{message:"fulfilled",code:0}),setTimeout(function(){n.sessionRequestQueue.state="IDLE",n.processSessionRequestQueue()},(0,d.toMiliseconds)(n.requestQueueDelay))}),fl(y(n),"cleanupPendingSentRequestsForTopic",function(e){var t=e.topic,r=e.error,i=n.client.core.history.pending;i.length>0&&i.filter(function(e){return e.topic===t&&"wc_sessionRequest"===e.request.method}).forEach(function(e){n.events.emit(Ne("session_request",e.request.id),{error:r})})}),fl(y(n),"processSessionRequestQueue",function(){if("ACTIVE"!==n.sessionRequestQueue.state){var e=n.sessionRequestQueue.queue[0];if(e)try{n.emitSessionRequest(e)}catch(Qt){n.client.logger.error(Qt)}else n.client.logger.info("session request queue is empty.")}else n.client.logger.info("session request queue is already active.")}),fl(y(n),"emitSessionRequest",function(e){n.emittedSessionRequests.has(e.id)?n.client.logger.warn({id:e.id},"Skipping emitting `session_request` event for duplicate request. id: ".concat(e.id)):(n.sessionRequestQueue.state="ACTIVE",n.emittedSessionRequests.add(e.id),n.client.events.emit("session_request",e))}),fl(y(n),"onPairingCreated",function(e){if(e.methods&&n.expectedPairingMethodMap.set(e.topic,e.methods),!e.active){var t=n.client.proposal.getAll().find(function(t){return t.pairingTopic===e.topic});t&&n.onSessionProposeRequest({topic:e.topic,payload:(0,vs.formatJsonRpcRequest)("wc_sessionPropose",ul(cl({},t),{requiredNamespaces:t.requiredNamespaces,optionalNamespaces:t.optionalNamespaces,relays:t.relays,proposer:t.proposer,sessionProperties:t.sessionProperties,scopedProperties:t.scopedProperties}),t.id),attestation:t.attestation,encryptedId:t.encryptedId})}}),fl(y(n),"isValidConnect",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s,c,u,f,l,h,d,v;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Za(t)){e.next=3;break}throw r=Ra("MISSING_OR_INVALID","connect() params: ".concat(JSON.stringify(t))),n=r.message,new Error(n);case 3:if(i=t.pairingTopic,o=t.requiredNamespaces,s=t.optionalNamespaces,c=t.sessionProperties,u=t.scopedProperties,f=t.relays,e.t0=Ua(i),e.t0){e.next=8;break}return e.next=8,a.isValidPairingTopic(i);case 8:if(function(e,t){var r=!1;return e?e&&Ba(e)&&e.length&&e.forEach(function(e){r=za(e)}):r=!0,r}(f)){e.next=11;break}throw l=Ra("MISSING_OR_INVALID","connect() relays: ".concat(f)),h=l.message,new Error(h);case 11:if(o&&!Ua(o)&&0!==Ca(o)&&(d="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces",["fatal","error","silent"].includes(a.client.logger.level)?console.warn(d):a.client.logger.warn(d),a.validateNamespaces(o,"requiredNamespaces")),s&&!Ua(s)&&0!==Ca(s)&&a.validateNamespaces(s,"optionalNamespaces"),c&&!Ua(c)&&a.validateSessionProps(c,"sessionProperties"),!u||Ua(u)){e.next=17;break}if(a.validateSessionProps(u,"scopedProperties"),v=Object.keys(o||{}).concat(Object.keys(s||{})),Object.keys(u).every(function(e){return v.includes(e.split(":")[0])})){e.next=17;break}throw new Error("Scoped properties must be a subset of required/optional namespaces, received: ".concat(JSON.stringify(u),", required/optional namespaces: ").concat(JSON.stringify(v)));case 17:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"validateNamespaces",function(e,t){var r=function(e,t,r){var n=null;if(e&&Ca(e)){var o=Ma(e,t);o&&(n=o);var a=function(e,t,r){var n=null;return Object.entries(e).forEach(function(e){var t=i(e,2),o=t[0],a=t[1];if(!n){var s=function(e,t,r){var n=null;return Ba(t)&&t.length?t.forEach(function(e){n||La(e)||(n=Ta("UNSUPPORTED_CHAINS","".concat(r,", chain ").concat(e,' should be a string and conform to "namespace:chainId" format')))}):La(e)||(n=Ta("UNSUPPORTED_CHAINS","".concat(r,', chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }'))),n}(o,ce(o,a),"".concat("connect()"," ").concat(r));s&&(n=s)}}),n}(e,0,r);a&&(n=a)}else n=Ra("MISSING_OR_INVALID","".concat(t,", ").concat(r," should be an object with data"));return n}(e,"connect()",t);if(r)throw new Error(r.message)}),fl(y(n),"isValidApprove",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s,c,u,f,l,h,d;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Za(t)){e.next=2;break}throw new Error(Ra("MISSING_OR_INVALID","approve() params: ".concat(t)).message);case 2:return r=t.id,n=t.namespaces,i=t.relayProtocol,o=t.sessionProperties,s=t.scopedProperties,a.checkRecentlyDeleted(r),e.next=6,a.isValidProposalId(r);case 6:if(c=a.client.proposal.get(r),!(u=qa(n,"approve()"))){e.next=9;break}throw new Error(u.message);case 9:if(!(f=Ka(c.requiredNamespaces,n,"approve()"))){e.next=12;break}throw new Error(f.message);case 12:if(Na(i,!0)){e.next=15;break}throw l=Ra("MISSING_OR_INVALID","approve() relayProtocol: ".concat(i)),h=l.message,new Error(h);case 15:if(o&&!Ua(o)&&a.validateSessionProps(o,"sessionProperties"),!s||Ua(s)){e.next=20;break}if(a.validateSessionProps(s,"scopedProperties"),d=new Set(Object.keys(n)),Object.keys(s).every(function(e){return d.has(e.split(":")[0])})){e.next=20;break}throw new Error("Scoped properties must be a subset of approved namespaces, received: ".concat(JSON.stringify(s),", approved namespaces: ").concat(Array.from(d).join(", ")));case 20:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"isValidReject",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s,c;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Za(t)){e.next=3;break}throw r=Ra("MISSING_OR_INVALID","reject() params: ".concat(t)),n=r.message,new Error(n);case 3:return i=t.id,o=t.reason,a.checkRecentlyDeleted(i),e.next=7,a.isValidProposalId(i);case 7:if(function(e){return!!(e&&"object"==typeof e&&e.code&&ja(e.code,!1)&&e.message&&Na(e.message,!1))}(o)){e.next=10;break}throw s=Ra("MISSING_OR_INVALID","reject() reason: ".concat(JSON.stringify(o))),c=s.message,new Error(c);case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"isValidSessionSettleRequest",function(e){if(!Za(e)){var t=Ra("MISSING_OR_INVALID","onSessionSettleRequest() params: ".concat(e)).message;throw new Error(t)}var r=e.relay,n=e.controller,i=e.namespaces,o=e.expiry;if(!za(r)){var a=Ra("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string").message;throw new Error(a)}var s=function(e,t){var r=null;return Na(null==e?void 0:e.publicKey,!1)||(r=Ra("MISSING_OR_INVALID","onSessionSettleRequest() controller public key should be a string")),r}(n);if(s)throw new Error(s.message);var c=qa(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(Ue(o)){var u=Ra("EXPIRED","onSessionSettleRequest()").message;throw new Error(u)}}),fl(y(n),"isValidUpdate",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s,c,u;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Za(t)){e.next=3;break}throw r=Ra("MISSING_OR_INVALID","update() params: ".concat(t)),n=r.message,new Error(n);case 3:return i=t.topic,o=t.namespaces,a.checkRecentlyDeleted(i),e.next=7,a.isValidSessionTopic(i);case 7:if(s=a.client.session.get(i),!(c=qa(o,"update()"))){e.next=10;break}throw new Error(c.message);case 10:if(!(u=Ka(s.requiredNamespaces,o,"update()"))){e.next=13;break}throw new Error(u.message);case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"isValidExtend",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Za(t)){e.next=3;break}throw r=Ra("MISSING_OR_INVALID","extend() params: ".concat(t)),n=r.message,new Error(n);case 3:return i=t.topic,a.checkRecentlyDeleted(i),e.next=7,a.isValidSessionTopic(i);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"isValidRequest",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,c,u,f,l,h,d,v,g,y,b;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Za(t)){e.next=3;break}throw r=Ra("MISSING_OR_INVALID","request() params: ".concat(t)),n=r.message,new Error(n);case 3:return i=t.topic,o=t.request,c=t.chainId,u=t.expiry,a.checkRecentlyDeleted(i),e.next=7,a.isValidSessionTopic(i);case 7:if(f=a.client.session.get(i),Fa(l=f.namespaces,c)){e.next=11;break}throw h=Ra("MISSING_OR_INVALID","request() chainId: ".concat(c)),d=h.message,new Error(d);case 11:if(function(e){return!(Ua(e)||!Na(e.method,!1))}(o)){e.next=14;break}throw v=Ra("MISSING_OR_INVALID","request() ".concat(JSON.stringify(o))),g=v.message,new Error(g);case 14:if(function(e,t,r){return!!Na(r,!1)&&function(e,t){var r=[];return Object.values(e).forEach(function(e){ka(e.accounts).includes(t)&&r.push.apply(r,s(e.methods))}),r}(e,t).includes(r)}(l,c,o.method)){e.next=17;break}throw y=Ra("MISSING_OR_INVALID","request() method: ".concat(o.method)),b=y.message,new Error(b);case 17:a.validateRequestExpiry(u);case 18:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"isValidRespond",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s,c,u,f,l,h;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Za(t)){e.next=3;break}throw n=Ra("MISSING_OR_INVALID","respond() params: ".concat(t)),i=n.message,new Error(i);case 3:return o=t.topic,s=t.response,e.prev=4,e.next=7,a.isValidSessionTopic(o);case 7:e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(4),null!=(r=null==t?void 0:t.response)&&r.id&&a.cleanupAfterResponse(t),e.t0;case 12:if(function(e){return!(Ua(e)||Ua(e.result)&&Ua(e.error)||!ja(e.id,!1)||!Na(e.jsonrpc,!1))}(s)){e.next=15;break}throw c=Ra("MISSING_OR_INVALID","respond() response: ".concat(JSON.stringify(s))),u=c.message,new Error(u);case 15:if((f=a.client.pendingRequest.get(s.id)).topic===o){e.next=19;break}throw l=Ra("MISMATCHED_TOPIC","Request response topic mismatch. reqId: ".concat(s.id,", expected topic: ").concat(f.topic,", received topic: ").concat(o)),h=l.message,new Error(h);case 19:case"end":return e.stop()}},e,null,[[4,9]])}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"isValidPing",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Za(t)){e.next=3;break}throw r=Ra("MISSING_OR_INVALID","ping() params: ".concat(t)),n=r.message,new Error(n);case 3:return i=t.topic,e.next=6,a.isValidSessionOrPairingTopic(i);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"isValidEmit",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,c,u,f,l,h,d,v,g,y;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Za(t)){e.next=3;break}throw r=Ra("MISSING_OR_INVALID","emit() params: ".concat(t)),n=r.message,new Error(n);case 3:return i=t.topic,o=t.event,c=t.chainId,e.next=6,a.isValidSessionTopic(i);case 6:if(u=a.client.session.get(i),Fa(f=u.namespaces,c)){e.next=10;break}throw l=Ra("MISSING_OR_INVALID","emit() chainId: ".concat(c)),h=l.message,new Error(h);case 10:if(function(e){return!(Ua(e)||!Na(e.name,!1))}(o)){e.next=13;break}throw d=Ra("MISSING_OR_INVALID","emit() event: ".concat(JSON.stringify(o))),v=d.message,new Error(v);case 13:if(function(e,t,r){return!!Na(r,!1)&&function(e,t){var r=[];return Object.values(e).forEach(function(e){ka(e.accounts).includes(t)&&r.push.apply(r,s(e.events))}),r}(e,t).includes(r)}(f,c,o.name)){e.next=16;break}throw g=Ra("MISSING_OR_INVALID","emit() event: ".concat(JSON.stringify(o))),y=g.message,new Error(y);case 16:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"isValidDisconnect",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Za(t)){e.next=3;break}throw r=Ra("MISSING_OR_INVALID","disconnect() params: ".concat(t)),n=r.message,new Error(n);case 3:return i=t.topic,e.next=6,a.isValidSessionOrPairingTopic(i);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"isValidAuthenticate",function(e){var t=e.chains,r=e.uri,n=e.domain,i=e.nonce;if(!Array.isArray(t)||0===t.length)throw new Error("chains is required and must be a non-empty array");if(!Na(r,!1))throw new Error("uri is required parameter");if(!Na(n,!1))throw new Error("domain is required parameter");if(!Na(i,!1))throw new Error("nonce is required parameter");if(s(new Set(t.map(function(e){return ae(e).namespace}))).length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");if("eip155"!==ae(t[0]).namespace)throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),fl(y(n),"getVerifyContext",function(){var e=(0,o.Z)(p().mark(function e(t){var r,n,i,o,s,c,u,f;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.attestationId,n=t.hash,i=t.encryptedId,o=t.metadata,s=t.transportType,c={verified:{verifyUrl:o.verifyUrl||Cs,validation:"UNKNOWN",origin:o.url||""}},e.prev=1,s!==Ss){e.next=5;break}return u=a.getAppLinkIfEnabled(o,s),e.abrupt("return",(c.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",c));case 5:return e.next=7,a.client.core.verify.resolve({attestationId:r,hash:n,encryptedId:i,verifyUrl:o.verifyUrl});case 7:(f=e.sent)&&(c.verified.origin=f.origin,c.verified.isScam=f.isScam,c.verified.validation=f.origin===new URL(o.url).origin?"VALID":"INVALID"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),a.client.logger.warn(e.t0);case 14:return e.abrupt("return",(a.client.logger.debug("Verify context: ".concat(JSON.stringify(c))),c));case 15:case"end":return e.stop()}},e,null,[[1,11]])}));return function(t){return e.apply(this,arguments)}}()),fl(y(n),"validateSessionProps",function(e,t){Object.values(e).forEach(function(r,n){if(null==r){var i=Ra("MISSING_OR_INVALID","".concat(t," must contain an existing value for each key. Received: ").concat(r," for key ").concat(Object.keys(e)[n])).message;throw new Error(i)}})}),fl(y(n),"getPendingAuthRequest",function(e){var t=n.client.auth.requests.get(e);return"object"==typeof t?t:void 0}),fl(y(n),"addToRecentlyDeleted",function(e,t){if(n.recentlyDeletedMap.set(e,t),n.recentlyDeletedMap.size>=n.recentlyDeletedLimit){var r,i=0,o=n.recentlyDeletedLimit/2,a=u(n.recentlyDeletedMap.keys());try{for(a.s();!(r=a.n()).done;){var s=r.value;if(i++>=o)break;n.recentlyDeletedMap.delete(s)}}catch(c){a.e(c)}finally{a.f()}}}),fl(y(n),"checkRecentlyDeleted",function(e){var t=n.recentlyDeletedMap.get(e);if(t){var r=Ra("MISSING_OR_INVALID","Record was recently deleted - ".concat(t,": ").concat(e)).message;throw new Error(r)}}),fl(y(n),"isLinkModeEnabled",function(e,t){var r,i,o,a,s,c,u,f,l;return!(!e||t!==Ss)&&!0===(null==(i=null==(r=n.client.metadata)?void 0:r.redirect)?void 0:i.linkMode)&&void 0!==(null==(a=null==(o=n.client.metadata)?void 0:o.redirect)?void 0:a.universal)&&""!==(null==(c=null==(s=n.client.metadata)?void 0:s.redirect)?void 0:c.universal)&&void 0!==(null==(u=null==e?void 0:e.redirect)?void 0:u.universal)&&""!==(null==(f=null==e?void 0:e.redirect)?void 0:f.universal)&&!0===(null==(l=null==e?void 0:e.redirect)?void 0:l.linkMode)&&n.client.core.linkModeSupportedApps.includes(e.redirect.universal)&&typeof(null==global?void 0:global.Linking)<"u"}),fl(y(n),"getAppLinkIfEnabled",function(e,t){var r;return n.isLinkModeEnabled(e,t)?null==(r=null==e?void 0:e.redirect)?void 0:r.universal:void 0}),fl(y(n),"handleLinkModeMessage",function(e){var t=e.url;if(t&&t.includes("wc_ev")&&t.includes("topic")){var r=ze(t,"topic")||"",i=decodeURIComponent(ze(t,"wc_ev")||""),o=n.client.session.keys.includes(r);o&&n.client.session.update(r,{transportType:Ss}),n.client.core.dispatchEnvelope({topic:r,message:i,sessionExists:o})}}),fl(y(n),"registerLinkModeListeners",(0,o.Z)(p().mark(function e(){var t,r,n;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Fe()||we()&&null!=(t=a.client.metadata.redirect)&&t.linkMode)){e.next=8;break}if(!(typeof(r=null==global?void 0:global.Linking)<"u")){e.next=8;break}return r.addEventListener("url",a.handleLinkModeMessage,a.client.name),e.next=6,r.getInitialURL();case 6:(n=e.sent)&&setTimeout(function(){a.handleLinkModeMessage({url:n})},50);case 8:case"end":return e.stop()}},e)}))),fl(y(n),"getTVFApproveParams",function(e){try{var t=Ea(e.namespaces),r=function(e){var t=[];return Object.values(e).forEach(function(e){t.push.apply(t,s(e.methods))}),s(new Set(t))}(e.namespaces),i=function(e){var t=[];return Object.values(e).forEach(function(e){t.push.apply(t,s(e.events))}),s(new Set(t))}(e.namespaces);return{approvedChains:t,approvedMethods:r,approvedEvents:i,sessionProperties:e.sessionProperties,scopedProperties:e.scopedProperties}}catch(t){return n.client.logger.warn(t,"Error getting TVF approve params"),{}}}),fl(y(n),"getTVFParams",function(e,t,r){var i,o,a;if(null==(i=t.request)||!i.method)return{};var s={correlationId:e,rpcMethods:[t.request.method],chainId:t.chainId};try{var c=n.extractTxHashesFromResult(t.request,r);s.txHashes=c,s.contractAddresses=n.isValidContractData(t.request.params)?[null==(a=null==(o=t.request.params)?void 0:o[0])?void 0:a.to]:[]}catch(u){n.client.logger.warn(u,"Error getting TVF params")}return s}),fl(y(n),"isValidContractData",function(e){var t;if(!e)return!1;try{var r=(null==e?void 0:e.data)||(null==(t=null==e?void 0:e[0])?void 0:t.data);if(!r.startsWith("0x"))return!1;var n=r.slice(2);return!!/^[0-9a-fA-F]*$/.test(n)&&n.length%2==0}catch(i){}return!1}),fl(y(n),"extractTxHashesFromResult",function(e,t){var r;try{if(!t)return[];var i=e.method,o=Qf[i];if("sui_signTransaction"===i)return[Vr(t.transactionBytes)];if("near_signTransaction"===i)return[Hr(t)];if("near_signTransactions"===i)return t.map(function(e){return Hr(e)});if("xrpl_signTransactionFor"===i||"xrpl_signTransaction"===i)return[null==(r=t.tx_json)?void 0:r.hash];if("polkadot_signTransaction"===i)return[Qa({transaction:e.params.transactionPayload,signature:t.signature})];if("algo_signTxn"===i)return Ba(t)?t.map(function(e){return Wr(e)}):[Wr(t)];if("cosmos_signDirect"===i)return[Jr(t)];if("wallet_sendCalls"===i)return function(e){var r,n,i=[];try{if("string"==typeof e)return i.push(e),i;if("object"!=typeof e)return i;null!=e&&e.id&&i.push(e.id);var o=null==(n=null==(r=null==e?void 0:e.capabilities)?void 0:r.caip345)?void 0:n.transactionHashes;o&&i.push.apply(i,s(o))}catch(t){console.warn("getWalletSendCallsHashes failed: ",t)}return i}(t);if("string"==typeof t)return[t];var a=t[o.key];if(Ba(a))return"solana_signAllTransactions"===i?a.map(function(e){return function(e){for(var t=atob(e),r=new Uint8Array(t.length),n=0;n<t.length;n++)r[n]=t.charCodeAt(n);var i=r[0];if(0===i)throw new Error("No signatures found");if(r.length<1+64*i)throw new Error("Transaction data too short for claimed signature count");if(r.length<100)throw new Error("Transaction too short");var o=Buffer.from(e,"base64").slice(1,65);return ee.Jq.encode(o)}(e)}):a;if("string"==typeof a)return[a]}catch(i){n.client.logger.warn(i,"Error extracting tx hashes from result")}return[]}),n}return x(r,[{key:"processPendingMessageEvents",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){var r,n,o,a,s,c,f,l,h;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,r=e.client.core.relayer.messages.getWithoutAck(e.client.session.keys),n=0,o=Object.entries(r);case 3:if(!(n<o.length)){t.next=31;break}a=i(o[n],2),s=a[0],c=a[1],f=u(c),t.prev=6,f.s();case 8:if((l=f.n()).done){t.next=20;break}return h=l.value,t.prev=10,t.next=13,e.onProviderMessageEvent({topic:s,message:h,publishedAt:Date.now()});case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(10),e.client.logger.warn("Error processing pending message event for topic: ".concat(s,", message: ").concat(h));case 18:t.next=8;break;case 20:t.next=25;break;case 22:t.prev=22,t.t1=t.catch(6),f.e(t.t1);case 25:return t.prev=25,f.f(),t.finish(25);case 28:n++,t.next=3;break;case 31:t.next=36;break;case 33:t.prev=33,t.t2=t.catch(0),e.client.logger.warn(t.t2,"processPendingMessageEvents failed");case 36:case"end":return t.stop()}},t,null,[[0,33],[6,22,25,28],[10,15]])}))()}},{key:"isInitialized",value:function(){if(!this.initialized){var e=Ra("NOT_INITIALIZED",this.name).message;throw new Error(e)}}},{key:"confirmOnlineStateOrThrow",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.client.core.relayer.confirmOnlineStateOrThrow();case 2:case"end":return t.stop()}},t)}))()}},{key:"registerRelayerEvents",value:function(){var e=this;this.client.core.relayer.on("relayer_message",function(t){e.onProviderMessageEvent(t)})}},{key:"onRelayMessage",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){var n,i,o,a,s,c,u;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.topic,i=e.message,o=e.attestation,a=e.transportType,s=t.client.auth.authKeys.keys.includes(el)?t.client.auth.authKeys.get(el):{responseTopic:void 0,publicKey:void 0},c=s.publicKey,r.prev=1,r.next=4,t.client.core.crypto.decode(n,i,{receiverPublicKey:c,encoding:a===Ss?Do:Lo});case 4:if(u=r.sent,!(0,vs.isJsonRpcRequest)(u)){r.next=11;break}return t.client.core.history.set(n,u),r.next=9,t.onRelayEventRequest({topic:n,payload:u,attestation:o,transportType:a,encryptedId:Zo(i)});case 9:r.next=22;break;case 11:if(!(0,vs.isJsonRpcResponse)(u)){r.next=19;break}return r.next=14,t.client.core.history.resolve(u);case 14:return r.next=16,t.onRelayEventResponse({topic:n,payload:u,transportType:a});case 16:t.client.core.history.delete(n,u.id),r.next=22;break;case 19:return t.client.logger.error("onRelayMessage() -> unknown payload: ".concat(JSON.stringify(u))),r.next=22,t.onRelayEventUnknownPayload({topic:n,payload:u,transportType:a});case 22:return r.next=24,t.client.core.relayer.messages.ack(n,i);case 24:r.next=29;break;case 26:r.prev=26,r.t0=r.catch(1),t.client.logger.error("onRelayMessage() -> failed to process an inbound message: ".concat(i)),t.client.logger.error(r.t0);case 29:case"end":return r.stop()}},r,null,[[1,26]])}))()}},{key:"registerExpirerEvents",value:function(){var e=this;this.client.core.expirer.on(Ts,function(){var t=(0,o.Z)(p().mark(function t(r){var n,i,o;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=Be(r.target),i=n.topic,!(o=n.id)||!e.client.pendingRequest.keys.includes(o)){t.next=7;break}return t.next=4,e.deletePendingSessionRequest(o,Ra("EXPIRED"),!0);case 4:t.t0=t.sent,t.next=30;break;case 7:if(!o||!e.client.auth.requests.keys.includes(o)){t.next=13;break}return t.next=10,e.deletePendingAuthRequest(o,Ra("EXPIRED"),!0);case 10:t.t1=t.sent,t.next=29;break;case 13:if(!i){t.next=22;break}if(t.t3=e.client.session.keys.includes(i),!t.t3){t.next=19;break}return t.next=18,e.deleteSession({topic:i,expirerHasDeleted:!0});case 18:t.t3=e.client.events.emit("session_expire",{topic:i});case 19:t.t2=t.t3,t.next=28;break;case 22:if(t.t4=o,!t.t4){t.next=27;break}return t.next=26,e.deleteProposal(o,!0);case 26:t.t4=e.client.events.emit("proposal_expire",{id:o});case 27:t.t2=t.t4;case 28:t.t1=void t.t2;case 29:t.t0=t.t1;case 30:return t.abrupt("return",t.t0);case 31:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())}},{key:"registerPairingEvents",value:function(){var e=this;this.client.core.pairing.events.on("pairing_create",function(t){return e.onPairingCreated(t)}),this.client.core.pairing.events.on("pairing_delete",function(t){e.addToRecentlyDeleted(t.topic,"pairing")})}},{key:"isValidPairingTopic",value:function(e){if(!Na(e,!1)){var t=Ra("MISSING_OR_INVALID","pairing topic should be a string: ".concat(e)).message;throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){var r=Ra("NO_MATCHING_KEY","pairing topic doesn't exist: ".concat(e)).message;throw new Error(r)}if(Ue(this.client.core.pairing.pairings.get(e).expiry)){var n=Ra("EXPIRED","pairing topic: ".concat(e)).message;throw new Error(n)}}},{key:"isValidSessionTopic",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){var n,i,o,a,s,c,u,f;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(Na(e,!1)){r.next=3;break}throw n=Ra("MISSING_OR_INVALID","session topic should be a string: ".concat(e)),i=n.message,new Error(i);case 3:if(t.checkRecentlyDeleted(e),t.client.session.keys.includes(e)){r.next=6;break}throw o=Ra("NO_MATCHING_KEY","session topic doesn't exist: ".concat(e)),a=o.message,new Error(a);case 6:if(!Ue(t.client.session.get(e).expiry)){r.next=11;break}return r.next=9,t.deleteSession({topic:e});case 9:throw s=Ra("EXPIRED","session topic: ".concat(e)),c=s.message,new Error(c);case 11:if(t.client.core.crypto.keychain.has(e)){r.next=16;break}return u=Ra("MISSING_OR_INVALID","session topic does not exist in keychain: ".concat(e)),f=u.message,r.next=15,t.deleteSession({topic:e});case 15:throw new Error(f);case 16:case"end":return r.stop()}},r)}))()}},{key:"isValidSessionOrPairingTopic",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){var n,i,o,a;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t.checkRecentlyDeleted(e),!t.client.session.keys.includes(e)){r.next=5;break}return r.next=3,t.isValidSessionTopic(e);case 3:r.next=12;break;case 5:if(t.client.core.pairing.pairings.keys.includes(e)){r.next=11;break}if(!Na(e,!1)){r.next=9;break}throw n=Ra("NO_MATCHING_KEY","session or pairing topic doesn't exist: ".concat(e)),i=n.message,new Error(i);case 9:throw o=Ra("MISSING_OR_INVALID","session or pairing topic should be a string: ".concat(e)),a=o.message,new Error(a);case 11:t.isValidPairingTopic(e);case 12:case"end":return r.stop()}},r)}))()}},{key:"isValidProposalId",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){var n,i,o,a,s,c;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(function(e){return"number"==typeof e}(e)){r.next=3;break}throw n=Ra("MISSING_OR_INVALID","proposal id should be a number: ".concat(e)),i=n.message,new Error(i);case 3:if(t.client.proposal.keys.includes(e)){r.next=6;break}throw o=Ra("NO_MATCHING_KEY","proposal id doesn't exist: ".concat(e)),a=o.message,new Error(a);case 6:if(!Ue(t.client.proposal.get(e).expiryTimestamp)){r.next=11;break}return r.next=9,t.deleteProposal(e);case 9:throw s=Ra("EXPIRED","proposal id: ".concat(e)),c=s.message,new Error(c);case 11:case"end":return r.stop()}},r)}))()}},{key:"validateRequestExpiry",value:function(e){if(e&&!function(e,t){return ja(e,!1)&&e<=t.max&&e>=t.min}(e,Yf)){var t=Ra("MISSING_OR_INVALID","request() expiry: ".concat(e,". Expiry must be a number (in seconds) between ").concat(Yf.min," and ").concat(Yf.max)).message;throw new Error(t)}}}]),r}(function(){return x(function e(t){k(this,e),this.client=t})}()),pl=function(e){h(r,e);var t=v(r);function r(e,n){var i;return k(this,r),(i=t.call(this,e,n,"proposal",Vf)).core=e,i.logger=n,i}return x(r)}(pf),hl=function(e){h(r,e);var t=v(r);function r(e,n){var i;return k(this,r),(i=t.call(this,e,n,"session",Vf)).core=e,i.logger=n,i}return x(r)}(pf),dl=function(e){h(r,e);var t=v(r);function r(e,n){var i;return k(this,r),i=t.call(this,e,n,"request",Vf,function(e){return e.id}),i.core=e,i.logger=n,i}return x(r)}(pf),vl=function(e){h(r,e);var t=v(r);function r(e,n){var i;return k(this,r),(i=t.call(this,e,n,"authKeys",$f,function(){return el})).core=e,i.logger=n,i}return x(r)}(pf),gl=function(e){h(r,e);var t=v(r);function r(e,n){var i;return k(this,r),(i=t.call(this,e,n,"pairingTopics",$f)).core=e,i.logger=n,i}return x(r)}(pf),yl=function(e){h(r,e);var t=v(r);function r(e,n){var i;return k(this,r),i=t.call(this,e,n,"requests",$f,function(e){return e.id}),i.core=e,i.logger=n,i}return x(r)}(pf),bl=Object.defineProperty,ml=function(e,t,r){return function(e,t,r){return t in e?bl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r}(e,"symbol"!=typeof t?t+"":t,r)},wl=function(){function e(t,r){k(this,e),this.core=t,this.logger=r,ml(this,"authKeys"),ml(this,"pairingTopics"),ml(this,"requests"),this.authKeys=new vl(this.core,this.logger),this.pairingTopics=new gl(this.core,this.logger),this.requests=new yl(this.core,this.logger)}return x(e,[{key:"init",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authKeys.init();case 2:return t.next=4,e.pairingTopics.init();case 4:return t.next=6,e.requests.init();case 6:case"end":return t.stop()}},t)}))()}}]),e}(),xl=Object.defineProperty,kl=function(e,t,r){return function(e,t,r){return t in e?xl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r}(e,"symbol"!=typeof t?t+"":t,r)},El=function(e){h(r,e);var t=v(r);function r(e){var n,i;k(this,r),n=t.call(this,e),i=y(n),kl(y(n),"protocol","wc"),kl(y(n),"version",2),kl(y(n),"name","client"),kl(y(n),"metadata"),kl(y(n),"core"),kl(y(n),"logger"),kl(y(n),"events",new f.EventEmitter),kl(y(n),"engine"),kl(y(n),"session"),kl(y(n),"proposal"),kl(y(n),"pendingRequest"),kl(y(n),"auth"),kl(y(n),"signConfig"),kl(y(n),"on",function(e,t){return n.events.on(e,t)}),kl(y(n),"once",function(e,t){return n.events.once(e,t)}),kl(y(n),"off",function(e,t){return n.events.off(e,t)}),kl(y(n),"removeListener",function(e,t){return n.events.removeListener(e,t)}),kl(y(n),"removeAllListeners",function(e){return n.events.removeAllListeners(e)}),kl(y(n),"connect",function(){var e=(0,o.Z)(p().mark(function e(t){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.engine.connect(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),i.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}()),kl(y(n),"pair",function(){var e=(0,o.Z)(p().mark(function e(t){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.engine.pair(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),i.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}()),kl(y(n),"approve",function(){var e=(0,o.Z)(p().mark(function e(t){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.engine.approve(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),i.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}()),kl(y(n),"reject",function(){var e=(0,o.Z)(p().mark(function e(t){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.engine.reject(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),i.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}()),kl(y(n),"update",function(){var e=(0,o.Z)(p().mark(function e(t){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.engine.update(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),i.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}()),kl(y(n),"extend",function(){var e=(0,o.Z)(p().mark(function e(t){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.engine.extend(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),i.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}()),kl(y(n),"request",function(){var e=(0,o.Z)(p().mark(function e(t){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.engine.request(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),i.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}()),kl(y(n),"respond",function(){var e=(0,o.Z)(p().mark(function e(t){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.engine.respond(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),i.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}()),kl(y(n),"ping",function(){var e=(0,o.Z)(p().mark(function e(t){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.engine.ping(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),i.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}()),kl(y(n),"emit",function(){var e=(0,o.Z)(p().mark(function e(t){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.engine.emit(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),i.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}()),kl(y(n),"disconnect",function(){var e=(0,o.Z)(p().mark(function e(t){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.engine.disconnect(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),i.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}()),kl(y(n),"find",function(e){try{return n.engine.find(e)}catch(Xt){throw n.logger.error(Xt.message),Xt}}),kl(y(n),"getPendingSessionRequests",function(){try{return n.engine.getPendingSessionRequests()}catch(Qt){throw n.logger.error(Qt.message),Qt}}),kl(y(n),"authenticate",function(){var e=(0,o.Z)(p().mark(function e(t,r){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.engine.authenticate(t,r);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),i.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,r){return e.apply(this,arguments)}}()),kl(y(n),"formatAuthMessage",function(e){try{return n.engine.formatAuthMessage(e)}catch(Xt){throw n.logger.error(Xt.message),Xt}}),kl(y(n),"approveSessionAuthenticate",function(){var e=(0,o.Z)(p().mark(function e(t){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.engine.approveSessionAuthenticate(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),i.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}()),kl(y(n),"rejectSessionAuthenticate",function(){var e=(0,o.Z)(p().mark(function e(t){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.engine.rejectSessionAuthenticate(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),i.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}()),n.name=(null==e?void 0:e.name)||"client",n.metadata=function(e){var t,r,n=Ie();try{return null!=e&&e.url&&n.url&&new URL(e.url).host!==new URL(n.url).host&&(console.warn("The configured WalletConnect 'metadata.url':".concat(e.url," differs from the actual page url:").concat(n.url,". This is probably unintended and can lead to issues.")),e.url=n.url),null!=(t=null==e?void 0:e.icons)&&t.length&&e.icons.length>0&&(e.icons=e.icons.filter(function(e){return""!==e})),function(e,t){return fe(e,le(t))}(ge(ge({},n),e),{url:(null==e?void 0:e.url)||n.url,name:(null==e?void 0:e.name)||n.name,description:(null==e?void 0:e.description)||n.description,icons:null!=(r=null==e?void 0:e.icons)&&r.length&&e.icons.length>0?e.icons:n.icons})}catch(Qt){return console.warn("Error populating app metadata",Qt),e||n}}(null==e?void 0:e.metadata),n.signConfig=null==e?void 0:e.signConfig;var a=Xa({logger:(null==e?void 0:e.logger)||"error",name:n.name});return n.logger=a,n.core=(null==e?void 0:e.core)||new Kf(e),n.session=new hl(n.core,n.logger),n.proposal=new pl(n.core,n.logger),n.pendingRequest=new dl(n.core,n.logger),n.engine=new ll(y(n)),n.auth=new wl(n.core,n.logger),n}return x(r,[{key:"context",get:function(){return(0,oe.Fd)(this.logger)}},{key:"pairing",get:function(){return this.core.pairing.pairings}},{key:"initialize",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.logger.trace("Initialized"),t.prev=1,t.next=4,e.core.start();case 4:return t.next=6,e.session.init();case 6:return t.next=8,e.proposal.init();case 8:return t.next=10,e.pendingRequest.init();case 10:return t.next=12,e.auth.init();case 12:return t.next=14,e.engine.init();case 14:e.logger.info("SignClient Initialization Success"),t.next=20;break;case 17:throw t.prev=17,t.t0=t.catch(1),e.logger.info("SignClient Initialization Failure"),e.logger.error(t.t0.message),t.t0;case 20:case"end":return t.stop()}},t,null,[[1,17]])}))()}}],[{key:"init",value:function(e){return(0,o.Z)(p().mark(function t(){var n;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new r(e),t.next=3,n.initialize();case 3:return t.abrupt("return",n);case 4:case"end":return t.stop()}},t)}))()}}]),r}(function(){return x(function e(t){k(this,e),this.opts=t,ps(this,"protocol","wc"),ps(this,"version",2)})}()),Il=El,Sl=n(39330);function Ol(e){return"__proto__"===e}function _l(e){return null==e||"object"!=typeof e&&"function"!=typeof e}function Pl(e){return Object.getOwnPropertySymbols(e).filter(function(t){return Object.prototype.propertyIsEnumerable.call(e,t)})}function Al(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}var Rl="[object String]",Tl="[object Number]",Bl="[object Boolean]",Cl="[object Arguments]",Ul="[object Object]";function Nl(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function jl(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Map,o=arguments.length>4?arguments[4]:void 0,a=null==o?void 0:o(e,t,r,n);if(void 0!==a)return a;if(_l(e))return e;if(n.has(e))return n.get(e);if(Array.isArray(e)){var s=new Array(e.length);n.set(e,s);for(var c=0;c<e.length;c++)s[c]=jl(e[c],c,r,n,o);return Object.hasOwn(e,"index")&&(s.index=e.index),Object.hasOwn(e,"input")&&(s.input=e.input),s}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){var f=new RegExp(e.source,e.flags);return f.lastIndex=e.lastIndex,f}if(e instanceof Map){var l=new Map;n.set(e,l);var p,h=u(e);try{for(h.s();!(p=h.n()).done;){var d=i(p.value,2),v=d[0],g=d[1];l.set(v,jl(g,v,r,n,o))}}catch(T){h.e(T)}finally{h.f()}return l}if(e instanceof Set){var y=new Set;n.set(e,y);var b,m=u(e);try{for(m.s();!(b=m.n()).done;){var w=b.value;y.add(jl(w,void 0,r,n,o))}}catch(T){m.e(T)}finally{m.f()}return y}if(typeof Buffer<"u"&&Buffer.isBuffer(e))return e.subarray();if(Nl(e)){var x=new(Object.getPrototypeOf(e).constructor)(e.length);n.set(e,x);for(var k=0;k<e.length;k++)x[k]=jl(e[k],k,r,n,o);return x}if(e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){var E=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return n.set(e,E),Ll(E,e,r,n,o),E}if(typeof File<"u"&&e instanceof File){var I=new File([e],e.name,{type:e.type});return n.set(e,I),Ll(I,e,r,n,o),I}if(typeof Blob<"u"&&e instanceof Blob){var S=new Blob([e],{type:e.type});return n.set(e,S),Ll(S,e,r,n,o),S}if(e instanceof Error){var O=new e.constructor;return n.set(e,O),O.message=e.message,O.name=e.name,O.stack=e.stack,O.cause=e.cause,Ll(O,e,r,n,o),O}if(e instanceof Boolean){var _=new Boolean(e.valueOf());return n.set(e,_),Ll(_,e,r,n,o),_}if(e instanceof Number){var P=new Number(e.valueOf());return n.set(e,P),Ll(P,e,r,n,o),P}if(e instanceof String){var A=new String(e.valueOf());return n.set(e,A),Ll(A,e,r,n,o),A}if("object"==typeof e&&function(e){switch(Al(e)){case Cl:case"[object Array]":case"[object ArrayBuffer]":case"[object DataView]":case Bl:case"[object Date]":case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Map]":case Tl:case Ul:case"[object RegExp]":case"[object Set]":case Rl:case"[object Symbol]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return!0;default:return!1}}(e)){var R=Object.create(Object.getPrototypeOf(e));return n.set(e,R),Ll(R,e,r,n,o),R}return e}function Ll(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,o=[].concat(s(Object.keys(t)),s(Pl(t))),a=0;a<o.length;a++){var c=o[a],u=Object.getOwnPropertyDescriptor(e,c);(null==u||u.writable)&&(e[c]=jl(t[c],c,r,n,i))}}function Dl(e){return function(e,t){return function(e,t){return jl(e,void 0,e,new Map,t)}(e,function(t,r,n,i){if("object"==typeof e){if(Al(e)===Ul&&"function"!=typeof e.constructor){var o={};return i.set(e,o),Ll(o,e,n,i),o}switch(Object.prototype.toString.call(e)){case Tl:case Rl:case Bl:var a=new e.constructor(null==e?void 0:e.valueOf());return Ll(a,e),a;case Cl:var s={};return Ll(s,e),s.length=e.length,s[Symbol.iterator]=e[Symbol.iterator],s;default:return}}})}(e)}function Ml(e){return null!==e&&"object"==typeof e&&"[object Arguments]"===Al(e)}function ql(e){return"object"==typeof e&&null!==e}function zl(e){return ql(e)&&function(e){return null!=e&&"function"!=typeof e&&function(e){return Number.isSafeInteger(e)&&e>=0}(e.length)}(e)}function Zl(){}function Fl(e){return Nl(e)}function Kl(e){if("object"!=typeof e||null==e)return!1;if(null===Object.getPrototypeOf(e))return!0;if("[object Object]"!==Object.prototype.toString.call(e)){var t,r=e[Symbol.toStringTag];return!(null==r||null===(t=Object.getOwnPropertyDescriptor(e,Symbol.toStringTag))||void 0===t||!t.writable)&&e.toString()==="[object ".concat(r,"]")}for(var n=e;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(e)===n}function Vl(e,t,r,n){if(_l(e)&&(e=Object(e)),null==t||"object"!=typeof t)return e;if(n.has(t))return function(e){if(_l(e))return e;if(Array.isArray(e)||Nl(e)||e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer)return e.slice(0);var t=Object.getPrototypeOf(e);if(null==t)return Object.assign(Object.create(t),e);var r,n=t.constructor;if(e instanceof Date||e instanceof Map||e instanceof Set)return new n(e);if(e instanceof RegExp){var i=new n(e);return i.lastIndex=e.lastIndex,i}if(e instanceof DataView)return new n(e.buffer.slice(0));if(e instanceof Error)return(r=e instanceof AggregateError?new n(e.errors,e.message,{cause:e.cause}):new n(e.message,{cause:e.cause})).stack=e.stack,Object.assign(r,e),r;if(typeof File<"u"&&e instanceof File)return new n([e],e.name,{type:e.type,lastModified:e.lastModified});if("object"==typeof e){var o=Object.create(t);return Object.assign(o,e)}return e}(n.get(t));if(n.set(t,e),Array.isArray(t)){t=t.slice();for(var i=0;i<t.length;i++){var o;t[i]=null!==(o=t[i])&&void 0!==o?o:void 0}}for(var c=[].concat(s(Object.keys(t)),s(Pl(t))),u=0;u<c.length;u++){var f=c[u];if(!Ol(f)){var l=t[f],p=e[f];if(Ml(l)&&(l=a({},l)),Ml(p)&&(p=a({},p)),typeof Buffer<"u"&&Buffer.isBuffer(l)&&(l=Dl(l)),Array.isArray(l))if(Array.isArray(p)){for(var h=[],d=Reflect.ownKeys(p),v=0;v<d.length;v++){var g=d[v];h[g]=p[g]}p=h}else if(zl(p)){for(var y=[],b=0;b<p.length;b++)y[b]=p[b];p=y}else p=[];var m=r(p,l,f,e,t,n);void 0!==m?e[f]=m:Array.isArray(l)||ql(p)&&ql(l)&&(Kl(p)||Kl(l)||Fl(p)||Fl(l))?e[f]=Vl(p,l,r,n):null==p&&Kl(l)?e[f]=Vl({},l,r,n):null==p&&Fl(l)?e[f]=Dl(l):(void 0===p||void 0!==l)&&(e[f]=l)}}return e}var Hl="universal_provider",Wl="wc@2:".concat(Hl,":"),Gl="https://rpc.walletconnect.org/v1/",Jl="generic",Yl="".concat(Gl,"bundler"),Ql="call_status",Xl=Object.defineProperty,$l=Object.defineProperties,ep=Object.getOwnPropertyDescriptors,tp=Object.getOwnPropertySymbols,rp=Object.prototype.hasOwnProperty,np=Object.prototype.propertyIsEnumerable,ip=function(e,t,r){return t in e?Xl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},op=function(e,t){for(var r in t||(t={}))rp.call(t,r)&&ip(e,r,t[r]);if(tp){var n,i=u(tp(t));try{for(i.s();!(n=i.n()).done;){r=n.value;np.call(t,r)&&ip(e,r,t[r])}}catch(o){i.e(o)}finally{i.f()}}return e},ap=function(e,t){return $l(e,ep(t))};function sp(e,t,r){var n,i=ae(e);return(null==(n=t.rpcMap)?void 0:n[i.reference])||"".concat(Gl,"?chainId=").concat(i.namespace,":").concat(i.reference,"&projectId=").concat(r)}function cp(e){return e.map(function(e){return"".concat(e.split(":")[0],":").concat(e.split(":")[1])})}function up(e){return Object.fromEntries(Object.entries(e).filter(function(e){var t,r,n=i(e,2),o=(n[0],n[1]);return(null==(t=null==o?void 0:o.chains)?void 0:t.length)&&(null==(r=null==o?void 0:o.chains)?void 0:r.length)>0}))}function fp(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return(function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var i=r.slice(0,-1),o=r[r.length-1],a=e,s=0;s<i.length;s++)a=Vl(a,i[s],o,new Map);return a}).apply(void 0,[e].concat(r,[Zl]))}(up(lp(e)),up(lp(t)))}function lp(e){var t,r,n,o,a,s={};if(!Ca(e))return s;for(var c=0,u=Object.entries(e);c<u.length;c++){var f=i(u[c],2),l=f[0],p=f[1],h=Ia(l)?[l]:p.chains,d=p.methods||[],v=p.events||[],g=p.rpcMap||{},y=Sa(l);s[y]=ap(op(op({},s[y]),p),{chains:je(h,null==(t=s[y])?void 0:t.chains),methods:je(d,null==(r=s[y])?void 0:r.methods),events:je(v,null==(n=s[y])?void 0:n.events)}),(Ca(g)||Ca((null==(o=s[y])?void 0:o.rpcMap)||{}))&&(s[y].rpcMap=op(op({},g),null==(a=s[y])?void 0:a.rpcMap))}return s}function pp(e){return e.includes(":")?e.split(":")[2]:e}function hp(e){for(var t={},r=0,n=Object.entries(e);r<n.length;r++){var o=i(n[r],2),a=o[0],s=o[1],c=s.methods||[],u=s.events||[],f=s.accounts||[],l=Ia(a)?[a]:s.chains?s.chains:cp(s.accounts);t[a]={chains:l,methods:c,events:u,accounts:f}}return t}function dp(e){return"number"==typeof e?e:e.includes("0x")?parseInt(e,16):(e=e.includes(":")?e.split(":")[1]:e,isNaN(Number(e))?e:Number(e))}var vp,gp={},yp=function(e){return gp[e]},bp=function(e,t){gp[e]=t},mp=Object.defineProperty,wp=Object.getOwnPropertySymbols,xp=Object.prototype.hasOwnProperty,kp=Object.prototype.propertyIsEnumerable,Ep=function(e,t,r){return t in e?mp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Ip=function(e,t){for(var r in t||(t={}))xp.call(t,r)&&Ep(e,r,t[r]);if(wp){var n,i=u(wp(t));try{for(i.s();!(n=i.n()).done;){r=n.value;kp.call(t,r)&&Ep(e,r,t[r])}}catch(o){i.e(o)}finally{i.f()}}return e},Sp=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],Op=function(e){return e&&e.startsWith("0x")?BigInt(e).toString(10):e},_p=function(e){return e&&e.startsWith("0x")?e:"0x".concat(BigInt(e).toString(16))},Pp=function(e){return Object.keys(e).filter(function(e){return Sp.includes(e)}).reduce(function(t,r){return t[r]=Ap(e[r]),t},{})},Ap=function(e){return"string"==typeof e&&function(e){try{var t=JSON.parse(e);return"object"==typeof t&&null!==t&&!Array.isArray(t)}catch(r){return!1}}(e)?JSON.parse(e):e},Rp=Object.defineProperty,Tp=function(){function e(t){k(this,e),function(e,t,r){!function(e,t,r){t in e?Rp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r}(e,t+"",void 0)}(this,"storage"),this.storage=t}return x(e,[{key:"getItem",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.storage.getItem(e);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},r)}))()}},{key:"setItem",value:function(e,t){var r=this;return(0,o.Z)(p().mark(function n(){return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.storage.setItem(e,t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n)}))()}},{key:"removeItem",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.storage.removeItem(e);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},r)}))()}}],[{key:"getStorage",value:function(t){return vp||(vp=new e(t)),vp}}]),e}(),Bp=Object.defineProperty,Cp=Object.defineProperties,Up=Object.getOwnPropertyDescriptors,Np=Object.getOwnPropertySymbols,jp=Object.prototype.hasOwnProperty,Lp=Object.prototype.propertyIsEnumerable,Dp=function(e,t,r){return t in e?Bp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Mp=function(e,t){for(var r in t||(t={}))jp.call(t,r)&&Dp(e,r,t[r]);if(Np){var n,i=u(Np(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Lp.call(t,r)&&Dp(e,r,t[r])}}catch(o){i.e(o)}finally{i.f()}}return e},qp=function(e,t){return Cp(e,Up(t))};function zp(){return zp=(0,o.Z)(p().mark(function e(t,r){var n,i,o,a,s,c,u,f,l;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=ae(t.result.capabilities.caip345.caip2),i=t.result.capabilities.caip345.transactionHashes,e.next=4,Promise.allSettled(i.map(function(e){return Zp(n.reference,e,r)}));case 4:return o=e.sent,a=o.filter(function(e){return"fulfilled"===e.status}).map(function(e){return e.value}).filter(function(e){return e}),o.filter(function(e){return"rejected"===e.status}).forEach(function(e){return console.warn("Failed to fetch transaction receipt:",e.reason)}),s=!a.length||a.some(function(e){return!e}),c=a.every(function(e){return"0x1"===(null==e?void 0:e.status)}),u=a.every(function(e){return"0x0"===(null==e?void 0:e.status)}),f=a.some(function(e){return"0x0"===(null==e?void 0:e.status)}),e.abrupt("return",(s?l=100:c?l=200:u?l=500:f&&(l=600),{id:t.result.id,version:t.request.version,atomic:t.request.atomicRequired,chainId:t.request.chainId,capabilities:t.result.capabilities,receipts:a,status:l}));case 9:case"end":return e.stop()}},e)})),zp.apply(this,arguments)}function Zp(e,t,r){return Fp.apply(this,arguments)}function Fp(){return Fp=(0,o.Z)(p().mark(function e(t,r,n){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(parseInt(t)).request((0,vs.formatJsonRpcRequest)("eth_getTransactionReceipt",[r]));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),Fp.apply(this,arguments)}function Kp(){return Kp=(0,o.Z)(function(e){var t=e.sendCalls,r=e.storage;return p().mark(function e(){var n;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getItem(Ql);case 2:return n=e.sent,e.next=5,r.setItem(Ql,qp(Mp({},n),c({},t.result.id,{request:t.request,result:t.result,expiry:Ce(86400)})));case 5:case"end":return e.stop()}},e)})()}),Kp.apply(this,arguments)}function Vp(e){return Hp.apply(this,arguments)}function Hp(){return Hp=(0,o.Z)(function(e){var t=e.resultId,r=e.storage;return p().mark(function e(){var n,i;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getItem(Ql);case 2:if(!(n=e.sent)){e.next=10;break}return delete n[t],e.next=7,r.setItem(Ql,n);case 7:for(i in n)Ue(n[i].expiry)&&delete n[i];return e.next=10,r.setItem(Ql,n);case 10:case"end":return e.stop()}},e)})()}),Hp.apply(this,arguments)}function Wp(){return Wp=(0,o.Z)(function(e){var t=e.resultId,r=e.storage;return p().mark(function e(){var n,i;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getItem(Ql);case 2:if(e.t1=n=e.sent,e.t0=null===e.t1,e.t0){e.next=6;break}e.t0=void 0===n;case 6:if(!e.t0){e.next=10;break}e.t2=void 0,e.next=11;break;case 10:e.t2=n[t];case 11:if(!(i=e.t2)||Ue(i.expiry)){e.next=14;break}return e.abrupt("return",i);case 14:return e.next=16,Vp({resultId:t,storage:r});case 16:case"end":return e.stop()}},e)})()}),Wp.apply(this,arguments)}var Gp=Object.defineProperty,Jp=Object.defineProperties,Yp=Object.getOwnPropertyDescriptors,Qp=Object.getOwnPropertySymbols,Xp=Object.prototype.hasOwnProperty,$p=Object.prototype.propertyIsEnumerable,eh=function(e,t,r){return t in e?Gp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},th=function(e,t){for(var r in t||(t={}))Xp.call(t,r)&&eh(e,r,t[r]);if(Qp){var n,i=u(Qp(t));try{for(i.s();!(n=i.n()).done;){r=n.value;$p.call(t,r)&&eh(e,r,t[r])}}catch(o){i.e(o)}finally{i.f()}}return e},rh=function(e,t){return Jp(e,Yp(t))},nh=function(e,t,r){return eh(e,"symbol"!=typeof t?t+"":t,r)},ih=function(){function e(t){k(this,e),nh(this,"name","eip155"),nh(this,"client"),nh(this,"chainId"),nh(this,"namespace"),nh(this,"httpProviders"),nh(this,"events"),nh(this,"storage"),this.namespace=t.namespace,this.events=yp("events"),this.client=yp("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain()),this.storage=Tp.getStorage(this.client.core.storage)}return x(e,[{key:"request",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:r.t0=e.request.method,r.next="eth_requestAccounts"===r.t0||"eth_accounts"===r.t0?3:"wallet_switchEthereumChain"===r.t0?4:"eth_chainId"===r.t0?7:"wallet_getCapabilities"===r.t0?8:"wallet_getCallsStatus"===r.t0?11:"wallet_sendCalls"===r.t0?14:17;break;case 3:return r.abrupt("return",t.getAccounts());case 4:return r.next=6,t.handleSwitchChain(e);case 6:return r.abrupt("return",r.sent);case 7:return r.abrupt("return",parseInt(t.getDefaultChain()));case 8:return r.next=10,t.getCapabilities(e);case 10:return r.abrupt("return",r.sent);case 11:return r.next=13,t.getCallStatus(e);case 13:return r.abrupt("return",r.sent);case 14:return r.next=16,t.sendCalls(e);case 16:return r.abrupt("return",r.sent);case 17:if(!t.namespace.methods.includes(e.request.method)){r.next=23;break}return r.next=20,t.client.request(e);case 20:r.t1=r.sent,r.next=24;break;case 23:r.t1=t.getHttpProvider().request(e.request);case 24:return r.abrupt("return",r.t1);case 25:case"end":return r.stop()}},r)}))()}},{key:"updateNamespace",value:function(e){this.namespace=Object.assign(this.namespace,e)}},{key:"setDefaultChain",value:function(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t);var r=this.chainId;this.chainId=parseInt(e),this.events.emit("default_chain_changed",{currentCaipChainId:"".concat(this.name,":").concat(e),previousCaipChainId:"".concat(this.name,":").concat(r)})}},{key:"requestAccounts",value:function(){return this.getAccounts()}},{key:"getDefaultChain",value:function(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;var e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}},{key:"createHttpProvider",value:function(e,t){var r=t||sp("".concat(this.name,":").concat(e),this.namespace,this.client.core.projectId);if(!r)throw new Error("No RPC url provided for chainId: ".concat(e));return new ds.r(new Sl.k(r,yp("disableProviderPing")))}},{key:"setHttpProvider",value:function(e,t){var r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}},{key:"createHttpProviders",value:function(){var e=this,t={};return this.namespace.chains.forEach(function(r){var n,i=parseInt(function(e){return e.includes(":")?e.split(":")[1]:e}(r));t[i]=e.createHttpProvider(i,null==(n=e.namespace.rpcMap)?void 0:n[r])}),t}},{key:"getAccounts",value:function(){var e=this,t=this.namespace.accounts;return t?s(new Set(t.filter(function(t){return t.split(":")[1]===e.chainId.toString()}).map(function(e){return e.split(":")[2]}))):[]}},{key:"getHttpProvider",value:function(e){var t=e||this.chainId;return this.httpProviders[t]||(this.httpProviders=rh(th({},this.httpProviders),c({},t,this.createHttpProvider(t))),this.httpProviders[t])}},{key:"handleSwitchChain",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){var n,i,o,a;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(o=(o=e.request.params?null==(n=e.request.params[0])?void 0:n.chainId:"0x0").startsWith("0x")?o:"0x".concat(o),a=parseInt(o,16),!t.isChainApproved(a)){r.next=7;break}t.setDefaultChain("".concat(a)),r.next=12;break;case 7:if(t.namespace.methods.includes("wallet_switchEthereumChain")){r.next=9;break}throw new Error("Failed to switch to chain 'eip155:".concat(a,"'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method."));case 9:return r.next=11,t.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:o}]},chainId:null==(i=t.namespace.chains)?void 0:i[0]});case 11:t.setDefaultChain("".concat(a));case 12:return r.abrupt("return",null);case 13:case"end":return r.stop()}},r)}))()}},{key:"isChainApproved",value:function(e){return this.namespace.chains.includes("".concat(this.name,":").concat(e))}},{key:"getCapabilities",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){var n,o,a,s,f,l,h,d,v,g,y,b,m;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(l=null==(o=null==(n=e.request)?void 0:n.params)?void 0:o[0],h=(null==(s=null==(a=e.request)?void 0:a.params)?void 0:s[1])||[],l){r.next=3;break}throw new Error("Missing address parameter in `wallet_getCapabilities` request");case 3:if(d=t.client.session.get(e.topic),v=(null==(f=null==d?void 0:d.sessionProperties)?void 0:f.capabilities)||{},g="".concat(l).concat(h.length>0?h.join(","):"0x".concat(t.chainId.toString(16))),!(y=null==v?void 0:v[g])){r.next=6;break}return r.abrupt("return",y);case 6:try{b=function(e,t,r){var n=e.sessionProperties,o=void 0===n?{}:n,a=e.scopedProperties,s=void 0===a?{}:a,c={};if(Ca(s)||Ca(o)){var f,l=Pp(o),p=u(r);try{for(p.s();!(f=p.n()).done;){var h=f.value,d=Op(h);if(d){c[_p(d)]=l;var v=null==s?void 0:s["eip155:".concat(d)];if(v){var g=null==v?void 0:v["eip155:".concat(d,":").concat(t)];c[_p(d)]=Ip(Ip({},c[_p(d)]),Pp(g||v))}}}}catch(k){p.e(k)}finally{p.f()}for(var y=0,b=Object.entries(c);y<b.length;y++){var m=i(b[y],2),w=m[0],x=m[1];0===Object.keys(x).length&&delete c[w]}return Object.keys(c).length>0?c:void 0}}(d,l,h)}catch(p){console.warn("Failed to extract capabilities from session",p)}if(!b){r.next=9;break}return r.abrupt("return",b);case 9:return r.next=11,t.client.request(e);case 11:return m=r.sent,r.prev=12,r.next=15,t.client.session.update(e.topic,{sessionProperties:rh(th({},d.sessionProperties||{}),{capabilities:rh(th({},v||{}),c({},g,m))})});case 15:r.next=20;break;case 17:r.prev=17,r.t0=r.catch(12),console.warn("Failed to update session with capabilities",r.t0);case 20:return r.abrupt("return",m);case 21:case"end":return r.stop()}},r,null,[[12,17]])}))()}},{key:"getCallStatus",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){var n,i,o,a,s,c,u,f;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(a=t.client.session.get(e.topic),!(s=null==(n=a.sessionProperties)?void 0:n.bundler_name)){r.next=12;break}return c=t.getBundlerUrl(e.chainId,s),r.prev=3,r.next=6,t.getUserOperationReceipt(c,e);case 6:return r.abrupt("return",r.sent);case 9:r.prev=9,r.t0=r.catch(3),console.warn("Failed to fetch call status from bundler",r.t0,c);case 12:if(!(u=null==(i=a.sessionProperties)?void 0:i.bundler_url)){r.next=23;break}return r.prev=14,r.next=17,t.getUserOperationReceipt(u,e);case 17:return r.abrupt("return",r.sent);case 20:r.prev=20,r.t1=r.catch(14),console.warn("Failed to fetch call status from custom bundler",r.t1,u);case 23:return r.next=25,function(e){return Wp.apply(this,arguments)}({resultId:null==(o=e.request.params)?void 0:o[0],storage:t.storage});case 25:if(!(f=r.sent)){r.next=36;break}return r.prev=27,r.next=30,function(e,t){return zp.apply(this,arguments)}(f,t.getHttpProvider.bind(t));case 30:return r.abrupt("return",r.sent);case 33:r.prev=33,r.t2=r.catch(27),console.warn("Failed to fetch call status from stored send calls",r.t2,f);case 36:if(!t.namespace.methods.includes(e.request.method)){r.next=40;break}return r.next=39,t.client.request(e);case 39:return r.abrupt("return",r.sent);case 40:throw new Error("Fetching call status not approved by the wallet.");case 41:case"end":return r.stop()}},r,null,[[3,9],[14,20],[27,33]])}))()}},{key:"getUserOperationReceipt",value:function(e,t){return(0,o.Z)(p().mark(function r(){var n,i,o;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=new URL(e),r.next=3,fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify((0,vs.formatJsonRpcRequest)("eth_getUserOperationReceipt",[null==(n=t.request.params)?void 0:n[0]]))});case 3:if((o=r.sent).ok){r.next=6;break}throw new Error("Failed to fetch user operation receipt - ".concat(o.status));case 6:return r.next=8,o.json();case 8:return r.abrupt("return",r.sent);case 9:case"end":return r.stop()}},r)}))()}},{key:"getBundlerUrl",value:function(e,t){return"".concat(Yl,"?projectId=").concat(this.client.core.projectId,"&chainId=").concat(e,"&bundler=").concat(t)}},{key:"sendCalls",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){var n,i,o,a,s,c,u,f,l;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.client.request(e);case 2:if(a=r.sent,s=null==(n=e.request.params)?void 0:n[0],c=null==a?void 0:a.id,u=(null==a?void 0:a.capabilities)||{},f=null==(i=null==u?void 0:u.caip345)?void 0:i.caip2,l=null==(o=null==u?void 0:u.caip345)?void 0:o.transactionHashes,r.t0=!c||!f||!(null!=l&&l.length),r.t0){r.next=12;break}return r.next=12,function(e){return Kp.apply(this,arguments)}({sendCalls:{request:s,result:a},storage:t.storage});case 12:return r.abrupt("return",a);case 13:case"end":return r.stop()}},r)}))()}}]),e}(),oh=Object.defineProperty,ah=function(e,t,r){return function(e,t,r){return t in e?oh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r}(e,"symbol"!=typeof t?t+"":t,r)},sh=function(){function e(t){k(this,e),ah(this,"name",Jl),ah(this,"client"),ah(this,"httpProviders"),ah(this,"events"),ah(this,"namespace"),ah(this,"chainId"),this.namespace=t.namespace,this.events=yp("events"),this.client=yp("client"),this.chainId=this.getDefaultChain(),this.name=this.getNamespaceName(),this.httpProviders=this.createHttpProviders()}return x(e,[{key:"updateNamespace",value:function(e){this.namespace.chains=s(new Set((this.namespace.chains||[]).concat(e.chains||[]))),this.namespace.accounts=s(new Set((this.namespace.accounts||[]).concat(e.accounts||[]))),this.namespace.methods=s(new Set((this.namespace.methods||[]).concat(e.methods||[]))),this.namespace.events=s(new Set((this.namespace.events||[]).concat(e.events||[]))),this.httpProviders=this.createHttpProviders()}},{key:"requestAccounts",value:function(){return this.getAccounts()}},{key:"request",value:function(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}},{key:"setDefaultChain",value:function(e,t){this.httpProviders[e]||this.setHttpProvider(e,t);var r=this.chainId;this.chainId=e,this.events.emit("default_chain_changed",{currentCaipChainId:"".concat(this.name,":").concat(e),previousCaipChainId:"".concat(this.name,":").concat(r)})}},{key:"getDefaultChain",value:function(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;var e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}},{key:"getNamespaceName",value:function(){var e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return ae(e).namespace}},{key:"getAccounts",value:function(){var e=this,t=this.namespace.accounts;return t?s(new Set(t.filter(function(t){return t.split(":")[1]===e.chainId.toString()}).map(function(e){return e.split(":")[2]}))):[]}},{key:"createHttpProviders",value:function(){var e,t,r=this,n={};return null==(t=null==(e=this.namespace)?void 0:e.accounts)||t.forEach(function(e){var t,i,o=ae(e),a=null==(i=null==(t=r.namespace)?void 0:t.rpcMap)?void 0:i["".concat(o.namespace,":").concat(o.reference)];n[o.reference]=r.createHttpProvider(e,a)}),n}},{key:"getHttpProvider",value:function(e){var t=ae(e).reference,r=this.httpProviders[t];if(typeof r>"u")throw new Error("JSON-RPC provider for ".concat(e," not found"));return r}},{key:"setHttpProvider",value:function(e,t){var r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}},{key:"createHttpProvider",value:function(e,t){var r=t||sp(e,this.namespace,this.client.core.projectId);if(!r)throw new Error("No RPC url provided for chainId: ".concat(e));return new ds.r(new Sl.Z(r,yp("disableProviderPing")))}}]),e}(),ch=Object.defineProperty,uh=Object.defineProperties,fh=Object.getOwnPropertyDescriptors,lh=Object.getOwnPropertySymbols,ph=Object.prototype.hasOwnProperty,hh=Object.prototype.propertyIsEnumerable,dh=function(e,t,r){return t in e?ch(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},vh=function(e,t){for(var r in t||(t={}))ph.call(t,r)&&dh(e,r,t[r]);if(lh){var n,i=u(lh(t));try{for(i.s();!(n=i.n()).done;){r=n.value;hh.call(t,r)&&dh(e,r,t[r])}}catch(o){i.e(o)}finally{i.f()}}return e},gh=function(e,t){return uh(e,fh(t))},yh=function(e,t,r){return dh(e,"symbol"!=typeof t?t+"":t,r)},bh=function(){function e(t){var r,n;k(this,e),yh(this,"client"),yh(this,"namespaces"),yh(this,"optionalNamespaces"),yh(this,"sessionProperties"),yh(this,"scopedProperties"),yh(this,"events",new f),yh(this,"rpcProviders",{}),yh(this,"session"),yh(this,"providerOpts"),yh(this,"logger"),yh(this,"uri"),yh(this,"disableProviderPing",!1),yh(this,"connectParams"),this.providerOpts=t,this.logger=Xa({logger:null!=(r=t.logger)?r:"error",name:null!=(n=this.providerOpts.name)?n:Hl}),this.disableProviderPing=(null==t?void 0:t.disableProviderPing)||!1}return x(e,[{key:"request",value:function(e,t,r){var n=this;return(0,o.Z)(p().mark(function o(){var a,s,c,u;return p().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(a=n.validateChain(t),s=i(a,2),c=s[0],u=s[1],n.session){o.next=3;break}throw new Error("Please call connect() before request()");case 3:return o.next=5,n.getProvider(c).request({request:vh({},e),chainId:"".concat(c,":").concat(u),topic:n.session.topic,expiry:r});case 5:return o.abrupt("return",o.sent);case 6:case"end":return o.stop()}},o)}))()}},{key:"sendAsync",value:function(e,t,r,n){var i=(new Date).getTime();this.request(e,r,n).then(function(e){return t(null,(0,vs.formatJsonRpcResult)(i,e))}).catch(function(e){return t(e,void 0)})}},{key:"enable",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.client){t.next=2;break}throw new Error("Sign Client not initialized");case 2:if(t.t0=e.session,t.t0){t.next=6;break}return t.next=6,e.connect({namespaces:e.namespaces,optionalNamespaces:e.optionalNamespaces,sessionProperties:e.sessionProperties,scopedProperties:e.scopedProperties});case 6:return t.next=8,e.requestAccounts();case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}},t)}))()}},{key:"disconnect",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){var r;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.session){t.next=2;break}throw new Error("Please call connect() before enable()");case 2:return t.next=4,e.client.disconnect({topic:null==(r=e.session)?void 0:r.topic,reason:Ta("USER_DISCONNECTED")});case 4:return t.next=6,e.cleanup();case 6:case"end":return t.stop()}},t)}))()}},{key:"connect",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t.client){r.next=2;break}throw new Error("Sign Client not initialized");case 2:if(t.connectParams=e,t.setNamespaces(e),t.cleanupPendingPairings(),e.skipPairing){r.next=6;break}return r.next=5,t.pair(e.pairingTopic);case 5:return r.abrupt("return",r.sent);case 6:case"end":return r.stop()}},r)}))()}},{key:"authenticate",value:function(e,t){var r=this;return(0,o.Z)(p().mark(function n(){var i,o,a,s,c;return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r.client){n.next=2;break}throw new Error("Sign Client not initialized");case 2:return r.setNamespaces(e),n.next=5,r.cleanupPendingPairings();case 5:return n.next=7,r.client.authenticate(e,t);case 7:return i=n.sent,o=i.uri,a=i.response,o&&(r.uri=o,r.events.emit("display_uri",o)),n.next=13,a();case 13:if(s=n.sent,r.session=s.session,!r.session){n.next=20;break}return c=hp(r.session.namespaces),r.namespaces=fp(r.namespaces,c),n.next=19,r.persist("namespaces",r.namespaces);case 19:r.onConnect();case 20:return n.abrupt("return",s);case 21:case"end":return n.stop()}},n)}))()}},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"once",value:function(e,t){this.events.once(e,t)}},{key:"removeListener",value:function(e,t){this.events.removeListener(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"isWalletConnect",get:function(){return!0}},{key:"pair",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){var n,i,o,a,s,c,u;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.client.connect({pairingTopic:e,requiredNamespaces:t.namespaces,optionalNamespaces:t.optionalNamespaces,sessionProperties:t.sessionProperties,scopedProperties:t.scopedProperties,authentication:null==(n=t.connectParams)?void 0:n.authentication,walletPay:null==(i=t.connectParams)?void 0:i.walletPay});case 2:return o=r.sent,a=o.uri,s=o.approval,a&&(t.uri=a,t.events.emit("display_uri",a)),r.next=8,s();case 8:return c=r.sent,t.session=c,u=hp(c.namespaces),t.namespaces=fp(t.namespaces,u),r.next=14,t.persist("namespaces",t.namespaces);case 14:return r.next=16,t.persist("optionalNamespaces",t.optionalNamespaces);case 16:return t.onConnect(),r.abrupt("return",t.session);case 18:case"end":return r.stop()}},r)}))()}},{key:"setDefaultChain",value:function(e,t){try{if(!this.session)return;var r=i(this.validateChain(e),2),n=r[0],o=r[1],a=this.getProvider(n);a?a.setDefaultChain(o,t):this.session&&this.logger.warn("Provider for namespace '".concat(n,"' not found in setDefaultChain"))}catch(n){if(!/Please call connect/.test(n.message))throw n}}},{key:"cleanupPendingPairings",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;return(0,o.Z)(p().mark(function r(){var n,i,o,a;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,t.logger.info("Cleaning up inactive pairings..."),Ba(n=t.client.pairing.getAll())){r.next=5;break}return r.abrupt("return");case 5:i=u(n),r.prev=6,i.s();case 8:if((o=i.n()).done){r.next=18;break}if(a=o.value,!e.deletePairings){r.next=14;break}t.client.core.expirer.set(a.topic,0),r.next=16;break;case 14:return r.next=16,t.client.core.relayer.subscriber.unsubscribe(a.topic);case 16:r.next=8;break;case 18:r.next=23;break;case 20:r.prev=20,r.t0=r.catch(6),i.e(r.t0);case 23:return r.prev=23,i.f(),r.finish(23);case 26:t.logger.info("Inactive pairings cleared: ".concat(n.length)),r.next=32;break;case 29:r.prev=29,r.t1=r.catch(0),t.logger.warn(r.t1,"Failed to cleanup pending pairings");case 32:case"end":return r.stop()}},r,null,[[0,29],[6,20,23,26]])}))()}},{key:"abortPairingAttempt",value:function(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}},{key:"checkStorage",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getFromStore("namespaces");case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0={};case 5:return e.namespaces=t.t0,t.next=8,e.getFromStore("optionalNamespaces");case 8:if(t.t1=t.sent,t.t1){t.next=11;break}t.t1={};case 11:e.optionalNamespaces=t.t1,e.session&&e.createProviders();case 13:case"end":return t.stop()}},t)}))()}},{key:"initialize",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.logger.trace("Initialized"),t.next=3,e.createClient();case 3:return t.next=5,e.checkStorage();case 5:e.registerEventListeners();case 6:case"end":return t.stop()}},t)}))()}},{key:"createClient",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){var r,n,i;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.providerOpts.client,t.t0){t.next=5;break}return t.next=4,Il.init({core:e.providerOpts.core,logger:e.providerOpts.logger||"error",relayUrl:e.providerOpts.relayUrl||"wss://relay.walletconnect.org",projectId:e.providerOpts.projectId,metadata:e.providerOpts.metadata,storageOptions:e.providerOpts.storageOptions,storage:e.providerOpts.storage,name:e.providerOpts.name,customStoragePrefix:e.providerOpts.customStoragePrefix,telemetryEnabled:e.providerOpts.telemetryEnabled});case 4:t.t0=t.sent;case 5:if(e.client=t.t0,!e.providerOpts.session){t.next=16;break}t.prev=7,e.session=e.client.session.get(e.providerOpts.session.topic),t.next=14;break;case 11:throw t.prev=11,t.t1=t.catch(7),e.logger.error(t.t1,"Failed to get session"),new Error("The provided session: ".concat(null==(n=null==(r=e.providerOpts)?void 0:r.session)?void 0:n.topic," doesn't exist in the Sign client"));case 14:t.next=18;break;case 16:i=e.client.session.getAll(),e.session=i[0];case 18:e.logger.trace("SignClient Initialized");case 19:case"end":return t.stop()}},t,null,[[7,11]])}))()}},{key:"createProviders",value:function(){var e=this;if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");var t=s(new Set(Object.keys(this.session.namespaces).map(function(e){return Sa(e)})));bp("client",this.client),bp("events",this.events),bp("disableProviderPing",this.disableProviderPing),t.forEach(function(t){if(e.session){var r=function(e,t){var r=Object.keys(t.namespaces).filter(function(t){return t.includes(e)});if(!r.length)return[];var n=[];return r.forEach(function(e){n.push.apply(n,s(t.namespaces[e].accounts))}),n}(t,e.session);if(0!==(null==r?void 0:r.length)){var n=cp(r),i=fp(e.namespaces,e.optionalNamespaces),o=gh(vh({},i[t]),{accounts:r,chains:n});e.rpcProviders[t]="eip155"===t?new ih({namespace:o}):new sh({namespace:o})}}})}},{key:"registerEventListeners",value:function(){var e=this,t=this;if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",function(t){var r;t.topic===(null==(r=e.session)?void 0:r.topic)&&e.events.emit("session_ping",t)}),this.client.on("session_event",function(t){var r,n=t.params;if(t.topic===(null==(r=e.session)?void 0:r.topic)){var i=n.event;if("accountsChanged"===i.name){var o=i.data;o&&Ba(o)&&e.events.emit("accountsChanged",o.map(pp))}else if("chainChanged"===i.name){var a=n.chainId,s=n.event.data,c=Sa(a),u=dp(a)!==dp(s)?"".concat(c,":").concat(dp(s)):a;e.onChainChanged({currentCaipChainId:u})}else e.events.emit(i.name,i.data);e.events.emit("session_event",t)}}),this.client.on("session_update",function(t){var r,n,i=t.topic,o=t.params;if(i===(null==(r=e.session)?void 0:r.topic)){var a=o.namespaces,s=null==(n=e.client)?void 0:n.session.get(i);e.session=gh(vh({},s),{namespaces:a}),e.onSessionUpdate(),e.events.emit("session_update",{topic:i,params:o})}}),this.client.on("session_delete",function(){var e=(0,o.Z)(p().mark(function e(r){var n;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=r.topic===(null==(n=t.session)?void 0:n.topic),!e.t0){e.next=6;break}return e.next=4,t.cleanup();case 4:t.events.emit("session_delete",r),t.events.emit("disconnect",gh(vh({},Ta("USER_DISCONNECTED")),{data:r.topic}));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),this.on("default_chain_changed",function(t){e.onChainChanged(gh(vh({},t),{internal:!0}))})}},{key:"getProvider",value:function(e){return this.rpcProviders[e]||this.rpcProviders[Jl]}},{key:"onSessionUpdate",value:function(){var e=this;Object.keys(this.rpcProviders).forEach(function(t){var r;e.getProvider(t).updateNamespace(null==(r=e.session)?void 0:r.namespaces[t])})}},{key:"setNamespaces",value:function(e){var t=e.namespaces,r=void 0===t?{}:t,n=e.optionalNamespaces,i=void 0===n?{}:n,o=e.sessionProperties,a=e.scopedProperties;this.optionalNamespaces=fp(r,i),this.sessionProperties=o,this.scopedProperties=a}},{key:"validateChain",value:function(e){var t=i((null==e?void 0:e.split(":"))||["",""],2),r=t[0],n=t[1];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,n];if(r&&!Object.keys(this.namespaces||{}).map(function(e){return Sa(e)}).includes(r))throw new Error("Namespace '".concat(r,"' is not configured. Please call connect() first with namespace config."));if(r&&n)return[r,n];var o=Sa(Object.keys(this.namespaces)[0]);return[o,this.rpcProviders[o].getDefaultChain()]}},{key:"requestAccounts",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){var r,n,o;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.validateChain(),n=i(r,1),o=n[0],t.next=3,e.getProvider(o).requestAccounts();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}))()}},{key:"onChainChanged",value:function(e){var t=e.currentCaipChainId,r=e.previousCaipChainId,n=e.internal,a=void 0!==n&&n,s=this;return(0,o.Z)(p().mark(function e(){var n,o,c,u,f;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s.namespaces){e.next=2;break}return e.abrupt("return");case 2:if(n=s.validateChain(t),o=i(n,2),c=o[0],!(u=o[1])){e.next=7;break}return s.updateNamespaceChain(c,u),a?(s.events.emit("chainChanged",u),s.emitAccountsChangedOnChainChange({namespace:c,currentCaipChainId:t,previousCaipChainId:r})):(f=s.getProvider(c))?f.setDefaultChain(u):s.session&&s.logger.warn("Provider for namespace '".concat(c,"' not found during chain change")),e.next=7,s.persist("namespaces",s.namespaces);case 7:case"end":return e.stop()}},e)}))()}},{key:"emitAccountsChangedOnChainChange",value:function(e){var t,r,n=e.namespace,i=e.currentCaipChainId,o=e.previousCaipChainId;try{if(o===i)return;var a=null==(r=null==(t=this.session)?void 0:t.namespaces[n])?void 0:r.accounts;if(!a)return;var s=a.filter(function(e){return e.includes("".concat(i,":"))}).map(pp);if(!Ba(s))return;this.events.emit("accountsChanged",s)}catch(a){this.logger.warn(a,"Failed to emit accountsChanged on chain change")}}},{key:"updateNamespaceChain",value:function(e,t){if(this.namespaces){var r=this.namespaces[e]?e:"".concat(e,":").concat(t),n={chains:[],methods:[],events:[],defaultChain:t};this.namespaces[r]?this.namespaces[r]&&(this.namespaces[r].defaultChain=t):this.namespaces[r]=n}}},{key:"onConnect",value:function(){this.createProviders(),this.events.emit("connect",{session:this.session})}},{key:"cleanup",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.connectParams=void 0,e.namespaces=void 0,e.optionalNamespaces=void 0,e.sessionProperties=void 0,t.next=6,e.deleteFromStore("namespaces");case 6:return t.next=8,e.deleteFromStore("optionalNamespaces");case 8:return t.next=10,e.deleteFromStore("sessionProperties");case 10:return e.session=void 0,e.cleanupPendingPairings({deletePairings:!0}),t.next=14,e.cleanupStorage();case 14:case"end":return t.stop()}},t)}))()}},{key:"persist",value:function(e,t){var r=this;return(0,o.Z)(p().mark(function n(){var i,o;return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o=(null==(i=r.session)?void 0:i.topic)||"",n.next=3,r.client.core.storage.setItem("".concat(Wl,"/").concat(e).concat(o),t);case 3:case"end":return n.stop()}},n)}))()}},{key:"getFromStore",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){var n,i;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=(null==(n=t.session)?void 0:n.topic)||"",r.next=3,t.client.core.storage.getItem("".concat(Wl,"/").concat(e).concat(i));case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}},r)}))()}},{key:"deleteFromStore",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){var n,i;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=(null==(n=t.session)?void 0:n.topic)||"",r.next=3,t.client.core.storage.removeItem("".concat(Wl,"/").concat(e).concat(i));case 3:case"end":return r.stop()}},r)}))()}},{key:"cleanupStorage",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){var r,n,i,o,a;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!((null==(r=e.client)?void 0:r.session.length)>0)){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,e.client.core.storage.getKeys();case 5:n=t.sent,i=u(n),t.prev=7,i.s();case 9:if((o=i.n()).done){t.next=17;break}if(a=o.value,t.t0=a.startsWith(Wl),!t.t0){t.next=15;break}return t.next=15,e.client.core.storage.removeItem(a);case 15:t.next=9;break;case 17:t.next=22;break;case 19:t.prev=19,t.t1=t.catch(7),i.e(t.t1);case 22:return t.prev=22,i.f(),t.finish(22);case 25:t.next=30;break;case 27:t.prev=27,t.t2=t.catch(0),e.logger.warn(t.t2,"Failed to cleanup storage");case 30:case"end":return t.stop()}},t,null,[[0,27],[7,19,22,25]])}))()}}],[{key:"init",value:function(t){return(0,o.Z)(p().mark(function r(){var n;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=new e(t),r.next=3,n.initialize();case 3:return r.abrupt("return",n);case 4:case"end":return r.stop()}},r)}))()}}]),e}(),mh=bh,wh=["eth_sendTransaction","personal_sign"],xh=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_sendCalls","wallet_getCapabilities","wallet_getCallsStatus","wallet_showCallsStatus"],kh=["chainChanged","accountsChanged"],Eh=["chainChanged","accountsChanged","message","disconnect","connect"],Ih=function(){var e=(0,o.Z)(p().mark(function e(){var t,r;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(1426).then(n.bind(n,71426));case 2:return t=e.sent,r=t.createAppKit,e.abrupt("return",r);case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),Sh=Object.defineProperty,Oh=Object.defineProperties,_h=Object.getOwnPropertyDescriptors,Ph=Object.getOwnPropertySymbols,Ah=Object.prototype.hasOwnProperty,Rh=Object.prototype.propertyIsEnumerable,Th=function(e,t,r){return t in e?Sh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Bh=function(e,t){for(var r in t||(t={}))Ah.call(t,r)&&Th(e,r,t[r]);if(Ph){var n,i=u(Ph(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Rh.call(t,r)&&Th(e,r,t[r])}}catch(o){i.e(o)}finally{i.f()}}return e},Ch=function(e,t){return Oh(e,_h(t))},Uh=function(e,t,r){return Th(e,"symbol"!=typeof t?t+"":t,r)};function Nh(e){return Number(e[0].split(":")[1])}function jh(e){return"0x".concat(e.toString(16))}var Lh=function(){function e(){var t=this;k(this,e),Uh(this,"events",new f.EventEmitter),Uh(this,"namespace","eip155"),Uh(this,"accounts",[]),Uh(this,"signer"),Uh(this,"chainId",1),Uh(this,"modal"),Uh(this,"rpc"),Uh(this,"STORAGE_KEY","wc@2:ethereum_provider:"),Uh(this,"on",function(e,r){return t.events.on(e,r),t}),Uh(this,"once",function(e,r){return t.events.once(e,r),t}),Uh(this,"removeListener",function(e,r){return t.events.removeListener(e,r),t}),Uh(this,"off",function(e,r){return t.events.off(e,r),t}),Uh(this,"parseAccount",function(e){return t.isCompatibleChainId(e)?t.parseAccountId(e).address:e}),this.signer={},this.rpc={}}return x(e,[{key:"request",value:function(e,t){var r=this;return(0,o.Z)(p().mark(function n(){return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.signer.request(e,r.formatChainId(r.chainId),t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n)}))()}},{key:"sendAsync",value:function(e,t,r){this.signer.sendAsync(e,t,this.formatChainId(this.chainId),r)}},{key:"connected",get:function(){return!!this.signer.client&&this.signer.client.core.relayer.connected}},{key:"connecting",get:function(){return!!this.signer.client&&this.signer.client.core.relayer.connecting}},{key:"enable",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.session,t.t0){t.next=4;break}return t.next=4,e.connect();case 4:return t.next=6,e.request({method:"eth_requestAccounts"});case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}},t)}))()}},{key:"connect",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){var n,i,a,u,f,l;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t.signer.client){r.next=2;break}throw new Error("Provider not initialized. Call init() first");case 2:return t.loadConnectOpts(e),i=function(e){var t=e.chains,r=e.optionalChains,n=e.methods,i=e.optionalMethods,o=e.events,a=e.optionalEvents,u=e.rpcMap;if(!Ba(t))throw new Error("Invalid chains");var f={chains:t,methods:n||wh,events:o||kh,rpcMap:Bh({},t.length?c({},Nh(t),u[Nh(t)]):{})},l=null==o?void 0:o.filter(function(e){return!kh.includes(e)}),p=null==n?void 0:n.filter(function(e){return!wh.includes(e)});if(!(r||a||i||null!=l&&l.length||null!=p&&p.length))return{required:t.length?f:void 0};var h={chains:s(new Set(null!=l&&l.length&&null!=p&&p.length||!r?f.chains.concat(r||[]):r)),methods:s(new Set(f.methods.concat(null!=i&&i.length?i:xh))),events:s(new Set(f.events.concat(null!=a&&a.length?a:Eh))),rpcMap:u};return{required:t.length?f:void 0,optional:r.length?h:void 0}}(t.rpc),a=i.required,u=i.optional,r.prev=4,r.next=7,new Promise(function(){var r=(0,o.Z)(p().mark(function r(n,i){var o,s,f;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t.rpc.showQrModal&&(null==(o=t.modal)||o.open(),null==(s=t.modal)||s.subscribeState(function(e){!e.open&&!t.signer.session&&(t.signer.abortPairingAttempt(),i(new Error("Connection request reset. Please try again.")))})),f=null!=e&&e.scopedProperties?c({},t.namespace,e.scopedProperties):void 0,r.next=4,t.signer.connect(Ch(Bh({namespaces:Bh({},a&&c({},t.namespace,a))},u&&{optionalNamespaces:c({},t.namespace,u)}),{pairingTopic:null==e?void 0:e.pairingTopic,scopedProperties:f})).then(function(e){n(e)}).catch(function(e){var r;null==(r=t.modal)||r.showErrorMessage("Unable to connect"),i(new Error(e.message))});case 4:case"end":return r.stop()}},r)}));return function(e,t){return r.apply(this,arguments)}}());case 7:if(f=r.sent){r.next=10;break}return r.abrupt("return");case 10:l=se(f.namespaces,[t.namespace]),t.setChainIds(t.rpc.chains.length?t.rpc.chains:l),t.setAccounts(l),t.events.emit("connect",{chainId:jh(t.chainId)}),r.next=17;break;case 14:throw r.prev=14,r.t0=r.catch(4),t.signer.logger.error(r.t0),r.t0;case 17:return r.prev=17,null==(n=t.modal)||n.close(),r.finish(17);case 20:case"end":return r.stop()}},r,null,[[4,14,17,20]])}))()}},{key:"authenticate",value:function(e,t){var r=this;return(0,o.Z)(p().mark(function n(){var i,a,s,c;return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r.signer.client){n.next=2;break}throw new Error("Provider not initialized. Call init() first");case 2:return r.loadConnectOpts({chains:null==e?void 0:e.chains}),n.prev=3,n.next=6,new Promise(function(){var n=(0,o.Z)(p().mark(function n(i,o){var a,s;return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r.rpc.showQrModal&&(null==(a=r.modal)||a.open(),null==(s=r.modal)||s.subscribeState(function(e){!e.open&&!r.signer.session&&(r.signer.abortPairingAttempt(),o(new Error("Connection request reset. Please try again.")))})),n.next=3,r.signer.authenticate(Ch(Bh({},e),{chains:r.rpc.chains}),t).then(function(e){i(e)}).catch(function(e){var t;null==(t=r.modal)||t.showErrorMessage("Unable to connect"),o(new Error(e.message))});case 3:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}());case 6:return a=n.sent,(s=a.session)&&(c=se(s.namespaces,[r.namespace]),r.setChainIds(r.rpc.chains.length?r.rpc.chains:c),r.setAccounts(c),r.events.emit("connect",{chainId:jh(r.chainId)})),n.abrupt("return",a);case 12:throw n.prev=12,n.t0=n.catch(3),r.signer.logger.error(n.t0),n.t0;case 15:return n.prev=15,null==(i=r.modal)||i.close(),n.finish(15);case 18:case"end":return n.stop()}},n,null,[[3,12,15,18]])}))()}},{key:"disconnect",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.session,!t.t0){t.next=4;break}return t.next=4,e.signer.disconnect();case 4:e.reset();case 5:case"end":return t.stop()}},t)}))()}},{key:"isWalletConnect",get:function(){return!0}},{key:"session",get:function(){return this.signer.session}},{key:"registerEventListeners",value:function(){var e=this;this.signer.on("session_event",function(t){var r=t.params.event;"accountsChanged"===r.name?(e.accounts=e.parseAccounts(r.data),e.events.emit("accountsChanged",e.accounts)):"chainChanged"===r.name?e.setChainId(e.formatChainId(r.data)):e.events.emit(r.name,r.data),e.events.emit("session_event",t)}),this.signer.on("accountsChanged",function(t){e.accounts=e.parseAccounts(t),e.events.emit("accountsChanged",e.accounts)}),this.signer.on("chainChanged",function(t){var r=parseInt(t);e.chainId=r,e.events.emit("chainChanged",jh(e.chainId)),e.persist()}),this.signer.on("session_update",function(t){e.events.emit("session_update",t)}),this.signer.on("session_delete",function(t){e.reset(),e.events.emit("session_delete",t),e.events.emit("disconnect",Ch(Bh({},Ta("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",function(t){e.events.emit("display_uri",t)})}},{key:"switchEthereumChain",value:function(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}},{key:"isCompatibleChainId",value:function(e){return"string"==typeof e&&e.startsWith("".concat(this.namespace,":"))}},{key:"formatChainId",value:function(e){return"".concat(this.namespace,":").concat(e)}},{key:"parseChainId",value:function(e){return Number(e.split(":")[1])}},{key:"setChainIds",value:function(e){var t=this,r=e.filter(function(e){return t.isCompatibleChainId(e)}).map(function(e){return t.parseChainId(e)});r.length&&(this.chainId=r[0],this.events.emit("chainChanged",jh(this.chainId)),this.persist())}},{key:"setChainId",value:function(e){if(this.isCompatibleChainId(e)){var t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}},{key:"parseAccountId",value:function(e){var t=i(e.split(":"),3),r=t[0],n=t[1],o=t[2];return{chainId:"".concat(r,":").concat(n),address:o}}},{key:"setAccounts",value:function(e){var t=this;this.accounts=e.filter(function(e){return t.parseChainId(t.parseAccountId(e).chainId)===t.chainId}).map(function(e){return t.parseAccountId(e).address}),this.events.emit("accountsChanged",this.accounts)}},{key:"getRpcConfig",value:function(e){var t,r,n=this,i=null!=(t=null==e?void 0:e.chains)?t:[],o=null!=(r=null==e?void 0:e.optionalChains)?r:[],a=i.concat(o);if(!a.length)throw new Error("No chains specified in either `chains` or `optionalChains`");var s=i.length?(null==e?void 0:e.methods)||wh:[],c=i.length?(null==e?void 0:e.events)||kh:[],u=(null==e?void 0:e.optionalMethods)||[],f=(null==e?void 0:e.optionalEvents)||[],l=(null==e?void 0:e.rpcMap)||this.buildRpcMap(a,e.projectId),p=(null==e?void 0:e.qrModalOptions)||void 0;return{chains:null==i?void 0:i.map(function(e){return n.formatChainId(e)}),optionalChains:o.map(function(e){return n.formatChainId(e)}),methods:s,events:c,optionalMethods:u,optionalEvents:f,rpcMap:l,showQrModal:!(null==e||!e.showQrModal),qrModalOptions:p,projectId:e.projectId,metadata:e.metadata}}},{key:"buildRpcMap",value:function(e,t){var r=this,n={};return e.forEach(function(e){n[e]=r.getRpcUrl(e,t)}),n}},{key:"initialize",value:function(e){var t=this;return(0,o.Z)(p().mark(function r(){var n,i,o,a,c,u;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t.rpc=t.getRpcConfig(e),t.chainId=Nh(t.rpc.chains.length?t.rpc.chains:t.rpc.optionalChains),r.next=4,mh.init({projectId:t.rpc.projectId,metadata:t.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storage:e.storage,storageOptions:e.storageOptions,customStoragePrefix:e.customStoragePrefix,telemetryEnabled:e.telemetryEnabled,logger:e.logger});case 4:return t.signer=r.sent,t.registerEventListeners(),r.next=8,t.loadPersistedSession();case 8:if(!t.rpc.showQrModal){r.next=34;break}return r.prev=9,r.next=12,Ih();case 12:return o=r.sent,r.next=15,Promise.resolve().then(function(){return Qh});case 15:if(a=r.sent,c=a.convertWCMToAppKitOptions,(u=c(Ch(Bh({},t.rpc.qrModalOptions),{chains:s(new Set([].concat(s(t.rpc.chains),s(t.rpc.optionalChains)))),metadata:t.rpc.metadata,projectId:t.rpc.projectId}))).networks.length){r.next=20;break}throw new Error("No networks found for WalletConnect");case 20:i=o(Ch(Bh({},u),{universalProvider:t.signer,manualWCControl:!0,enableMobileFullScreen:!0===(null==(n=t.rpc.qrModalOptions)?void 0:n.enableMobileFullScreen)})),r.next=26;break;case 23:throw r.prev=23,r.t0=r.catch(9),console.warn(r.t0),new Error("To use QR modal, please install @reown/appkit package");case 26:if(!i){r.next=34;break}r.prev=27,t.modal=i,r.next=34;break;case 31:throw r.prev=31,r.t1=r.catch(27),t.signer.logger.error(r.t1),new Error("Could not generate WalletConnectModal Instance");case 34:case"end":return r.stop()}},r,null,[[9,23],[27,31]])}))()}},{key:"loadConnectOpts",value:function(e){var t=this;if(e){var r=e.chains,n=e.optionalChains,i=e.rpcMap;r&&Ba(r)&&(this.rpc.chains=r.map(function(e){return t.formatChainId(e)}),r.forEach(function(e){t.rpc.rpcMap[e]=(null==i?void 0:i[e])||t.getRpcUrl(e)})),n&&Ba(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=null==n?void 0:n.map(function(e){return t.formatChainId(e)}),n.forEach(function(e){t.rpc.rpcMap[e]=(null==i?void 0:i[e])||t.getRpcUrl(e)}))}}},{key:"getRpcUrl",value:function(e,t){var r;return(null==(r=this.rpc.rpcMap)?void 0:r[e])||"https://rpc.walletconnect.org/v1/?chainId=eip155:".concat(e,"&projectId=").concat(t||this.rpc.projectId)}},{key:"loadPersistedSession",value:function(){var e=this;return(0,o.Z)(p().mark(function t(){var r,n;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.session){t.next=15;break}return t.prev=1,t.next=4,e.signer.client.core.storage.getItem("".concat(e.STORAGE_KEY,"/chainId"));case 4:r=t.sent,n=e.session.namespaces["".concat(e.namespace,":").concat(r)]?e.session.namespaces["".concat(e.namespace,":").concat(r)]:e.session.namespaces[e.namespace],e.setChainIds(r?[e.formatChainId(r)]:null==n?void 0:n.accounts),e.setAccounts(null==n?void 0:n.accounts),t.next=15;break;case 9:return t.prev=9,t.t0=t.catch(1),e.signer.logger.error("Failed to load persisted session, clearing state..."),e.signer.logger.error(t.t0),t.next=15,e.disconnect().catch(function(t){return e.signer.logger.warn(t)});case 15:case"end":return t.stop()}},t,null,[[1,9]])}))()}},{key:"reset",value:function(){this.chainId=1,this.accounts=[]}},{key:"persist",value:function(){this.session&&this.signer.client.core.storage.setItem("".concat(this.STORAGE_KEY,"/chainId"),this.chainId)}},{key:"parseAccounts",value:function(e){var t=this;return"string"==typeof e||e instanceof String?[this.parseAccount(e)]:e.map(function(e){return t.parseAccount(e)})}}],[{key:"init",value:function(t){return(0,o.Z)(p().mark(function r(){var n;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=new e,r.next=3,n.initialize(t);case 3:return r.abrupt("return",n);case 4:case"end":return r.stop()}},r)}))()}}]),e}(),Dh=Lh,Mh=Object.defineProperty,qh=Object.defineProperties,zh=Object.getOwnPropertyDescriptors,Zh=Object.getOwnPropertySymbols,Fh=Object.prototype.hasOwnProperty,Kh=Object.prototype.propertyIsEnumerable,Vh=function(e,t,r){return t in e?Mh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Hh=function(e,t){for(var r in t||(t={}))Fh.call(t,r)&&Vh(e,r,t[r]);if(Zh){var n,i=u(Zh(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Kh.call(t,r)&&Vh(e,r,t[r])}}catch(o){i.e(o)}finally{i.f()}}return e},Wh=function(e,t){return qh(e,zh(t))};function Gh(e){if(e)return{"--w3m-font-family":e["--wcm-font-family"],"--w3m-accent":e["--wcm-accent-color"],"--w3m-color-mix":e["--wcm-background-color"],"--w3m-z-index":e["--wcm-z-index"]?Number(e["--wcm-z-index"]):void 0,"--w3m-qr-color":e["--wcm-accent-color"],"--w3m-font-size-master":e["--wcm-text-medium-regular-size"],"--w3m-border-radius-master":e["--wcm-container-border-radius"],"--w3m-color-mix-strength":0}}var Jh=function(e){var t=i(e.split(":"),2),r=t[0];return Yh({id:t[1],caipNetworkId:e,chainNamespace:r,name:"",nativeCurrency:{name:"",symbol:"",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}})};function Yh(e){return Hh({formatters:void 0,fees:void 0,serializers:void 0},e)}var Qh=Object.freeze({__proto__:null,convertWCMToAppKitOptions:function(e){var t,r,n,i,o,a,c,u=null==(t=e.chains)?void 0:t.map(Jh).filter(Boolean);if(0===u.length)throw new Error("At least one chain must be specified");var f=u.find(function(t){var r;return t.id===(null==(r=e.defaultChain)?void 0:r.id)}),l={projectId:e.projectId,networks:u,themeMode:e.themeMode,themeVariables:Gh(e.themeVariables),chainImages:e.chainImages,connectorImages:e.walletImages,defaultNetwork:f,metadata:Wh(Hh({},e.metadata),{name:(null==(r=e.metadata)?void 0:r.name)||"WalletConnect",description:(null==(n=e.metadata)?void 0:n.description)||"Connect to WalletConnect-compatible wallets",url:(null==(i=e.metadata)?void 0:i.url)||"https://walletconnect.org",icons:(null==(o=e.metadata)?void 0:o.icons)||["https://walletconnect.org/walletconnect-logo.png"]}),showWallets:!0,featuredWalletIds:"NONE"===e.explorerRecommendedWalletIds?[]:Array.isArray(e.explorerRecommendedWalletIds)?e.explorerRecommendedWalletIds:[],excludeWalletIds:"ALL"===e.explorerExcludedWalletIds?[]:Array.isArray(e.explorerExcludedWalletIds)?e.explorerExcludedWalletIds:[],enableEIP6963:!1,enableInjected:!1,enableCoinbase:!0,enableWalletConnect:!0,features:{email:!1,socials:!1}};if(null!=(a=e.mobileWallets)&&a.length||null!=(c=e.desktopWallets)&&c.length){var p=[].concat(s((e.mobileWallets||[]).map(function(e){return{id:e.id,name:e.name,links:e.links}})),s((e.desktopWallets||[]).map(function(e){return{id:e.id,name:e.name,links:{native:e.links.native,universal:e.links.universal}}}))),h=[].concat(s(l.featuredWalletIds||[]),s(l.excludeWalletIds||[])),d=p.filter(function(e){return!h.includes(e.id)});d.length&&(l.customWallets=d)}return l},defineChain:Yh})},47737:function(e,t,n){"use strict";n.d(t,{G:function(){return i}});var i=function(e){h(r,e);var t=v(r);function r(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};k(this,r);var o=function(){var e;if(i.cause instanceof r){if(i.cause.details)return i.cause.details;if(i.cause.shortMessage)return i.cause.shortMessage}return i.cause&&"details"in i.cause&&"string"==typeof i.cause.details?i.cause.details:null!==(e=i.cause)&&void 0!==e&&e.message?i.cause.message:i.details}(),a=i.cause instanceof r&&i.cause.docsPath||i.docsPath,c="https://oxlib.sh".concat(null!=a?a:"");return n=t.call(this,[e||"An error occurred."].concat(s(i.metaMessages?[""].concat(s(i.metaMessages)):[]),s(o||a?["",o?"Details: ".concat(o):void 0,a?"See: ".concat(c):void 0]:[])).filter(function(e){return"string"==typeof e}).join("\n"),i.cause?{cause:i.cause}:void 0),Object.defineProperty(y(n),"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(y(n),"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(y(n),"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(y(n),"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(y(n),"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(y(n),"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(y(n),"version",{enumerable:!0,configurable:!0,writable:!0,value:"ox@0.1.1"}),n.cause=i.cause,n.details=o,n.docs=c,n.docsPath=a,n.shortMessage=e,n}return x(r,[{key:"walk",value:function(e){return o(this,e)}}]),r}(r(Error));function o(e,t){return null!=t&&t(e)?e:e&&"object"==typeof e&&"cause"in e&&e.cause?o(e.cause,t):t?null:e}},89062:function(e,t,r){"use strict";r.d(t,{zo:function(){return s},Dp:function(){return c},xv:function(){return u},xS:function(){return f},eh:function(){return l},tP:function(){return p},dp:function(){return d},Gu:function(){return g},M6:function(){return E},mV:function(){return I},$s:function(){return S}});var n=r(47737),i=r(85900),o=r(36125),a=Array.from({length:256},function(e,t){return t.toString(16).padStart(2,"0")});function s(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return"0x".concat(t.reduce(function(e,t){return e+t.replace("0x","")},""))}function c(e){return e instanceof Uint8Array?u(e):Array.isArray(e)?u(new Uint8Array(e)):e}function u(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="",n=0;n<e.length;n++)r+=a[e[n]];var o="0x".concat(r);return"number"==typeof t.size?(i.Yf(o,t.size),l(o,t.size)):o}function f(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.signed,o=r.size,a=BigInt(e);o?t=n?(1n<<8n*BigInt(o)-1n)-1n:Math.pow(2n,8n*BigInt(o))-1n:"number"==typeof e&&(t=BigInt(Number.MAX_SAFE_INTEGER));var s="bigint"==typeof t&&n?-t-1n:0;if(t&&a>t||a<s){var c="bigint"==typeof e?"n":"";throw new b({max:t?"".concat(t).concat(c):void 0,min:"".concat(s).concat(c),signed:n,size:o,value:"".concat(e).concat(c)})}var u="0x".concat((n&&a<0?(1n<<BigInt(8*o))+BigInt(a):a).toString(16));return o?function(e,t){return i.vk(e,{dir:"left",size:t})}(u,o):u}function l(e,t){return i.vk(e,{dir:"right",size:t})}function p(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=n.strict;i.EM(e,t);var a="0x".concat(e.replace("0x","").slice(2*(null!=t?t:0),2*(null!=r?r:e.length)));return o&&i.Ro(a,t,r),a}function d(e){return Math.ceil((e.length-2)/2)}function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.strict,n=void 0!==r&&r;try{return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.strict,n=void 0!==r&&r;if(!e)throw new m(e);if("string"!=typeof e)throw new m(e);if(n&&!/^0x[0-9a-fA-F]*$/.test(e))throw new w(e);if(!e.startsWith("0x"))throw new w(e)}(e,{strict:n}),!0}catch(i){return!1}}var b=function(e){h(r,e);var t=v(r);function r(e){var n,i=e.max,o=e.min,a=e.signed,s=e.size,c=e.value;return k(this,r),n=t.call(this,"Number `".concat(c,"` is not in safe").concat(s?" ".concat(8*s,"-bit"):"").concat(a?" signed":" unsigned"," integer range ").concat(i?"(`".concat(o,"` to `").concat(i,"`)"):"(above `".concat(o,"`)"))),Object.defineProperty(y(n),"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"}),n}return x(r)}(n.G),m=function(e){h(r,e);var t=v(r);function r(e){var n;return k(this,r),n=t.call(this,"Value `".concat("object"==typeof e?o.P(e):e,"` of type `").concat(typeof e,"` is an invalid hex type."),{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(y(n),"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"}),n}return x(r)}(n.G),w=function(e){h(r,e);var t=v(r);function r(e){var n;return k(this,r),n=t.call(this,"Value `".concat(e,"` is an invalid hex value."),{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(y(n),"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"}),n}return x(r)}(n.G),E=function(e){h(r,e);var t=v(r);function r(e){var n,i=e.givenSize,o=e.maxSize;return k(this,r),n=t.call(this,"Size cannot exceed `".concat(o,"` bytes. Given size: `").concat(i,"` bytes.")),Object.defineProperty(y(n),"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"}),n}return x(r)}(n.G),I=function(e){h(r,e);var t=v(r);function r(e){var n,i=e.offset,o=e.position,a=e.size;return k(this,r),n=t.call(this,"Slice ".concat("start"===o?"starting":"ending"," at offset `").concat(i,"` is out-of-bounds (size: `").concat(a,"`).")),Object.defineProperty(y(n),"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"}),n}return x(r)}(n.G),S=function(e){h(r,e);var t=v(r);function r(e){var n,i=e.size,o=e.targetSize,a=e.type;return k(this,r),n=t.call(this,"".concat(a.charAt(0).toUpperCase()).concat(a.slice(1).toLowerCase()," size (`").concat(i,"`) exceeds padding size (`").concat(o,"`).")),Object.defineProperty(y(n),"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"}),n}return x(r)}(n.G)},36125:function(e,t,r){"use strict";function n(e,t,r){return JSON.stringify(e,function(e,r){return"function"==typeof t?t(e,r):"bigint"==typeof r?r.toString()+"#__bigint":r},r)}r.d(t,{P:function(){return n}})},4180:function(t,n,o){"use strict";o.d(n,{RJ:function(){return ir}});var c="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function f(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function l(e){if(!function(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}(e))throw new Error("Uint8Array expected");for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(r.length>0&&!r.includes(e.length))throw new Error("Uint8Array expected of length "+r+", got length="+e.length)}function p(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function d(e,t){l(e);var r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function b(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0;n<t.length;n++)t[n].fill(0)}function w(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function E(e,t){return e<<32-t|e>>>t}function I(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}var S=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]?function(e){return e}:function(e){for(var t=0;t<e.length;t++)e[t]=I(e[t]);return e};function O(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}(e)),l(e),e}var _=x(function e(){k(this,e)});function P(e){var t=function(t){return e().update(O(t)).digest()},r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=function(){return e()},t}function A(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(c&&"function"==typeof c.getRandomValues)return c.getRandomValues(new Uint8Array(e));if(c&&"function"==typeof c.randomBytes)return Uint8Array.from(c.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}function R(e,t,r){return e&t^~e&r}function T(e,t,r){return e&t^e&r^t&r}var B=function(e){h(r,e);var t=v(r);function r(e,n,i,o){var a;return k(this,r),(a=t.call(this)).finished=!1,a.length=0,a.pos=0,a.destroyed=!1,a.blockLen=e,a.outputLen=n,a.padOffset=i,a.isLE=o,a.buffer=new Uint8Array(e),a.view=w(a.buffer),a}return x(r,[{key:"update",value:function(e){p(this),l(e=O(e));for(var t=this.view,r=this.buffer,n=this.blockLen,i=e.length,o=0;o<i;){var a=Math.min(n-this.pos,i-o);if(a!==n)r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===n&&(this.process(t,0),this.pos=0);else for(var s=w(e);n<=i-o;o+=n)this.process(s,o)}return this.length+=e.length,this.roundClean(),this}},{key:"digestInto",value:function(e){p(this),d(e,this),this.finished=!0;var t=this.buffer,r=this.view,n=this.blockLen,i=this.isLE,o=this.pos;t[o++]=128,b(this.buffer.subarray(o)),this.padOffset>n-o&&(this.process(r,0),o=0);for(var a=o;a<n;a++)t[a]=0;(function(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);var i=BigInt(32),o=BigInt(4294967295),a=Number(r>>i&o),s=Number(r&o),c=n?0:4;e.setUint32(t+(n?4:0),a,n),e.setUint32(t+c,s,n)})(r,n-8,BigInt(8*this.length),i),this.process(r,0);var s=w(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");var u=c/4,f=this.get();if(u>f.length)throw new Error("_sha2: outputLen bigger than state");for(var l=0;l<u;l++)s.setUint32(4*l,f[l],i)}},{key:"digest",value:function(){var e=this.buffer,t=this.outputLen;this.digestInto(e);var r=e.slice(0,t);return this.destroy(),r}},{key:"_cloneInto",value:function(e){var t;e||(e=new this.constructor),(t=e).set.apply(t,s(this.get()));var r=this.blockLen,n=this.buffer,i=this.length,o=this.finished,a=this.destroyed,c=this.pos;return e.destroyed=a,e.finished=o,e.length=i,e.pos=c,i%r&&e.buffer.set(n),e}},{key:"clone",value:function(){return this._cloneInto()}}]),r}(_),C=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),U=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),N=new Uint32Array(64),j=function(e){h(r,e);var t=v(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;return k(this,r),(e=t.call(this,64,n,8,!1)).A=0|C[0],e.B=0|C[1],e.C=0|C[2],e.D=0|C[3],e.E=0|C[4],e.F=0|C[5],e.G=0|C[6],e.H=0|C[7],e}return x(r,[{key:"get",value:function(){return[this.A,this.B,this.C,this.D,this.E,this.F,this.G,this.H]}},{key:"set",value:function(e,t,r,n,i,o,a,s){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|o,this.G=0|a,this.H=0|s}},{key:"process",value:function(e,t){for(var r=0;r<16;r++,t+=4)N[r]=e.getUint32(t,!1);for(var n=16;n<64;n++){var i=N[n-15],o=N[n-2],a=E(i,7)^E(i,18)^i>>>3,s=E(o,17)^E(o,19)^o>>>10;N[n]=s+N[n-7]+a+N[n-16]|0}var c=this.A,u=this.B,f=this.C,l=this.D,p=this.E,h=this.F,d=this.G,v=this.H;for(r=0;r<64;r++){o=v+(E(p,6)^E(p,11)^E(p,25))+R(p,h,d)+U[r]+N[r]|0,s=(E(c,2)^E(c,13)^E(c,22))+T(c,u,f)|0;v=d,d=h,h=p,p=l+o|0,l=f,f=u,u=c,c=o+s|0}c=c+this.A|0,u=u+this.B|0,f=f+this.C|0,l=l+this.D|0,p=p+this.E|0,h=h+this.F|0,d=d+this.G|0,v=v+this.H|0,this.set(c,u,f,l,p,h,d,v)}},{key:"roundClean",value:function(){b(N)}},{key:"destroy",value:function(){this.set(0,0,0,0,0,0,0,0),b(this.buffer)}}]),r}(B),L=P(function(){return new j}),D=function(e){h(r,e);var t=v(r);function r(e,n){var i;k(this,r),(i=t.call(this)).finished=!1,i.destroyed=!1,function(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.createHasher");f(e.outputLen),f(e.blockLen)}(e);var o=O(n);if(i.iHash=e.create(),"function"!=typeof i.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");i.blockLen=i.iHash.blockLen,i.outputLen=i.iHash.outputLen;var a=i.blockLen,s=new Uint8Array(a);s.set(o.length>a?e.create().update(o).digest():o);for(var c=0;c<s.length;c++)s[c]^=54;i.iHash.update(s),i.oHash=e.create();for(var u=0;u<s.length;u++)s[u]^=106;return i.oHash.update(s),b(s),i}return x(r,[{key:"update",value:function(e){return p(this),this.iHash.update(e),this}},{key:"digestInto",value:function(e){p(this),l(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}},{key:"digest",value:function(){var e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}},{key:"_cloneInto",value:function(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));var t=this.oHash,r=this.iHash,n=this.finished,i=this.destroyed,o=this.blockLen,a=this.outputLen;return e.finished=n,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}},{key:"clone",value:function(){return this._cloneInto()}},{key:"destroy",value:function(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}]),r}(_),M=function(e,t,r){return new D(e,t).update(r).digest()};M.create=function(e,t){return new D(e,t)};var q=BigInt(0),z=BigInt(1);function Z(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function F(e){if(!Z(e))throw new Error("Uint8Array expected")}function K(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)}function V(e){var t=e.toString(16);return 1&t.length?"0"+t:t}function H(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?q:BigInt("0x"+e)}var W="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,G=Array.from({length:256},function(e,t){return t.toString(16).padStart(2,"0")});function J(e){if(F(e),W)return e.toHex();for(var t="",r=0;r<e.length;r++)t+=G[e[r]];return t}function Y(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}function Q(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);if(W)return Uint8Array.fromHex(e);var t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);for(var n=new Uint8Array(r),i=0,o=0;i<r;i++,o+=2){var a=Y(e.charCodeAt(o)),s=Y(e.charCodeAt(o+1));if(void 0===a||void 0===s)throw new Error('hex string expected, got non-hex character "'+(e[o]+e[o+1])+'" at index '+o);n[i]=16*a+s}return n}function X(e){return H(J(e))}function $(e){return F(e),H(J(Uint8Array.from(e).reverse()))}function ee(e,t){return Q(e.toString(16).padStart(2*t,"0"))}function te(e,t){return ee(e,t).reverse()}function re(e,t,r){var n;if("string"==typeof t)try{n=Q(t)}catch(jt){throw new Error(e+" must be hex string or Uint8Array, cause: "+jt)}else{if(!Z(t))throw new Error(e+" must be hex string or Uint8Array");n=Uint8Array.from(t)}var i=n.length;if("number"==typeof r&&i!==r)throw new Error(e+" of length "+r+" expected, got "+i);return n}function ne(){for(var e=0,t=0;t<arguments.length;t++){var r=t<0||arguments.length<=t?void 0:arguments[t];F(r),e+=r.length}for(var n=new Uint8Array(e),i=0,o=0;i<arguments.length;i++){var a=i<0||arguments.length<=i?void 0:arguments[i];n.set(a,o),o+=a.length}return n}var ie=function(e){return"bigint"==typeof e&&q<=e};function oe(e,t,r){return ie(e)&&ie(t)&&ie(r)&&t<=e&&e<r}function ae(e,t,r,n){if(!oe(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}var se=function(e){return(z<<BigInt(e))-z},ce=function(e){return new Uint8Array(e)},ue=function(e){return Uint8Array.from(e)},fe={bigint:function(e){return"bigint"==typeof e},function:function(e){return"function"==typeof e},boolean:function(e){return"boolean"==typeof e},string:function(e){return"string"==typeof e},stringOrUint8Array:function(e){return"string"==typeof e||Z(e)},isSafeInteger:function(e){return Number.isSafeInteger(e)},array:function(e){return Array.isArray(e)},field:function(e,t){return t.Fp.isValid(e)},hash:function(e){return"function"==typeof e&&Number.isSafeInteger(e.outputLen)}};function le(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=function(t,r,n){var i=fe[r];if("function"!=typeof i)throw new Error("invalid validator function");var o=e[t];if(!(n&&void 0===o||i(o,e)))throw new Error("param "+String(t)+" is invalid. Expected "+r+", got "+o)},o=0,a=Object.entries(t);o<a.length;o++){var s=i(a[o],2),c=s[0],u=s[1];n(c,u,!1)}for(var f=0,l=Object.entries(r);f<l.length;f++){var p=i(l[f],2),h=p[0],d=p[1];n(h,d,!0)}return e}function pe(e){var t=new WeakMap;return function(r){var n=t.get(r);if(void 0!==n)return n;for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];var s=e.apply(void 0,[r].concat(o));return t.set(r,s),s}}var he=BigInt(0),de=BigInt(1),ve=BigInt(2),ge=BigInt(3),ye=BigInt(4),be=BigInt(5),me=BigInt(8);function we(e,t){var r=e%t;return r>=he?r:t+r}function xe(e,t,r){for(var n=e;t-- >he;)n*=n,n%=r;return n}function ke(e,t){if(e===he)throw new Error("invert: expected non-zero number");if(t<=he)throw new Error("invert: expected positive modulus, got "+t);for(var r=we(e,t),n=t,i=he,o=de,a=de,s=he;r!==he;){var c=n/r,u=n%r,f=i-a*c,l=o-s*c;n=r,r=u,i=a,o=s,a=f,s=l}if(n!==de)throw new Error("invert: does not exist");return we(i,t)}function Ee(e,t){var r=e.pow(t,(e.ORDER+de)/ye);if(!e.eql(e.sqr(r),t))throw new Error("Cannot find square root");return r}function Ie(e,t){var r=(e.ORDER-be)/me,n=e.mul(t,ve),i=e.pow(n,r),o=e.mul(t,i),a=e.mul(e.mul(o,ve),i),s=e.mul(o,e.sub(a,e.ONE));if(!e.eql(e.sqr(s),t))throw new Error("Cannot find square root");return s}var Se=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Oe(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=new Array(t.length).fill(r?e.ZERO:void 0),i=t.reduce(function(t,r,i){return e.is0(r)?t:(n[i]=t,e.mul(t,r))},e.ONE),o=e.inv(i);return t.reduceRight(function(t,r,i){return e.is0(r)?t:(n[i]=e.mul(t,n[i]),e.mul(t,r))},o),n}function _e(e,t){var r=e.pow(t,(e.ORDER-de)/ve),n=e.eql(r,e.ONE),i=e.eql(r,e.ZERO),o=e.eql(r,e.neg(e.ONE));if(!n&&!i&&!o)throw new Error("invalid Legendre symbol result");return n?1:i?0:-1}function Pe(e,t){void 0!==t&&f(t);var r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function Ae(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(e<=he)throw new Error("invalid field: expected ORDER > 0, got "+e);var i,o=Pe(e,t),a=o.nBitLength,s=o.nByteLength;if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");var c=Object.freeze({ORDER:e,isLE:r,BITS:a,BYTES:s,MASK:se(a),ZERO:he,ONE:de,create:function(t){return we(t,e)},isValid:function(t){if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return he<=t&&t<e},is0:function(e){return e===he},isOdd:function(e){return(e&de)===de},neg:function(t){return we(-t,e)},eql:function(e,t){return e===t},sqr:function(t){return we(t*t,e)},add:function(t,r){return we(t+r,e)},sub:function(t,r){return we(t-r,e)},mul:function(t,r){return we(t*r,e)},pow:function(e,t){return function(e,t,r){if(r<he)throw new Error("invalid exponent, negatives unsupported");if(r===he)return e.ONE;if(r===de)return t;for(var n=e.ONE,i=t;r>he;)r&de&&(n=e.mul(n,i)),i=e.sqr(i),r>>=de;return n}(c,e,t)},div:function(t,r){return we(t*ke(r,e),e)},sqrN:function(e){return e*e},addN:function(e,t){return e+t},subN:function(e,t){return e-t},mulN:function(e,t){return e*t},inv:function(t){return ke(t,e)},sqrt:n.sqrt||function(t){return i||(i=function(e){return e%ye===ge?Ee:e%me===be?Ie:function(e){if(e<BigInt(3))throw new Error("sqrt is not defined for small field");for(var t=e-de,r=0;t%ve===he;)t/=ve,r++;for(var n=ve,i=Ae(e);1===_e(i,n);)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===r)return Ee;var o=i.pow(n,t),a=(t+de)/ve;return function(e,n){if(e.is0(n))return n;if(1!==_e(e,n))throw new Error("Cannot find square root");for(var i=r,s=e.mul(e.ONE,o),c=e.pow(n,t),u=e.pow(n,a);!e.eql(c,e.ONE);){if(e.is0(c))return e.ZERO;for(var f=1,l=e.sqr(c);!e.eql(l,e.ONE);)if(f++,l=e.sqr(l),f===i)throw new Error("Cannot find square root");var p=de<<BigInt(i-f-1),h=e.pow(s,p);i=f,s=e.sqr(h),c=e.mul(c,s),u=e.mul(u,h)}return u}}(e)}(e)),i(c,t)},toBytes:function(e){return r?te(e,s):ee(e,s)},fromBytes:function(e){if(e.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+e.length);return r?$(e):X(e)},invertBatch:function(e){return Oe(c,e)},cmov:function(e,t,r){return r?t:e}});return Object.freeze(c)}function Re(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");var t=e.toString(2).length;return Math.ceil(t/8)}function Te(e){var t=Re(e);return t+Math.ceil(t/2)}var Be=BigInt(0),Ce=BigInt(1);function Ue(e,t){var r=t.negate();return e?r:t}function Ne(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function je(e,t){Ne(e,t);var r=Math.pow(2,e);return{windows:Math.ceil(t/e)+1,windowSize:Math.pow(2,e-1),mask:se(e),maxNumber:r,shiftBy:BigInt(e)}}function Le(e,t,r){var n=r.windowSize,i=r.mask,o=r.maxNumber,a=r.shiftBy,s=Number(e&i),c=e>>a;s>n&&(s-=o,c+=Ce);var u=t*n;return{nextN:c,offset:u+Math.abs(s)-1,isZero:0===s,isNeg:s<0,isNegF:t%2!=0,offsetF:u}}var De=new WeakMap,Me=new WeakMap;function qe(e){return Me.get(e)||1}function ze(e){return function(e){le(e,Se.reduce(function(e,t){return e[t]="function",e},{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}(e.Fp),le(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze(a(a(a({},Pe(e.n,e.nBitLength)),e),{},{p:e.Fp.ORDER}))}function Ze(e){void 0!==e.lowS&&K("lowS",e.lowS),void 0!==e.prehash&&K("prehash",e.prehash)}var Fe=function(e){h(r,e);var t=v(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return k(this,r),t.call(this,e)}return x(r)}(r(Error)),Ke={Err:Fe,_tlv:{encode:function(e,t){var r=Ke.Err;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");var n=t.length/2,i=V(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");var o=n>127?V(i.length/2|128):"";return V(e)+o+i+t},decode:function(e,t){var r=Ke.Err,n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");var i=t[n++],o=0;if(128&i){var a=127&i;if(!a)throw new r("tlv.decode(long): indefinite length not supported");if(a>4)throw new r("tlv.decode(long): byte length is too big");var s=t.subarray(n,n+a);if(s.length!==a)throw new r("tlv.decode: length bytes not complete");if(0===s[0])throw new r("tlv.decode(long): zero leftmost byte");var c,f=u(s);try{for(f.s();!(c=f.n()).done;){o=o<<8|c.value}}catch(p){f.e(p)}finally{f.f()}if(n+=a,o<128)throw new r("tlv.decode(long): not minimal encoding")}else o=i;var l=t.subarray(n,n+o);if(l.length!==o)throw new r("tlv.decode: wrong value length");return{v:l,l:t.subarray(n+o)}}},_int:{encode:function(e){var t=Ke.Err;if(e<He)throw new t("integer: negative integers are not allowed");var r=V(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode:function(e){var t=Ke.Err;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return X(e)}},toSig:function(e){var t=Ke.Err,r=Ke._int,n=Ke._tlv,i=re("signature",e),o=n.decode(48,i),a=o.v;if(o.l.length)throw new t("invalid signature: left bytes after parsing");var s=n.decode(2,a),c=s.v,u=s.l,f=n.decode(2,u),l=f.v;if(f.l.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(c),s:r.decode(l)}},hexFromSig:function(e){var t=Ke._tlv,r=Ke._int,n=t.encode(2,r.encode(e.r)),i=t.encode(2,r.encode(e.s));return t.encode(48,n+i)}};function Ve(e,t){return J(ee(e,t))}var He=BigInt(0),We=BigInt(1),Ge=(BigInt(2),BigInt(3)),Je=BigInt(4);function Ye(e){var t=function(e){var t=ze(e);return le(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze(a({lowS:!0},t))}(e),r=t.Fp,n=t.n,i=t.nByteLength,o=t.nBitLength,s=r.BYTES+1,c=2*r.BYTES+1;function u(e){return we(e,n)}function f(e){return ke(e,n)}var l=function(e){var t=function(e){var t=ze(e);le(t,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});var r=t.endo,n=t.Fp,i=t.a;if(r){if(!n.eql(i,n.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze(a({},t))}(e),r=t.Fp,n=Ae(t.n,t.nBitLength),i=t.toBytes||function(e,t,n){var i=t.toAffine();return ne(Uint8Array.from([4]),r.toBytes(i.x),r.toBytes(i.y))},o=t.fromBytes||function(e){var t=e.subarray(1);return{x:r.fromBytes(t.subarray(0,r.BYTES)),y:r.fromBytes(t.subarray(r.BYTES,2*r.BYTES))}};function s(e){var n=t.a,i=t.b,o=r.sqr(e),a=r.mul(o,e);return r.add(r.add(a,r.mul(e,n)),i)}function c(e,t){var n=r.sqr(t),i=s(e);return r.eql(n,i)}if(!c(t.Gx,t.Gy))throw new Error("bad curve params: generator point");var u=r.mul(r.pow(t.a,Ge),Je),f=r.mul(r.sqr(t.b),BigInt(27));if(r.is0(r.add(u,f)))throw new Error("bad curve params: a or b");function l(e){var r,n=t.allowedPrivateKeyLengths,i=t.nByteLength,o=t.wrapPrivateKey,a=t.n;if(n&&"bigint"!=typeof e){if(Z(e)&&(e=J(e)),"string"!=typeof e||!n.includes(e.length))throw new Error("invalid private key");e=e.padStart(2*i,"0")}try{r="bigint"==typeof e?e:X(re("private key",e,i))}catch(s){throw new Error("invalid private key, expected hex or "+i+" bytes, got "+typeof e)}return o&&(r=we(r,a)),ae("private key",r,We,a),r}function p(e){if(!(e instanceof v))throw new Error("ProjectivePoint expected")}var h=pe(function(e,t){var n=e.px,i=e.py,o=e.pz;if(r.eql(o,r.ONE))return{x:n,y:i};var a=e.is0();null==t&&(t=a?r.ONE:r.inv(o));var s=r.mul(n,t),c=r.mul(i,t),u=r.mul(o,t);if(a)return{x:r.ZERO,y:r.ZERO};if(!r.eql(u,r.ONE))throw new Error("invZ was invalid");return{x:s,y:c}}),d=pe(function(e){if(e.is0()){if(t.allowInfinityPoint&&!r.is0(e.py))return;throw new Error("bad point: ZERO")}var n=e.toAffine(),i=n.x,o=n.y;if(!r.isValid(i)||!r.isValid(o))throw new Error("bad point: x or y not FE");if(!c(i,o))throw new Error("bad point: equation left != right");if(!e.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0}),v=function(){function e(t,n,i){if(k(this,e),null==t||!r.isValid(t))throw new Error("x required");if(null==n||!r.isValid(n)||r.is0(n))throw new Error("y required");if(null==i||!r.isValid(i))throw new Error("z required");this.px=t,this.py=n,this.pz=i,Object.freeze(this)}return x(e,[{key:"x",get:function(){return this.toAffine().x}},{key:"y",get:function(){return this.toAffine().y}},{key:"_setWindowSize",value:function(e){b.setWindowSize(this,e)}},{key:"assertValidity",value:function(){d(this)}},{key:"hasEvenY",value:function(){var e=this.toAffine().y;if(r.isOdd)return!r.isOdd(e);throw new Error("Field doesn't support isOdd")}},{key:"equals",value:function(e){p(e);var t=this.px,n=this.py,i=this.pz,o=e.px,a=e.py,s=e.pz,c=r.eql(r.mul(t,s),r.mul(o,i)),u=r.eql(r.mul(n,s),r.mul(a,i));return c&&u}},{key:"negate",value:function(){return new e(this.px,r.neg(this.py),this.pz)}},{key:"double",value:function(){var n=t.a,i=t.b,o=r.mul(i,Ge),a=this.px,s=this.py,c=this.pz,u=r.ZERO,f=r.ZERO,l=r.ZERO,p=r.mul(a,a),h=r.mul(s,s),d=r.mul(c,c),v=r.mul(a,s);return v=r.add(v,v),l=r.mul(a,c),l=r.add(l,l),u=r.mul(n,l),f=r.mul(o,d),f=r.add(u,f),u=r.sub(h,f),f=r.add(h,f),f=r.mul(u,f),u=r.mul(v,u),l=r.mul(o,l),d=r.mul(n,d),v=r.sub(p,d),v=r.mul(n,v),v=r.add(v,l),l=r.add(p,p),p=r.add(l,p),p=r.add(p,d),p=r.mul(p,v),f=r.add(f,p),d=r.mul(s,c),d=r.add(d,d),p=r.mul(d,v),u=r.sub(u,p),l=r.mul(d,h),l=r.add(l,l),new e(u,f,l=r.add(l,l))}},{key:"add",value:function(n){p(n);var i=this.px,o=this.py,a=this.pz,s=n.px,c=n.py,u=n.pz,f=r.ZERO,l=r.ZERO,h=r.ZERO,d=t.a,v=r.mul(t.b,Ge),g=r.mul(i,s),y=r.mul(o,c),b=r.mul(a,u),m=r.add(i,o),w=r.add(s,c);m=r.mul(m,w),w=r.add(g,y),m=r.sub(m,w),w=r.add(i,a);var x=r.add(s,u);return w=r.mul(w,x),x=r.add(g,b),w=r.sub(w,x),x=r.add(o,a),f=r.add(c,u),x=r.mul(x,f),f=r.add(y,b),x=r.sub(x,f),h=r.mul(d,w),f=r.mul(v,b),h=r.add(f,h),f=r.sub(y,h),h=r.add(y,h),l=r.mul(f,h),y=r.add(g,g),y=r.add(y,g),b=r.mul(d,b),w=r.mul(v,w),y=r.add(y,b),b=r.sub(g,b),b=r.mul(d,b),w=r.add(w,b),g=r.mul(y,w),l=r.add(l,g),g=r.mul(x,w),f=r.mul(m,f),f=r.sub(f,g),g=r.mul(m,y),h=r.mul(x,h),new e(f,l,h=r.add(h,g))}},{key:"subtract",value:function(e){return this.add(e.negate())}},{key:"is0",value:function(){return this.equals(e.ZERO)}},{key:"wNAF",value:function(t){return b.wNAFCached(this,t,e.normalizeZ)}},{key:"multiplyUnsafe",value:function(n){var i=t.endo,o=t.n;ae("scalar",n,He,o);var a=e.ZERO;if(n===He)return a;if(this.is0()||n===We)return this;if(!i||b.hasPrecomputes(this))return b.wNAFCachedUnsafe(this,n,e.normalizeZ);for(var s=i.splitScalar(n),c=s.k1neg,u=s.k1,f=s.k2neg,l=s.k2,p=a,h=a,d=this;u>He||l>He;)u&We&&(p=p.add(d)),l&We&&(h=h.add(d)),d=d.double(),u>>=We,l>>=We;return c&&(p=p.negate()),f&&(h=h.negate()),h=new e(r.mul(h.px,i.beta),h.py,h.pz),p.add(h)}},{key:"multiply",value:function(n){var i,o,a=t.endo,s=t.n;if(ae("scalar",n,We,s),a){var c=a.splitScalar(n),u=c.k1neg,f=c.k1,l=c.k2neg,p=c.k2,h=this.wNAF(f),d=h.p,v=h.f,g=this.wNAF(p),y=g.p,m=g.f;d=b.constTimeNegate(u,d),y=b.constTimeNegate(l,y),y=new e(r.mul(y.px,a.beta),y.py,y.pz),i=d.add(y),o=v.add(m)}else{var w=this.wNAF(n);i=w.p,o=w.f}return e.normalizeZ([i,o])[0]}},{key:"multiplyAndAddUnsafe",value:function(t,r,n){var i=e.BASE,o=function(e,t){return t!==He&&t!==We&&e.equals(i)?e.multiply(t):e.multiplyUnsafe(t)},a=o(this,r).add(o(t,n));return a.is0()?void 0:a}},{key:"toAffine",value:function(e){return h(this,e)}},{key:"isTorsionFree",value:function(){var r=t.h,n=t.isTorsionFree;if(r===We)return!0;if(n)return n(e,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}},{key:"clearCofactor",value:function(){var r=t.h,n=t.clearCofactor;return r===We?this:n?n(e,this):this.multiplyUnsafe(t.h)}},{key:"toRawBytes",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return K("isCompressed",t),this.assertValidity(),i(e,this,t)}},{key:"toHex",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return K("isCompressed",e),J(this.toRawBytes(e))}}],[{key:"fromAffine",value:function(t){var n=t||{},i=n.x,o=n.y;if(!t||!r.isValid(i)||!r.isValid(o))throw new Error("invalid affine point");if(t instanceof e)throw new Error("projective point not allowed");var a=function(e){return r.eql(e,r.ZERO)};return a(i)&&a(o)?e.ZERO:new e(i,o,r.ONE)}},{key:"normalizeZ",value:function(t){var n=Oe(r,t.map(function(e){return e.pz}));return t.map(function(e,t){return e.toAffine(n[t])}).map(e.fromAffine)}},{key:"fromHex",value:function(t){var r=e.fromAffine(o(re("pointHex",t)));return r.assertValidity(),r}},{key:"fromPrivateKey",value:function(t){return e.BASE.multiply(l(t))}},{key:"msm",value:function(t,r){return function(e,t,r,n){(function(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach(function(e,r){if(!(e instanceof t))throw new Error("invalid point at index "+r)})})(r,e),function(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach(function(e,r){if(!t.isValid(e))throw new Error("invalid scalar at index "+r)})}(n,t);var i=r.length,o=n.length;if(i!==o)throw new Error("arrays of points and scalars must have equal length");var a=e.ZERO,s=function(e){var t;for(t=0;e>q;e>>=z,t+=1);return t}(BigInt(i)),c=1;s>12?c=s-3:s>4?c=s-2:s>0&&(c=2);for(var u=se(c),f=new Array(Number(u)+1).fill(a),l=a,p=Math.floor((t.BITS-1)/c)*c;p>=0;p-=c){f.fill(a);for(var h=0;h<o;h++){var d=Number(n[h]>>BigInt(p)&u);f[d]=f[d].add(r[h])}for(var v=a,g=f.length-1,y=a;g>0;g--)y=y.add(f[g]),v=v.add(y);if(l=l.add(v),0!==p)for(var b=0;b<c;b++)l=l.double()}return l}(e,n,t,r)}}]),e}();v.BASE=new v(t.Gx,t.Gy,r.ONE),v.ZERO=new v(r.ZERO,r.ONE,r.ZERO);var g=t.endo,y=t.nBitLength,b=function(e,t){return{constTimeNegate:Ue,hasPrecomputes:function(e){return 1!==qe(e)},unsafeLadder:function(t,r){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.ZERO,i=t;r>Be;)r&Ce&&(n=n.add(i)),i=i.double(),r>>=Ce;return n},precomputeWindow:function(e,r){for(var n=je(r,t),i=n.windows,o=n.windowSize,a=[],s=e,c=s,u=0;u<i;u++){c=s,a.push(c);for(var f=1;f<o;f++)c=c.add(s),a.push(c);s=c.double()}return a},wNAF:function(r,n,i){for(var o=e.ZERO,a=e.BASE,s=je(r,t),c=0;c<s.windows;c++){var u=Le(i,c,s),f=u.nextN,l=u.offset,p=u.isZero,h=u.isNeg,d=u.isNegF,v=u.offsetF;i=f,p?a=a.add(Ue(d,n[v])):o=o.add(Ue(h,n[l]))}return{p:o,f:a}},wNAFUnsafe:function(r,n,i){for(var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.ZERO,a=je(r,t),s=0;s<a.windows&&i!==Be;s++){var c=Le(i,s,a),u=c.nextN,f=c.offset,l=c.isZero,p=c.isNeg;if(i=u,!l){var h=n[f];o=o.add(p?h.negate():h)}}return o},getPrecomputes:function(e,t,r){var n=De.get(t);return n||(n=this.precomputeWindow(t,e),1!==e&&De.set(t,r(n))),n},wNAFCached:function(e,t,r){var n=qe(e);return this.wNAF(n,this.getPrecomputes(n,e,r),t)},wNAFCachedUnsafe:function(e,t,r,n){var i=qe(e);return 1===i?this.unsafeLadder(e,t,n):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),t,n)},setWindowSize:function(e,r){Ne(r,t),Me.set(e,r),De.delete(e)}}}(v,g?Math.ceil(y/2):y);return{CURVE:t,ProjectivePoint:v,normPrivateKeyToScalar:l,weierstrassEquation:s,isWithinCurveOrder:function(e){return oe(e,We,t.n)}}}(a(a({},t),{},{toBytes:function(e,t,n){var i=t.toAffine(),o=r.toBytes(i.x),a=ne;return K("isCompressed",n),n?a(Uint8Array.from([t.hasEvenY()?2:3]),o):a(Uint8Array.from([4]),o,r.toBytes(i.y))},fromBytes:function(e){var t=e.length,n=e[0],i=e.subarray(1);if(t!==s||2!==n&&3!==n){if(t===c&&4===n)return{x:r.fromBytes(i.subarray(0,r.BYTES)),y:r.fromBytes(i.subarray(r.BYTES,2*r.BYTES))};throw new Error("invalid Point, expected length of "+s+", or uncompressed "+c+", got "+t)}var o=X(i);if(!oe(o,We,r.ORDER))throw new Error("Point is not on curve");var a,u=d(o);try{a=r.sqrt(u)}catch(l){var f=l instanceof Error?": "+l.message:"";throw new Error("Point is not on curve"+f)}return 1==(1&n)!=((a&We)===We)&&(a=r.neg(a)),{x:o,y:a}}})),p=l.ProjectivePoint,h=l.normPrivateKeyToScalar,d=l.weierstrassEquation,v=l.isWithinCurveOrder;function g(e){return e>n>>We}var y=function(e,t,r){return X(e.slice(t,r))},b=function(){function e(t,r,i){k(this,e),ae("r",t,We,n),ae("s",r,We,n),this.r=t,this.s=r,null!=i&&(this.recovery=i),Object.freeze(this)}return x(e,[{key:"assertValidity",value:function(){}},{key:"addRecoveryBit",value:function(t){return new e(this.r,this.s,t)}},{key:"recoverPublicKey",value:function(e){var n=this.r,i=this.s,o=this.recovery,a=I(re("msgHash",e));if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");var s=2===o||3===o?n+t.n:n;if(s>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");var c=p.fromHex((0==(1&o)?"02":"03")+Ve(s,r.BYTES)),l=f(s),h=u(-a*l),d=u(i*l),v=p.BASE.multiplyAndAddUnsafe(c,h,d);if(!v)throw new Error("point at infinify");return v.assertValidity(),v}},{key:"hasHighS",value:function(){return g(this.s)}},{key:"normalizeS",value:function(){return this.hasHighS()?new e(this.r,u(-this.s),this.recovery):this}},{key:"toDERRawBytes",value:function(){return Q(this.toDERHex())}},{key:"toDERHex",value:function(){return Ke.hexFromSig(this)}},{key:"toCompactRawBytes",value:function(){return Q(this.toCompactHex())}},{key:"toCompactHex",value:function(){var e=i;return Ve(this.r,e)+Ve(this.s,e)}}],[{key:"fromCompact",value:function(t){var r=i;return t=re("compactSignature",t,2*r),new e(y(t,0,r),y(t,r,2*r))}},{key:"fromDER",value:function(t){var r=Ke.toSig(re("DER",t));return new e(r.r,r.s)}}]),e}(),m={isValidPrivateKey:function(e){try{return h(e),!0}catch(t){return!1}},normPrivateKeyToScalar:h,randomPrivateKey:function(){var e=Te(t.n);return function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e.length,i=Re(t),o=Te(t);if(n<16||n<o||n>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+n);var a=we(r?$(e):X(e),t-de)+de;return r?te(a,i):ee(a,i)}(t.randomBytes(e),t.n)},precompute:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.BASE;return t._setWindowSize(e),t.multiply(BigInt(3)),t}};function w(e){if("bigint"==typeof e)return!1;if(e instanceof p)return!0;var n=re("key",e).length,o=r.BYTES,a=o+1;return t.allowedPrivateKeyLengths||i===a?void 0:n===a||n===2*o+1}var E=t.bits2int||function(e){if(e.length>8192)throw new Error("input is too large");var t=X(e),r=8*e.length-o;return r>0?t>>BigInt(r):t},I=t.bits2int_modN||function(e){return u(E(e))},S=se(o);function O(e){return ae("num < 2^"+o,e,He,S),ee(e,i)}var _={lowS:t.lowS,prehash:!1},P={lowS:t.lowS,prehash:!1};return p.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return p.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!0===w(e))throw new Error("first arg must be private key");if(!1===w(t))throw new Error("second arg must be public key");return p.fromHex(t).multiply(h(e)).toRawBytes(r)},sign:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_,o=function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_;if(["recovered","canonical"].some(function(e){return e in i}))throw new Error("sign() legacy options not supported");var o=t.hash,a=t.randomBytes,s=i.lowS,c=i.prehash,l=i.extraEntropy;null==s&&(s=!0),e=re("msgHash",e),Ze(i),c&&(e=re("prehashed msgHash",o(e)));var d=I(e),y=h(n),m=[O(y),O(d)];if(null!=l&&!1!==l){var w=!0===l?a(r.BYTES):l;m.push(re("extraEntropy",w))}var x=ne.apply(void 0,m),k=d;return{seed:x,k2sig:function(e){var t=E(e);if(v(t)){var r=f(t),n=p.BASE.multiply(t).toAffine(),i=u(n.x);if(i!==He){var o=u(r*u(k+i*y));if(o!==He){var a=(n.x===i?0:2)|Number(n.y&We),c=o;return s&&g(o)&&(c=function(e){return g(e)?u(-e):e}(o),a^=1),new b(i,c,a)}}}}}}(e,n,i),a=o.seed,s=o.k2sig;return function(e,t,r){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof r)throw new Error("hmacFn must be a function");var n=ce(e),i=ce(e),o=0,a=function(){n.fill(1),i.fill(0),o=0},s=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return r.apply(void 0,[i,n].concat(t))},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ce(0);i=s(ue([0]),e),n=s(),0!==e.length&&(i=s(ue([1]),e),n=s())},u=function(){if(o++>=1e3)throw new Error("drbg: tried 1000 values");for(var e=0,r=[];e<t;){var i=(n=s()).slice();r.push(i),e+=n.length}return ne.apply(void 0,r)};return function(e,t){var r;for(a(),c(e);!(r=t(u()));)c();return a(),r}}(t.hash.outputLen,t.nByteLength,t.hmac)(a,s)},verify:function(e,r,n){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:P,a=e;r=re("msgHash",r),n=re("publicKey",n);var s=o.lowS,c=o.prehash,l=o.format;if(Ze(o),"strict"in o)throw new Error("options.strict was renamed to lowS");if(void 0!==l&&"compact"!==l&&"der"!==l)throw new Error("format must be compact or der");var h,d,v="string"==typeof a||Z(a),g=!v&&!l&&"object"==typeof a&&null!==a&&"bigint"==typeof a.r&&"bigint"==typeof a.s;if(!v&&!g)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");try{if(g&&(h=new b(a.r,a.s)),v){try{"compact"!==l&&(h=b.fromDER(a))}catch(_){if(!(_ instanceof Ke.Err))throw _}!h&&"der"!==l&&(h=b.fromCompact(a))}d=p.fromHex(n)}catch(A){return!1}if(!h||s&&h.hasHighS())return!1;c&&(r=t.hash(r));var y=h,m=y.r,w=y.s,x=I(r),k=f(w),E=u(x*k),S=u(m*k),O=null===(i=p.BASE.multiplyAndAddUnsafe(d,E,S))||void 0===i?void 0:i.toAffine();return!!O&&u(O.x)===m},ProjectivePoint:p,Signature:b,utils:m}}var Qe=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Xe=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),$e=BigInt(0),et=BigInt(1),tt=BigInt(2),rt=function(e,t){return(e+t/tt)/t},nt=Ae(Qe,void 0,void 0,{sqrt:function(e){var t=Qe,r=BigInt(3),n=BigInt(6),i=BigInt(11),o=BigInt(22),a=BigInt(23),s=BigInt(44),c=BigInt(88),u=e*e*e%t,f=u*u*e%t,l=xe(f,r,t)*f%t,p=xe(l,r,t)*f%t,h=xe(p,tt,t)*u%t,d=xe(h,i,t)*h%t,v=xe(d,o,t)*d%t,g=xe(v,s,t)*v%t,y=xe(g,c,t)*g%t,b=xe(y,s,t)*v%t,m=xe(b,r,t)*f%t,w=xe(m,a,t)*d%t,x=xe(w,n,t)*u%t,k=xe(x,tt,t);if(!nt.eql(nt.sqr(k),e))throw new Error("Cannot find square root");return k}}),it=function(e,t){var r=function(t){return Ye(a(a({},e),function(e){return{hash:e,hmac:function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return M(e,t,(function(){for(var e=0,t=0;t<arguments.length;t++){var r=t<0||arguments.length<=t?void 0:arguments[t];l(r),e+=r.length}for(var n=new Uint8Array(e),i=0,o=0;i<arguments.length;i++){var a=i<0||arguments.length<=i?void 0:arguments[i];n.set(a,o),o+=a.length}return n}).apply(void 0,n))},randomBytes:A}}(t)))};return a(a({},r(t)),{},{create:r})}({a:$e,b:BigInt(7),Fp:nt,n:Xe,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:function(e){var t=Xe,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-et*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=r,a=BigInt("0x100000000000000000000000000000000"),s=rt(o*e,t),c=rt(-n*e,t),u=we(e-s*r-c*i,t),f=we(-s*n-c*o,t),l=u>a,p=f>a;if(l&&(u=t-u),p&&(f=t-f),u>a||f>a)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:l,k1:u,k2neg:p,k2:f}}}},L),ot=o(47737),at=o(89062);function st(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}var ct=o(85900),ut=o(36125),ft=new TextEncoder;function lt(e){return e instanceof Uint8Array?e:"string"==typeof e?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.size,n=e;r&&(ct.Yf(e,r),n=at.eh(e,r));var i=n.slice(2);i.length%2&&(i="0".concat(i));for(var o=i.length/2,a=new Uint8Array(o),s=0,c=0;s<o;s++){var u=st(i.charCodeAt(c++)),f=st(i.charCodeAt(c++));if(void 0===u||void 0===f)throw new ot.G('Invalid byte sequence ("'.concat(i[c-2]).concat(i[c-1],'" in "').concat(i,'").'));a[s]=16*u+f}return a}(e):function(e){return e instanceof Uint8Array?e:new Uint8Array(e)}(e)}function pt(e){return e.length}var ht=function(e){h(r,e);var t=v(r);function r(e){var n;return k(this,r),n=t.call(this,"Value `".concat("object"==typeof e?ut.P(e):e,"` of type `").concat(typeof e,"` is an invalid Bytes value."),{metaMessages:["Bytes values must be of type `Bytes`."]}),Object.defineProperty(y(n),"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.InvalidBytesTypeError"}),n}return x(r)}(ot.G),dt=function(e){h(r,e);var t=v(r);function r(e){var n,i=e.givenSize,o=e.maxSize;return k(this,r),n=t.call(this,"Size cannot exceed `".concat(o,"` bytes. Given size: `").concat(i,"` bytes.")),Object.defineProperty(y(n),"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"}),n}return x(r)}(ot.G),vt=function(e){h(r,e);var t=v(r);function r(e){var n,i=e.size,o=e.targetSize,a=e.type;return k(this,r),n=t.call(this,"".concat(a.charAt(0).toUpperCase()).concat(a.slice(1).toLowerCase()," size (`").concat(i,"`) exceeds padding size (`").concat(o,"`).")),Object.defineProperty(y(n),"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"}),n}return x(r)}(ot.G),gt=function(t){h(n,t);var r=v(n);function n(e){var t;return k(this,n),t=r.call(this),Object.defineProperty(y(t),"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t.maxSize=e,t}return x(n,[{key:"get",value:function(t){var r=e(m(n.prototype),"get",this).call(this,t);return e(m(n.prototype),"has",this).call(this,t)&&void 0!==r&&(this.delete(t),e(m(n.prototype),"set",this).call(this,t,r)),r}},{key:"set",value:function(t,r){if(e(m(n.prototype),"set",this).call(this,t,r),this.maxSize&&this.size>this.maxSize){var i=this.keys().next().value;i&&this.delete(i)}return this}}]),n}(r(Map)),yt=new gt(8192),bt=BigInt(Math.pow(2,32)-1),mt=BigInt(32);function wt(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?{h:Number(e&bt),l:Number(e>>mt&bt)}:{h:0|Number(e>>mt&bt),l:0|Number(e&bt)}}for(var xt=BigInt(0),kt=BigInt(1),Et=BigInt(2),It=BigInt(7),St=BigInt(256),Ot=BigInt(113),_t=[],Pt=[],At=[],Rt=0,Tt=kt,Bt=1,Ct=0;Rt<24;Rt++){var Ut;Bt=(Ut=[Ct,(2*Bt+3*Ct)%5])[0],Ct=Ut[1],_t.push(2*(5*Ct+Bt)),Pt.push((Rt+1)*(Rt+2)/2%64);for(var Nt=xt,jt=0;jt<7;jt++)(Tt=(Tt<<kt^(Tt>>It)*Ot)%St)&Et&&(Nt^=kt<<(kt<<BigInt(jt))-kt);At.push(Nt)}var Lt=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.length,n=new Uint32Array(r),i=new Uint32Array(r),o=0;o<r;o++){var a=wt(e[o],t),s=a.h,c=a.l,u=[s,c];n[o]=u[0],i[o]=u[1]}return[n,i]}(At,!0),Dt=Lt[0],Mt=Lt[1],qt=function(e,t,r){return r>32?function(e,t,r){return t<<r-32|e>>>64-r}(e,t,r):function(e,t,r){return e<<r|t>>>32-r}(e,t,r)},zt=function(e,t,r){return r>32?function(e,t,r){return e<<r-32|t>>>64-r}(e,t,r):function(e,t,r){return t<<r|e>>>32-r}(e,t,r)},Zt=function(e){h(r,e);var t=v(r);function r(e,n,i){var o,a,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:24;if(k(this,r),(o=t.call(this)).pos=0,o.posOut=0,o.finished=!1,o.destroyed=!1,o.enableXOF=!1,o.blockLen=e,o.suffix=n,o.outputLen=i,o.enableXOF=s,o.rounds=c,f(i),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");return o.state=new Uint8Array(200),o.state32=(a=o.state,new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4))),g(o)}return x(r,[{key:"clone",value:function(){return this._cloneInto()}},{key:"keccak",value:function(){S(this.state32),function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24,r=new Uint32Array(10),n=24-t;n<24;n++){for(var i=0;i<10;i++)r[i]=e[i]^e[i+10]^e[i+20]^e[i+30]^e[i+40];for(var o=0;o<10;o+=2)for(var a=(o+8)%10,s=(o+2)%10,c=r[s],u=r[s+1],f=qt(c,u,1)^r[a],l=zt(c,u,1)^r[a+1],p=0;p<50;p+=10)e[o+p]^=f,e[o+p+1]^=l;for(var h=e[2],d=e[3],v=0;v<24;v++){var g=Pt[v],y=qt(h,d,g),m=zt(h,d,g),w=_t[v];h=e[w],d=e[w+1],e[w]=y,e[w+1]=m}for(var x=0;x<50;x+=10){for(var k=0;k<10;k++)r[k]=e[x+k];for(var E=0;E<10;E++)e[x+E]^=~r[(E+2)%10]&r[(E+4)%10]}e[0]^=Dt[n],e[1]^=Mt[n]}b(r)}(this.state32,this.rounds),S(this.state32),this.posOut=0,this.pos=0}},{key:"update",value:function(e){p(this),l(e=O(e));for(var t=this.blockLen,r=this.state,n=e.length,i=0;i<n;){for(var o=Math.min(t-this.pos,n-i),a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}},{key:"finish",value:function(){if(!this.finished){this.finished=!0;var e=this.state,t=this.suffix,r=this.pos,n=this.blockLen;e[r]^=t,0!=(128&t)&&r===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}}},{key:"writeInto",value:function(e){p(this,!1),l(e),this.finish();for(var t=this.state,r=this.blockLen,n=0,i=e.length;n<i;){this.posOut>=r&&this.keccak();var o=Math.min(r-this.posOut,i-n);e.set(t.subarray(this.posOut,this.posOut+o),n),this.posOut+=o,n+=o}return e}},{key:"xofInto",value:function(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}},{key:"xof",value:function(e){return f(e),this.xofInto(new Uint8Array(e))}},{key:"digestInto",value:function(e){if(d(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}},{key:"digest",value:function(){return this.digestInto(new Uint8Array(this.outputLen))}},{key:"destroy",value:function(){this.destroyed=!0,b(this.state)}},{key:"_cloneInto",value:function(e){var t=this.blockLen,n=this.suffix,i=this.outputLen,o=this.rounds,a=this.enableXOF;return e||(e=new r(t,n,i,a,o)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=o,e.suffix=n,e.outputLen=i,e.enableXOF=a,e.destroyed=this.destroyed,e}}]),r}(_),Ft=P(function(){return new Zt(136,1,32)});function Kt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.as,n=void 0===r?"string"==typeof e?"Hex":"Bytes":r,i=Ft(lt(e));return"Bytes"===n?i:at.xv(i)}function Vt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.compressed,n=e.prefix,i=e.x,o=e.y;if(!1===r||"bigint"==typeof i&&"bigint"==typeof o){if(4!==n)throw new Gt({prefix:n,cause:new Yt})}else{if(!0!==r&&("bigint"!=typeof i||void 0!==o))throw new Wt({publicKey:e});if(3!==n&&2!==n)throw new Gt({prefix:n,cause:new Jt})}}function Ht(e){if(132!==e.length&&130!==e.length&&68!==e.length)throw new Qt({publicKey:e});return 130===e.length?{prefix:4,x:BigInt(at.tP(e,0,32)),y:BigInt(at.tP(e,32,64))}:132===e.length?{prefix:Number(at.tP(e,0,1)),x:BigInt(at.tP(e,1,33)),y:BigInt(at.tP(e,33,65))}:{prefix:Number(at.tP(e,0,1)),x:BigInt(at.tP(e,1,33))}}var Wt=function(e){h(r,e);var t=v(r);function r(e){var n,i=e.publicKey;return k(this,r),n=t.call(this,"Value `".concat(ut.P(i),"` is not a valid public key."),{metaMessages:["Public key must contain:","- an `x` and `prefix` value (compressed)","- an `x`, `y`, and `prefix` value (uncompressed)"]}),Object.defineProperty(y(n),"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidError"}),n}return x(r)}(ot.G),Gt=function(e){h(r,e);var t=v(r);function r(e){var n,i=e.prefix,o=e.cause;return k(this,r),n=t.call(this,'Prefix "'.concat(i,'" is invalid.'),{cause:o}),Object.defineProperty(y(n),"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidPrefixError"}),n}return x(r)}(ot.G),Jt=function(e){h(r,e);var t=v(r);function r(){var e;return k(this,r),e=t.call(this,"Prefix must be 2 or 3 for compressed public keys."),Object.defineProperty(y(e),"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidCompressedPrefixError"}),e}return x(r)}(ot.G),Yt=function(e){h(r,e);var t=v(r);function r(){var e;return k(this,r),e=t.call(this,"Prefix must be 4 for uncompressed public keys."),Object.defineProperty(y(e),"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidUncompressedPrefixError"}),e}return x(r)}(ot.G),Qt=function(e){h(r,e);var t=v(r);function r(e){var n,i=e.publicKey;return k(this,r),n=t.call(this,"Value `".concat(i,"` is an invalid public key size."),{metaMessages:["Expected: 33 bytes (compressed + prefix), 64 bytes (uncompressed) or 65 bytes (uncompressed + prefix).","Received ".concat(at.dp(at.Dp(i))," bytes.")]}),Object.defineProperty(y(n),"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidSerializedSizeError"}),n}return x(r)}(ot.G),Xt=/^0x[a-fA-F0-9]{40}$/;function $t(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.strict,n=void 0===r||r;if(!Xt.test(e))throw new tr({address:e,cause:new rr});if(n){if(e.toLowerCase()===e)return;if(er(e)!==e)throw new tr({address:e,cause:new nr})}}function er(e){if(yt.has(e))return yt.get(e);$t(e,{strict:!1});for(var t=e.substring(2).toLowerCase(),r=Kt(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.size,n=ft.encode(e);return"number"==typeof r?(function(e,t){if(pt(e)>t)throw new dt({givenSize:pt(e),maxSize:t})}(n,r),function(e,t){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.dir,n=t.size,i=void 0===n?32:n;if(0===i)return e;if(e.length>i)throw new vt({size:e.length,targetSize:i,type:"Bytes"});for(var o=new Uint8Array(i),a=0;a<i;a++){var s="right"===r;o[s?a:i-a-1]=e[s?a:e.length-a-1]}return o}(e,{dir:"right",size:t})}(n,r)):n}(t),{as:"Bytes"}),n=t.split(""),i=0;i<40;i+=2)r[i>>1]>>4>=8&&n[i]&&(n[i]=n[i].toUpperCase()),(15&r[i>>1])>=8&&n[i+1]&&(n[i+1]=n[i+1].toUpperCase());var o="0x".concat(n.join(""));return yt.set(e,o),o}var tr=function(e){h(r,e);var t=v(r);function r(e){var n,i=e.address,o=e.cause;return k(this,r),n=t.call(this,'Address "'.concat(i,'" is invalid.'),{cause:o}),Object.defineProperty(y(n),"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"}),n}return x(r)}(ot.G),rr=function(e){h(r,e);var t=v(r);function r(){var e;return k(this,r),e=t.call(this,"Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(y(e),"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"}),e}return x(r)}(ot.G),nr=function(e){h(r,e);var t=v(r);function r(){var e;return k(this,r),e=t.call(this,"Address does not match its checksum counterpart."),Object.defineProperty(y(e),"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"}),e}return x(r)}(ot.G);function ir(e){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).checksum,r=void 0!==t&&t;return $t(e),r?er(e):e}("0x".concat(Kt("0x".concat(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Vt(e);var r=e.prefix,n=e.x,i=e.y,o=t.includePrefix,a=void 0===o||o;return at.zo(a?at.xS(r,{size:1}):"0x",at.xS(n,{size:32}),"bigint"==typeof i?at.xS(i,{size:32}):"0x")}(e).slice(4))).substring(26)),t)}(function(e){var t=e.payload,r=e.signature,n=r.r,i=r.s,o=r.yParity;return function(e){var t=function(){if(at.Gu(e))return Ht(e);if(function(e){try{return function(e){if(!(e instanceof Uint8Array)){if(!e)throw new ht(e);if("object"!=typeof e)throw new ht(e);if(!("BYTES_PER_ELEMENT"in e))throw new ht(e);if(1!==e.BYTES_PER_ELEMENT||"Uint8Array"!==e.constructor.name)throw new ht(e)}}(e),!0}catch(t){return!1}}(e))return function(e){return Ht(at.xv(e))}(e);var t=e.prefix,r=e.x,n=e.y;return"bigint"==typeof r&&"bigint"==typeof n?{prefix:null!=t?t:4,x:r,y:n}:{prefix:t,x:r}}();return Vt(t),t}(new it.Signature(BigInt(n),BigInt(i)).addRecoveryBit(o).recoverPublicKey(at.Dp(t).substring(2)))}(e))}},13324:function(e,t,r){"use strict";r.d(t,{H_:function(){return o}});var n=r(47737),i=r(89062);function o(e){if(130!==e.length&&132!==e.length)throw new a({signature:e});var t=BigInt(i.tP(e,0,32)),r=BigInt(i.tP(e,32,64)),n=function(){var t=Number("0x".concat(e.slice(130)));if(!Number.isNaN(t))try{return function(e){if(0===e||27===e)return 0;if(1===e||28===e)return 1;if(e>=35)return e%2==0?1:0;throw new c({value:e})}(t)}catch(r){throw new s({value:t})}}();return void 0===n?{r:t,s:r}:{r:t,s:r,yParity:n}}var a=function(e){h(r,e);var t=v(r);function r(e){var n,o=e.signature;return k(this,r),n=t.call(this,"Value `".concat(o,"` is an invalid signature size."),{metaMessages:["Expected: 64 bytes or 65 bytes.","Received ".concat(i.dp(i.Dp(o))," bytes.")]}),Object.defineProperty(y(n),"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSerializedSizeError"}),n}return x(r)}(n.G),s=function(e){h(r,e);var t=v(r);function r(e){var n,i=e.value;return k(this,r),n=t.call(this,"Value `".concat(i,"` is an invalid y-parity value. Y-parity must be 0 or 1.")),Object.defineProperty(y(n),"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidYParityError"}),n}return x(r)}(n.G),c=function(e){h(r,e);var t=v(r);function r(e){var n,i=e.value;return k(this,r),n=t.call(this,"Value `".concat(i,"` is an invalid v value. v must be 27, 28 or >=35.")),Object.defineProperty(y(n),"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidVError"}),n}return x(r)}(n.G)},85900:function(e,t,r){"use strict";r.d(t,{Yf:function(){return i},EM:function(){return o},Ro:function(){return a},vk:function(){return s}});var n=r(89062);function i(e,t){if(n.dp(e)>t)throw new n.M6({givenSize:n.dp(e),maxSize:t})}function o(e,t){if("number"==typeof t&&t>0&&t>n.dp(e)-1)throw new n.mV({offset:t,position:"start",size:n.dp(e)})}function a(e,t,r){if("number"==typeof t&&"number"==typeof r&&n.dp(e)!==r-t)throw new n.mV({offset:r,position:"end",size:n.dp(e)})}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.dir,i=t.size,o=void 0===i?32:i;if(0===o)return e;var a=e.replace("0x","");if(a.length>2*o)throw new n.$s({size:Math.ceil(a.length/2),targetSize:o,type:"Hex"});return"0x".concat(a["right"===r?"padEnd":"padStart"](2*o,"0"))}},51462:function(e,t,r){"use strict";r.d(t,{zo:function(){return S},mL:function(){return He},BB:function(){return We}});var n={};r.r(n),r.d(n,{identity:function(){return N}});var i={};r.r(i),r.d(i,{base2:function(){return j}});var o={};r.r(o),r.d(o,{base8:function(){return L}});var s={};r.r(s),r.d(s,{base10:function(){return D}});var f={};r.r(f),r.d(f,{base16:function(){return M},base16upper:function(){return q}});var l={};r.r(l),r.d(l,{base32:function(){return z},base32hex:function(){return V},base32hexpad:function(){return W},base32hexpadupper:function(){return G},base32hexupper:function(){return H},base32pad:function(){return F},base32padupper:function(){return K},base32upper:function(){return Z},base32z:function(){return J}});var h={};r.r(h),r.d(h,{base36:function(){return Y},base36upper:function(){return Q}});var d={};r.r(d),r.d(d,{base58btc:function(){return X},base58flickr:function(){return $}});var v={};r.r(v),r.d(v,{base64:function(){return ee},base64pad:function(){return te},base64url:function(){return re},base64urlpad:function(){return ne}});var g={};r.r(g),r.d(g,{base256emoji:function(){return se}});var y={};r.r(y),r.d(y,{sha256:function(){return _e},sha512:function(){return Pe}});var b={};r.r(b),r.d(b,{identity:function(){return Re}});var m={};r.r(m),r.d(m,{code:function(){return Be},decode:function(){return Ue},encode:function(){return Ce},name:function(){return Te}});var w={};function E(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function I(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?E(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function S(e,t){t||(t=e.reduce(function(e,t){return e+t.length},0));var r,n=I(t),i=0,o=u(e);try{for(o.s();!(r=o.n()).done;){var a=r.value;n.set(a,i),i+=a.length}}catch(s){o.e(s)}finally{o.f()}return E(n)}r.r(w),r.d(w,{code:function(){return De},decode:function(){return qe},encode:function(){return Me},name:function(){return Le}}),new Uint8Array(0);var O=function(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},_=function(){function e(t,r,n){k(this,e),this.name=t,this.prefix=r,this.baseEncode=n}return x(e,[{key:"encode",value:function(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}]),e}(),P=function(){function e(t,r,n){if(k(this,e),this.name=t,this.prefix=r,void 0===r.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}return x(e,[{key:"decode",value:function(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}},{key:"or",value:function(e){return R(this,e)}}]),e}(),A=function(){function e(t){k(this,e),this.decoders=t}return x(e,[{key:"or",value:function(e){return R(this,e)}},{key:"decode",value:function(e){var t=this.decoders[e[0]];if(t)return t.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}]),e}(),R=function(e,t){return new A(a(a({},e.decoders||c({},e.prefix,e)),t.decoders||c({},t.prefix,t)))},T=function(){function e(t,r,n,i){k(this,e),this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new _(t,r,n),this.decoder=new P(t,r,i)}return x(e,[{key:"encode",value:function(e){return this.encoder.encode(e)}},{key:"decode",value:function(e){return this.decoder.decode(e)}}]),e}(),B=function(e){var t=e.name,r=e.prefix,n=e.encode,i=e.decode;return new T(t,r,n,i)},C=function(e){var t=e.prefix,r=e.name,n=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),a=o.charCodeAt(0);if(255!==r[a])throw new TypeError(o+" is ambiguous");r[a]=i}var s=e.length,c=e.charAt(0),u=Math.log(s)/Math.log(256),f=Math.log(256)/Math.log(s);function l(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var o=(e.length-t)*u+1>>>0,a=new Uint8Array(o);e[t];){var f=r[e.charCodeAt(t)];if(255===f)return;for(var l=0,p=o-1;(0!==f||l<i)&&-1!==p;p--,l++)a[p]=(f+=s*a[p]>>>0)%256>>>0,f=f/256>>>0;if(0!==f)throw new Error("Non-zero carry");i=l,t++}if(" "!==e[t]){for(var h=o-i;h!==o&&0===a[h];)h++;for(var d=new Uint8Array(n+(o-h)),v=n;h!==o;)d[v++]=a[h++];return d}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var a=(o-i)*f+1>>>0,u=new Uint8Array(a);i!==o;){for(var l=t[i],p=0,h=a-1;(0!==l||p<n)&&-1!==h;h--,p++)u[h]=(l+=256*u[h]>>>0)%s>>>0,l=l/s>>>0;if(0!==l)throw new Error("Non-zero carry");n=p,i++}for(var d=a-n;d!==a&&0===u[d];)d++;for(var v=c.repeat(r);d<a;++d)v+=e.charAt(u[d]);return v},decodeUnsafe:l,decode:function(e){var r=l(e);if(r)return r;throw new Error("Non-".concat(t," character"))}}}(e.alphabet,r),i=n.encode,o=n.decode;return B({prefix:t,name:r,encode:i,decode:function(e){return O(o(e))}})},U=function(e){var t=e.name,r=e.prefix,n=e.bitsPerChar,i=e.alphabet;return B({prefix:r,name:t,encode:function(e){return function(e,t,r){for(var n="="===t[t.length-1],i=(1<<r)-1,o="",a=0,s=0,c=0;c<e.length;++c)for(s=s<<8|e[c],a+=8;a>r;)o+=t[i&s>>(a-=r)];if(a&&(o+=t[i&s<<r-a]),n)for(;o.length*r&7;)o+="=";return o}(e,i,n)},decode:function(e){return function(e,t,r,n){for(var i={},o=0;o<t.length;++o)i[t[o]]=o;for(var a=e.length;"="===e[a-1];)--a;for(var s=new Uint8Array(a*r/8|0),c=0,u=0,f=0,l=0;l<a;++l){var p=i[e[l]];if(void 0===p)throw new SyntaxError("Non-".concat(n," character"));u=u<<r|p,(c+=r)>=8&&(c-=8,s[f++]=255&u>>c)}if(c>=r||255&u<<8-c)throw new SyntaxError("Unexpected end of data");return s}(e,i,n,t)}})},N=B({prefix:"\0",name:"identity",encode:function(e){return function(e){return(new TextDecoder).decode(e)}(e)},decode:function(e){return function(e){return(new TextEncoder).encode(e)}(e)}}),j=U({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),L=U({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),D=C({prefix:"9",name:"base10",alphabet:"0123456789"}),M=U({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),q=U({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),z=U({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Z=U({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),F=U({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),K=U({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),V=U({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),H=U({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),W=U({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),G=U({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),J=U({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Y=C({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Q=C({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),X=C({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),$=C({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),ee=U({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),te=U({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),re=U({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ne=U({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),ie=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),oe=ie.reduce(function(e,t,r){return e[r]=t,e},[]),ae=ie.reduce(function(e,t,r){return e[t.codePointAt(0)]=r,e},[]),se=B({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(function(e,t){return e+oe[t]},"")},decode:function(e){var t,r=[],n=u(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,o=ae[i.codePointAt(0)];if(void 0===o)throw new Error("Non-base256emoji character: ".concat(i));r.push(o)}}catch(a){n.e(a)}finally{n.f()}return new Uint8Array(r)}}),ce=r(8239),ue=Math.pow(2,31),fe=Math.pow(2,7),le=Math.pow(2,14),pe=Math.pow(2,21),he=Math.pow(2,28),de=Math.pow(2,35),ve=Math.pow(2,42),ge=Math.pow(2,49),ye=Math.pow(2,56),be=Math.pow(2,63),me=function e(t,r,n){r=r||[];for(var i=n=n||0;t>=ue;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},we=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return me(e,t,r),t},xe=function(e){return function(e){return e<fe?1:e<le?2:e<pe?3:e<he?4:e<de?5:e<ve?6:e<ge?7:e<ye?8:e<be?9:10}(e)},ke=function(e,t){var r=t.byteLength,n=xe(e),i=n+xe(r),o=new Uint8Array(i+r);return we(e,o,0),we(r,o,n),o.set(t,i),new Ee(e,r,t,o)},Ee=x(function e(t,r,n,i){k(this,e),this.code=t,this.size=r,this.digest=n,this.bytes=i}),Ie=function(e){var t=e.name,r=e.code,n=e.encode;return new Se(t,r,n)},Se=function(){function e(t,r,n){k(this,e),this.name=t,this.code=r,this.encode=n}return x(e,[{key:"digest",value:function(e){var t=this;if(e instanceof Uint8Array){var r=this.encode(e);return r instanceof Uint8Array?ke(this.code,r):r.then(function(e){return ke(t.code,e)})}throw Error("Unknown type, must be binary type")}}]),e}(),Oe=function(e){return t=(0,ce.Z)(p().mark(function t(r){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Uint8Array,t.next=3,crypto.subtle.digest(e,r);case 3:return t.t1=t.sent,t.abrupt("return",new t.t0(t.t1));case 5:case"end":return t.stop()}},t)})),function(e){return t.apply(this,arguments)};var t},_e=Ie({name:"sha2-256",code:18,encode:Oe("SHA-256")}),Pe=Ie({name:"sha2-512",code:19,encode:Oe("SHA-512")}),Ae=O,Re={code:0,name:"identity",encode:Ae,digest:function(e){return ke(0,Ae(e))}},Te="raw",Be=85,Ce=function(e){return O(e)},Ue=function(e){return O(e)},Ne=new TextEncoder,je=new TextDecoder,Le="json",De=512,Me=function(e){return Ne.encode(JSON.stringify(e))},qe=function(e){return JSON.parse(je.decode(e))};Symbol,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");var ze=a(a(a(a(a(a(a(a(a(a({},n),i),o),s),f),l),h),d),v),g);function Ze(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var Fe=Ze("utf8","u",function(e){return"u"+new TextDecoder("utf8").decode(e)},function(e){return(new TextEncoder).encode(e.substring(1))}),Ke=Ze("ascii","a",function(e){for(var t="a",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},function(e){for(var t=I((e=e.substring(1)).length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),Ve=a({utf8:Fe,"utf-8":Fe,hex:ze.base16,latin1:Ke,ascii:Ke,binary:Ke},ze);function He(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",r=Ve[t];if(!r)throw new Error('Unsupported encoding "'.concat(t,'"'));return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode("".concat(r.prefix).concat(e)):E(globalThis.Buffer.from(e,"utf-8"))}function We(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",r=Ve[t];if(!r)throw new Error('Unsupported encoding "'.concat(t,'"'));return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}},64697:function(e,t,r){"use strict";function n(e){this.wrapped=e}r.d(t,{Z:function(){return n}})},19663:function(e,t,r){"use strict";function n(e,t){var r={},n=!1;function i(r,i){return n=!0,i=new Promise(function(t){t(e[r](i))}),{done:!1,value:t(i)}}return r["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},r.next=function(e){return n?(n=!1,e):i("next",e)},"function"==typeof e.throw&&(r.throw=function(e){if(n)throw n=!1,e;return i("throw",e)}),"function"==typeof e.return&&(r.return=function(e){return n?(n=!1,e):i("return",e)}),r}r.d(t,{Z:function(){return n}})},48415:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(64697);function i(e){return new n.Z(e)}},5640:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(64697);function i(e){var t,r;function i(t,r){try{var a=e[t](r),s=a.value,c=s instanceof n.Z;Promise.resolve(c?s.wrapped:s).then(function(e){c?i("return"===t?"return":"next",e):o(a.done?"return":"normal",e)},function(e){i("throw",e)})}catch(u){o("throw",u)}}function o(e,n){switch(e){case"return":t.resolve({value:n,done:!0});break;case"throw":t.reject(n);break;default:t.resolve({value:n,done:!1})}(t=t.next)?i(t.key,t.arg):r=null}this._invoke=function(e,n){return new Promise(function(o,a){var s={key:e,arg:n,resolve:o,reject:a,next:null};r?r=r.next=s:(t=r=s,i(e,n))})},"function"!=typeof e.return&&(this.return=void 0)}function o(e){return function(){return new i(e.apply(this,arguments))}}i.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},i.prototype.next=function(e){return this._invoke("next",e)},i.prototype.throw=function(e){return this._invoke("throw",e)},i.prototype.return=function(e){return this._invoke("return",e)}}}])}();