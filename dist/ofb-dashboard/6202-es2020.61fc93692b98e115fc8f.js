var tw=Object.defineProperty,nw=(e,t,r)=>t in e?tw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ln=(e,t,r)=>(nw(e,"symbol"!=typeof t?t+"":t,r),r);(self.webpackChunkofb_dashboard=self.webpackChunkofb_dashboard||[]).push([[6202],{5158:function(e,t){"use strict";function r(){return(null==global?void 0:global.crypto)||(null==global?void 0:global.msCrypto)||{}}function n(){const e=r();return e.subtle||e.webkitSubtle}Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowserCryptoAvailable=t.getSubtleCrypto=t.getBrowerCrypto=void 0,t.getBrowerCrypto=r,t.getSubtleCrypto=n,t.isBrowserCryptoAvailable=function(){return!!r()&&!!n()}},69537:function(e,t){"use strict";function r(){return"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product}function n(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node}Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowser=t.isNode=t.isReactNative=void 0,t.isReactNative=r,t.isNode=n,t.isBrowser=function(){return!r()&&!n()}},38572:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(33172);n.__exportStar(r(5158),t),n.__exportStar(r(69537),t)},52399:function(e,t,r){"use strict";r.d(t,{q:function(){return n}});class n{}},59093:function(e,t,r){"use strict";r.d(t,{Lx:function(){return l},C$:function(){return u}});var n=r(8239),i=r(93105),s=r(14611),o=r(52399);class a extends o.q{constructor(e){super()}}const c=s.FIVE_SECONDS,l={pulse:"heartbeat_pulse"};class u extends a{constructor(e){super(e),this.events=new i.EventEmitter,this.interval=c,this.interval=e?.interval||c}static init(e){return(0,n.Z)(function*(){const t=new u(e);return yield t.init(),t})()}init(){var e=this;return(0,n.Z)(function*(){yield e.initialize()})()}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}initialize(){var e=this;return(0,n.Z)(function*(){e.intervalRef=setInterval(()=>e.pulse(),(0,s.toMiliseconds)(e.interval))})()}pulse(){this.events.emit(l.pulse)}}},39330:function(e,t,r){"use strict";r.d(t,{k:function(){return w},Z:function(){return w}});var n=r(8239),i=r(93105),s=r(75630),o=r.n(s),a=r(80328),c=r(22339),l=Object.defineProperty,u=Object.defineProperties,f=Object.getOwnPropertyDescriptors,h=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable,g=(e,t,r)=>t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,y=(e,t)=>{for(var r in t||(t={}))d.call(t,r)&&g(e,r,t[r]);if(h)for(var r of h(t))p.call(t,r)&&g(e,r,t[r]);return e},m=(e,t)=>u(e,f(t));const b={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};class w{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new i.EventEmitter,this.isAvailable=!1,this.registering=!1,!(0,c.isHttpUrl)(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}open(e=this.url){var t=this;return(0,n.Z)(function*(){yield t.register(e)})()}close(){var e=this;return(0,n.Z)(function*(){if(!e.isAvailable)throw new Error("Connection already closed");e.onClose()})()}send(e){var t=this;return(0,n.Z)(function*(){t.isAvailable||(yield t.register());try{const r=(0,a.u)(e),n=yield(yield o()(t.url,m(y({},b),{body:r}))).json();t.onPayload({data:n})}catch(r){t.onError(e.id,r)}})()}register(e=this.url){var t=this;return(0,n.Z)(function*(){if(!(0,c.isHttpUrl)(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(t.registering){const e=t.events.getMaxListeners();return(t.events.listenerCount("register_error")>=e||t.events.listenerCount("open")>=e)&&t.events.setMaxListeners(e+1),new Promise((e,r)=>{t.events.once("register_error",e=>{t.resetMaxListeners(),r(e)}),t.events.once("open",()=>{if(t.resetMaxListeners(),typeof t.isAvailable>"u")return r(new Error("HTTP connection is missing or invalid"));e()})})}t.url=e,t.registering=!0;try{if(!t.disableProviderPing){const t=(0,a.u)({id:1,jsonrpc:"2.0",method:"test",params:[]});yield o()(e,m(y({},b),{body:t}))}t.onOpen()}catch(r){const e=t.parseError(r);throw t.events.emit("register_error",e),t.onClose(),e}})()}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t="string"==typeof e.data?(0,a.D)(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const r=this.parseError(t),n=r.message||r.toString(),i=(0,c.formatJsonRpcError)(e,n);this.events.emit("payload",i)}parseError(e,t=this.url){return(0,c.CX)(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}}},2517:function(e,t,r){"use strict";r.d(t,{r:function(){return o}});var n=r(8239),i=r(93105),s=r(22339);class o extends s.IJsonRpcProvider{constructor(e){super(e),this.events=new i.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}connect(e=this.connection){var t=this;return(0,n.Z)(function*(){yield t.open(e)})()}disconnect(){var e=this;return(0,n.Z)(function*(){yield e.close()})()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}request(e,t){var r=this;return(0,n.Z)(function*(){return r.requestStrict((0,s.formatJsonRpcRequest)(e.method,e.params||[],e.id||(0,s.getBigIntRpcId)().toString()),t)})()}requestStrict(e,t){var r=this;return(0,n.Z)(function*(){return new Promise(function(){var i=(0,n.Z)(function*(n,i){if(!r.connection.connected)try{yield r.open()}catch(o){i(o)}r.events.on(`${e.id}`,e=>{(0,s.isJsonRpcError)(e)?i(e.error):n(e.result)});try{yield r.connection.send(e,t)}catch(o){i(o)}});return function(e,t){return i.apply(this,arguments)}}())})()}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),(0,s.isJsonRpcResponse)(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&3e3===e.code&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}open(e=this.connection){var t=this;return(0,n.Z)(function*(){t.connection===e&&t.connection.connected||(t.connection.connected&&t.close(),"string"==typeof e&&(yield t.connection.open(e),e=t.connection),t.connection=t.setConnection(e),yield t.connection.open(),t.registerEventListeners(),t.events.emit("connect"))})()}close(){var e=this;return(0,n.Z)(function*(){yield e.connection.close()})()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}},52885:function(e,t,r){"use strict";r.d(t,{O4:function(){return n},CA:function(){return i},dQ:function(){return s},xK:function(){return o},JV:function(){return a}});const n="INTERNAL_ERROR",i="SERVER_ERROR",s=[-32700,-32600,-32601,-32602,-32603],o={PARSE_ERROR:{code:-32700,message:"Parse error"},INVALID_REQUEST:{code:-32600,message:"Invalid Request"},METHOD_NOT_FOUND:{code:-32601,message:"Method not found"},INVALID_PARAMS:{code:-32602,message:"Invalid params"},[n]:{code:-32603,message:"Internal error"},[i]:{code:-32e3,message:"Server error"}},a=i},84275:function(e,t,r){"use strict";var n=r(38572);r.o(n,"IJsonRpcProvider")&&r.d(t,{IJsonRpcProvider:function(){return n.IJsonRpcProvider}}),r.o(n,"formatJsonRpcError")&&r.d(t,{formatJsonRpcError:function(){return n.formatJsonRpcError}}),r.o(n,"formatJsonRpcRequest")&&r.d(t,{formatJsonRpcRequest:function(){return n.formatJsonRpcRequest}}),r.o(n,"formatJsonRpcResult")&&r.d(t,{formatJsonRpcResult:function(){return n.formatJsonRpcResult}}),r.o(n,"getBigIntRpcId")&&r.d(t,{getBigIntRpcId:function(){return n.getBigIntRpcId}}),r.o(n,"isHttpUrl")&&r.d(t,{isHttpUrl:function(){return n.isHttpUrl}}),r.o(n,"isJsonRpcError")&&r.d(t,{isJsonRpcError:function(){return n.isJsonRpcError}}),r.o(n,"isJsonRpcRequest")&&r.d(t,{isJsonRpcRequest:function(){return n.isJsonRpcRequest}}),r.o(n,"isJsonRpcResponse")&&r.d(t,{isJsonRpcResponse:function(){return n.isJsonRpcResponse}}),r.o(n,"isJsonRpcResult")&&r.d(t,{isJsonRpcResult:function(){return n.isJsonRpcResult}}),r.o(n,"isLocalhostUrl")&&r.d(t,{isLocalhostUrl:function(){return n.isLocalhostUrl}}),r.o(n,"isReactNative")&&r.d(t,{isReactNative:function(){return n.isReactNative}}),r.o(n,"isWsUrl")&&r.d(t,{isWsUrl:function(){return n.isWsUrl}}),r.o(n,"payloadId")&&r.d(t,{payloadId:function(){return n.payloadId}})},93938:function(e,t,r){"use strict";r.d(t,{i5:function(){return i},by:function(){return s},L2:function(){return o},CX:function(){return a}});var n=r(52885);function i(e){return n.dQ.includes(e)}function s(e){return Object.keys(n.xK).includes(e)?n.xK[e]:n.xK[n.JV]}function o(e){return Object.values(n.xK).find(t=>t.code===e)||n.xK[n.JV]}function a(e,t,r){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):e}},90863:function(e,t,r){"use strict";r.d(t,{o0:function(){return s},CS:function(){return o},sT:function(){return a},tm:function(){return c},RI:function(){return l}});var n=r(93938),i=r(52885);function s(e=3){return Date.now()*Math.pow(10,e)+Math.floor(Math.random()*Math.pow(10,e))}function o(e=6){return BigInt(s(e))}function a(e,t,r){return{id:r||s(),jsonrpc:"2.0",method:e,params:t}}function c(e,t){return{id:e,jsonrpc:"2.0",result:t}}function l(e,t,r){return{id:e,jsonrpc:"2.0",error:u(t,r)}}function u(e,t){return void 0===e?(0,n.by)(i.O4):("string"==typeof e&&(e=Object.assign(Object.assign({},(0,n.by)(i.CA)),{message:e})),void 0!==t&&(e.data=t),(0,n.i5)(e.code)&&(e=(0,n.L2)(e.code)),e)}},22339:function(e,t,r){"use strict";r.d(t,{CX:function(){return n.CX},formatJsonRpcError:function(){return s.RI},formatJsonRpcRequest:function(){return s.sT},formatJsonRpcResult:function(){return s.tm},getBigIntRpcId:function(){return s.CS},payloadId:function(){return s.o0},IJsonRpcProvider:function(){return o.x0},isHttpUrl:function(){return a.jK},isLocalhostUrl:function(){return a.JF},isWsUrl:function(){return a.UZ},isJsonRpcError:function(){return c.jg},isJsonRpcRequest:function(){return c.DW},isJsonRpcResponse:function(){return c.u},isJsonRpcResult:function(){return c.k4}}),r(52885);var n=r(93938),i=r(84275);r.o(i,"IJsonRpcProvider")&&r.d(t,{IJsonRpcProvider:function(){return i.IJsonRpcProvider}}),r.o(i,"formatJsonRpcError")&&r.d(t,{formatJsonRpcError:function(){return i.formatJsonRpcError}}),r.o(i,"formatJsonRpcRequest")&&r.d(t,{formatJsonRpcRequest:function(){return i.formatJsonRpcRequest}}),r.o(i,"formatJsonRpcResult")&&r.d(t,{formatJsonRpcResult:function(){return i.formatJsonRpcResult}}),r.o(i,"getBigIntRpcId")&&r.d(t,{getBigIntRpcId:function(){return i.getBigIntRpcId}}),r.o(i,"isHttpUrl")&&r.d(t,{isHttpUrl:function(){return i.isHttpUrl}}),r.o(i,"isJsonRpcError")&&r.d(t,{isJsonRpcError:function(){return i.isJsonRpcError}}),r.o(i,"isJsonRpcRequest")&&r.d(t,{isJsonRpcRequest:function(){return i.isJsonRpcRequest}}),r.o(i,"isJsonRpcResponse")&&r.d(t,{isJsonRpcResponse:function(){return i.isJsonRpcResponse}}),r.o(i,"isJsonRpcResult")&&r.d(t,{isJsonRpcResult:function(){return i.isJsonRpcResult}}),r.o(i,"isLocalhostUrl")&&r.d(t,{isLocalhostUrl:function(){return i.isLocalhostUrl}}),r.o(i,"isReactNative")&&r.d(t,{isReactNative:function(){return i.isReactNative}}),r.o(i,"isWsUrl")&&r.d(t,{isWsUrl:function(){return i.isWsUrl}}),r.o(i,"payloadId")&&r.d(t,{payloadId:function(){return i.payloadId}});var s=r(90863),o=r(12484),a=r(96796),c=r(9087)},12484:function(e,t,r){"use strict";r.d(t,{x0:function(){return n}});class n extends class extends class{}{constructor(){super()}}{constructor(e){super()}}},96796:function(e,t,r){"use strict";function n(e,t){const r=function(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(t&&t.length)return t[0]}(e);return void 0!==r&&new RegExp(t).test(r)}function i(e){return n(e,"^https?:")}function s(e){return n(e,"^wss?:")}function o(e){return new RegExp("wss?://localhost(:d{2,5})?").test(e)}r.d(t,{jK:function(){return i},UZ:function(){return s},JF:function(){return o}})},9087:function(e,t,r){"use strict";function n(e){return"object"==typeof e&&"id"in e&&"jsonrpc"in e&&"2.0"===e.jsonrpc}function i(e){return n(e)&&"method"in e}function s(e){return n(e)&&(o(e)||a(e))}function o(e){return"result"in e}function a(e){return"error"in e}r.d(t,{DW:function(){return i},u:function(){return s},k4:function(){return o},jg:function(){return a}})},70213:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var n=r(8239),i=r(93105),s=r(80328),o=r(22339);const a=e=>e.split("?")[0],c=typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:r(98164);class l{constructor(e){if(this.url=e,this.events=new i.EventEmitter,this.registering=!1,!(0,o.isWsUrl)(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}open(e=this.url){var t=this;return(0,n.Z)(function*(){yield t.register(e)})()}close(){var e=this;return(0,n.Z)(function*(){return new Promise((t,r)=>{typeof e.socket>"u"?r(new Error("Connection already closed")):(e.socket.onclose=r=>{e.onClose(r),t()},e.socket.close())})})()}send(e){var t=this;return(0,n.Z)(function*(){typeof t.socket>"u"&&(t.socket=yield t.register());try{t.socket.send((0,s.u)(e))}catch(r){t.onError(e.id,r)}})()}register(e=this.url){if(!(0,o.isWsUrl)(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise((e,t)=>{this.events.once("register_error",e=>{this.resetMaxListeners(),t(e)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return t(new Error("WebSocket connection is missing or invalid"));e(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,r)=>{const n=(0,o.isReactNative)()?void 0:{rejectUnauthorized:!(0,o.isLocalhostUrl)(e)},i=new c(e,[],n);typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u"?i.onerror=e=>{r(this.emitError(e.error))}:i.on("error",e=>{r(this.emitError(e))}),i.onopen=()=>{this.onOpen(i),t(i)}})}onOpen(e){e.onmessage=e=>this.onPayload(e),e.onclose=e=>this.onClose(e),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t="string"==typeof e.data?(0,s.D)(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const r=this.parseError(t),n=r.message||r.toString(),i=(0,o.formatJsonRpcError)(e,n);this.events.emit("payload",i)}parseError(e,t=this.url){return(0,o.CX)(e,a(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}emitError(e){const t=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${a(this.url)}`));return this.events.emit("register_error",t),t}}},98164:function(e){"use strict";e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},39927:function(e,t,r){"use strict";r.d(t,{Z:function(){return U}});var n=r(8239);const i=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,s=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,o=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function a(e,t){if(!("__proto__"===e||"constructor"===e&&t&&"object"==typeof t&&"prototype"in t))return t;!function(e){console.warn(`[destr] Dropping "${e}" key to prevent prototype pollution.`)}(e)}function c(e,t={}){if("string"!=typeof e)return e;if('"'===e[0]&&'"'===e[e.length-1]&&-1===e.indexOf("\\"))return e.slice(1,-1);const r=e.trim();if(r.length<=9)switch(r.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!o.test(e)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return e}try{if(i.test(e)||s.test(e)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(e,a)}return JSON.parse(e)}catch(n){if(t.strict)throw n;return e}}function l(e,...t){try{return function(e){return e&&"function"==typeof e.then?e:Promise.resolve(e)}(e(...t))}catch(r){return Promise.reject(r)}}function u(e){if(function(e){const t=typeof e;return null===e||"object"!==t&&"function"!==t}(e))return String(e);if(function(e){const t=Object.getPrototypeOf(e);return!t||t.isPrototypeOf(Object)}(e)||Array.isArray(e))return JSON.stringify(e);if("function"==typeof e.toJSON)return u(e.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const f="base64:";function h(e){return e&&e.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function d(...e){return h(e.join(":"))}function p(e){return(e=h(e))?e+":":""}const g=()=>{const e=new Map;return{name:"memory",getInstance:()=>e,hasItem:t=>e.has(t),getItem:t=>e.get(t)??null,getItemRaw:t=>e.get(t)??null,setItem(t,r){e.set(t,r)},setItemRaw(t,r){e.set(t,r)},removeItem(t){e.delete(t)},getKeys:()=>[...e.keys()],clear(){e.clear()},dispose(){e.clear()}}};function y(e,t,r){return e.watch?e.watch((e,n)=>t(e,r+n)):()=>{}}function m(e){return b.apply(this,arguments)}function b(){return(b=(0,n.Z)(function*(e){"function"==typeof e.dispose&&(yield l(e.dispose))})).apply(this,arguments)}function w(e){return new Promise((t,r)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>r(e.error)})}function v(e,t){const r=indexedDB.open(e);r.onupgradeneeded=()=>r.result.createObjectStore(t);const n=w(r);return(e,r)=>n.then(n=>r(n.transaction(t,e).objectStore(t)))}let E;function x(){return E||(E=v("keyval-store","keyval")),E}function I(e,t=x()){return t("readonly",t=>w(t.get(e)))}var S=r(80328),O=(e={})=>{const t=e.base&&e.base.length>0?`${e.base}:`:"",r=e=>t+e;let i;return e.dbName&&e.storeName&&(i=v(e.dbName,e.storeName)),{name:"idb-keyval",options:e,hasItem:e=>(0,n.Z)(function*(){return!(typeof(yield I(r(e),i))>"u")})(),getItem:e=>(0,n.Z)(function*(){return(yield I(r(e),i))??null})(),setItem:(e,t)=>function(e,t,r=x()){return r("readwrite",r=>(r.put(t,e),w(r.transaction)))}(r(e),t,i),removeItem:e=>function(e,t=x()){return t("readwrite",t=>(t.delete(e),w(t.transaction)))}(r(e),i),getKeys:()=>function(e=x()){return e("readonly",e=>{if(e.getAllKeys)return w(e.getAllKeys());const t=[];return function(e,t){return e.openCursor().onsuccess=function(){!this.result||(t(this.result),this.result.continue())},w(e.transaction)}(e,e=>t.push(e.key)).then(()=>t)})}(i),clear:()=>function(e=x()){return e("readwrite",e=>(e.clear(),w(e.transaction)))}(i)}};class _{constructor(){this.indexedDb=function(e={}){const t={mounts:{"":e.driver||g()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=e=>{for(const r of t.mountpoints)if(e.startsWith(r))return{base:r,relativeKey:e.slice(r.length),driver:t.mounts[r]};return{base:"",relativeKey:e,driver:t.mounts[""]}},i=(e,r)=>t.mountpoints.filter(t=>t.startsWith(e)||r&&e.startsWith(t)).map(r=>({relativeBase:e.length>r.length?e.slice(r.length):void 0,mountpoint:r,driver:t.mounts[r]})),s=(e,r)=>{if(t.watching){r=h(r);for(const n of t.watchListeners)n(e,r)}},o=function(){var e=(0,n.Z)(function*(){if(!t.watching){t.watching=!0;for(const e in t.mounts)t.unwatch[e]=yield y(t.mounts[e],s,e)}});return function(){return e.apply(this,arguments)}}(),a=function(){var e=(0,n.Z)(function*(){if(t.watching){for(const e in t.unwatch)yield t.unwatch[e]();t.unwatch={},t.watching=!1}});return function(){return e.apply(this,arguments)}}(),b=(e,t,n)=>{const i=new Map,s=e=>{let t=i.get(e.base);return t||(t={driver:e.driver,base:e.base,items:[]},i.set(e.base,t)),t};for(const o of e){const e="string"==typeof o,n=h(e?o:o.key),i=e?void 0:o.value,a=e||!o.options?t:{...t,...o.options},c=r(n);s(c).items.push({key:n,value:i,relativeKey:c.relativeKey,options:a})}return Promise.all([...i.values()].map(e=>n(e))).then(e=>e.flat())},w={hasItem(e,t={}){e=h(e);const{relativeKey:n,driver:i}=r(e);return l(i.hasItem,n,t)},getItem(e,t={}){e=h(e);const{relativeKey:n,driver:i}=r(e);return l(i.getItem,n,t).then(e=>c(e))},getItems:(e,t={})=>b(e,t,e=>e.driver.getItems?l(e.driver.getItems,e.items.map(e=>({key:e.relativeKey,options:e.options})),t).then(t=>t.map(t=>({key:d(e.base,t.key),value:c(t.value)}))):Promise.all(e.items.map(t=>l(e.driver.getItem,t.relativeKey,t.options).then(e=>({key:t.key,value:c(e)}))))),getItemRaw(e,t={}){e=h(e);const{relativeKey:n,driver:i}=r(e);return i.getItemRaw?l(i.getItemRaw,n,t):l(i.getItem,n,t).then(e=>function(e){return"string"==typeof e&&e.startsWith(f)?function(e){return globalThis.Buffer?Buffer.from(e,"base64"):Uint8Array.from(globalThis.atob(e),e=>e.codePointAt(0))}(e.slice(f.length)):e}(e))},setItem:(e,t,i={})=>(0,n.Z)(function*(){if(void 0===t)return w.removeItem(e);e=h(e);const{relativeKey:n,driver:o}=r(e);!o.setItem||(yield l(o.setItem,n,u(t),i),o.watch||s("update",e))})(),setItems:(e,t)=>(0,n.Z)(function*(){yield b(e,t,function(){var e=(0,n.Z)(function*(e){if(e.driver.setItems)return l(e.driver.setItems,e.items.map(e=>({key:e.relativeKey,value:u(e.value),options:e.options})),t);!e.driver.setItem||(yield Promise.all(e.items.map(t=>l(e.driver.setItem,t.relativeKey,u(t.value),t.options))))});return function(t){return e.apply(this,arguments)}}())})(),setItemRaw:(e,t,i={})=>(0,n.Z)(function*(){if(void 0===t)return w.removeItem(e,i);e=h(e);const{relativeKey:n,driver:o}=r(e);if(o.setItemRaw)yield l(o.setItemRaw,n,t,i);else{if(!o.setItem)return;yield l(o.setItem,n,function(e){return"string"==typeof e?e:f+function(e){return globalThis.Buffer?Buffer.from(e).toString("base64"):globalThis.btoa(String.fromCodePoint(...e))}(e)}(t),i)}o.watch||s("update",e)})(),removeItem:(e,t={})=>(0,n.Z)(function*(){"boolean"==typeof t&&(t={removeMeta:t}),e=h(e);const{relativeKey:n,driver:i}=r(e);!i.removeItem||(yield l(i.removeItem,n,t),(t.removeMeta||t.removeMata)&&(yield l(i.removeItem,n+"$",t)),i.watch||s("remove",e))})(),getMeta:(e,t={})=>(0,n.Z)(function*(){"boolean"==typeof t&&(t={nativeOnly:t}),e=h(e);const{relativeKey:n,driver:i}=r(e),s=Object.create(null);if(i.getMeta&&Object.assign(s,yield l(i.getMeta,n,t)),!t.nativeOnly){const e=yield l(i.getItem,n+"$",t).then(e=>c(e));e&&"object"==typeof e&&("string"==typeof e.atime&&(e.atime=new Date(e.atime)),"string"==typeof e.mtime&&(e.mtime=new Date(e.mtime)),Object.assign(s,e))}return s})(),setMeta(e,t,r={}){return this.setItem(e+"$",t,r)},removeMeta(e,t={}){return this.removeItem(e+"$",t)},getKeys:(e,t={})=>(0,n.Z)(function*(){e=p(e);const r=i(e,!0);let n=[];const s=[];let o=!0;for(const e of r){e.driver.flags?.maxDepth||(o=!1);const r=yield l(e.driver.getKeys,e.relativeBase,t);for(const t of r){const r=e.mountpoint+h(t);n.some(e=>r.startsWith(e))||s.push(r)}n=[e.mountpoint,...n.filter(t=>!t.startsWith(e.mountpoint))]}const a=void 0!==t.maxDepth&&!o;return s.filter(r=>(!a||function(e,t){if(void 0===t)return!0;let r=0,n=e.indexOf(":");for(;n>-1;)r++,n=e.indexOf(":",n+1);return r<=t}(r,t.maxDepth))&&function(e,t){return t?e.startsWith(t)&&"$"!==e[e.length-1]:"$"!==e[e.length-1]}(r,e))})(),clear:(e,t={})=>(0,n.Z)(function*(){e=p(e),yield Promise.all(i(e,!1).map(function(){var e=(0,n.Z)(function*(e){if(e.driver.clear)return l(e.driver.clear,e.relativeBase,t);if(e.driver.removeItem){const r=yield e.driver.getKeys(e.relativeBase||"",t);return Promise.all(r.map(r=>e.driver.removeItem(r,t)))}});return function(t){return e.apply(this,arguments)}}()))})(),dispose:()=>(0,n.Z)(function*(){yield Promise.all(Object.values(t.mounts).map(e=>m(e)))})(),watch:e=>(0,n.Z)(function*(){return yield o(),t.watchListeners.push(e),(0,n.Z)(function*(){t.watchListeners=t.watchListeners.filter(t=>t!==e),0===t.watchListeners.length&&(yield a())})})(),unwatch:()=>(0,n.Z)(function*(){t.watchListeners=[],yield a()})(),mount(e,r){if((e=p(e))&&t.mounts[e])throw new Error(`already mounted at ${e}`);return e&&(t.mountpoints.push(e),t.mountpoints.sort((e,t)=>t.length-e.length)),t.mounts[e]=r,t.watching&&Promise.resolve(y(r,s,e)).then(r=>{t.unwatch[e]=r}).catch(console.error),w},unmount:(e,r=!0)=>(0,n.Z)(function*(){(e=p(e))&&t.mounts[e]&&(t.watching&&e in t.unwatch&&(t.unwatch[e]?.(),delete t.unwatch[e]),r&&(yield m(t.mounts[e])),t.mountpoints=t.mountpoints.filter(t=>t!==e),delete t.mounts[e])})(),getMount(e=""){e=h(e)+":";const t=r(e);return{driver:t.driver,base:t.base}},getMounts:(e="",t={})=>(e=h(e),i(e,t.parents).map(e=>({driver:e.driver,base:e.mountpoint}))),keys:(e,t={})=>w.getKeys(e,t),get:(e,t={})=>w.getItem(e,t),set:(e,t,r={})=>w.setItem(e,t,r),has:(e,t={})=>w.hasItem(e,t),del:(e,t={})=>w.removeItem(e,t),remove:(e,t={})=>w.removeItem(e,t)};return w}({driver:O({dbName:"WALLET_CONNECT_V2_INDEXED_DB",storeName:"keyvaluestorage"})})}getKeys(){var e=this;return(0,n.Z)(function*(){return e.indexedDb.getKeys()})()}getEntries(){var e=this;return(0,n.Z)(function*(){return(yield e.indexedDb.getItems(yield e.indexedDb.getKeys())).map(e=>[e.key,e.value])})()}getItem(e){var t=this;return(0,n.Z)(function*(){const r=yield t.indexedDb.getItem(e);if(null!==r)return r})()}setItem(e,t){var r=this;return(0,n.Z)(function*(){yield r.indexedDb.setItem(e,(0,S.u)(t))})()}removeItem(e){var t=this;return(0,n.Z)(function*(){yield t.indexedDb.removeItem(e)})()}}var P=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},A={exports:{}};function R(e){var t;return[e[0],(0,S.D)(null!=(t=e[1])?t:"")]}!function(){let e;function t(){}e=t,e.prototype.getItem=function(e){return this.hasOwnProperty(e)?String(this[e]):null},e.prototype.setItem=function(e,t){this[e]=String(t)},e.prototype.removeItem=function(e){delete this[e]},e.prototype.clear=function(){const e=this;Object.keys(e).forEach(function(t){e[t]=void 0,delete e[t]})},e.prototype.key=function(e){return e=e||0,Object.keys(this)[e]},e.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),A.exports=typeof P<"u"&&P.localStorage?P.localStorage:typeof window<"u"&&window.localStorage?window.localStorage:new t}();class T{constructor(){this.localStorage=A.exports}getKeys(){var e=this;return(0,n.Z)(function*(){return Object.keys(e.localStorage)})()}getEntries(){var e=this;return(0,n.Z)(function*(){return Object.entries(e.localStorage).map(R)})()}getItem(e){var t=this;return(0,n.Z)(function*(){const r=t.localStorage.getItem(e);if(null!==r)return(0,S.D)(r)})()}setItem(e,t){var r=this;return(0,n.Z)(function*(){r.localStorage.setItem(e,(0,S.u)(t))})()}removeItem(e){var t=this;return(0,n.Z)(function*(){t.localStorage.removeItem(e)})()}}const B=function(){var e=(0,n.Z)(function*(e,t,r){const n="wc_storage_version",i=yield t.getItem(n);if(i&&i>=1)return void r(t);const s=yield e.getKeys();if(!s.length)return void r(t);const o=[];for(;s.length;){const r=s.shift();if(!r)continue;const n=r.toLowerCase();if(n.includes("wc@")||n.includes("walletconnect")||n.includes("wc_")||n.includes("wallet_connect")){const n=yield e.getItem(r);yield t.setItem(r,n),o.push(r)}}yield t.setItem(n,1),r(t),C(e,o)});return function(t,r,n){return e.apply(this,arguments)}}(),C=function(){var e=(0,n.Z)(function*(e,t){t.length&&t.forEach(function(){var t=(0,n.Z)(function*(t){yield e.removeItem(t)});return function(e){return t.apply(this,arguments)}}())});return function(t,r){return e.apply(this,arguments)}}();class U{constructor(){this.initialized=!1,this.setInitialized=e=>{this.storage=e,this.initialized=!0};const e=new T;this.storage=e;try{const t=new _;B(e,t,this.setInitialized)}catch{this.initialized=!0}}getKeys(){var e=this;return(0,n.Z)(function*(){return yield e.initialize(),e.storage.getKeys()})()}getEntries(){var e=this;return(0,n.Z)(function*(){return yield e.initialize(),e.storage.getEntries()})()}getItem(e){var t=this;return(0,n.Z)(function*(){return yield t.initialize(),t.storage.getItem(e)})()}setItem(e,t){var r=this;return(0,n.Z)(function*(){return yield r.initialize(),r.storage.setItem(e,t)})()}removeItem(e){var t=this;return(0,n.Z)(function*(){return yield t.initialize(),t.storage.removeItem(e)})()}initialize(){var e=this;return(0,n.Z)(function*(){e.initialized||(yield new Promise(t=>{const r=setInterval(()=>{e.initialized&&(clearInterval(r),t())},20)}))})()}}},14616:function(e,t,r){"use strict";r.d(t,{Ep:function(){return Y},Rt:function(){return Q},jI:function(){return G},Fd:function(){return J}});var n={exports:{}};function i(e){try{return JSON.stringify(e)}catch{return'"[Circular]"'}}const s=function(e,t,r){var n=r&&r.stringify||i;if("object"==typeof e&&null!==e){var s=t.length+1;if(1===s)return e;var o=new Array(s);o[0]=n(e);for(var a=1;a<s;a++)o[a]=n(t[a]);return o.join(" ")}if("string"!=typeof e)return e;var c=t.length;if(0===c)return e;for(var l="",u=0,f=-1,h=e&&e.length||0,d=0;d<h;){if(37===e.charCodeAt(d)&&d+1<h){switch(f=f>-1?f:0,e.charCodeAt(d+1)){case 100:case 102:if(u>=c||null==t[u])break;f<d&&(l+=e.slice(f,d)),l+=Number(t[u]),f=d+2,d++;break;case 105:if(u>=c||null==t[u])break;f<d&&(l+=e.slice(f,d)),l+=Math.floor(Number(t[u])),f=d+2,d++;break;case 79:case 111:case 106:if(u>=c||void 0===t[u])break;f<d&&(l+=e.slice(f,d));var p=typeof t[u];if("string"===p){l+="'"+t[u]+"'",f=d+2,d++;break}if("function"===p){l+=t[u].name||"<anonymous>",f=d+2,d++;break}l+=n(t[u]),f=d+2,d++;break;case 115:if(u>=c)break;f<d&&(l+=e.slice(f,d)),l+=String(t[u]),f=d+2,d++;break;case 37:f<d&&(l+=e.slice(f,d)),l+="%",f=d+2,d++,u--}++u}++d}return-1===f?e:(f<h&&(l+=e.slice(f)),l)};n.exports=d;const o=function(){function e(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return e(self)||e(window)||e(this)||{}}}().console||{},a={mapHttpRequest:E,mapHttpResponse:E,wrapRequestSerializer:x,wrapResponseSerializer:x,wrapErrorSerializer:x,req:E,res:E,err:w,errWithCause:w};function c(e,t){return"silent"===e?1/0:t.levels.values[e]}const l=Symbol("pino.logFuncs"),u=Symbol("pino.hierarchy"),f={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function h(e,t){t[u]={logger:t,parent:e[u]}}function d(e){(e=e||{}).browser=e.browser||{};const t=e.browser.transmit;if(t&&"function"!=typeof t.send)throw Error("pino: transmit option must have a send function");const r=e.browser.write||o;e.browser.write&&(e.browser.asObject=!0);const n=e.serializers||{},i=function(e,t){return Array.isArray(e)?e.filter(function(e){return"!stdSerializers.err"!==e}):!0===e&&Object.keys(t)}(e.browser.serialize,n);let s=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const a=Object.keys(e.customLevels||{}),u=["error","fatal","warn","info","debug","trace"].concat(a);"function"==typeof r&&u.forEach(function(e){r[e]=r}),(!1===e.enabled||e.browser.disabled)&&(e.level="silent");const g=e.level||"info",m=Object.create(r);m.log||(m.log=I),function(e,t,r){const n={};t.forEach(e=>{n[e]=r[e]?r[e]:o[e]||o[f[e]||"log"]||I}),e[l]=n}(m,u,r),h({},m),Object.defineProperty(m,"levelVal",{get:function(){return c(this.level,this)}}),Object.defineProperty(m,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,p(this,w,m,"error"),p(this,w,m,"fatal"),p(this,w,m,"warn"),p(this,w,m,"info"),p(this,w,m,"debug"),p(this,w,m,"trace"),a.forEach(e=>{p(this,w,m,e)})}});const w={transmit:t,serialize:i,asObject:e.browser.asObject,asObjectBindingsOnly:e.browser.asObjectBindingsOnly,formatters:e.browser.formatters,levels:u,timestamp:v(e),messageKey:e.messageKey||"msg",onChild:e.onChild||I};function E(r,s,o){if(!s)throw new Error("missing bindings for child Pino");o=o||{},i&&s.serializers&&(o.serializers=s.serializers);const a=o.serializers;if(i&&a){var c=Object.assign({},n,a),l=!0===e.browser.serialize?Object.keys(c):i;delete s.serializers,y([s],l,c,this._stdErrSerialize)}function u(e){this._childLevel=1+(0|e._childLevel),this.bindings=s,c&&(this.serializers=c,this._serialize=l),t&&(this._logEvent=b([].concat(e._logEvent.bindings,s)))}u.prototype=this;const f=new u(this);return h(this,f),f.child=function(...e){return E.call(this,r,...e)},f.level=o.level||this.level,r.onChild(f),f}return m.levels=function(e){const t=e.customLevels||{},r=Object.assign({},d.levels.values,t),n=Object.assign({},d.levels.labels,function(e){const t={};return Object.keys(e).forEach(function(r){t[e[r]]=r}),t}(t));return{values:r,labels:n}}(e),m.level=g,m.isLevelEnabled=function(e){return!!this.levels.values[e]&&this.levels.values[e]>=this.levels.values[this.level]},m.setMaxListeners=m.getMaxListeners=m.emit=m.addListener=m.on=m.prependListener=m.once=m.prependOnceListener=m.removeListener=m.removeAllListeners=m.listeners=m.listenerCount=m.eventNames=m.write=m.flush=I,m.serializers=n,m._serialize=i,m._stdErrSerialize=s,m.child=function(...e){return E.call(this,w,...e)},t&&(m._logEvent=b()),m}function p(e,t,r,n){if(Object.defineProperty(e,n,{value:c(e.level,r)>c(n,r)?I:r[l][n],writable:!0,enumerable:!0,configurable:!0}),e[n]===I){if(!t.transmit)return;const i=c(t.transmit.level||e.level,r);if(c(n,r)<i)return}e[n]=function(e,t,r,n){return function(i){return function(){const s=t.timestamp(),a=new Array(arguments.length),l=Object.getPrototypeOf&&Object.getPrototypeOf(this)===o?o:this;for(var u=0;u<a.length;u++)a[u]=arguments[u];var f=!1;if(t.serialize&&(y(a,this._serialize,this.serializers,this._stdErrSerialize),f=!0),t.asObject||t.formatters?i.call(l,...g(this,n,a,s,t)):i.apply(l,a),t.transmit){const i=t.transmit.level||e._level,o=c(i,r),l=c(n,r);if(l<o)return;m(this,{ts:s,methodLevel:n,methodValue:l,transmitLevel:i,transmitValue:r.levels.values[t.transmit.level||e._level],send:t.transmit.send,val:c(e._level,r)},a,f)}}}(e[l][n])}(e,t,r,n);const i=function(e){const t=[];e.bindings&&t.push(e.bindings);let r=e[u];for(;r.parent;)r=r.parent,r.logger.bindings&&t.push(r.logger.bindings);return t.reverse()}(e);0!==i.length&&(e[n]=function(e,t){return function(){return t.apply(this,[...e,...arguments])}}(i,e[n]))}function g(e,t,r,n,i){const{level:o,log:a=(e=>e)}=i.formatters||{},c=r.slice();let l=c[0];const u={};let f=1+(0|e._childLevel);if(f<1&&(f=1),n&&(u.time=n),o){const r=o(t,e.levels.values[t]);Object.assign(u,r)}else u.level=e.levels.values[t];if(i.asObjectBindingsOnly){if(null!==l&&"object"==typeof l)for(;f--&&"object"==typeof c[0];)Object.assign(u,c.shift());return[a(u),...c]}if(null!==l&&"object"==typeof l){for(;f--&&"object"==typeof c[0];)Object.assign(u,c.shift());l=c.length?s(c.shift(),c):void 0}else"string"==typeof l&&(l=s(c.shift(),c));return void 0!==l&&(u[i.messageKey]=l),[a(u)]}function y(e,t,r,n){for(const i in e)if(n&&e[i]instanceof Error)e[i]=d.stdSerializers.err(e[i]);else if("object"==typeof e[i]&&!Array.isArray(e[i])&&t)for(const n in e[i])t.indexOf(n)>-1&&n in r&&(e[i][n]=r[n](e[i][n]))}function m(e,t,r,n=!1){const i=t.send,s=t.ts,o=t.methodLevel,a=t.methodValue,c=t.val,l=e._logEvent.bindings;n||y(r,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=s,e._logEvent.messages=r.filter(function(e){return-1===l.indexOf(e)}),e._logEvent.level.label=o,e._logEvent.level.value=a,i(o,e._logEvent,c),e._logEvent=b(l)}function b(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function w(e){const t={type:e.constructor.name,msg:e.message,stack:e.stack};for(const r in e)void 0===t[r]&&(t[r]=e[r]);return t}function v(e){return"function"==typeof e.timestamp?e.timestamp:!1===e.timestamp?S:O}function E(){return{}}function x(e){return e}function I(){}function S(){return!1}function O(){return Date.now()}d.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},d.stdSerializers=a,d.stdTimeFunctions=Object.assign({},{nullTime:S,epochTime:O,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}}),n.exports.default=d,n.exports.pino=d;const _="custom_context",P=1024e3;var A=Object.defineProperty,R=(e,t,r)=>((e,t,r)=>t in e?A(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class T{constructor(e){R(this,"nodeValue"),R(this,"sizeInBytes"),R(this,"next"),this.nodeValue=e,this.sizeInBytes=(new TextEncoder).encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class B{constructor(e){R(this,"lengthInNodes"),R(this,"sizeInBytes"),R(this,"head"),R(this,"tail"),R(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const t=new T(e);if(t.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=t),this.tail=t):(this.head=t,this.tail=t),this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let t=this.head;for(;null!==t;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const t=e.value;return e=e.next,{done:!1,value:t}}}}}function C(e){return"string"==typeof e?e:(e=>JSON.stringify(e,(e,t)=>"bigint"==typeof t?t.toString()+"n":t))(e)||""}var U=Object.defineProperty,N=(e,t,r)=>((e,t,r)=>t in e?U(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class k{constructor(e,t=P){N(this,"logs"),N(this,"level"),N(this,"levelValue"),N(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=e??"error",this.levelValue=n.exports.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new B(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===n.exports.levels.values.error?console.error(e):t===n.exports.levels.values.warn?console.warn(e):t===n.exports.levels.values.debug?console.debug(e):t===n.exports.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(C({timestamp:(new Date).toISOString(),log:e}));const t="string"==typeof e?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new B(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const t=this.getLogArray();return t.push(C({extraMetadata:e})),new Blob(t,{type:"application/json"})}}var j=Object.defineProperty;class L{constructor(e,t=P){((e,t,r)=>{((e,t,r)=>{t in e?j(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r)})(this,"baseChunkLogger"),this.baseChunkLogger=new k(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const t=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=t,r.download=`walletconnect-logs-${(new Date).toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t)}}var D=Object.defineProperty;class q{constructor(e,t=P){((e,t,r)=>{((e,t,r)=>{t in e?D(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r)})(this,"baseChunkLogger"),this.baseChunkLogger=new k(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}}var M=Object.defineProperty,$=Object.defineProperties,z=Object.getOwnPropertyDescriptors,Z=Object.getOwnPropertySymbols,F=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable,V=(e,t,r)=>t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,H=(e,t)=>{for(var r in t||(t={}))F.call(t,r)&&V(e,r,t[r]);if(Z)for(var r of Z(t))K.call(t,r)&&V(e,r,t[r]);return e},W=(e,t)=>$(e,z(t));function G(e){return W(H({},e),{level:e?.level||"info"})}function J(e,t=_){return e[t]||""}function Y(e,t,r=_){const n=function(e,t,r=_){const n=J(e,r);return n.trim()?`${n}/${t}`:t}(e,t,r);return function(e,t,r=_){return e[r]=t,e}(e.child({context:n}),n,r)}function Q(e){var t;if(typeof e.loggerOverride<"u"&&"string"!=typeof e.loggerOverride)return{logger:e.loggerOverride,chunkLoggerController:null};const r=W(H({},e.opts),{level:"string"==typeof e.loggerOverride?e.loggerOverride:null==(t=e.opts)?void 0:t.level});return typeof window<"u"?function(e){var t,r;const i=new L(null==(t=e.opts)?void 0:t.level,e.maxSizeInBytes);return{logger:n.exports(W(H({},e.opts),{level:"trace",browser:W(H({},null==(r=e.opts)?void 0:r.browser),{write:e=>i.write(e)})})),chunkLoggerController:i}}(W(H({},e),{opts:r})):function(e){var t,r;const i=new q(null==(t=e.opts)?void 0:t.level,e.maxSizeInBytes);return{logger:n.exports(W(H({},e.opts),{level:"trace",browser:W(H({},null==(r=e.opts)?void 0:r.browser),{write:e=>i.write(e)})}),i),chunkLoggerController:i}}(W(H({},e),{opts:r}))}},63840:function(e,t,r){"use strict";r.d(t,{iO:function(){return n}});const n={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}}},29168:function(e,t,r){"use strict";r.d(t,{xp:function(){return br},bG:function(){return pr},Au:function(){return wr},vf:function(){return vr}});var n=r(8239),i=r(14611),s=r(80328);function o(e,...t){if(!function(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function a(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}const c="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,l=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);function u(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e)),o(e),e}function f(e=32){if(c&&"function"==typeof c.getRandomValues)return c.getRandomValues(new Uint8Array(e));if(c&&"function"==typeof c.randomBytes)return c.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}const h=BigInt(2**32-1),d=BigInt(32);function p(e,t=!1){return t?{h:Number(e&h),l:Number(e>>d&h)}:{h:0|Number(e>>d&h),l:0|Number(e&h)}}const g=function(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let i=0;i<e.length;i++){const{h:s,l:o}=p(e[i],t);[r[i],n[i]]=[s,o]}return[r,n]},y=(e,t,r)=>e>>>r,m=(e,t,r)=>e<<32-r|t>>>r,b=(e,t,r)=>e>>>r|t<<32-r,w=(e,t,r)=>e<<32-r|t>>>r,v=(e,t,r)=>e<<64-r|t>>>r-32,E=(e,t,r)=>e>>>r-32|t<<64-r,x=function(e,t,r,n){const i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:0|i}},I=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),S=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,O=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),_=(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0,P=(e,t,r,n,i,s)=>t+r+n+i+s+(e/2**32|0)|0,A=(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0),[R,T]=g(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),B=new Uint32Array(80),C=new Uint32Array(80);class U extends class extends class{clone(){return this._cloneInto()}}{constructor(e,t,r,n){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=l(this.buffer)}update(e){a(this);const{view:t,buffer:r,blockLen:n}=this,i=(e=u(e)).length;for(let s=0;s<i;){const o=Math.min(n-this.pos,i-s);if(o!==n)r.set(e.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===n&&(this.process(t,0),this.pos=0);else{const t=l(e);for(;n<=i-s;s+=n)this.process(t,s)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){a(this),function(e,t){o(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:n,isLE:i}=this;let{pos:s}=this;t[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>n-s&&(this.process(r,0),s=0);for(let o=s;o<n;o++)t[o]=0;(function(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?0:4;e.setUint32(t+(n?4:0),o,n),e.setUint32(t+c,a,n)})(r,n-8,BigInt(8*this.length),i),this.process(r,0);const c=l(e),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=u/4,h=this.get();if(f>h.length)throw new Error("_sha2: outputLen bigger than state");for(let o=0;o<f;o++)c.setUint32(4*o,h[o],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:n,finished:i,destroyed:s,pos:o}=this;return e.length=n,e.pos=o,e.finished=i,e.destroyed=s,n%t&&e.buffer.set(r),e}}{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:r,Bl:n,Ch:i,Cl:s,Dh:o,Dl:a,Eh:c,El:l,Fh:u,Fl:f,Gh:h,Gl:d,Hh:p,Hl:g}=this;return[e,t,r,n,i,s,o,a,c,l,u,f,h,d,p,g]}set(e,t,r,n,i,s,o,a,c,l,u,f,h,d,p,g){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|s,this.Dh=0|o,this.Dl=0|a,this.Eh=0|c,this.El=0|l,this.Fh=0|u,this.Fl=0|f,this.Gh=0|h,this.Gl=0|d,this.Hh=0|p,this.Hl=0|g}process(e,t){for(let y=0;y<16;y++,t+=4)B[y]=e.getUint32(t),C[y]=e.getUint32(t+=4);for(let x=16;x<80;x++){const e=0|B[x-15],t=0|C[x-15],r=b(e,t,1)^b(e,t,8)^y(e,t,7),n=w(e,t,1)^w(e,t,8)^m(e,t,7),i=0|B[x-2],s=0|C[x-2],o=b(i,s,19)^v(i,s,61)^y(i,s,6),a=w(i,s,19)^E(i,s,61)^m(i,s,6),c=O(n,a,C[x-7],C[x-16]),l=_(c,r,o,B[x-7],B[x-16]);B[x]=0|l,C[x]=0|c}let{Ah:r,Al:n,Bh:i,Bl:s,Ch:o,Cl:a,Dh:c,Dl:l,Eh:u,El:f,Fh:h,Fl:d,Gh:p,Gl:g,Hh:U,Hl:N}=this;for(let y=0;y<80;y++){const e=b(u,f,14)^b(u,f,18)^v(u,f,41),t=w(u,f,14)^w(u,f,18)^E(u,f,41),m=u&h^~u&p,O=A(N,t,f&d^~f&g,T[y],C[y]),_=P(O,U,e,m,R[y],B[y]),k=0|O,j=b(r,n,28)^v(r,n,34)^v(r,n,39),L=w(r,n,28)^E(r,n,34)^E(r,n,39),D=r&i^r&o^i&o,q=n&s^n&a^s&a;U=0|p,N=0|g,p=0|h,g=0|d,h=0|u,d=0|f,({h:u,l:f}=x(0|c,0|l,0|_,0|k)),c=0|o,l=0|a,o=0|i,a=0|s,i=0|r,s=0|n;const M=I(k,L,q);r=S(M,_,j,D),n=0|M}({h:r,l:n}=x(0|this.Ah,0|this.Al,0|r,0|n)),({h:i,l:s}=x(0|this.Bh,0|this.Bl,0|i,0|s)),({h:o,l:a}=x(0|this.Ch,0|this.Cl,0|o,0|a)),({h:c,l}=x(0|this.Dh,0|this.Dl,0|c,0|l)),({h:u,l:f}=x(0|this.Eh,0|this.El,0|u,0|f)),({h,l:d}=x(0|this.Fh,0|this.Fl,0|h,0|d)),({h:p,l:g}=x(0|this.Gh,0|this.Gl,0|p,0|g)),({h:U,l:N}=x(0|this.Hh,0|this.Hl,0|U,0|N)),this.set(r,n,i,s,o,a,c,l,u,f,h,d,p,g,U,N)}roundClean(){B.fill(0),C.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const N=function(e){const t=t=>e().update(u(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}(()=>new U),k=BigInt(0),j=BigInt(1),L=BigInt(2);function D(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function q(e){if(!D(e))throw new Error("Uint8Array expected")}function M(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)}const $=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function z(e){q(e);let t="";for(let r=0;r<e.length;r++)t+=$[e[r]];return t}function Z(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?k:BigInt("0x"+e)}function F(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}function K(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){const t=F(e.charCodeAt(s)),r=F(e.charCodeAt(s+1));if(void 0===t||void 0===r)throw new Error('hex string expected, got non-hex character "'+(e[s]+e[s+1])+'" at index '+s);n[i]=16*t+r}return n}function V(e){return q(e),Z(z(Uint8Array.from(e).reverse()))}function H(e,t){return K(e.toString(16).padStart(2*t,"0"))}function W(e,t){return H(e,t).reverse()}function G(e,t,r){let n;if("string"==typeof t)try{n=K(t)}catch(s){throw new Error(e+" must be hex string or Uint8Array, cause: "+s)}else{if(!D(t))throw new Error(e+" must be hex string or Uint8Array");n=Uint8Array.from(t)}const i=n.length;if("number"==typeof r&&i!==r)throw new Error(e+" of length "+r+" expected, got "+i);return n}function J(...e){let t=0;for(let n=0;n<e.length;n++){const r=e[n];q(r),t+=r.length}const r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){const t=e[n];r.set(t,i),i+=t.length}return r}const Y=e=>"bigint"==typeof e&&k<=e;function Q(e,t,r,n){if(!function(e,t,r){return Y(e)&&Y(t)&&Y(r)&&t<=e&&e<r}(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}const X=e=>(L<<BigInt(e-1))-j,ee={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||D(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function te(e,t,r={}){const n=(t,r,n)=>{const i=ee[r];if("function"!=typeof i)throw new Error("invalid validator function");const s=e[t];if(!(n&&void 0===s||i(s,e)))throw new Error("param "+String(t)+" is invalid. Expected "+r+", got "+s)};for(const[i,s]of Object.entries(t))n(i,s,!1);for(const[i,s]of Object.entries(r))n(i,s,!0);return e}function re(e){const t=new WeakMap;return(r,...n)=>{const i=t.get(r);if(void 0!==i)return i;const s=e(r,...n);return t.set(r,s),s}}const ne=BigInt(0),ie=BigInt(1),se=BigInt(2),oe=BigInt(3),ae=BigInt(4),ce=BigInt(5),le=BigInt(8);function ue(e,t){const r=e%t;return r>=ne?r:t+r}function fe(e,t,r){if(t<ne)throw new Error("invalid exponent, negatives unsupported");if(r<=ne)throw new Error("invalid modulus");if(r===ie)return ne;let n=ie;for(;t>ne;)t&ie&&(n=n*e%r),e=e*e%r,t>>=ie;return n}function he(e,t,r){let n=e;for(;t-- >ne;)n*=n,n%=r;return n}function de(e,t){if(e===ne)throw new Error("invert: expected non-zero number");if(t<=ne)throw new Error("invert: expected positive modulus, got "+t);let r=ue(e,t),n=t,i=ne,s=ie;for(;r!==ne;){const e=n%r,t=i-s*(n/r);n=r,r=e,i=s,s=t}if(n!==ie)throw new Error("invert: does not exist");return ue(i,t)}const pe=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ge(e,t){const r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function ye(e,t,r=!1,n={}){if(e<=ne)throw new Error("invalid field: expected ORDER > 0, got "+e);const{nBitLength:i,nByteLength:s}=ge(e,t);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:e,isLE:r,BITS:i,BYTES:s,MASK:X(i),ZERO:ne,ONE:ie,create:t=>ue(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return ne<=t&&t<e},is0:e=>e===ne,isOdd:e=>(e&ie)===ie,neg:t=>ue(-t,e),eql:(e,t)=>e===t,sqr:t=>ue(t*t,e),add:(t,r)=>ue(t+r,e),sub:(t,r)=>ue(t-r,e),mul:(t,r)=>ue(t*r,e),pow:(e,t)=>function(e,t,r){if(r<ne)throw new Error("invalid exponent, negatives unsupported");if(r===ne)return e.ONE;if(r===ie)return t;let n=e.ONE,i=t;for(;r>ne;)r&ie&&(n=e.mul(n,i)),i=e.sqr(i),r>>=ie;return n}(a,e,t),div:(t,r)=>ue(t*de(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>de(t,e),sqrt:n.sqrt||(t=>(o||(o=function(e){if(e%ae===oe){const t=(e+ie)/ae;return function(e,r){const n=e.pow(r,t);if(!e.eql(e.sqr(n),r))throw new Error("Cannot find square root");return n}}if(e%le===ce){const t=(e-ce)/le;return function(e,r){const n=e.mul(r,se),i=e.pow(n,t),s=e.mul(r,i),o=e.mul(e.mul(s,se),i),a=e.mul(s,e.sub(o,e.ONE));if(!e.eql(e.sqr(a),r))throw new Error("Cannot find square root");return a}}return function(e){const t=(e-ie)/se;let r,n,i;for(r=e-ie,n=0;r%se===ne;r/=se,n++);for(i=se;i<e&&fe(i,t,e)!==e-ie;i++)if(i>1e3)throw new Error("Cannot find square root: likely non-prime P");if(1===n){const t=(e+ie)/ae;return function(e,r){const n=e.pow(r,t);if(!e.eql(e.sqr(n),r))throw new Error("Cannot find square root");return n}}const s=(r+ie)/se;return function(e,o){if(e.pow(o,t)===e.neg(e.ONE))throw new Error("Cannot find square root");let a=n,c=e.pow(e.mul(e.ONE,i),r),l=e.pow(o,s),u=e.pow(o,r);for(;!e.eql(u,e.ONE);){if(e.eql(u,e.ZERO))return e.ZERO;let t=1;for(let n=e.sqr(u);t<a&&!e.eql(n,e.ONE);t++)n=e.sqr(n);const r=e.pow(c,ie<<BigInt(a-t-1));c=e.sqr(r),l=e.mul(l,r),u=e.mul(u,c),a=t}return l}}(e)}(e)),o(a,t))),invertBatch:e=>function(e,t){const r=new Array(t.length),n=t.reduce((t,n,i)=>e.is0(n)?t:(r[i]=t,e.mul(t,n)),e.ONE),i=e.inv(n);return t.reduceRight((t,n,i)=>e.is0(n)?t:(r[i]=e.mul(t,r[i]),e.mul(t,n)),i),r}(a,e),cmov:(e,t,r)=>r?t:e,toBytes:e=>r?W(e,s):H(e,s),fromBytes:e=>{if(e.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+e.length);return r?V(e):function(e){return Z(z(e))}(e)}});return Object.freeze(a)}const me=BigInt(0),be=BigInt(1);function we(e,t){const r=t.negate();return e?r:t}function ve(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Ee(e,t){return ve(e,t),{windows:Math.ceil(t/e)+1,windowSize:2**(e-1)}}const xe=new WeakMap,Ie=new WeakMap;function Se(e){return Ie.get(e)||1}const Oe=BigInt(0),_e=BigInt(1),Pe=BigInt(2),Ae=BigInt(8),Re={zip215:!0};BigInt(0),BigInt(1);const Te=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Be=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const Ce=BigInt(1),Ue=BigInt(2);BigInt(3);const Ne=BigInt(5),ke=BigInt(8);const je=ye(Te,void 0,!0),Le=function(e){const t=function(e){const t=function(e){return function(e){te(e,pe.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}(e.Fp),te(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...ge(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}(e);return te(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}(e),{Fp:r,n,prehash:i,hash:s,randomBytes:o,nByteLength:a,h:c}=t,l=Pe<<BigInt(8*a)-_e,u=r.create,f=ye(t.n,t.nBitLength),h=t.uvRatio||((e,t)=>{try{return{isValid:!0,value:r.sqrt(e*r.inv(t))}}catch{return{isValid:!1,value:Oe}}}),d=t.adjustScalarBytes||(e=>e),p=t.domain||((e,t,r)=>{if(M("phflag",r),t.length||r)throw new Error("Contexts/pre-hash are not supported");return e});function g(e,t){Q("coordinate "+e,t,Oe,l)}function y(e){if(!(e instanceof w))throw new Error("ExtendedPoint expected")}const m=re((e,t)=>{const{ex:n,ey:i,ez:s}=e,o=e.is0();null==t&&(t=o?Ae:r.inv(s));const a=u(n*t),c=u(i*t),l=u(s*t);if(o)return{x:Oe,y:_e};if(l!==_e)throw new Error("invZ was invalid");return{x:a,y:c}}),b=re(e=>{const{a:r,d:n}=t;if(e.is0())throw new Error("bad point: ZERO");const{ex:i,ey:s,ez:o,et:a}=e,c=u(i*i),l=u(s*s),f=u(o*o),h=u(f*f),d=u(c*r);if(u(f*u(d+l))!==u(h+u(n*u(c*l))))throw new Error("bad point: equation left != right (1)");if(u(i*s)!==u(o*a))throw new Error("bad point: equation left != right (2)");return!0});class w{constructor(e,t,r,n){this.ex=e,this.ey=t,this.ez=r,this.et=n,g("x",e),g("y",t),g("z",r),g("t",n),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(e){if(e instanceof w)throw new Error("extended point not allowed");const{x:t,y:r}=e||{};return g("x",t),g("y",r),new w(t,r,_e,u(t*r))}static normalizeZ(e){const t=r.invertBatch(e.map(e=>e.ez));return e.map((e,r)=>e.toAffine(t[r])).map(w.fromAffine)}static msm(e,t){return function(e,t,r,n){if(function(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((e,r)=>{if(!(e instanceof t))throw new Error("invalid point at index "+r)})}(r,e),function(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((e,r)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+r)})}(n,t),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const i=e.ZERO,s=function(e){let t;for(t=0;e>k;e>>=j,t+=1);return t}(BigInt(r.length)),o=s>12?s-3:s>4?s-2:s?2:1,a=(1<<o)-1,c=new Array(a+1).fill(i);let l=i;for(let u=Math.floor((t.BITS-1)/o)*o;u>=0;u-=o){c.fill(i);for(let t=0;t<n.length;t++){const e=Number(n[t]>>BigInt(u)&BigInt(a));c[e]=c[e].add(r[t])}let e=i;for(let t=c.length-1,r=i;t>0;t--)r=r.add(c[t]),e=e.add(r);if(l=l.add(e),0!==u)for(let t=0;t<o;t++)l=l.double()}return l}(w,f,e,t)}_setWindowSize(e){x.setWindowSize(this,e)}assertValidity(){b(this)}equals(e){y(e);const{ex:t,ey:r,ez:n}=this,{ex:i,ey:s,ez:o}=e,a=u(t*o),c=u(i*n),l=u(r*o),f=u(s*n);return a===c&&l===f}is0(){return this.equals(w.ZERO)}negate(){return new w(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:e}=t,{ex:r,ey:n,ez:i}=this,s=u(r*r),o=u(n*n),a=u(Pe*u(i*i)),c=u(e*s),l=r+n,f=u(u(l*l)-s-o),h=c+o,d=h-a,p=c-o,g=u(f*d),y=u(h*p),m=u(f*p),b=u(d*h);return new w(g,y,b,m)}add(e){y(e);const{a:r,d:n}=t,{ex:i,ey:s,ez:o,et:a}=this,{ex:c,ey:l,ez:f,et:h}=e;if(r===BigInt(-1)){const e=u((s-i)*(l+c)),t=u((s+i)*(l-c)),r=u(t-e);if(r===Oe)return this.double();const n=u(o*Pe*h),d=u(a*Pe*f),p=d+n,g=t+e,y=d-n,m=u(p*r),b=u(g*y),v=u(p*y),E=u(r*g);return new w(m,b,E,v)}const d=u(i*c),p=u(s*l),g=u(a*n*h),m=u(o*f),b=u((i+s)*(c+l)-d-p),v=m-g,E=m+g,x=u(p-r*d),I=u(b*v),S=u(E*x),O=u(b*x),_=u(v*E);return new w(I,S,_,O)}subtract(e){return this.add(e.negate())}wNAF(e){return x.wNAFCached(this,e,w.normalizeZ)}multiply(e){const t=e;Q("scalar",t,_e,n);const{p:r,f:i}=this.wNAF(t);return w.normalizeZ([r,i])[0]}multiplyUnsafe(e,t=w.ZERO){const r=e;return Q("scalar",r,Oe,n),r===Oe?E:this.is0()||r===_e?this:x.wNAFCachedUnsafe(this,r,w.normalizeZ,t)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return x.unsafeLadder(this,n).is0()}toAffine(e){return m(this,e)}clearCofactor(){const{h:e}=t;return e===_e?this:this.multiplyUnsafe(e)}static fromHex(e,n=!1){const{d:i,a:s}=t,o=r.BYTES;e=G("pointHex",e,o),M("zip215",n);const a=e.slice(),c=e[o-1];a[o-1]=-129&c;const f=V(a);Q("pointHex.y",f,Oe,n?l:r.ORDER);const d=u(f*f),p=u(d-_e),g=u(i*d-s);let{isValid:y,value:m}=h(p,g);if(!y)throw new Error("Point.fromHex: invalid y coordinate");const b=(m&_e)===_e,v=0!=(128&c);if(!n&&m===Oe&&v)throw new Error("Point.fromHex: x=0 and x_0=1");return v!==b&&(m=u(-m)),w.fromAffine({x:m,y:f})}static fromPrivateKey(e){return O(e).point}toRawBytes(){const{x:e,y:t}=this.toAffine(),n=W(t,r.BYTES);return n[n.length-1]|=e&_e?128:0,n}toHex(){return z(this.toRawBytes())}}w.BASE=new w(t.Gx,t.Gy,_e,u(t.Gx*t.Gy)),w.ZERO=new w(Oe,_e,_e,Oe);const{BASE:v,ZERO:E}=w,x=function(e,t){return{constTimeNegate:we,hasPrecomputes:e=>1!==Se(e),unsafeLadder(t,r,n=e.ZERO){let i=t;for(;r>me;)r&be&&(n=n.add(i)),i=i.double(),r>>=be;return n},precomputeWindow(e,r){const{windows:n,windowSize:i}=Ee(r,t),s=[];let o=e,a=o;for(let t=0;t<n;t++){a=o,s.push(a);for(let e=1;e<i;e++)a=a.add(o),s.push(a);o=a.double()}return s},wNAF(r,n,i){const{windows:s,windowSize:o}=Ee(r,t);let a=e.ZERO,c=e.BASE;const l=BigInt(2**r-1),u=2**r,f=BigInt(r);for(let e=0;e<s;e++){const t=e*o;let r=Number(i&l);i>>=f,r>o&&(r-=u,i+=be);const s=t,h=t+Math.abs(r)-1,d=e%2!=0,p=r<0;0===r?c=c.add(we(d,n[s])):a=a.add(we(p,n[h]))}return{p:a,f:c}},wNAFUnsafe(r,n,i,s=e.ZERO){const{windows:o,windowSize:a}=Ee(r,t),c=BigInt(2**r-1),l=2**r,u=BigInt(r);for(let e=0;e<o;e++){const t=e*a;if(i===me)break;let r=Number(i&c);if(i>>=u,r>a&&(r-=l,i+=be),0===r)continue;let o=n[t+Math.abs(r)-1];r<0&&(o=o.negate()),s=s.add(o)}return s},getPrecomputes(e,t,r){let n=xe.get(t);return n||(n=this.precomputeWindow(t,e),1!==e&&xe.set(t,r(n))),n},wNAFCached(e,t,r){const n=Se(e);return this.wNAF(n,this.getPrecomputes(n,e,r),t)},wNAFCachedUnsafe(e,t,r,n){const i=Se(e);return 1===i?this.unsafeLadder(e,t,n):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),t,n)},setWindowSize(e,r){ve(r,t),Ie.set(e,r),xe.delete(e)}}}(w,8*a);function I(e){return ue(e,n)}function S(e){return I(V(e))}function O(e){const t=r.BYTES;e=G("private key",e,t);const n=G("hashed private key",s(e),2*t),i=d(n.slice(0,t)),o=n.slice(t,2*t),a=S(i),c=v.multiply(a),l=c.toRawBytes();return{head:i,prefix:o,scalar:a,point:c,pointBytes:l}}function _(e=new Uint8Array,...t){const r=J(...t);return S(s(p(r,G("context",e),!!i)))}const P=Re;return v._setWindowSize(8),{CURVE:t,getPublicKey:function(e){return O(e).pointBytes},sign:function(e,t,s={}){e=G("message",e),i&&(e=i(e));const{prefix:o,scalar:a,pointBytes:c}=O(t),l=_(s.context,o,e),u=v.multiply(l).toRawBytes(),f=I(l+_(s.context,u,c,e)*a);return Q("signature.s",f,Oe,n),G("result",J(u,W(f,r.BYTES)),2*r.BYTES)},verify:function(e,t,n,s=P){const{context:o,zip215:a}=s,c=r.BYTES;e=G("signature",e,2*c),t=G("message",t),n=G("publicKey",n,c),void 0!==a&&M("zip215",a),i&&(t=i(t));const l=V(e.slice(c,2*c));let u,f,h;try{u=w.fromHex(n,a),f=w.fromHex(e.slice(0,c),a),h=v.multiplyUnsafe(l)}catch{return!1}if(!a&&u.isSmallOrder())return!1;const d=_(o,f.toRawBytes(),u.toRawBytes(),t);return f.add(u.multiplyUnsafe(d)).subtract(h).clearCofactor().equals(w.ZERO)},ExtendedPoint:w,utils:{getExtendedPublicKey:O,randomPrivateKey:()=>o(r.BYTES),precompute:(e=8,t=w.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)}}}({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:je,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:ke,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:N,randomBytes:f,adjustScalarBytes:function(e){return e[0]&=248,e[31]&=127,e[31]|=64,e},uvRatio:function(e,t){const r=Te,n=ue(t*t*t,r),i=function(e){const t=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),s=Te,o=e*e%s*e%s,a=he(o,Ue,s)*o%s,c=he(a,Ce,s)*e%s,l=he(c,Ne,s)*c%s,u=he(l,t,s)*l%s,f=he(u,r,s)*u%s,h=he(f,n,s)*f%s,d=he(h,i,s)*h%s,p=he(d,i,s)*h%s,g=he(p,t,s)*l%s;return{pow_p_5_8:he(g,Ue,s)*e%s,b2:o}}(e*ue(n*n*t,r)).pow_p_5_8;let s=ue(e*n*i,r);const o=ue(t*s*s,r),a=s,c=ue(s*Be,r),l=o===e,u=o===ue(-e,r),f=o===ue(-e*Be,r);return l&&(s=a),(u||f)&&(s=c),((e,t)=>(ue(e,t)&ie)===ie)(s,r)&&(s=ue(-s,r)),{isValid:l||u,value:s}}}),De="base64url",qe="did",Me="key",$e="base58btc";function ze(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Ze(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?ze(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function Fe(e,t){t||(t=e.reduce((e,t)=>e+t.length,0));const r=Ze(t);let n=0;for(const i of e)r.set(i,n),n+=i.length;return ze(r)}const Ke=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};class Ve{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class He{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Ge(this,e)}}class We{constructor(e){this.decoders=e}or(e){return Ge(this,e)}decode(e){const t=this.decoders[e[0]];if(t)return t.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Ge=(e,t)=>new We({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Je{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new Ve(e,t,r),this.decoder=new He(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Ye=({name:e,prefix:t,encode:r,decode:n})=>new Je(e,t,r,n),Qe=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function f(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var f=0,h=s-1;(0!==u||f<i)&&-1!==h;h--,f++)o[h]=(u+=a*o[h]>>>0)%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=f,t++}if(" "!==e[t]){for(var d=s-i;d!==s&&0===o[d];)d++;for(var p=new Uint8Array(n+(s-d)),g=n;d!==s;)p[g++]=o[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,s=t.length;i!==s&&0===t[i];)i++,r++;for(var o=(s-i)*u+1>>>0,l=new Uint8Array(o);i!==s;){for(var f=t[i],h=0,d=o-1;(0!==f||h<n)&&-1!==d;d--,h++)l[d]=(f+=256*l[d]>>>0)%a>>>0,f=f/a>>>0;if(0!==f)throw new Error("Non-zero carry");n=h,i++}for(var p=o-n;p!==o&&0===l[p];)p++;for(var g=c.repeat(r);p<o;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:f,decode:function(e){var r=f(e);if(r)return r;throw new Error(`Non-${t} character`)}}}(r,t);return Ye({prefix:e,name:t,encode:n,decode:e=>Ke(i(e))})},Xe=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Ye({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;for(;"="===e[s-1];)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError(`Non-${n} character`);c=c<<r|t,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),et=Ye({prefix:"\0",name:"identity",encode:e=>(e=>(new TextDecoder).decode(e))(e),decode:e=>(e=>(new TextEncoder).encode(e))(e)});var tt=Object.freeze({__proto__:null,identity:et});const rt=Xe({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var nt=Object.freeze({__proto__:null,base2:rt});const it=Xe({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var st=Object.freeze({__proto__:null,base8:it});const ot=Qe({prefix:"9",name:"base10",alphabet:"0123456789"});var at=Object.freeze({__proto__:null,base10:ot});const ct=Xe({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),lt=Xe({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var ut=Object.freeze({__proto__:null,base16:ct,base16upper:lt});const ft=Xe({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ht=Xe({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),dt=Xe({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),pt=Xe({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),gt=Xe({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),yt=Xe({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),mt=Xe({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),bt=Xe({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),wt=Xe({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var vt=Object.freeze({__proto__:null,base32:ft,base32upper:ht,base32pad:dt,base32padupper:pt,base32hex:gt,base32hexupper:yt,base32hexpad:mt,base32hexpadupper:bt,base32z:wt});const Et=Qe({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),xt=Qe({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var It=Object.freeze({__proto__:null,base36:Et,base36upper:xt});const St=Qe({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ot=Qe({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var _t=Object.freeze({__proto__:null,base58btc:St,base58flickr:Ot});const Pt=Xe({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),At=Xe({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Rt=Xe({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Tt=Xe({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Bt=Object.freeze({__proto__:null,base64:Pt,base64pad:At,base64url:Rt,base64urlpad:Tt});const Ct=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),Ut=Ct.reduce((e,t,r)=>(e[r]=t,e),[]),Nt=Ct.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]),kt=Ye({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+Ut[t],"")},decode:function(e){const t=[];for(const r of e){const e=Nt[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var jt=Object.freeze({__proto__:null,base256emoji:kt}),Lt=Math.pow(2,31),Dt=Math.pow(2,7),qt=Math.pow(2,14),Mt=Math.pow(2,21),$t=Math.pow(2,28),zt=Math.pow(2,35),Zt=Math.pow(2,42),Ft=Math.pow(2,49),Kt=Math.pow(2,56),Vt=Math.pow(2,63),Ht=function e(t,r,n){r=r||[];for(var i=n=n||0;t>=Lt;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},Wt=function(e){return e<Dt?1:e<qt?2:e<Mt?3:e<$t?4:e<zt?5:e<Zt?6:e<Ft?7:e<Kt?8:e<Vt?9:10};const Gt=(e,t,r=0)=>(Ht(e,t,r),t),Jt=e=>Wt(e),Yt=(e,t)=>{const r=t.byteLength,n=Jt(e),i=n+Jt(r),s=new Uint8Array(i+r);return Gt(e,s,0),Gt(r,s,n),s.set(t,i),new Qt(e,r,t,s)};class Qt{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const Xt=({name:e,code:t,encode:r})=>new er(e,t,r);class er{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Yt(this.code,t):t.then(e=>Yt(this.code,e))}throw Error("Unknown type, must be binary type")}}const tr=e=>function(){var t=(0,n.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(e,t))});return function(e){return t.apply(this,arguments)}}(),rr=Xt({name:"sha2-256",code:18,encode:tr("SHA-256")}),nr=Xt({name:"sha2-512",code:19,encode:tr("SHA-512")});Object.freeze({__proto__:null,sha256:rr,sha512:nr});const ir=Ke;Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:ir,digest:e=>Yt(0,ir(e))}}),new TextEncoder,new TextDecoder;const sr={...tt,...nt,...st,...at,...ut,...vt,...It,..._t,...Bt,...jt};function or(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const ar=or("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>(new TextEncoder).encode(e.substring(1))),cr=or("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{const t=Ze((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),lr={utf8:ar,"utf-8":ar,hex:sr.base16,latin1:cr,ascii:cr,binary:cr,...sr};function ur(e,t="utf8"){const r=lr[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}function fr(e,t="utf8"){const r=lr[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):ze(globalThis.Buffer.from(e,"utf-8"))}function hr(e){return(0,s.D)(ur(fr(e,De),"utf8"))}function dr(e){return ur(fr((0,s.u)(e),"utf8"),De)}function pr(e){const t="z"+ur(Fe([fr("K36",$e),e]),$e);return[qe,Me,t].join(":")}function gr(e){return ur(e,De)}function yr(e){return fr([dr(e.header),dr(e.payload)].join("."),"utf8")}function mr(e){return[dr(e.header),dr(e.payload),gr(e.signature)].join(".")}function br(e){const t=e.split("."),r=hr(t[0]),n=hr(t[1]),i=function(e){return fr(e,De)}(t[2]);return{header:r,payload:n,signature:i,data:fr(t.slice(0,2).join("."),"utf8")}}function wr(e=f(32)){const t=Le.getPublicKey(e);return{secretKey:Fe([e,t]),publicKey:t}}function vr(e,t,r,n){return Er.apply(this,arguments)}function Er(){return(Er=(0,n.Z)(function*(e,t,r,n,s=(0,i.fromMiliseconds)(Date.now())){const o={alg:"EdDSA",typ:"JWT"},a={iss:pr(n.publicKey),sub:e,aud:t,iat:s,exp:s+r},c=yr({header:o,payload:a});return mr({header:o,payload:a,signature:Le.sign(c,n.secretKey.slice(0,32))})})).apply(this,arguments)}},80328:function(e,t,r){"use strict";function n(e){if("string"!=typeof e)throw new Error("Cannot safe json parse value of type "+typeof e);try{return(e=>{const t=e.replace(/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,'$1"$2n"$3');return JSON.parse(t,(e,t)=>"string"==typeof t&&t.match(/^\d+n$/)?BigInt(t.substring(0,t.length-1)):t)})(e)}catch{return e}}function i(e){return"string"==typeof e?e:(e=>JSON.stringify(e,(e,t)=>"bigint"==typeof t?t.toString()+"n":t))(e)||""}r.d(t,{D:function(){return n},u:function(){return i}})},78847:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(80017);n.__exportStar(r(77662),t),n.__exportStar(r(45898),t)},77662:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_THOUSAND=t.ONE_HUNDRED=void 0,t.ONE_HUNDRED=100,t.ONE_THOUSAND=1e3},45898:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=5*t.ONE_MINUTE,t.TEN_MINUTES=10*t.ONE_MINUTE,t.THIRTY_MINUTES=30*t.ONE_MINUTE,t.SIXTY_MINUTES=60*t.ONE_MINUTE,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=3*t.ONE_HOUR,t.SIX_HOURS=6*t.ONE_HOUR,t.TWELVE_HOURS=12*t.ONE_HOUR,t.TWENTY_FOUR_HOURS=24*t.ONE_HOUR,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=3*t.ONE_DAY,t.FIVE_DAYS=5*t.ONE_DAY,t.SEVEN_DAYS=7*t.ONE_DAY,t.THIRTY_DAYS=30*t.ONE_DAY,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=2*t.ONE_WEEK,t.THREE_WEEKS=3*t.ONE_WEEK,t.FOUR_WEEKS=4*t.ONE_WEEK,t.ONE_YEAR=365*t.ONE_DAY},14611:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(80017);n.__exportStar(r(47344),t),n.__exportStar(r(1429),t),n.__exportStar(r(40214),t),n.__exportStar(r(78847),t)},40214:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(80017).__exportStar(r(47997),t)},47997:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IWatch=void 0,t.IWatch=class{}},45442:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromMiliseconds=t.toMiliseconds=void 0;const n=r(78847);t.toMiliseconds=function(e){return e*n.ONE_THOUSAND},t.fromMiliseconds=function(e){return Math.floor(e/n.ONE_THOUSAND)}},67406:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delay=void 0,t.delay=function(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}},47344:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(80017);n.__exportStar(r(67406),t),n.__exportStar(r(45442),t)},1429:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(e){if(this.timestamps.has(e))throw new Error(`Watch already started for label: ${e}`);this.timestamps.set(e,{started:Date.now()})}stop(e){const t=this.get(e);if(void 0!==t.elapsed)throw new Error(`Watch already stopped for label: ${e}`);const r=Date.now()-t.started;this.timestamps.set(e,{started:t.started,elapsed:r})}get(e){const t=this.timestamps.get(e);if(void 0===t)throw new Error(`No timestamp found for label: ${e}`);return t}elapsed(e){const t=this.get(e);return t.elapsed||Date.now()-t.started}}t.Watch=r,t.default=r},37167:function(e,t){"use strict";function r(e){let t;return"undefined"!=typeof window&&void 0!==window[e]&&(t=window[e]),t}function n(e){const t=r(e);if(!t)throw new Error(`${e} is not defined in Window`);return t}Object.defineProperty(t,"__esModule",{value:!0}),t.getLocalStorage=t.getLocalStorageOrThrow=t.getCrypto=t.getCryptoOrThrow=t.getLocation=t.getLocationOrThrow=t.getNavigator=t.getNavigatorOrThrow=t.getDocument=t.getDocumentOrThrow=t.getFromWindowOrThrow=t.getFromWindow=void 0,t.getFromWindow=r,t.getFromWindowOrThrow=n,t.getDocumentOrThrow=function(){return n("document")},t.getDocument=function(){return r("document")},t.getNavigatorOrThrow=function(){return n("navigator")},t.getNavigator=function(){return r("navigator")},t.getLocationOrThrow=function(){return n("location")},t.getLocation=function(){return r("location")},t.getCryptoOrThrow=function(){return n("crypto")},t.getCrypto=function(){return r("crypto")},t.getLocalStorageOrThrow=function(){return n("localStorage")},t.getLocalStorage=function(){return r("localStorage")}},78359:function(e,t,r){"use strict";t.D=void 0;const n=r(37167);t.D=function(){let e,t;try{e=n.getDocumentOrThrow(),t=n.getLocationOrThrow()}catch{return null}function r(...t){const r=e.getElementsByTagName("meta");for(let e=0;e<r.length;e++){const n=r[e],i=["itemprop","property","name"].map(e=>n.getAttribute(e)).filter(e=>!!e&&t.includes(e));if(i.length&&i){const e=n.getAttribute("content");if(e)return e}}return""}const i=function(){let t=r("name","og:site_name","og:title","twitter:title");return t||(t=e.title),t}();return{description:r("description","og:description","twitter:description","keywords"),url:t.origin,icons:function(){const r=e.getElementsByTagName("link"),n=[];for(let e=0;e<r.length;e++){const i=r[e],s=i.getAttribute("rel");if(s&&s.toLowerCase().indexOf("icon")>-1){const e=i.getAttribute("href");if(e)if(-1===e.toLowerCase().indexOf("https:")&&-1===e.toLowerCase().indexOf("http:")&&0!==e.indexOf("//")){let r=t.protocol+"//"+t.host;if(0===e.indexOf("/"))r+=e;else{const n=t.pathname.split("/");n.pop(),r+=n.join("/")+"/"+e}n.push(r)}else 0===e.indexOf("//")?n.push(t.protocol+e):n.push(e)}}return n}(),name:i}}},49764:function(e,t,r){const n=r(29888);function i(e,t,r){const n=e[t]+e[r];let i=e[t+1]+e[r+1];n>=4294967296&&i++,e[t]=n,e[t+1]=i}function s(e,t,r,n){let i=e[t]+r;r<0&&(i+=4294967296);let s=e[t+1]+n;i>=4294967296&&s++,e[t]=i,e[t+1]=s}function o(e,t){return e[t]^e[t+1]<<8^e[t+2]<<16^e[t+3]<<24}function a(e,t,r,n,o,a){const c=f[o],l=f[o+1],h=f[a],d=f[a+1];i(u,e,t),s(u,e,c,l);let p=u[n]^u[e],g=u[n+1]^u[e+1];u[n]=g,u[n+1]=p,i(u,r,n),p=u[t]^u[r],g=u[t+1]^u[r+1],u[t]=p>>>24^g<<8,u[t+1]=g>>>24^p<<8,i(u,e,t),s(u,e,h,d),p=u[n]^u[e],g=u[n+1]^u[e+1],u[n]=p>>>16^g<<16,u[n+1]=g>>>16^p<<16,i(u,r,n),p=u[t]^u[r],g=u[t+1]^u[r+1],u[t]=g>>>31^p<<1,u[t+1]=p>>>31^g<<1}const c=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),l=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map(function(e){return 2*e})),u=new Uint32Array(32),f=new Uint32Array(32);function h(e,t){let r=0;for(r=0;r<16;r++)u[r]=e.h[r],u[r+16]=c[r];for(u[24]=u[24]^e.t,u[25]=u[25]^e.t/4294967296,t&&(u[28]=~u[28],u[29]=~u[29]),r=0;r<32;r++)f[r]=o(e.b,4*r);for(r=0;r<12;r++)a(0,8,16,24,l[16*r+0],l[16*r+1]),a(2,10,18,26,l[16*r+2],l[16*r+3]),a(4,12,20,28,l[16*r+4],l[16*r+5]),a(6,14,22,30,l[16*r+6],l[16*r+7]),a(0,10,20,30,l[16*r+8],l[16*r+9]),a(2,12,22,24,l[16*r+10],l[16*r+11]),a(4,14,16,26,l[16*r+12],l[16*r+13]),a(6,8,18,28,l[16*r+14],l[16*r+15]);for(r=0;r<16;r++)e.h[r]=e.h[r]^u[r]^u[r+16]}const d=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function p(e,t,r,n){if(0===e||e>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(t&&t.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(r&&16!==r.length)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(n&&16!==n.length)throw new Error("Illegal personal, expected Uint8Array with length is 16");const i={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:e};d.fill(0),d[0]=e,t&&(d[1]=t.length),d[2]=1,d[3]=1,r&&d.set(r,32),n&&d.set(n,48);for(let s=0;s<16;s++)i.h[s]=c[s]^o(d,4*s);return t&&(g(i,t),i.c=128),i}function g(e,t){for(let r=0;r<t.length;r++)128===e.c&&(e.t+=e.c,h(e,!1),e.c=0),e.b[e.c++]=t[r]}function y(e){for(e.t+=e.c;e.c<128;)e.b[e.c++]=0;h(e,!0);const t=new Uint8Array(e.outlen);for(let r=0;r<e.outlen;r++)t[r]=e.h[r>>2]>>8*(3&r);return t}function m(e,t,r,i,s){r=r||64,e=n.normalizeInput(e),i&&(i=n.normalizeInput(i)),s&&(s=n.normalizeInput(s));const o=p(r,t,i,s);return g(o,e),y(o)}e.exports={blake2b:m,blake2bHex:function(e,t,r,i,s){const o=m(e,t,r,i,s);return n.toHex(o)},blake2bInit:p,blake2bUpdate:g,blake2bFinal:y}},14471:function(e,t,r){const n=r(29888);function i(e,t){return e[t]^e[t+1]<<8^e[t+2]<<16^e[t+3]<<24}function s(e,t,r,n,i,s){l[e]=l[e]+l[t]+i,l[n]=o(l[n]^l[e],16),l[r]=l[r]+l[n],l[t]=o(l[t]^l[r],12),l[e]=l[e]+l[t]+s,l[n]=o(l[n]^l[e],8),l[r]=l[r]+l[n],l[t]=o(l[t]^l[r],7)}function o(e,t){return e>>>t^e<<32-t}const a=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),c=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),l=new Uint32Array(16),u=new Uint32Array(16);function f(e,t){let r=0;for(r=0;r<8;r++)l[r]=e.h[r],l[r+8]=a[r];for(l[12]^=e.t,l[13]^=e.t/4294967296,t&&(l[14]=~l[14]),r=0;r<16;r++)u[r]=i(e.b,4*r);for(r=0;r<10;r++)s(0,4,8,12,u[c[16*r+0]],u[c[16*r+1]]),s(1,5,9,13,u[c[16*r+2]],u[c[16*r+3]]),s(2,6,10,14,u[c[16*r+4]],u[c[16*r+5]]),s(3,7,11,15,u[c[16*r+6]],u[c[16*r+7]]),s(0,5,10,15,u[c[16*r+8]],u[c[16*r+9]]),s(1,6,11,12,u[c[16*r+10]],u[c[16*r+11]]),s(2,7,8,13,u[c[16*r+12]],u[c[16*r+13]]),s(3,4,9,14,u[c[16*r+14]],u[c[16*r+15]]);for(r=0;r<8;r++)e.h[r]^=l[r]^l[r+8]}function h(e,t){if(!(e>0&&e<=32))throw new Error("Incorrect output length, should be in [1, 32]");const r=t?t.length:0;if(t&&!(r>0&&r<=32))throw new Error("Incorrect key length, should be in [1, 32]");const n={h:new Uint32Array(a),b:new Uint8Array(64),c:0,t:0,outlen:e};return n.h[0]^=16842752^r<<8^e,r>0&&(d(n,t),n.c=64),n}function d(e,t){for(let r=0;r<t.length;r++)64===e.c&&(e.t+=e.c,f(e,!1),e.c=0),e.b[e.c++]=t[r]}function p(e){for(e.t+=e.c;e.c<64;)e.b[e.c++]=0;f(e,!0);const t=new Uint8Array(e.outlen);for(let r=0;r<e.outlen;r++)t[r]=e.h[r>>2]>>8*(3&r)&255;return t}function g(e,t,r){r=r||32,e=n.normalizeInput(e);const i=h(r,t);return d(i,e),p(i)}e.exports={blake2s:g,blake2sHex:function(e,t,r){const i=g(e,t,r);return n.toHex(i)},blake2sInit:h,blake2sUpdate:d,blake2sFinal:p}},40187:function(e,t,r){const n=r(49764),i=r(14471);e.exports={blake2b:n.blake2b,blake2bHex:n.blake2bHex,blake2bInit:n.blake2bInit,blake2bUpdate:n.blake2bUpdate,blake2bFinal:n.blake2bFinal,blake2s:i.blake2s,blake2sHex:i.blake2sHex,blake2sInit:i.blake2sInit,blake2sUpdate:i.blake2sUpdate,blake2sFinal:i.blake2sFinal}},29888:function(e){function t(e){return(4294967296+e).toString(16).substring(1)}e.exports={normalizeInput:function(e){let t;if(e instanceof Uint8Array)t=e;else{if("string"!=typeof e)throw new Error("Input must be an string, Buffer or Uint8Array");t=(new TextEncoder).encode(e)}return t},toHex:function(e){return Array.prototype.map.call(e,function(e){return(e<16?"0":"")+e.toString(16)}).join("")},debugPrint:function(e,r,n){let i="\n"+e+" = ";for(let s=0;s<r.length;s+=2){if(32===n)i+=t(r[s]).toUpperCase(),i+=" ",i+=t(r[s+1]).toUpperCase();else{if(64!==n)throw new Error("Invalid size "+n);i+=t(r[s+1]).toUpperCase(),i+=t(r[s]).toUpperCase()}s%6==4?i+="\n"+new Array(e.length+4).join(" "):s<r.length-2&&(i+=" ")}console.log(i)},testSpeed:function(e,t,r){let n=(new Date).getTime();const i=new Uint8Array(t);for(let o=0;o<t;o++)i[o]=o%256;const s=(new Date).getTime();console.log("Generated random input in "+(s-n)+"ms"),n=s;for(let o=0;o<r;o++){const r=e(i),s=(new Date).getTime(),o=s-n;n=s,console.log("Hashed in "+o+"ms: "+r.substring(0,20)+"..."),console.log(Math.round(t/(1<<20)/(o/1e3)*100)/100+" MB PER SECOND")}}}},75630:function(e,t){var r,n="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||"undefined"!=typeof global&&global,i=function(){function e(){this.fetch=!1,this.DOMException=n.DOMException}return e.prototype=n,new e}();r=i,function(e){var t=void 0!==r&&r||"undefined"!=typeof self&&self||"undefined"!=typeof global&&global||{},n="URLSearchParams"in t,i="Symbol"in t&&"iterator"in Symbol,s="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch{return!1}}(),o="FormData"in t,a="ArrayBuffer"in t;if(a)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(e){return e&&c.indexOf(Object.prototype.toString.call(e))>-1};function u(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function f(e){return"string"!=typeof e&&(e=String(e)),e}function h(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return i&&(t[Symbol.iterator]=function(){return t}),t}function d(e){this.map={},e instanceof d?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){if(2!=e.length)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function p(e){if(!e._noBody){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}}function g(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function y(e){var t=new FileReader,r=g(t);return t.readAsArrayBuffer(e),r}function m(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(e){this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:s&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:o&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():a&&s&&function(e){return e&&DataView.prototype.isPrototypeOf(e)}(e)?(this._bodyArrayBuffer=m(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a&&(ArrayBuffer.prototype.isPrototypeOf(e)||l(e))?this._bodyArrayBuffer=m(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},s&&(this.blob=function(){var e=p(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer)return p(this)||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer));if(s)return this.blob().then(y);throw new Error("could not read as ArrayBuffer")},this.text=function(){var e=p(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,r=g(t),n=/charset=([A-Za-z0-9_-]+)/.exec(e.type);return t.readAsText(e,n?n[1]:"utf-8"),r}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(E)}),this.json=function(){return this.text().then(JSON.parse)},this}d.prototype.append=function(e,t){e=u(e),t=f(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},d.prototype.delete=function(e){delete this.map[u(e)]},d.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},d.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},d.prototype.set=function(e,t){this.map[u(e)]=f(t)},d.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},d.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),h(e)},d.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),h(e)},d.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),h(e)},i&&(d.prototype[Symbol.iterator]=d.prototype.entries);var w=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function v(e,r){if(!(this instanceof v))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n=(r=r||{}).body;if(e instanceof v){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,r.headers||(this.headers=new d(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,!n&&null!=e._bodyInit&&(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=r.credentials||this.credentials||"same-origin",(r.headers||!this.headers)&&(this.headers=new d(r.headers)),this.method=function(e){var t=e.toUpperCase();return w.indexOf(t)>-1?t:e}(r.method||this.method||"GET"),this.mode=r.mode||this.mode||null,this.signal=r.signal||this.signal||function(){if("AbortController"in t)return(new AbortController).signal}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(n),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==r.cache&&"no-cache"!==r.cache)){var i=/([?&])_=[^&]*/;i.test(this.url)?this.url=this.url.replace(i,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}function E(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}}),t}function x(e){var t=new d;return e.replace(/\r?\n[\t ]+/g," ").split("\r").map(function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e}).forEach(function(e){var r=e.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();try{t.append(n,i)}catch(s){console.warn("Response "+s.message)}}}),t}function I(e,t){if(!(this instanceof I))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new d(t.headers),this.url=t.url||"",this._initBody(e)}v.prototype.clone=function(){return new v(this,{body:this._bodyInit})},b.call(v.prototype),b.call(I.prototype),I.prototype.clone=function(){return new I(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},I.error=function(){var e=new I(null,{status:200,statusText:""});return e.ok=!1,e.status=0,e.type="error",e};var S=[301,302,303,307,308];I.redirect=function(e,t){if(-1===S.indexOf(t))throw new RangeError("Invalid status code");return new I(null,{status:t,headers:{location:e}})},e.DOMException=t.DOMException;try{new e.DOMException}catch{e.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function O(r,n){return new Promise(function(i,o){var c=new v(r,n);if(c.signal&&c.signal.aborted)return o(new e.DOMException("Aborted","AbortError"));var l=new XMLHttpRequest;function h(){l.abort()}if(l.onload=function(){var e={statusText:l.statusText,headers:x(l.getAllResponseHeaders()||"")};e.status=0===c.url.indexOf("file://")&&(l.status<200||l.status>599)?200:l.status,e.url="responseURL"in l?l.responseURL:e.headers.get("X-Request-URL");var t="response"in l?l.response:l.responseText;setTimeout(function(){i(new I(t,e))},0)},l.onerror=function(){setTimeout(function(){o(new TypeError("Network request failed"))},0)},l.ontimeout=function(){setTimeout(function(){o(new TypeError("Network request timed out"))},0)},l.onabort=function(){setTimeout(function(){o(new e.DOMException("Aborted","AbortError"))},0)},l.open(c.method,function(e){try{return""===e&&t.location.href?t.location.href:e}catch{return e}}(c.url),!0),"include"===c.credentials?l.withCredentials=!0:"omit"===c.credentials&&(l.withCredentials=!1),"responseType"in l&&(s?l.responseType="blob":a&&(l.responseType="arraybuffer")),n&&"object"==typeof n.headers&&!(n.headers instanceof d||t.Headers&&n.headers instanceof t.Headers)){var p=[];Object.getOwnPropertyNames(n.headers).forEach(function(e){p.push(u(e)),l.setRequestHeader(e,f(n.headers[e]))}),c.headers.forEach(function(e,t){-1===p.indexOf(t)&&l.setRequestHeader(t,e)})}else c.headers.forEach(function(e,t){l.setRequestHeader(t,e)});c.signal&&(c.signal.addEventListener("abort",h),l.onreadystatechange=function(){4===l.readyState&&c.signal.removeEventListener("abort",h)}),l.send(void 0===c._bodyInit?null:c._bodyInit)})}O.polyfill=!0,t.fetch||(t.fetch=O,t.Headers=d,t.Request=v,t.Response=I),e.Headers=d,e.Request=v,e.Response=I,e.fetch=O,Object.defineProperty(e,"__esModule",{value:!0})}({}),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var s=n.fetch?n:i;(t=s.fetch).default=s.fetch,t.fetch=s.fetch,t.Headers=s.Headers,t.Request=s.Request,t.Response=s.Response,e.exports=t},97057:function(e,t,r){"use strict";r.d(t,{qY:function(){return h}});var n=function(e,t,r){if(r||2===arguments.length)for(var n,i=0,s=t.length;i<s;i++)(n||!(i in t))&&(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},i=function(e,t,r){this.name=e,this.version=t,this.os=r,this.type="browser"},s=function(e){this.version=e,this.type="node",this.name="node",this.os=process.platform},o=function(e,t,r,n){this.name=e,this.version=t,this.os=r,this.bot=n,this.type="bot-device"},a=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},c=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},l=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,u=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],f=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function h(e){return e?d(e):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new c:"undefined"!=typeof navigator?d(navigator.userAgent):"undefined"!=typeof process&&process.version?new s(process.version.slice(1)):null}function d(e){var t=function(e){return""!==e&&u.reduce(function(t,r){var n=r[0];if(t)return t;var i=r[1].exec(e);return!!i&&[n,i]},!1)}(e);if(!t)return null;var r=t[0],s=t[1];if("searchbot"===r)return new a;var c=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);c?c.length<3&&(c=n(n([],c,!0),function(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}(3-c.length),!0)):c=[];var h=c.join("."),d=function(e){for(var t=0,r=f.length;t<r;t++){var n=f[t],i=n[0];if(n[1].exec(e))return i}return null}(e),p=l.exec(e);return p&&p[1]?new o(r,h,d,p[1]):new i(r,h,d)}},93105:function(e){"use strict";var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise(function(r,n){function i(r){e.removeListener(t,s),n(r)}function s(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}g(e,t,s,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&g(e,"error",t,{once:!0})}(e,i)})},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var o=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function l(e,t,r,n){var i,s,o;if(a(r),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),o=s[t]),void 0===o)o=s[t]=r,++e._eventsCount;else if("function"==typeof o?o=s[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),(i=c(e))>0&&o.length>i&&!o.warned){o.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=o.length,function(e){console&&console.warn&&console.warn(e)}(l)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=u.bind(n);return i.listener=r,n.wrapFn=i,i}function h(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):p(i,i.length)}function d(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function p(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function g(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function i(s){n.once&&e.removeEventListener(t,i),r(s)})}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),s.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,s=this._events;if(void 0!==s)i=i&&void 0===s.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(void 0===c)return!1;if("function"==typeof c)n(c,this,t);else{var l=c.length,u=p(c,l);for(r=0;r<l;++r)n(u[r],this,t)}return!0},s.prototype.on=s.prototype.addListener=function(e,t){return l(this,e,t,!1)},s.prototype.prependListener=function(e,t){return l(this,e,t,!0)},s.prototype.once=function(e,t){return a(t),this.on(e,f(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,f(this,e,t)),this},s.prototype.off=s.prototype.removeListener=function(e,t){var r,n,i,s,o;if(a(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,s=r.length-1;s>=0;s--)if(r[s]===t||r[s].listener===t){o=r[s].listener,i=s;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,s=Object.keys(r);for(n=0;n<s.length;++n)"removeListener"!==(i=s[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},s.prototype.listeners=function(e){return h(this,e,!0)},s.prototype.rawListeners=function(e){return h(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},s.prototype.listenerCount=d,s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},33172:function(e,t,r){"use strict";r.r(t),r.d(t,{__extends:function(){return i},__assign:function(){return s},__rest:function(){return o},__decorate:function(){return a},__param:function(){return c},__metadata:function(){return l},__awaiter:function(){return u},__generator:function(){return f},__createBinding:function(){return h},__exportStar:function(){return d},__values:function(){return p},__read:function(){return g},__spread:function(){return y},__spreadArrays:function(){return m},__await:function(){return b},__asyncGenerator:function(){return w},__asyncDelegator:function(){return v},__asyncValues:function(){return E},__makeTemplateObject:function(){return x},__importStar:function(){return I},__importDefault:function(){return S},__classPrivateFieldGet:function(){return O},__classPrivateFieldSet:function(){return _}});var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function i(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var s=function(){return s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s.apply(this,arguments)};function o(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function a(e,t,r,n){var i,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,r,o):i(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o}function c(e,t){return function(r,n){t(r,n,e)}}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function u(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{c(n.next(e))}catch(t){s(t)}}function a(e){try{c(n.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,a)}c((n=n.apply(e,t||[])).next())})}function f(e,t){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(a){s=[6,a],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function h(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}function d(e,t){for(var r in e)"default"!==r&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function g(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(g(arguments[t]));return e}function m(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function w(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){i[e]&&(n[e]=function(t){return new Promise(function(r,n){s.push([e,t,r,n])>1||a(e,t)})})}function a(e,t){try{!function(e){e.value instanceof b?Promise.resolve(e.value.v).then(c,l):u(s[0][2],e)}(i[e](t))}catch(r){u(s[0][3],r)}}function c(e){a("next",e)}function l(e){a("throw",e)}function u(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function v(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:b(e[n](t)),done:"return"===n}:i?i(t):t}:i}}function E(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=p(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){!function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}(n,i,(t=e[r](t)).done,t.value)})}}}function x(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function I(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function S(e){return e&&e.__esModule?e:{default:e}}function O(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function _(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}},80017:function(e,t,r){"use strict";r.r(t),r.d(t,{__extends:function(){return i},__assign:function(){return s},__rest:function(){return o},__decorate:function(){return a},__param:function(){return c},__metadata:function(){return l},__awaiter:function(){return u},__generator:function(){return f},__createBinding:function(){return h},__exportStar:function(){return d},__values:function(){return p},__read:function(){return g},__spread:function(){return y},__spreadArrays:function(){return m},__await:function(){return b},__asyncGenerator:function(){return w},__asyncDelegator:function(){return v},__asyncValues:function(){return E},__makeTemplateObject:function(){return x},__importStar:function(){return I},__importDefault:function(){return S},__classPrivateFieldGet:function(){return O},__classPrivateFieldSet:function(){return _}});var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function i(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var s=function(){return s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s.apply(this,arguments)};function o(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function a(e,t,r,n){var i,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,r,o):i(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o}function c(e,t){return function(r,n){t(r,n,e)}}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function u(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{c(n.next(e))}catch(t){s(t)}}function a(e){try{c(n.throw(e))}catch(t){s(t)}}function c(e){e.done?i(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(o,a)}c((n=n.apply(e,t||[])).next())})}function f(e,t){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(a){s=[6,a],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function h(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}function d(e,t){for(var r in e)"default"!==r&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function g(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(g(arguments[t]));return e}function m(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function w(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){i[e]&&(n[e]=function(t){return new Promise(function(r,n){s.push([e,t,r,n])>1||a(e,t)})})}function a(e,t){try{!function(e){e.value instanceof b?Promise.resolve(e.value.v).then(c,l):u(s[0][2],e)}(i[e](t))}catch(r){u(s[0][3],r)}}function c(e){a("next",e)}function l(e){a("throw",e)}function u(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function v(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:b(e[n](t)),done:"return"===n}:i?i(t):t}:i}}function E(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=p(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){!function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}(n,i,(t=e[r](t)).done,t.value)})}}}function x(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function I(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function S(e){return e&&e.__esModule?e:{default:e}}function O(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function _(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}},24517:function(e,t,r){"use strict";function n(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function i(e,...t){if(!n(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function s(e,t){return!!Array.isArray(t)&&(0===t.length||t.every(e?e=>"string"==typeof e:e=>Number.isSafeInteger(e)))}function o(e){if("function"!=typeof e)throw new Error("function expected");return!0}function a(e,t){if("string"!=typeof t)throw new Error(`${e}: string expected`);return!0}function c(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function l(e){if(!Array.isArray(e))throw new Error("array expected")}function u(e,t){if(!s(!0,t))throw new Error(`${e}: array of strings expected`)}function f(e,t){if(!s(!1,t))throw new Error(`${e}: array of numbers expected`)}function h(...e){const t=e=>e,r=(e,t)=>r=>e(t(r));return{encode:e.map(e=>e.encode).reduceRight(r,t),decode:e.map(e=>e.decode).reduce(r,t)}}function d(e){const t="string"==typeof e?e.split(""):e,r=t.length;u("alphabet",t);const n=new Map(t.map((e,t)=>[e,t]));return{encode:n=>(l(n),n.map(n=>{if(!Number.isSafeInteger(n)||n<0||n>=r)throw new Error(`alphabet.encode: digit index outside alphabet "${n}". Allowed: ${e}`);return t[n]})),decode:t=>(l(t),t.map(t=>{a("alphabet.decode",t);const r=n.get(t);if(void 0===r)throw new Error(`Unknown letter: "${t}". Allowed: ${e}`);return r}))}}function p(e=""){return a("join",e),{encode:t=>(u("join.decode",t),t.join(e)),decode:t=>(a("join.decode",t),t.split(e))}}function g(e,t="="){return c(e),a("padding",t),{encode(r){for(u("padding.encode",r);r.length*e%8;)r.push(t);return r},decode(r){u("padding.decode",r);let n=r.length;if(n*e%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;n>0&&r[n-1]===t;n--)if((n-1)*e%8==0)throw new Error("padding: invalid, string has too much padding");return r.slice(0,n)}}}function y(e){return o(e),{encode:e=>e,decode:t=>e(t)}}function m(e,t,r){if(t<2)throw new Error(`convertRadix: invalid from=${t}, base cannot be less than 2`);if(r<2)throw new Error(`convertRadix: invalid to=${r}, base cannot be less than 2`);if(l(e),!e.length)return[];let n=0;const i=[],s=Array.from(e,e=>{if(c(e),e<0||e>=t)throw new Error(`invalid integer: ${e}`);return e}),o=s.length;for(;;){let e=0,a=!0;for(let i=n;i<o;i++){const o=s[i],c=t*e,l=c+o;if(!Number.isSafeInteger(l)||c/t!==e||l-o!==c)throw new Error("convertRadix: carry overflow");e=l%r;const u=Math.floor(l/r);if(s[i]=u,!Number.isSafeInteger(u)||u*r+e!==l)throw new Error("convertRadix: carry overflow");a&&(u?a=!1:n=i)}if(i.push(e),a)break}for(let a=0;a<e.length-1&&0===e[a];a++)i.push(0);return i.reverse()}r.d(t,{pJ:function(){return S},Jq:function(){return A}});const b=(e,t)=>0===t?e:b(t,e%t),w=(e,t)=>e+(t-b(e,t)),v=(()=>{let e=[];for(let t=0;t<40;t++)e.push(2**t);return e})();function E(e,t,r,n){if(l(e),t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(r<=0||r>32)throw new Error(`convertRadix2: wrong to=${r}`);if(w(t,r)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${r} carryBits=${w(t,r)}`);let i=0,s=0;const o=v[t],a=v[r]-1,u=[];for(const l of e){if(c(l),l>=o)throw new Error(`convertRadix2: invalid data word=${l} from=${t}`);if(i=i<<t|l,s+t>32)throw new Error(`convertRadix2: carry overflow pos=${s} from=${t}`);for(s+=t;s>=r;s-=r)u.push((i>>s-r&a)>>>0);const e=v[s];if(void 0===e)throw new Error("invalid carry");i&=e-1}if(i=i<<r-s&a,!n&&s>=t)throw new Error("Excess padding");if(!n&&i>0)throw new Error(`Non-zero padding: ${i}`);return n&&s>0&&u.push(i>>>0),u}function x(e,t=!1){if(c(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(w(8,e)>32||w(e,8)>32)throw new Error("radix2: carry overflow");return{encode:r=>{if(!n(r))throw new Error("radix2.encode input should be Uint8Array");return E(Array.from(r),8,e,!t)},decode:r=>(f("radix2.decode",r),Uint8Array.from(E(r,e,8,t)))}}function I(e){return o(e),function(...t){try{return e.apply(null,t)}catch{}}}h(x(4),d("0123456789ABCDEF"),p(""));const S=h(x(5),d("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),g(5),p("")),O=(h(x(5),d("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),p("")),h(x(5),d("0123456789ABCDEFGHIJKLMNOPQRSTUV"),g(5),p("")),h(x(5),d("0123456789ABCDEFGHIJKLMNOPQRSTUV"),p("")),h(x(5),d("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),p(""),y(e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),(()=>"function"==typeof Uint8Array.from([]).toBase64&&"function"==typeof Uint8Array.fromBase64)()),_=(e,t)=>{a("base64",e);const r=t?"base64url":"base64";if(e.length>0&&!(t?/^[A-Za-z0-9=_-]+$/:/^[A-Za-z0-9=+/]+$/).test(e))throw new Error("invalid base64");return Uint8Array.fromBase64(e,{alphabet:r,lastChunkHandling:"strict"})},P=(O||h(x(6),d("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),g(6),p("")),h(x(6),d("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),p("")),O||h(x(6),d("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),g(6),p("")),h(x(6),d("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),p("")),e=>h(function(e){return c(e),{encode:t=>{if(!n(t))throw new Error("radix.encode input should be Uint8Array");return m(Array.from(t),256,e)},decode:t=>(f("radix.decode",t),Uint8Array.from(m(t,e,256)))}}(58),d(e),p(""))),A=P("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),R=(P("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),P("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz"),h(d("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),p(""))),T=[996825010,642813549,513874426,1027748829,705979059];function B(e){const t=e>>25;let r=(33554431&e)<<5;for(let n=0;n<T.length;n++)1==(t>>n&1)&&(r^=T[n]);return r}function C(e,t,r=1){const n=e.length;let i=1;for(let s=0;s<n;s++){const t=e.charCodeAt(s);if(t<33||t>126)throw new Error(`Invalid prefix (${e})`);i=B(i)^t>>5}i=B(i);for(let s=0;s<n;s++)i=B(i)^31&e.charCodeAt(s);for(let s of t)i=B(i)^s;for(let s=0;s<6;s++)i=B(i);return i^=r,R.encode(E([i%v[30]],30,5,!1))}function U(e){const t="bech32"===e?1:734539939,r=x(5),i=r.decode,s=r.encode,o=I(i);function c(e,r,i=90){a("bech32.encode prefix",e),n(r)&&(r=Array.from(r)),f("bech32.encode",r);const s=e.length;if(0===s)throw new TypeError(`Invalid prefix length ${s}`);const o=s+7+r.length;if(!1!==i&&o>i)throw new TypeError(`Length ${o} exceeds limit ${i}`);const c=e.toLowerCase(),l=C(c,r,t);return`${c}1${R.encode(r)}${l}`}function l(e,r=90){a("bech32.decode input",e);const n=e.length;if(n<8||!1!==r&&n>r)throw new TypeError(`invalid string length: ${n} (${e}). Expected (8..${r})`);const i=e.toLowerCase();if(e!==i&&e!==e.toUpperCase())throw new Error("String must be lowercase or uppercase");const s=i.lastIndexOf("1");if(0===s||-1===s)throw new Error('Letter "1" must be present between prefix and data only');const o=i.slice(0,s),c=i.slice(s+1);if(c.length<6)throw new Error("Data must be at least 6 characters long");const l=R.decode(c).slice(0,-6),u=C(o,l,t);if(!c.endsWith(u))throw new Error(`Invalid checksum in ${e}: expected "${u}"`);return{prefix:o,words:l}}return{encode:c,decode:l,encodeFromBytes:function(e,t){return c(e,s(t))},decodeToBytes:function(e){const{prefix:t,words:r}=l(e,!1);return{prefix:t,words:r,bytes:i(r)}},decodeUnsafe:I(l),fromWords:i,fromWordsUnsafe:o,toWords:s}}U("bech32"),U("bech32m"),(()=>"function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex)()||h(x(4),d("0123456789abcdef"),p(""),y(e=>{if("string"!=typeof e||e.length%2!=0)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()}))},86202:function(e,t,r){"use strict";r.r(t),r.d(t,{EthereumProvider:function(){return vd},OPTIONAL_EVENTS:function(){return sd},OPTIONAL_METHODS:function(){return nd},REQUIRED_EVENTS:function(){return id},REQUIRED_METHODS:function(){return rd},default:function(){return wd}});var n=r(8239),i=r(93105),s=r(97057),o=r(14611),a=r(37167),c=r(78359),l=r(13324),u=r(4180),f=r(5640),h=r(48415),d=r(19663);function p(e){return`${e<0?"-":""}0x${Math.abs(e).toString(16).padStart(2,"0")}`}class g{constructor(e,t){ln(this,"type"),ln(this,"data"),this.type=e,this.data=t}}class y extends Error{constructor(e){super(e);const t=Object.create(y.prototype);Object.setPrototypeOf(this,t),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:y.name})}}const m=4294967295;function b(e,t,r){const n=Math.floor(r/4294967296),i=r;e.setUint32(t,n),e.setUint32(t+4,i)}function w(e,t){return 4294967296*e.getInt32(t)+e.getUint32(t+4)}const v={type:-1,encode:function(e){if(e instanceof Date){const t=function(e){const t=e.getTime(),r=Math.floor(t/1e3),n=1e6*(t-1e3*r),i=Math.floor(n/1e9);return{sec:r+i,nsec:n-1e9*i}}(e);return function({sec:e,nsec:t}){if(e>=0&&t>=0&&e<=17179869183){if(0===t&&e<=4294967295){const t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e),t}{const r=e/4294967296,n=4294967295&e,i=new Uint8Array(8),s=new DataView(i.buffer);return s.setUint32(0,t<<2|3&r),s.setUint32(4,n),i}}{const r=new Uint8Array(12),n=new DataView(r.buffer);return n.setUint32(0,t),b(n,4,e),r}}(t)}return null},decode:function(e){const t=function(e){const t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:t.getUint32(0),nsec:0};case 8:{const e=t.getUint32(0);return{sec:4294967296*(3&e)+t.getUint32(4),nsec:e>>>2}}case 12:return{sec:w(t,4),nsec:t.getUint32(0)};default:throw new y(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${e.length}`)}}(e);return new Date(1e3*t.sec+t.nsec/1e6)}},E=class{constructor(){ln(this,"__brand"),ln(this,"builtInEncoders",[]),ln(this,"builtInDecoders",[]),ln(this,"encoders",[]),ln(this,"decoders",[]),this.register(v)}register({type:e,encode:t,decode:r}){if(e>=0)this.encoders[e]=t,this.decoders[e]=r;else{const n=-1-e;this.builtInEncoders[n]=t,this.builtInDecoders[n]=r}}tryToEncode(e,t){for(let r=0;r<this.builtInEncoders.length;r++){const n=this.builtInEncoders[r];if(null!=n){const i=n(e,t);if(null!=i)return new g(-1-r,i)}}for(let r=0;r<this.encoders.length;r++){const n=this.encoders[r];if(null!=n){const i=n(e,t);if(null!=i)return new g(r,i)}}return e instanceof g?e:null}decode(e,t,r){const n=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return n?n(e,t,r):new g(t,e)}};let x=E;ln(x,"defaultCodec",new E);const I=new TextEncoder;function S(e,t,r){let n=t;const i=n+r,s=[];let o="";for(;n<i;){const t=e[n++];if(0==(128&t))s.push(t);else if(192==(224&t)){const r=63&e[n++];s.push((31&t)<<6|r)}else if(224==(240&t)){const r=63&e[n++],i=63&e[n++];s.push((31&t)<<12|r<<6|i)}else if(240==(248&t)){let r=(7&t)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++];r>65535&&(r-=65536,s.push(r>>>10&1023|55296),r=56320|1023&r),s.push(r)}else s.push(t);s.length>=4096&&(o+=String.fromCharCode(...s),s.length=0)}return s.length>0&&(o+=String.fromCharCode(...s)),o}const O=new TextDecoder;function _(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):function(e){return e instanceof ArrayBuffer||"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer}(e)?new Uint8Array(e):Uint8Array.from(e)}function P(e){var t,r,n,i=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);i--;){if(r&&null!=(t=e[r]))return t.call(e);if(n&&null!=(t=e[n]))return new A(t.call(e));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function A(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return(A=function(e){this.s=e,this.n=e.next}).prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var r=this.s.return;return void 0===r?Promise.resolve({value:e,done:!0}):t(r.apply(this.s,arguments))},throw:function(e){var r=this.s.return;return void 0===r?Promise.reject(e):t(r.apply(this.s,arguments))}},new A(e)}const R="array",T="map_key",B="map_value",C=e=>{if("string"==typeof e||"number"==typeof e)return e;throw new y("The type of key must be string or number but "+typeof e)};class U{constructor(){ln(this,"stack",[]),ln(this,"stackHeadPosition",-1)}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const t=this.getUninitializedStateFromPool();t.type=R,t.position=0,t.size=e,t.array=new Array(e)}pushMapState(e){const t=this.getUninitializedStateFromPool();t.type=T,t.readCount=0,t.size=e,t.map={}}getUninitializedStateFromPool(){return this.stackHeadPosition++,this.stackHeadPosition===this.stack.length&&this.stack.push({type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null}),this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===R){const t=e;t.size=0,t.array=void 0,t.position=0,t.type=void 0}if(e.type===T||e.type===B){const t=e;t.size=0,t.map=void 0,t.readCount=0,t.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const N=new DataView(new ArrayBuffer(0)),k=new Uint8Array(N.buffer);try{N.getInt8(0)}catch(qt){if(!(qt instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const j=new RangeError("Insufficient data"),L=new class{constructor(e=16,t=16){ln(this,"hit",0),ln(this,"miss",0),ln(this,"caches"),ln(this,"maxKeyLength"),ln(this,"maxLengthPerKey"),this.maxKeyLength=e,this.maxLengthPerKey=t,this.caches=[];for(let r=0;r<this.maxKeyLength;r++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,t,r){const n=this.caches[r-1];e:for(const i of n){const n=i.bytes;for(let i=0;i<r;i++)if(n[i]!==e[t+i])continue e;return i.str}return null}store(e,t){const r=this.caches[e.length-1],n={bytes:e,str:t};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=n:r.push(n)}decode(e,t,r){const n=this.find(e,t,r);if(null!=n)return this.hit++,n;this.miss++;const i=S(e,t,r),s=Uint8Array.prototype.slice.call(e,t,t+r);return this.store(s,i),i}};class D{constructor(e){ln(this,"extensionCodec"),ln(this,"context"),ln(this,"useBigInt64"),ln(this,"rawStrings"),ln(this,"maxStrLength"),ln(this,"maxBinLength"),ln(this,"maxArrayLength"),ln(this,"maxMapLength"),ln(this,"maxExtLength"),ln(this,"keyDecoder"),ln(this,"mapKeyConverter"),ln(this,"totalPos",0),ln(this,"pos",0),ln(this,"view",N),ln(this,"bytes",k),ln(this,"headByte",-1),ln(this,"stack",new U),ln(this,"entered",!1),this.extensionCodec=e?.extensionCodec??x.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.rawStrings=e?.rawStrings??!1,this.maxStrLength=e?.maxStrLength??m,this.maxBinLength=e?.maxBinLength??m,this.maxArrayLength=e?.maxArrayLength??m,this.maxMapLength=e?.maxMapLength??m,this.maxExtLength=e?.maxExtLength??m,this.keyDecoder=void 0!==e?.keyDecoder?e.keyDecoder:L,this.mapKeyConverter=e?.mapKeyConverter??C}clone(){return new D({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=-1,this.stack.reset()}setBuffer(e){const t=_(e);this.bytes=t,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength),this.pos=0}appendBuffer(e){if(-1!==this.headByte||this.hasRemaining(1)){const t=this.bytes.subarray(this.pos),r=_(e),n=new Uint8Array(t.length+r.length);n.set(t),n.set(r,t.length),this.setBuffer(n)}else this.setBuffer(e)}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:t,pos:r}=this;return new RangeError(`Extra ${t.byteLength-r} of ${t.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t}finally{this.entered=!1}}*decodeMulti(e){if(this.entered)yield*this.clone().decodeMulti(e);else try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}decodeAsync(e){var t=this;return(0,n.Z)(function*(){if(t.entered)return t.clone().decodeAsync(e);try{t.entered=!0;let u,f=!1;var r,n=!0,i=!1;try{for(var s,o,a=P(e);n=(s=yield a.next()).done,o=yield s.value,!n;n=!0){const e=o;if(f)throw t.entered=!1,t.createExtraByteError(t.totalPos);t.appendBuffer(e);try{u=t.doDecodeSync(),f=!0}catch(c){if(!(c instanceof RangeError))throw c}t.totalPos+=t.pos}}catch(l){i=!0,r=l}finally{try{!n&&null!=a.return&&(yield a.return())}finally{if(i)throw r}}if(f){if(t.hasRemaining(1))throw t.createExtraByteError(t.totalPos);return u}const{headByte:h,pos:d,totalPos:g}=t;throw new RangeError(`Insufficient data in parsing ${p(h)} at ${g} (${d} in the current buffer)`)}finally{t.entered=!1}})()}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}decodeMultiAsync(e,t){var r=this;return(0,f.Z)(function*(){if(r.entered){const n=r.clone();yield*(0,d.Z)(P(n.decodeMultiAsync(e,t)),h.Z)}else try{r.entered=!0;let f=t,d=-1;var n,i=!0,s=!1;try{for(var o,a,c=P(e);i=(o=yield(0,h.Z)(c.next())).done,a=yield(0,h.Z)(o.value),!i;i=!0){const e=a;if(t&&0===d)throw r.createExtraByteError(r.totalPos);r.appendBuffer(e),f&&(d=r.readArraySize(),f=!1,r.complete());try{for(;yield r.doDecodeSync(),0!=--d;);}catch(l){if(!(l instanceof RangeError))throw l}r.totalPos+=r.pos}}catch(u){s=!0,n=u}finally{try{!i&&null!=c.return&&(yield(0,h.Z)(c.return()))}finally{if(s)throw n}}}finally{r.entered=!1}})()}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let t;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){const r=e-128;if(0!==r){this.pushMapState(r),this.complete();continue e}t={}}else if(e<160){const r=e-144;if(0!==r){this.pushArrayState(r),this.complete();continue e}t=[]}else t=this.decodeString(e-160,0);else if(192===e)t=null;else if(194===e)t=!1;else if(195===e)t=!0;else if(202===e)t=this.readF32();else if(203===e)t=this.readF64();else if(204===e)t=this.readU8();else if(205===e)t=this.readU16();else if(206===e)t=this.readU32();else if(207===e)t=this.useBigInt64?this.readU64AsBigInt():this.readU64();else if(208===e)t=this.readI8();else if(209===e)t=this.readI16();else if(210===e)t=this.readI32();else if(211===e)t=this.useBigInt64?this.readI64AsBigInt():this.readI64();else if(217===e){const e=this.lookU8();t=this.decodeString(e,1)}else if(218===e){const e=this.lookU16();t=this.decodeString(e,2)}else if(219===e){const e=this.lookU32();t=this.decodeString(e,4)}else if(220===e){const e=this.readU16();if(0!==e){this.pushArrayState(e),this.complete();continue e}t=[]}else if(221===e){const e=this.readU32();if(0!==e){this.pushArrayState(e),this.complete();continue e}t=[]}else if(222===e){const e=this.readU16();if(0!==e){this.pushMapState(e),this.complete();continue e}t={}}else if(223===e){const e=this.readU32();if(0!==e){this.pushMapState(e),this.complete();continue e}t={}}else if(196===e){const e=this.lookU8();t=this.decodeBinary(e,1)}else if(197===e){const e=this.lookU16();t=this.decodeBinary(e,2)}else if(198===e){const e=this.lookU32();t=this.decodeBinary(e,4)}else if(212===e)t=this.decodeExtension(1,0);else if(213===e)t=this.decodeExtension(2,0);else if(214===e)t=this.decodeExtension(4,0);else if(215===e)t=this.decodeExtension(8,0);else if(216===e)t=this.decodeExtension(16,0);else if(199===e){const e=this.lookU8();t=this.decodeExtension(e,1)}else if(200===e){const e=this.lookU16();t=this.decodeExtension(e,2)}else{if(201!==e)throw new y(`Unrecognized type byte: ${p(e)}`);{const e=this.lookU32();t=this.decodeExtension(e,4)}}this.complete();const r=this.stack;for(;r.length>0;){const e=r.top();if(e.type===R){if(e.array[e.position]=t,e.position++,e.position!==e.size)continue e;t=e.array,r.release(e)}else{if(e.type===T){if("__proto__"===t)throw new y("The key __proto__ is not allowed");e.key=this.mapKeyConverter(t),e.type=B;continue e}if(e.map[e.key]=t,e.readCount++,e.readCount!==e.size){e.key=null,e.type=T;continue e}t=e.map,r.release(e)}}return t}}readHeadByte(){return-1===this.headByte&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=-1}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:if(e<160)return e-144;throw new y(`Unrecognized array type byte: ${p(e)}`)}}pushMapState(e){if(e>this.maxMapLength)throw new y(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new y(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,t){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,t):this.decodeBinary(e,t)}decodeUtf8String(e,t){if(e>this.maxStrLength)throw new y(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+t+e)throw j;const r=this.pos+t;let n;return n=this.stateIsMapKey()&&this.keyDecoder?.canBeCached(e)?this.keyDecoder.decode(this.bytes,r,e):function(e,t,r){return r>200?function(e,t,r){const n=e.subarray(t,t+r);return O.decode(n)}(e,t,r):S(e,t,r)}(this.bytes,r,e),this.pos+=t+e,n}stateIsMapKey(){return this.stack.length>0&&this.stack.top().type===T}decodeBinary(e,t){if(e>this.maxBinLength)throw new y(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+t))throw j;const r=this.pos+t,n=this.bytes.subarray(r,r+e);return this.pos+=t+e,n}decodeExtension(e,t){if(e>this.maxExtLength)throw new y(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const r=this.view.getInt8(this.pos+t),n=this.decodeBinary(e,t+1);return this.extensionCodec.decode(n,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=function(e,t){return 4294967296*e.getUint32(t)+e.getUint32(t+4)}(this.view,this.pos);return this.pos+=8,e}readI64(){const e=w(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}}class q{constructor(e){ln(this,"extensionCodec"),ln(this,"context"),ln(this,"useBigInt64"),ln(this,"maxDepth"),ln(this,"initialBufferSize"),ln(this,"sortKeys"),ln(this,"forceFloat32"),ln(this,"ignoreUndefined"),ln(this,"forceIntegerToFloat"),ln(this,"pos"),ln(this,"view"),ln(this,"bytes"),ln(this,"entered",!1),this.extensionCodec=e?.extensionCodec??x.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.maxDepth=e?.maxDepth??100,this.initialBufferSize=e?.initialBufferSize??2048,this.sortKeys=e?.sortKeys??!1,this.forceFloat32=e?.forceFloat32??!1,this.ignoreUndefined=e?.ignoreUndefined??!1,this.forceIntegerToFloat=e?.forceIntegerToFloat??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new q({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,t){if(t>this.maxDepth)throw new Error(`Too deep objects in depth ${t}`);null==e?this.encodeNil():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.useBigInt64&&"bigint"==typeof e?this.encodeBigInt64(e):this.encodeObject(e,t)}ensureBufferSizeToWrite(e){const t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)}resizeBuffer(e){const t=new ArrayBuffer(e),r=new Uint8Array(t),n=new DataView(t);r.set(this.bytes),this.view=n,this.bytes=r}encodeNil(){this.writeU8(192)}encodeBoolean(e){this.writeU8(!1===e?194:195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else{if(!(e<4294967296))throw new Error(`Too long string: ${e} bytes in UTF-8`);this.writeU8(219),this.writeU32(e)}}encodeString(e){const t=function(e){const t=e.length;let r=0,n=0;for(;n<t;){let i=e.charCodeAt(n++);if(0!=(4294967168&i))if(0==(4294965248&i))r+=2;else{if(i>=55296&&i<=56319&&n<t){const t=e.charCodeAt(n);56320==(64512&t)&&(++n,i=((1023&i)<<10)+(1023&t)+65536)}r+=0==(4294901760&i)?3:4}else r++}return r}(e);this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),function(e,t,r){e.length>50?function(e,t,r){I.encodeInto(e,t.subarray(r))}(e,t,r):function(e,t,r){const n=e.length;let i=r,s=0;for(;s<n;){let r=e.charCodeAt(s++);if(0!=(4294967168&r)){if(0==(4294965248&r))t[i++]=r>>6&31|192;else{if(r>=55296&&r<=56319&&s<n){const t=e.charCodeAt(s);56320==(64512&t)&&(++s,r=((1023&r)<<10)+(1023&t)+65536)}0==(4294901760&r)?(t[i++]=r>>12&15|224,t[i++]=r>>6&63|128):(t[i++]=r>>18&7|240,t[i++]=r>>12&63|128,t[i++]=r>>6&63|128)}t[i++]=63&r|128}else t[i++]=r}}(e,t,r)}(e,this.bytes,this.pos),this.pos+=t}encodeObject(e,t){const r=this.extensionCodec.tryToEncode(e,this.context);if(null!=r)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else{if("object"!=typeof e)throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`);this.encodeMap(e,t)}}encodeBinary(e){const t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else{if(!(t<4294967296))throw new Error(`Too large binary: ${t}`);this.writeU8(198),this.writeU32(t)}const r=_(e);this.writeU8a(r)}encodeArray(e,t){const r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else{if(!(r<4294967296))throw new Error(`Too large array: ${r}`);this.writeU8(221),this.writeU32(r)}for(const n of e)this.doEncode(n,t+1)}countWithoutUndefined(e,t){let r=0;for(const n of t)void 0!==e[n]&&r++;return r}encodeMap(e,t){const r=Object.keys(e);this.sortKeys&&r.sort();const n=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(n<16)this.writeU8(128+n);else if(n<65536)this.writeU8(222),this.writeU16(n);else{if(!(n<4294967296))throw new Error(`Too large map object: ${n}`);this.writeU8(223),this.writeU32(n)}for(const i of r){const r=e[i];this.ignoreUndefined&&void 0===r||(this.encodeString(i),this.doEncode(r,t+1))}}encodeExtension(e){if("function"==typeof e.data){const t=e.data(this.pos+6),r=t.length;if(r>=4294967296)throw new Error(`Too large extension object: ${r}`);return this.writeU8(201),this.writeU32(r),this.writeI8(e.type),void this.writeU8a(t)}const t=e.data.length;if(1===t)this.writeU8(212);else if(2===t)this.writeU8(213);else if(4===t)this.writeU8(214);else if(8===t)this.writeU8(215);else if(16===t)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else{if(!(t<4294967296))throw new Error(`Too large extension object: ${t}`);this.writeU8(201),this.writeU32(t)}this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),function(e,t,r){const n=r;e.setUint32(t,r/4294967296),e.setUint32(t+4,n)}(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),b(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}}var M=r(24517),$=r(29168),z=r(51462),Z=r(63840),F=r(40187),K=r(14616);function V(e){const[t,r]=e.split(":");return{namespace:t,reference:r}}function H(e,t=[]){const r=[];return Object.keys(e).forEach(n=>{t.length&&!t.includes(n)||r.push(...e[n].accounts)}),r}function W(e,t){return e.includes(":")?[e]:t.chains||[]}var G=Object.defineProperty,J=Object.defineProperties,Y=Object.getOwnPropertyDescriptors,Q=Object.getOwnPropertySymbols,X=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable,te=(e,t,r)=>t in e?G(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,re=(e,t)=>{for(var r in t||(t={}))X.call(t,r)&&te(e,r,t[r]);if(Q)for(var r of Q(t))ee.call(t,r)&&te(e,r,t[r]);return e},ne=(e,t,r)=>te(e,"symbol"!=typeof t?t+"":t,r);const ie="js";function se(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function oe(){return!(0,a.getDocument)()&&!!(0,a.getNavigator)()&&"ReactNative"===navigator.product}function ae(){return!se()&&!!(0,a.getNavigator)()&&!!(0,a.getDocument)()}function ce(){return oe()?"react-native":se()?"node":ae()?"browser":"unknown"}function le(){var e;try{return oe()&&typeof global<"u"&&typeof(null==global?void 0:global.Application)<"u"?null==(e=global.Application)?void 0:e.applicationId:void 0}catch{return}}function ue(){return(0,c.D)()||{name:"",description:"",url:"",icons:[""]}}function fe(e,t,r){const n=function(){if("react-native"===ce()&&typeof global<"u"&&typeof(null==global?void 0:global.Platform)<"u"){const{OS:e,Version:t}=global.Platform;return[e,t].join("-")}const e=(0,s.qY)();if(null===e)return"unknown";const t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return"browser"===e.type?[t,e.name,e.version].join("-"):[t,e.version].join("-")}(),i=function(){var e;const t=ce();return"browser"===t?[t,(null==(e=(0,a.getLocation)())?void 0:e.host)||"unknown"].join(":"):t}();return[[e,t].join("-"),[ie,r].join("-"),n,i].join("/")}function he(e,t){return e.filter(e=>t.includes(e)).length===e.length}function de(e){return Object.fromEntries(e.entries())}function pe(e){return new Map(Object.entries(e))}function ge(e=o.FIVE_MINUTES,t){const r=(0,o.toMiliseconds)(e||o.FIVE_MINUTES);let n,i,s,a;return{resolve:e=>{s&&n&&(clearTimeout(s),n(e),a=Promise.resolve(e))},reject:e=>{s&&i&&(clearTimeout(s),i(e))},done:()=>new Promise((e,o)=>{if(a)return e(a);s=setTimeout(()=>{const e=new Error(t);a=Promise.reject(e),o(e)},r),n=e,i=o})}}function ye(e,t,r){return new Promise(function(){var i=(0,n.Z)(function*(n,i){const s=setTimeout(()=>i(new Error(r)),t);try{n(yield e)}catch(o){i(o)}clearTimeout(s)});return function(e,t){return i.apply(this,arguments)}}())}function me(e,t){if("string"==typeof t&&t.startsWith(`${e}:`))return t;if("topic"===e.toLowerCase()){if("string"!=typeof t)throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}if("id"===e.toLowerCase()){if("number"!=typeof t)throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${e}`)}function be(e){const[t,r]=e.split(":"),n={id:void 0,topic:void 0};if("topic"===t&&"string"==typeof r)n.topic=r;else{if("id"!==t||!Number.isInteger(Number(r)))throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);n.id=Number(r)}return n}function we(e,t){return(0,o.fromMiliseconds)((t||Date.now())+(0,o.toMiliseconds)(e))}function ve(e){return Date.now()>=(0,o.toMiliseconds)(e)}function Ee(e,t){return`${e}${t?`:${t}`:""}`}function xe(e=[],t=[]){return[...new Set([...e,...t])]}function Ie(){return(Ie=(0,n.Z)(function*({id:e,topic:t,wcDeepLink:r}){var n;try{if(!r)return;const i=("string"==typeof r?JSON.parse(r):r)?.href;if("string"!=typeof i)return;const s=Se(i,e,t),o=ce();if("browser"===o){if(null==(n=(0,a.getDocument)())||!n.hasFocus())return void console.warn("Document does not have focus, skipping deeplink.");Oe(s)}else"react-native"===o&&typeof(null==global?void 0:global.Linking)<"u"&&(yield global.Linking.openURL(s))}catch(i){console.error(i)}})).apply(this,arguments)}function Se(e,t,r){const n=`requestId=${t}&sessionTopic=${r}`;e.endsWith("/")&&(e=e.slice(0,-1));let i=`${e}`;return i=e.startsWith("https://t.me")?`${i}${e.includes("?")?"&startapp=":"?startapp="}${function(e,t=!1){const r=Buffer.from(e).toString("base64");return t?r.replace(/[=]/g,""):r}(n,!0)}`:`${i}/wc?${n}`,i}function Oe(e){let t="_self";!function(){try{return window.self!==window.top}catch{return!1}}()?(typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)||e.startsWith("https://")||e.startsWith("http://"))&&(t="_blank"):t="_top",window.open(e,t,"noreferrer noopener")}function _e(){return(_e=(0,n.Z)(function*(e,t){let r="";try{if(ae()&&(r=localStorage.getItem(t),r))return r;r=yield e.getItem(t)}catch(n){console.error(n)}return r})).apply(this,arguments)}function Pe(e,t){if(!e.includes(t))return null;const r=e.split(/([&,?,=])/),n=r.indexOf(t);return r[n+2]}function Ae(){return typeof crypto<"u"&&null!=crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function Re(){return typeof process<"u"&&"true"===process.env.IS_VITEST}function Te(e){return Buffer.from(e,"base64").toString("utf-8")}class Be{constructor({limit:e}){ne(this,"limit"),ne(this,"set"),this.limit=e,this.set=new Set}add(e){if(!this.set.has(e)){if(this.set.size>=this.limit){const e=this.set.values().next().value;e&&this.set.delete(e)}this.set.add(e)}}has(e){return this.set.has(e)}}const Ce=BigInt(2**32-1),Ue=BigInt(32);function Ne(e,t=!1){return t?{h:Number(e&Ce),l:Number(e>>Ue&Ce)}:{h:0|Number(e>>Ue&Ce),l:0|Number(e&Ce)}}function ke(e,t=!1){const r=e.length;let n=new Uint32Array(r),i=new Uint32Array(r);for(let s=0;s<r;s++){const{h:r,l:o}=Ne(e[s],t);[n[s],i[s]]=[r,o]}return[n,i]}const je=(e,t,r)=>e>>>r,Le=(e,t,r)=>e<<32-r|t>>>r,De=(e,t,r)=>e>>>r|t<<32-r,qe=(e,t,r)=>e<<32-r|t>>>r,Me=(e,t,r)=>e<<64-r|t>>>r-32,$e=(e,t,r)=>e>>>r-32|t<<64-r,ze=(e,t)=>t,Ze=(e,t)=>e;function Fe(e,t,r,n){const i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:0|i}}const Ke=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),Ve=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,He=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),We=(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0,Ge=(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0),Je=(e,t,r,n,i,s)=>t+r+n+i+s+(e/2**32|0)|0,Ye="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function Qe(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function Xe(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function et(e,...t){if(!Qe(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function tt(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.createHasher");Xe(e.outputLen),Xe(e.blockLen)}function rt(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function nt(e,t){et(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function it(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function st(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function ot(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function at(e,t){return e<<32-t|e>>>t}const ct=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];function lt(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}const ut=ct?e=>e:e=>lt(e),ft=ct?e=>e:function(e){for(let t=0;t<e.length;t++)e[t]=lt(e[t]);return e},ht="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,dt=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function pt(e){if(et(e),ht)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=dt[e[r]];return t}function gt(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}function yt(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);if(ht)return Uint8Array.fromHex(e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){const t=gt(e.charCodeAt(s)),r=gt(e.charCodeAt(s+1));if(void 0===t||void 0===r)throw new Error('hex string expected, got non-hex character "'+(e[s]+e[s+1])+'" at index '+s);n[i]=16*t+r}return n}function mt(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}function bt(e){return"string"==typeof e&&(e=mt(e)),et(e),e}function wt(...e){let t=0;for(let n=0;n<e.length;n++){const r=e[n];et(r),t+=r.length}const r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){const t=e[n];r.set(t,i),i+=t.length}return r}class vt{}function Et(e){const t=t=>e().update(bt(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function xt(e=32){if(Ye&&"function"==typeof Ye.getRandomValues)return Ye.getRandomValues(new Uint8Array(e));if(Ye&&"function"==typeof Ye.randomBytes)return Uint8Array.from(Ye.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}const It=BigInt(0),St=BigInt(1),Ot=BigInt(2),_t=BigInt(7),Pt=BigInt(256),At=BigInt(113),Rt=[],Tt=[],Bt=[];for(let ln=0,Nd=St,kd=1,jd=0;ln<24;ln++){[kd,jd]=[jd,(2*kd+3*jd)%5],Rt.push(2*(5*jd+kd)),Tt.push((ln+1)*(ln+2)/2%64);let e=It;for(let t=0;t<7;t++)Nd=(Nd<<St^(Nd>>_t)*At)%Pt,Nd&Ot&&(e^=St<<(St<<BigInt(t))-St);Bt.push(e)}const Ct=ke(Bt,!0),Ut=Ct[0],Nt=Ct[1],kt=(e,t,r)=>r>32?((e,t,r)=>t<<r-32|e>>>64-r)(e,t,r):((e,t,r)=>e<<r|t>>>32-r)(e,t,r),jt=(e,t,r)=>r>32?((e,t,r)=>e<<r-32|t>>>64-r)(e,t,r):((e,t,r)=>t<<r|e>>>32-r)(e,t,r);class Lt extends vt{constructor(e,t,r,n=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=n,this.rounds=i,Xe(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=it(this.state)}clone(){return this._cloneInto()}keccak(){ft(this.state32),function(e,t=24){const r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let n=0;n<10;n++)r[n]=e[n]^e[n+10]^e[n+20]^e[n+30]^e[n+40];for(let n=0;n<10;n+=2){const t=(n+8)%10,i=(n+2)%10,s=r[i],o=r[i+1],a=kt(s,o,1)^r[t],c=jt(s,o,1)^r[t+1];for(let r=0;r<50;r+=10)e[n+r]^=a,e[n+r+1]^=c}let t=e[2],i=e[3];for(let r=0;r<24;r++){const n=Tt[r],s=kt(t,i,n),o=jt(t,i,n),a=Rt[r];t=e[a],i=e[a+1],e[a]=s,e[a+1]=o}for(let n=0;n<50;n+=10){for(let t=0;t<10;t++)r[t]=e[n+t];for(let t=0;t<10;t++)e[n+t]^=~r[(t+2)%10]&r[(t+4)%10]}e[0]^=Ut[n],e[1]^=Nt[n]}st(r)}(this.state32,this.rounds),ft(this.state32),this.posOut=0,this.pos=0}update(e){rt(this),et(e=bt(e));const{blockLen:t,state:r}=this,n=e.length;for(let i=0;i<n;){const s=Math.min(t-this.pos,n-i);for(let t=0;t<s;t++)r[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:n}=this;e[r]^=t,0!=(128&t)&&r===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}writeInto(e){rt(this,!1),et(e),this.finish();const t=this.state,{blockLen:r}=this;for(let n=0,i=e.length;n<i;){this.posOut>=r&&this.keccak();const s=Math.min(r-this.posOut,i-n);e.set(t.subarray(this.posOut,this.posOut+s),n),this.posOut+=s,n+=s}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Xe(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(nt(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,st(this.state)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:n,rounds:i,enableXOF:s}=this;return e||(e=new Lt(t,r,n,s,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=n,e.enableXOF=s,e.destroyed=this.destroyed,e}}const Dt=(qt=1,136,32,Et(()=>new Lt(136,1,32)));var qt;function Mt(e,t,r){return e&t^~e&r}function $t(e,t,r){return e&t^e&r^t&r}class zt extends vt{constructor(e,t,r,n){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=n,this.buffer=new Uint8Array(e),this.view=ot(this.buffer)}update(e){rt(this),et(e=bt(e));const{view:t,buffer:r,blockLen:n}=this,i=e.length;for(let s=0;s<i;){const o=Math.min(n-this.pos,i-s);if(o!==n)r.set(e.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===n&&(this.process(t,0),this.pos=0);else{const t=ot(e);for(;n<=i-s;s+=n)this.process(t,s)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){rt(this),nt(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:n,isLE:i}=this;let{pos:s}=this;t[s++]=128,st(this.buffer.subarray(s)),this.padOffset>n-s&&(this.process(r,0),s=0);for(let u=s;u<n;u++)t[u]=0;(function(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?0:4;e.setUint32(t+(n?4:0),o,n),e.setUint32(t+c,a,n)})(r,n-8,BigInt(8*this.length),i),this.process(r,0);const o=ot(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,l=this.get();if(c>l.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<c;u++)o.setUint32(4*u,l[u],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:n,finished:i,destroyed:s,pos:o}=this;return e.destroyed=s,e.finished=i,e.length=n,e.pos=o,n%t&&e.buffer.set(r),e}clone(){return this._cloneInto()}}const Zt=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ft=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Kt=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),Vt=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ht=new Uint32Array(64);class Wt extends zt{constructor(e=32){super(64,e,8,!1),this.A=0|Zt[0],this.B=0|Zt[1],this.C=0|Zt[2],this.D=0|Zt[3],this.E=0|Zt[4],this.F=0|Zt[5],this.G=0|Zt[6],this.H=0|Zt[7]}get(){const{A:e,B:t,C:r,D:n,E:i,F:s,G:o,H:a}=this;return[e,t,r,n,i,s,o,a]}set(e,t,r,n,i,s,o,a){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|s,this.G=0|o,this.H=0|a}process(e,t){for(let u=0;u<16;u++,t+=4)Ht[u]=e.getUint32(t,!1);for(let u=16;u<64;u++){const e=Ht[u-15],t=Ht[u-2],r=at(e,7)^at(e,18)^e>>>3,n=at(t,17)^at(t,19)^t>>>10;Ht[u]=n+Ht[u-7]+r+Ht[u-16]|0}let{A:r,B:n,C:i,D:s,E:o,F:a,G:c,H:l}=this;for(let u=0;u<64;u++){const e=l+(at(o,6)^at(o,11)^at(o,25))+Mt(o,a,c)+Vt[u]+Ht[u]|0,t=(at(r,2)^at(r,13)^at(r,22))+$t(r,n,i)|0;l=c,c=a,a=o,o=s+e|0,s=i,i=n,n=r,r=e+t|0}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,s=s+this.D|0,o=o+this.E|0,a=a+this.F|0,c=c+this.G|0,l=l+this.H|0,this.set(r,n,i,s,o,a,c,l)}roundClean(){st(Ht)}destroy(){this.set(0,0,0,0,0,0,0,0),st(this.buffer)}}const Gt=ke(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),Jt=Gt[0],Yt=Gt[1],Qt=new Uint32Array(80),Xt=new Uint32Array(80);class er extends zt{constructor(e=64){super(128,e,16,!1),this.Ah=0|Kt[0],this.Al=0|Kt[1],this.Bh=0|Kt[2],this.Bl=0|Kt[3],this.Ch=0|Kt[4],this.Cl=0|Kt[5],this.Dh=0|Kt[6],this.Dl=0|Kt[7],this.Eh=0|Kt[8],this.El=0|Kt[9],this.Fh=0|Kt[10],this.Fl=0|Kt[11],this.Gh=0|Kt[12],this.Gl=0|Kt[13],this.Hh=0|Kt[14],this.Hl=0|Kt[15]}get(){const{Ah:e,Al:t,Bh:r,Bl:n,Ch:i,Cl:s,Dh:o,Dl:a,Eh:c,El:l,Fh:u,Fl:f,Gh:h,Gl:d,Hh:p,Hl:g}=this;return[e,t,r,n,i,s,o,a,c,l,u,f,h,d,p,g]}set(e,t,r,n,i,s,o,a,c,l,u,f,h,d,p,g){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|s,this.Dh=0|o,this.Dl=0|a,this.Eh=0|c,this.El=0|l,this.Fh=0|u,this.Fl=0|f,this.Gh=0|h,this.Gl=0|d,this.Hh=0|p,this.Hl=0|g}process(e,t){for(let b=0;b<16;b++,t+=4)Qt[b]=e.getUint32(t),Xt[b]=e.getUint32(t+=4);for(let b=16;b<80;b++){const e=0|Qt[b-15],t=0|Xt[b-15],r=De(e,t,1)^De(e,t,8)^je(e,0,7),n=qe(e,t,1)^qe(e,t,8)^Le(e,t,7),i=0|Qt[b-2],s=0|Xt[b-2],o=De(i,s,19)^Me(i,s,61)^je(i,0,6),a=qe(i,s,19)^$e(i,s,61)^Le(i,s,6),c=He(n,a,Xt[b-7],Xt[b-16]),l=We(c,r,o,Qt[b-7],Qt[b-16]);Qt[b]=0|l,Xt[b]=0|c}let{Ah:r,Al:n,Bh:i,Bl:s,Ch:o,Cl:a,Dh:c,Dl:l,Eh:u,El:f,Fh:h,Fl:d,Gh:p,Gl:g,Hh:y,Hl:m}=this;for(let b=0;b<80;b++){const e=De(u,f,14)^De(u,f,18)^Me(u,f,41),t=qe(u,f,14)^qe(u,f,18)^$e(u,f,41),w=u&h^~u&p,v=Ge(m,t,f&d^~f&g,Yt[b],Xt[b]),E=Je(v,y,e,w,Jt[b],Qt[b]),x=0|v,I=De(r,n,28)^Me(r,n,34)^Me(r,n,39),S=qe(r,n,28)^$e(r,n,34)^$e(r,n,39),O=r&i^r&o^i&o,_=n&s^n&a^s&a;y=0|p,m=0|g,p=0|h,g=0|d,h=0|u,d=0|f,({h:u,l:f}=Fe(0|c,0|l,0|E,0|x)),c=0|o,l=0|a,o=0|i,a=0|s,i=0|r,s=0|n;const P=Ke(x,S,_);r=Ve(P,E,I,O),n=0|P}({h:r,l:n}=Fe(0|this.Ah,0|this.Al,0|r,0|n)),({h:i,l:s}=Fe(0|this.Bh,0|this.Bl,0|i,0|s)),({h:o,l:a}=Fe(0|this.Ch,0|this.Cl,0|o,0|a)),({h:c,l}=Fe(0|this.Dh,0|this.Dl,0|c,0|l)),({h:u,l:f}=Fe(0|this.Eh,0|this.El,0|u,0|f)),({h,l:d}=Fe(0|this.Fh,0|this.Fl,0|h,0|d)),({h:p,l:g}=Fe(0|this.Gh,0|this.Gl,0|p,0|g)),({h:y,l:m}=Fe(0|this.Hh,0|this.Hl,0|y,0|m)),this.set(r,n,i,s,o,a,c,l,u,f,h,d,p,g,y,m)}roundClean(){st(Qt,Xt)}destroy(){st(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class tr extends er{constructor(){super(48),this.Ah=0|Ft[0],this.Al=0|Ft[1],this.Bh=0|Ft[2],this.Bl=0|Ft[3],this.Ch=0|Ft[4],this.Cl=0|Ft[5],this.Dh=0|Ft[6],this.Dl=0|Ft[7],this.Eh=0|Ft[8],this.El=0|Ft[9],this.Fh=0|Ft[10],this.Fl=0|Ft[11],this.Gh=0|Ft[12],this.Gl=0|Ft[13],this.Hh=0|Ft[14],this.Hl=0|Ft[15]}}const rr=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class nr extends er{constructor(){super(32),this.Ah=0|rr[0],this.Al=0|rr[1],this.Bh=0|rr[2],this.Bl=0|rr[3],this.Ch=0|rr[4],this.Cl=0|rr[5],this.Dh=0|rr[6],this.Dl=0|rr[7],this.Eh=0|rr[8],this.El=0|rr[9],this.Fh=0|rr[10],this.Fl=0|rr[11],this.Gh=0|rr[12],this.Gl=0|rr[13],this.Hh=0|rr[14],this.Hl=0|rr[15]}}const ir=Et(()=>new Wt),sr=Et(()=>new er),or=Et(()=>new tr),ar=Et(()=>new nr),cr=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),lr=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),ur=new Uint32Array(32);function fr(e,t,r,n,i,s){const o=i[s+1];let a=ur[2*e],c=ur[2*e+1],l=ur[2*t],u=ur[2*t+1],f=ur[2*r],h=ur[2*r+1],d=ur[2*n],p=ur[2*n+1],g=Ke(a,l,i[s]);c=Ve(g,c,u,o),a=0|g,({Dh:p,Dl:d}={Dh:p^c,Dl:d^a}),({Dh:p,Dl:d}={Dh:ze(0,d),Dl:Ze(p)}),({h,l:f}=Fe(h,f,p,d)),({Bh:u,Bl:l}={Bh:u^h,Bl:l^f}),({Bh:u,Bl:l}={Bh:De(u,l,24),Bl:qe(u,l,24)}),ur[2*e]=a,ur[2*e+1]=c,ur[2*t]=l,ur[2*t+1]=u,ur[2*r]=f,ur[2*r+1]=h,ur[2*n]=d,ur[2*n+1]=p}function hr(e,t,r,n,i,s){const o=i[s+1];let a=ur[2*e],c=ur[2*e+1],l=ur[2*t],u=ur[2*t+1],f=ur[2*r],h=ur[2*r+1],d=ur[2*n],p=ur[2*n+1],g=Ke(a,l,i[s]);c=Ve(g,c,u,o),a=0|g,({Dh:p,Dl:d}={Dh:p^c,Dl:d^a}),({Dh:p,Dl:d}={Dh:De(p,d,16),Dl:qe(p,d,16)}),({h,l:f}=Fe(h,f,p,d)),({Bh:u,Bl:l}={Bh:u^h,Bl:l^f}),({Bh:u,Bl:l}={Bh:Me(u,l,63),Bl:$e(u,l,63)}),ur[2*e]=a,ur[2*e+1]=c,ur[2*t]=l,ur[2*t+1]=u,ur[2*r]=f,ur[2*r+1]=h,ur[2*n]=d,ur[2*n+1]=p}class dr extends vt{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,Xe(e),Xe(t),this.blockLen=e,this.outputLen=t,this.buffer=new Uint8Array(e),this.buffer32=it(this.buffer)}update(e){rt(this),et(e=bt(e));const{blockLen:t,buffer:r,buffer32:n}=this,i=e.length,s=e.byteOffset,o=e.buffer;for(let a=0;a<i;){this.pos===t&&(ft(n),this.compress(n,0,!1),ft(n),this.pos=0);const c=Math.min(t-this.pos,i-a),l=s+a;if(c!==t||l%4||!(a+c<i))r.set(e.subarray(a,a+c),this.pos),this.pos+=c,this.length+=c,a+=c;else{const e=new Uint32Array(o,l,Math.floor((i-a)/4));ft(e);for(let r=0;a+t<i;r+=n.length,a+=t)this.length+=t,this.compress(e,r,!1);ft(e)}}return this}digestInto(e){rt(this),nt(e,this);const{pos:t,buffer32:r}=this;this.finished=!0,st(this.buffer.subarray(t)),ft(r),this.compress(r,0,!0),ft(r);const n=it(e);this.get().forEach((e,t)=>n[t]=ut(e))}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){const{buffer:t,length:r,finished:n,destroyed:i,outputLen:s,pos:o}=this;return e||(e=new this.constructor({dkLen:s})),e.set(...this.get()),e.buffer.set(t),e.destroyed=i,e.finished=n,e.length=r,e.pos=o,e.outputLen=s,e}clone(){return this._cloneInto()}}class pr extends dr{constructor(e={}){const t=void 0===e.dkLen?64:e.dkLen;super(128,t),this.v0l=0|lr[0],this.v0h=0|lr[1],this.v1l=0|lr[2],this.v1h=0|lr[3],this.v2l=0|lr[4],this.v2h=0|lr[5],this.v3l=0|lr[6],this.v3h=0|lr[7],this.v4l=0|lr[8],this.v4h=0|lr[9],this.v5l=0|lr[10],this.v5h=0|lr[11],this.v6l=0|lr[12],this.v6h=0|lr[13],this.v7l=0|lr[14],this.v7h=0|lr[15],function(e,t={},r,n,i){if(Xe(r),e<0||e>r)throw new Error("outputLen bigger than keyLen");const{key:s,salt:o,personalization:a}=t;if(void 0!==s&&(s.length<1||s.length>r))throw new Error("key length must be undefined or 1.."+r);if(void 0!==o&&o.length!==n)throw new Error("salt must be undefined or "+n);if(void 0!==a&&a.length!==i)throw new Error("personalization must be undefined or "+i)}(t,e,64,16,16);let{key:r,personalization:n,salt:i}=e,s=0;if(void 0!==r&&(r=bt(r),s=r.length),this.v0l^=this.outputLen|s<<8|65536|1<<24,void 0!==i){i=bt(i);const e=it(i);this.v4l^=ut(e[0]),this.v4h^=ut(e[1]),this.v5l^=ut(e[2]),this.v5h^=ut(e[3])}if(void 0!==n){n=bt(n);const e=it(n);this.v6l^=ut(e[0]),this.v6h^=ut(e[1]),this.v7l^=ut(e[2]),this.v7h^=ut(e[3])}if(void 0!==r){const e=new Uint8Array(this.blockLen);e.set(r),this.update(e)}}get(){let{v0l:e,v0h:t,v1l:r,v1h:n,v2l:i,v2h:s,v3l:o,v3h:a,v4l:c,v4h:l,v5l:u,v5h:f,v6l:h,v6h:d,v7l:p,v7h:g}=this;return[e,t,r,n,i,s,o,a,c,l,u,f,h,d,p,g]}set(e,t,r,n,i,s,o,a,c,l,u,f,h,d,p,g){this.v0l=0|e,this.v0h=0|t,this.v1l=0|r,this.v1h=0|n,this.v2l=0|i,this.v2h=0|s,this.v3l=0|o,this.v3h=0|a,this.v4l=0|c,this.v4h=0|l,this.v5l=0|u,this.v5h=0|f,this.v6l=0|h,this.v6h=0|d,this.v7l=0|p,this.v7h=0|g}compress(e,t,r){this.get().forEach((e,t)=>ur[t]=e),ur.set(lr,16);let{h:n,l:i}=Ne(BigInt(this.length));ur[24]=lr[8]^i,ur[25]=lr[9]^n,r&&(ur[28]=~ur[28],ur[29]=~ur[29]);let s=0;const o=cr;for(let a=0;a<12;a++)fr(0,4,8,12,e,t+2*o[s++]),hr(0,4,8,12,e,t+2*o[s++]),fr(1,5,9,13,e,t+2*o[s++]),hr(1,5,9,13,e,t+2*o[s++]),fr(2,6,10,14,e,t+2*o[s++]),hr(2,6,10,14,e,t+2*o[s++]),fr(3,7,11,15,e,t+2*o[s++]),hr(3,7,11,15,e,t+2*o[s++]),fr(0,5,10,15,e,t+2*o[s++]),hr(0,5,10,15,e,t+2*o[s++]),fr(1,6,11,12,e,t+2*o[s++]),hr(1,6,11,12,e,t+2*o[s++]),fr(2,7,8,13,e,t+2*o[s++]),hr(2,7,8,13,e,t+2*o[s++]),fr(3,4,9,14,e,t+2*o[s++]),hr(3,4,9,14,e,t+2*o[s++]);this.v0l^=ur[0]^ur[16],this.v0h^=ur[1]^ur[17],this.v1l^=ur[2]^ur[18],this.v1h^=ur[3]^ur[19],this.v2l^=ur[4]^ur[20],this.v2h^=ur[5]^ur[21],this.v3l^=ur[6]^ur[22],this.v3h^=ur[7]^ur[23],this.v4l^=ur[8]^ur[24],this.v4h^=ur[9]^ur[25],this.v5l^=ur[10]^ur[26],this.v5h^=ur[11]^ur[27],this.v6l^=ur[12]^ur[28],this.v6h^=ur[13]^ur[29],this.v7l^=ur[14]^ur[30],this.v7h^=ur[15]^ur[31],st(ur)}destroy(){this.destroyed=!0,st(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const gr=function(e){const t=(t,r)=>e(r).update(bt(t)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}(e=>new pr(e)),yr="https://rpc.walletconnect.org/v1";function mr(e){const t=`\x19Ethereum Signed Message:\n${e.length}`,r=(new TextEncoder).encode(t+e);return"0x"+Buffer.from(Dt(r)).toString("hex")}function br(e,t,r,n,i,s){return wr.apply(this,arguments)}function wr(){return wr=(0,n.Z)(function*(e,t,r,n,i,s){switch(r.t){case"eip191":return yield vr(e,t,r.s);case"eip1271":return yield Er(e,t,r.s,n,i,s);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}),wr.apply(this,arguments)}function vr(e,t,r){const n=l.H_(r);return u.RJ({payload:mr(t),signature:n}).toLowerCase()===e.toLowerCase()}function Er(e,t,r,n,i,s){return xr.apply(this,arguments)}function xr(){return xr=(0,n.Z)(function*(e,t,r,n,i,s){const o=V(n);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${n}`);try{const o="0x1626ba7e",a="0000000000000000000000000000000000000000000000000000000000000040",c=r.substring(2),l=(c.length/2).toString(16).padStart(64,"0"),u=o+(t.startsWith("0x")?t:mr(t)).substring(2)+a+l+c,f=yield fetch(`${s||yr}/?chainId=${n}&projectId=${i}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:Ir(),jsonrpc:"2.0",method:"eth_call",params:[{to:e,data:u},"latest"]})}),{result:h}=yield f.json();return!!h&&h.slice(0,o.length).toLowerCase()===o.toLowerCase()}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}),xr.apply(this,arguments)}function Ir(){return Date.now()+Math.floor(1e3*Math.random())}function Sr(e){const t=new Uint8Array(Buffer.from(e,"base64")),r=Array.from("TransactionData::").map(e=>e.charCodeAt(0)),n=new Uint8Array(r.length+t.length);n.set(r),n.set(t,r.length);const i=gr(n,{dkLen:32});return M.Jq.encode(i)}function Or(e){const t=new Uint8Array(ir(function(e){if(e instanceof Uint8Array)return e;if(Array.isArray(e))return new Uint8Array(e);if("object"==typeof e&&null!=e&&e.data)return new Uint8Array(Object.values(e.data));if("object"==typeof e&&e)return new Uint8Array(Object.values(e));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}(e)));return M.Jq.encode(t)}function _r(e){const t=function(e,t){return new D(void 0).decode(e)}(Buffer.from(e,"base64")).txn;if(!t)throw new Error("Invalid signed transaction: missing 'txn' field");const r=function(e,t){return new q(void 0).encodeSharedRef(e)}(t),n=Buffer.from("TX"),i=Buffer.concat([n,Buffer.from(r)]),s=ar(i);return M.pJ.encode(s).replace(/=+$/,"")}function Pr(e){const t=[];let r=BigInt(e);for(;r>=BigInt(128);)t.push(Number(r&BigInt(127)|BigInt(128))),r>>=BigInt(7);return t.push(Number(r)),Buffer.from(t)}function Ar(e){const t=Buffer.from(e.signed.bodyBytes,"base64"),r=Buffer.from(e.signed.authInfoBytes,"base64"),n=Buffer.from(e.signature.signature,"base64"),i=[];i.push(Buffer.from([10])),i.push(Pr(t.length)),i.push(t),i.push(Buffer.from([18])),i.push(Pr(r.length)),i.push(r),i.push(Buffer.from([26])),i.push(Pr(n.length)),i.push(n);const s=Buffer.concat(i),o=ir(s);return Buffer.from(o).toString("hex").toUpperCase()}var Rr=Object.defineProperty,Tr=Object.defineProperties,Br=Object.getOwnPropertyDescriptors,Cr=Object.getOwnPropertySymbols,Ur=Object.prototype.hasOwnProperty,Nr=Object.prototype.propertyIsEnumerable,kr=(e,t,r)=>t in e?Rr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const jr="did:pkh:",Lr={eip155:"Ethereum",solana:"Solana",bip122:"Bitcoin"},Dr=e=>e?.split(":"),qr=e=>{const t=e&&Dr(e);if(t)return t[2]+":"+t[3]},Mr=e=>{const t=e&&Dr(e);if(t)return t.pop()};function $r(e){return zr.apply(this,arguments)}function zr(){return zr=(0,n.Z)(function*(e){const{cacao:t,projectId:r}=e,{s:n,p:i}=t,s=Zr(i,i.iss),o=Mr(i.iss);return yield br(o,s,n,qr(i.iss),r)}),zr.apply(this,arguments)}const Zr=(e,t)=>{const r=(e=>{const t=e&&Dr(e);if(t)return e.includes(jr)?t[2]:t[0]})(t);if(!r)throw new Error("Invalid issuer: "+t);const n=`${e.domain} wants you to sign in with your ${(e=>e?Lr[e]||e:"")(r)} account:`,i=Mr(t);if(!e.aud&&!e.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=e.statement||void 0;const o=`URI: ${e.aud||e.uri}`,a=`Version: ${e.version}`,c=`Chain ID: ${(e=>{const t=e&&Dr(e);if(t)return e.includes(jr)?t[3]:t[1]})(t)}`,l=`Nonce: ${e.nonce}`,u=`Issued At: ${e.iat}`,f=e.exp?`Expiration Time: ${e.exp}`:void 0,h=e.nbf?`Not Before: ${e.nbf}`:void 0,d=e.requestId?`Request ID: ${e.requestId}`:void 0,p=e.resources?`Resources:${e.resources.map(e=>`\n- ${e}`).join("")}`:void 0,g=Yr(e.resources);return g&&(s=function(e="",t){Fr(t);const r="I further authorize the stated URI to perform the following actions on my behalf: ";if(e.includes(r))return e;const n=[];let i=0;return Object.keys(t.att).forEach(e=>{const r=Object.keys(t.att[e]).map(e=>({ability:e.split("/")[0],action:e.split("/")[1]}));r.sort((e,t)=>e.action.localeCompare(t.action));const s={};r.forEach(e=>{s[e.ability]||(s[e.ability]=[]),s[e.ability].push(e.action)});const o=Object.keys(s).map(t=>(i++,`(${i}) '${t}': '${s[t].join("', '")}' for '${e}'.`));n.push(o.join(", ").replace(".,","."))}),`${e?e+" ":""}${r}${n.join(" ")}`}(s,Hr(g))),[n,i,"",s,"",o,a,c,l,u,f,h,d,p].filter(e=>null!=e).join("\n")};function Fr(e){if(!e)throw new Error("No recap provided, value is undefined");if(!e.att)throw new Error("No `att` property found");const t=Object.keys(e.att);if(null==t||!t.length)throw new Error("No resources found in `att` property");t.forEach(t=>{const r=e.att[t];if(Array.isArray(r))throw new Error(`Resource must be an object: ${t}`);if("object"!=typeof r)throw new Error(`Resource must be an object: ${t}`);if(!Object.keys(r).length)throw new Error(`Resource object is empty: ${t}`);Object.keys(r).forEach(e=>{const t=r[e];if(!Array.isArray(t))throw new Error(`Ability limits ${e} must be an array of objects, found: ${t}`);if(!t.length)throw new Error(`Value of ${e} is empty array, must be an array with objects`);t.forEach(t=>{if("object"!=typeof t)throw new Error(`Ability limits (${e}) must be an array of objects, found: ${t}`)})})})}function Kr(e,t,r={}){t=t?.sort((e,t)=>e.localeCompare(t));const n=t.map(t=>({[`${e}/${t}`]:[r]}));return Object.assign({},...n)}function Vr(e){return Fr(e),`urn:recap:${function(e){return Buffer.from(JSON.stringify(e)).toString("base64")}(e).replace(/=/g,"")}`}function Hr(e){const t=function(e){return JSON.parse(Buffer.from(e,"base64").toString("utf-8"))}(e.replace("urn:recap:",""));return Fr(t),t}function Wr(e,t){const r=function(e,t){Fr(e),Fr(t);const r=Object.keys(e.att).concat(Object.keys(t.att)).sort((e,t)=>e.localeCompare(t)),n={att:{}};return r.forEach(r=>{var i,s;Object.keys((null==(i=e.att)?void 0:i[r])||{}).concat(Object.keys((null==(s=t.att)?void 0:s[r])||{})).sort((e,t)=>e.localeCompare(t)).forEach(i=>{var s,o;n.att[r]=((e,t)=>Tr(e,Br(t)))(((e,t)=>{for(var r in t||(t={}))Ur.call(t,r)&&kr(e,r,t[r]);if(Cr)for(var r of Cr(t))Nr.call(t,r)&&kr(e,r,t[r]);return e})({},n.att[r]),{[i]:(null==(s=e.att[r])?void 0:s[i])||(null==(o=t.att[r])?void 0:o[i])})})}),n}(Hr(e),Hr(t));return Vr(r)}function Gr(e){var t;const r=Hr(e);Fr(r);const n=null==(t=r.att)?void 0:t.eip155;return n?Object.keys(n).map(e=>e.split("/")[1]):[]}function Jr(e){const t=Hr(e);Fr(t);const r=[];return Object.values(t.att).forEach(e=>{Object.values(e).forEach(e=>{var t;null!=(t=e?.[0])&&t.chains&&r.push(e[0].chains)})}),[...new Set(r.flat())]}function Yr(e){if(!e)return;const t=e?.[e.length-1];return function(e){return e&&e.includes("urn:recap:")}(t)?t:void 0}function Qr(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function Xr(e){if("boolean"!=typeof e)throw new Error(`boolean expected, not ${e}`)}function en(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function tn(e,...t){if(!Qr(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function rn(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function nn(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function sn(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}const on=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];function an(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}(e);else{if(!Qr(e))throw new Error("Uint8Array expected, got "+typeof e);e=fn(e)}return e}function cn(e,t,r=!0){if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(r&&!function(e){return e.byteOffset%4==0}(t))throw new Error("invalid output, must be aligned");return t}function un(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?0:4;e.setUint32(t+(n?4:0),o,n),e.setUint32(t+c,a,n)}function fn(e){return Uint8Array.from(e)}const hn=e=>Uint8Array.from(e.split("").map(e=>e.charCodeAt(0))),dn=hn("expand 16-byte k"),pn=hn("expand 32-byte k"),gn=nn(dn),yn=nn(pn);function mn(e,t){return e<<t|e>>>32-t}function bn(e){return e.byteOffset%4==0}const wn=2**32-1,vn=new Uint32Array,En=(e,t)=>255&e[t++]|(255&e[t++])<<8;class xn{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,tn(e=an(e),32);const t=En(e,0),r=En(e,2),n=En(e,4),i=En(e,6),s=En(e,8),o=En(e,10),a=En(e,12),c=En(e,14);this.r[0]=8191&t,this.r[1]=8191&(t>>>13|r<<3),this.r[2]=7939&(r>>>10|n<<6),this.r[3]=8191&(n>>>7|i<<9),this.r[4]=255&(i>>>4|s<<12),this.r[5]=s>>>1&8190,this.r[6]=8191&(s>>>14|o<<2),this.r[7]=8065&(o>>>11|a<<5),this.r[8]=8191&(a>>>8|c<<8),this.r[9]=c>>>5&127;for(let l=0;l<8;l++)this.pad[l]=En(e,16+2*l)}process(e,t,r=!1){const n=r?0:2048,{h:i,r:s}=this,o=s[0],a=s[1],c=s[2],l=s[3],u=s[4],f=s[5],h=s[6],d=s[7],p=s[8],g=s[9],y=En(e,t+0),m=En(e,t+2),b=En(e,t+4),w=En(e,t+6),v=En(e,t+8),E=En(e,t+10),x=En(e,t+12),I=En(e,t+14);let S=i[0]+(8191&y),O=i[1]+(8191&(y>>>13|m<<3)),_=i[2]+(8191&(m>>>10|b<<6)),P=i[3]+(8191&(b>>>7|w<<9)),A=i[4]+(8191&(w>>>4|v<<12)),R=i[5]+(v>>>1&8191),T=i[6]+(8191&(v>>>14|E<<2)),B=i[7]+(8191&(E>>>11|x<<5)),C=i[8]+(8191&(x>>>8|I<<8)),U=i[9]+(I>>>5|n),N=0,k=N+S*o+O*(5*g)+_*(5*p)+P*(5*d)+A*(5*h);N=k>>>13,k&=8191,k+=R*(5*f)+T*(5*u)+B*(5*l)+C*(5*c)+U*(5*a),N+=k>>>13,k&=8191;let j=N+S*a+O*o+_*(5*g)+P*(5*p)+A*(5*d);N=j>>>13,j&=8191,j+=R*(5*h)+T*(5*f)+B*(5*u)+C*(5*l)+U*(5*c),N+=j>>>13,j&=8191;let L=N+S*c+O*a+_*o+P*(5*g)+A*(5*p);N=L>>>13,L&=8191,L+=R*(5*d)+T*(5*h)+B*(5*f)+C*(5*u)+U*(5*l),N+=L>>>13,L&=8191;let D=N+S*l+O*c+_*a+P*o+A*(5*g);N=D>>>13,D&=8191,D+=R*(5*p)+T*(5*d)+B*(5*h)+C*(5*f)+U*(5*u),N+=D>>>13,D&=8191;let q=N+S*u+O*l+_*c+P*a+A*o;N=q>>>13,q&=8191,q+=R*(5*g)+T*(5*p)+B*(5*d)+C*(5*h)+U*(5*f),N+=q>>>13,q&=8191;let M=N+S*f+O*u+_*l+P*c+A*a;N=M>>>13,M&=8191,M+=R*o+T*(5*g)+B*(5*p)+C*(5*d)+U*(5*h),N+=M>>>13,M&=8191;let $=N+S*h+O*f+_*u+P*l+A*c;N=$>>>13,$&=8191,$+=R*a+T*o+B*(5*g)+C*(5*p)+U*(5*d),N+=$>>>13,$&=8191;let z=N+S*d+O*h+_*f+P*u+A*l;N=z>>>13,z&=8191,z+=R*c+T*a+B*o+C*(5*g)+U*(5*p),N+=z>>>13,z&=8191;let Z=N+S*p+O*d+_*h+P*f+A*u;N=Z>>>13,Z&=8191,Z+=R*l+T*c+B*a+C*o+U*(5*g),N+=Z>>>13,Z&=8191;let F=N+S*g+O*p+_*d+P*h+A*f;N=F>>>13,F&=8191,F+=R*u+T*l+B*c+C*a+U*o,N+=F>>>13,F&=8191,N=(N<<2)+N|0,N=N+k|0,k=8191&N,N>>>=13,j+=N,i[0]=k,i[1]=j,i[2]=L,i[3]=D,i[4]=q,i[5]=M,i[6]=$,i[7]=z,i[8]=Z,i[9]=F}finalize(){const{h:e,pad:t}=this,r=new Uint16Array(10);let n=e[1]>>>13;e[1]&=8191;for(let o=2;o<10;o++)e[o]+=n,n=e[o]>>>13,e[o]&=8191;e[0]+=5*n,n=e[0]>>>13,e[0]&=8191,e[1]+=n,n=e[1]>>>13,e[1]&=8191,e[2]+=n,r[0]=e[0]+5,n=r[0]>>>13,r[0]&=8191;for(let o=1;o<10;o++)r[o]=e[o]+n,n=r[o]>>>13,r[o]&=8191;r[9]-=8192;let i=(1^n)-1;for(let o=0;o<10;o++)r[o]&=i;i=~i;for(let o=0;o<10;o++)e[o]=e[o]&i|r[o];e[0]=65535&(e[0]|e[1]<<13),e[1]=65535&(e[1]>>>3|e[2]<<10),e[2]=65535&(e[2]>>>6|e[3]<<7),e[3]=65535&(e[3]>>>9|e[4]<<4),e[4]=65535&(e[4]>>>12|e[5]<<1|e[6]<<14),e[5]=65535&(e[6]>>>2|e[7]<<11),e[6]=65535&(e[7]>>>5|e[8]<<8),e[7]=65535&(e[8]>>>8|e[9]<<5);let s=e[0]+t[0];e[0]=65535&s;for(let o=1;o<8;o++)s=(e[o]+t[o]|0)+(s>>>16)|0,e[o]=65535&s;sn(r)}update(e){rn(this),tn(e=an(e));const{buffer:t,blockLen:r}=this,n=e.length;for(let i=0;i<n;){const s=Math.min(r-this.pos,n-i);if(s!==r)t.set(e.subarray(i,i+s),this.pos),this.pos+=s,i+=s,this.pos===r&&(this.process(t,0,!1),this.pos=0);else for(;r<=n-i;i+=r)this.process(e,i)}return this}destroy(){sn(this.h,this.r,this.buffer,this.pad)}digestInto(e){rn(this),function(e,t){tn(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}(e,this),this.finished=!0;const{buffer:t,h:r}=this;let{pos:n}=this;if(n){for(t[n++]=1;n<16;n++)t[n]=0;this.process(t,0,!0)}this.finalize();let i=0;for(let s=0;s<8;s++)e[i++]=r[s]>>>0,e[i++]=r[s]>>>8;return e}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}}const In=function(e){const t=(t,r)=>e(r).update(an(t)).digest(),r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}(e=>new xn(e)),Sn=function(e,t){const{allowShortKeys:r,extendNonceFn:n,counterLength:i,counterRight:s,rounds:o}=function(e,t){if(null==t||"object"!=typeof t)throw new Error("options must be defined");return Object.assign({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t)}(0,{counterRight:!1,counterLength:4,allowShortKeys:!1});return en(i),en(o),Xr(s),Xr(r),(t,a,c,l,u=0)=>{tn(t),tn(a),tn(c);const f=c.length;if(void 0===l&&(l=new Uint8Array(f)),tn(l),en(u),u<0||u>=wn)throw new Error("arx: counter overflow");if(l.length<f)throw new Error(`arx: output (${l.length}) is shorter than data (${f})`);const h=[];let d,p,g=t.length;if(32===g)h.push(d=fn(t)),p=yn;else{if(16!==g||!r)throw new Error(`arx: invalid 32-byte key, got length=${g}`);d=new Uint8Array(32),d.set(t),d.set(t,16),p=gn,h.push(d)}bn(a)||h.push(a=fn(a));const y=nn(d);if(n){if(24!==a.length)throw new Error("arx: extended nonce must be 24 bytes");n(p,y,nn(a.subarray(0,16)),y),a=a.subarray(16)}const m=16-i;if(m!==a.length)throw new Error(`arx: nonce must be ${m} or 16 bytes`);if(12!==m){const e=new Uint8Array(12);e.set(a,s?0:12-a.length),h.push(a=e)}const b=nn(a);return function(e,t,r,n,i,s,o,a){const c=i.length,l=new Uint8Array(64),u=nn(l),f=bn(i)&&bn(s),h=f?nn(i):vn,d=f?nn(s):vn;for(let p=0;p<c;o++){if(e(t,r,n,u,o,a),o>=wn)throw new Error("arx: counter overflow");const g=Math.min(64,c-p);if(f&&64===g){const e=p/4;if(p%4!=0)throw new Error("arx: invalid block position");for(let t,r=0;r<16;r++)t=e+r,d[t]=h[t]^u[r];p+=64}else{for(let e,t=0;t<g;t++)e=p+t,s[e]=i[e]^l[t];p+=g}}}(e,p,y,b,c,l,u,o),sn(...h),l}}(function(e,t,r,n,i,s=20){let o=e[0],a=e[1],c=e[2],l=e[3],u=t[0],f=t[1],h=t[2],d=t[3],p=t[4],g=t[5],y=t[6],m=t[7],b=i,w=r[0],v=r[1],E=r[2],x=o,I=a,S=c,O=l,_=u,P=f,A=h,R=d,T=p,B=g,C=y,U=m,N=b,k=w,j=v,L=E;for(let q=0;q<s;q+=2)x=x+_|0,N=mn(N^x,16),T=T+N|0,_=mn(_^T,12),x=x+_|0,N=mn(N^x,8),T=T+N|0,_=mn(_^T,7),I=I+P|0,k=mn(k^I,16),B=B+k|0,P=mn(P^B,12),I=I+P|0,k=mn(k^I,8),B=B+k|0,P=mn(P^B,7),S=S+A|0,j=mn(j^S,16),C=C+j|0,A=mn(A^C,12),S=S+A|0,j=mn(j^S,8),C=C+j|0,A=mn(A^C,7),O=O+R|0,L=mn(L^O,16),U=U+L|0,R=mn(R^U,12),O=O+R|0,L=mn(L^O,8),U=U+L|0,R=mn(R^U,7),x=x+P|0,L=mn(L^x,16),C=C+L|0,P=mn(P^C,12),x=x+P|0,L=mn(L^x,8),C=C+L|0,P=mn(P^C,7),I=I+A|0,N=mn(N^I,16),U=U+N|0,A=mn(A^U,12),I=I+A|0,N=mn(N^I,8),U=U+N|0,A=mn(A^U,7),S=S+R|0,k=mn(k^S,16),T=T+k|0,R=mn(R^T,12),S=S+R|0,k=mn(k^S,8),T=T+k|0,R=mn(R^T,7),O=O+_|0,j=mn(j^O,16),B=B+j|0,_=mn(_^B,12),O=O+_|0,j=mn(j^O,8),B=B+j|0,_=mn(_^B,7);let D=0;n[D++]=o+x|0,n[D++]=a+I|0,n[D++]=c+S|0,n[D++]=l+O|0,n[D++]=u+_|0,n[D++]=f+P|0,n[D++]=h+A|0,n[D++]=d+R|0,n[D++]=p+T|0,n[D++]=g+B|0,n[D++]=y+C|0,n[D++]=m+U|0,n[D++]=b+N|0,n[D++]=w+k|0,n[D++]=v+j|0,n[D++]=E+L|0}),On=new Uint8Array(16),_n=(e,t)=>{e.update(t);const r=t.length%16;r&&e.update(On.subarray(r))},Pn=new Uint8Array(32);function An(e,t,r,n,i){const s=e(t,r,Pn),o=In.create(s);i&&_n(o,i),_n(o,n);const a=function(e,t,r){Xr(r);const n=new Uint8Array(16),i=function(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}(n);return un(i,0,BigInt(t),r),un(i,8,BigInt(e),r),n}(n.length,i?i.length:0,!0);o.update(a);const c=o.digest();return sn(s,a),c}const Rn=((e,t)=>{function r(r,...n){if(tn(r),!on)throw new Error("Non little-endian hardware is not yet supported");if(void 0!==e.nonceLength){const t=n[0];if(!t)throw new Error("nonce / iv required");e.varSizeNonce?tn(t):tn(t,e.nonceLength)}const i=e.tagLength;i&&void 0!==n[1]&&tn(n[1]);const s=t(r,...n),o=(e,t)=>{if(void 0!==t){if(2!==e)throw new Error("cipher output not supported");tn(t)}};let a=!1;return{encrypt(e,t){if(a)throw new Error("cannot encrypt() twice with same key + nonce");return a=!0,tn(e),o(s.encrypt.length,t),s.encrypt(e,t)},decrypt(e,t){if(tn(e),i&&e.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return o(s.decrypt.length,t),s.decrypt(e,t)}}}return Object.assign(r,e),r})({blockSize:64,nonceLength:12,tagLength:16},(e=>(t,r,n)=>({encrypt(i,s){const o=i.length;(s=cn(o+16,s,!1)).set(i);const a=s.subarray(0,-16);e(t,r,a,a,1);const c=An(e,t,r,a,n);return s.set(c,o),sn(c),s},decrypt(i,s){s=cn(i.length-16,s,!1);const o=i.subarray(0,-16),a=i.subarray(-16),c=An(e,t,r,o,n);if(!function(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r}(a,c))throw new Error("invalid tag");return s.set(i.subarray(0,-16)),e(t,r,s,s,1),sn(c),s}}))(Sn));class Tn extends vt{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,tt(e);const r=bt(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,i=new Uint8Array(n);i.set(r.length>n?e.create().update(r).digest():r);for(let s=0;s<i.length;s++)i[s]^=54;this.iHash.update(i),this.oHash=e.create();for(let s=0;s<i.length;s++)i[s]^=106;this.oHash.update(i),st(i)}update(e){return rt(this),this.iHash.update(e),this}digestInto(e){rt(this),et(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:n,destroyed:i,blockLen:s,outputLen:o}=this;return e.finished=n,e.destroyed=i,e.blockLen=s,e.outputLen=o,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Bn=(e,t,r)=>new Tn(e,t).update(r).digest();Bn.create=(e,t)=>new Tn(e,t);const Cn=Uint8Array.from([0]),Un=Uint8Array.of(),Nn=ir,kn=BigInt(0),jn=BigInt(1);function Ln(e,t=""){if("boolean"!=typeof e)throw new Error((t&&`"${t}"`)+"expected boolean, got type="+typeof e);return e}function Dn(e,t,r=""){const n=Qe(e),i=e?.length,s=void 0!==t;if(!n||s&&i!==t)throw new Error((r&&`"${r}" `)+"expected Uint8Array"+(s?` of length ${t}`:"")+", got "+(n?`length=${i}`:"type="+typeof e));return e}function qn(e){const t=e.toString(16);return 1&t.length?"0"+t:t}function Mn(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?kn:BigInt("0x"+e)}function $n(e){return Mn(pt(e))}function zn(e){return et(e),Mn(pt(Uint8Array.from(e).reverse()))}function Zn(e,t){return yt(e.toString(16).padStart(2*t,"0"))}function Fn(e,t){return Zn(e,t).reverse()}function Kn(e,t,r){let n;if("string"==typeof t)try{n=yt(t)}catch(s){throw new Error(e+" must be hex string or Uint8Array, cause: "+s)}else{if(!Qe(t))throw new Error(e+" must be hex string or Uint8Array");n=Uint8Array.from(t)}const i=n.length;if("number"==typeof r&&i!==r)throw new Error(e+" of length "+r+" expected, got "+i);return n}const Vn=e=>"bigint"==typeof e&&kn<=e;function Hn(e,t,r,n){if(!function(e,t,r){return Vn(e)&&Vn(t)&&Vn(r)&&t<=e&&e<r}(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}function Wn(e){let t;for(t=0;e>kn;e>>=jn,t+=1);return t}const Gn=e=>(jn<<BigInt(e))-jn;function Jn(e,t,r={}){if(!e||"object"!=typeof e)throw new Error("expected valid options object");function n(t,r,n){const i=e[t];if(n&&void 0===i)return;const s=typeof i;if(s!==r||null===i)throw new Error(`param "${t}" is invalid: expected ${r}, got ${s}`)}Object.entries(t).forEach(([e,t])=>n(e,t,!1)),Object.entries(r).forEach(([e,t])=>n(e,t,!0))}function Yn(e){const t=new WeakMap;return(r,...n)=>{const i=t.get(r);if(void 0!==i)return i;const s=e(r,...n);return t.set(r,s),s}}const Qn=BigInt(0),Xn=BigInt(1),ei=BigInt(2),ti=BigInt(3),ri=BigInt(4),ni=BigInt(5),ii=BigInt(7),si=BigInt(8),oi=BigInt(9),ai=BigInt(16);function ci(e,t){const r=e%t;return r>=Qn?r:t+r}function li(e,t,r){let n=e;for(;t-- >Qn;)n*=n,n%=r;return n}function ui(e,t){if(e===Qn)throw new Error("invert: expected non-zero number");if(t<=Qn)throw new Error("invert: expected positive modulus, got "+t);let r=ci(e,t),n=t,i=Qn,s=Xn;for(;r!==Qn;){const e=n%r,t=i-s*(n/r);n=r,r=e,i=s,s=t}if(n!==Xn)throw new Error("invert: does not exist");return ci(i,t)}function fi(e,t,r){if(!e.eql(e.sqr(t),r))throw new Error("Cannot find square root")}function hi(e,t){const r=e.pow(t,(e.ORDER+Xn)/ri);return fi(e,r,t),r}function di(e,t){const r=(e.ORDER-ni)/si,n=e.mul(t,ei),i=e.pow(n,r),s=e.mul(t,i),o=e.mul(e.mul(s,ei),i),a=e.mul(s,e.sub(o,e.ONE));return fi(e,a,t),a}function pi(e){if(e<ti)throw new Error("sqrt is not defined for small field");let t=e-Xn,r=0;for(;t%ei===Qn;)t/=ei,r++;let n=ei;const i=wi(e);for(;1===mi(i,n);)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===r)return hi;let s=i.pow(n,t);const o=(t+Xn)/ei;return function(e,n){if(e.is0(n))return n;if(1!==mi(e,n))throw new Error("Cannot find square root");let i=r,a=e.mul(e.ONE,s),c=e.pow(n,t),l=e.pow(n,o);for(;!e.eql(c,e.ONE);){if(e.is0(c))return e.ZERO;let t=1,r=e.sqr(c);for(;!e.eql(r,e.ONE);)if(t++,r=e.sqr(r),t===i)throw new Error("Cannot find square root");const n=Xn<<BigInt(i-t-1),s=e.pow(a,n);i=t,a=e.sqr(s),c=e.mul(c,a),l=e.mul(l,s)}return l}}const gi=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function yi(e,t,r=!1){const n=new Array(t.length).fill(r?e.ZERO:void 0),i=t.reduce((t,r,i)=>e.is0(r)?t:(n[i]=t,e.mul(t,r)),e.ONE),s=e.inv(i);return t.reduceRight((t,r,i)=>e.is0(r)?t:(n[i]=e.mul(t,n[i]),e.mul(t,r)),s),n}function mi(e,t){const r=e.pow(t,(e.ORDER-Xn)/ei),n=e.eql(r,e.ONE),i=e.eql(r,e.ZERO),s=e.eql(r,e.neg(e.ONE));if(!n&&!i&&!s)throw new Error("invalid Legendre symbol result");return n?1:i?0:-1}function bi(e,t){void 0!==t&&Xe(t);const r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function wi(e,t,r=!1,n={}){if(e<=Qn)throw new Error("invalid field: expected ORDER > 0, got "+e);let i,s,o,a=!1;if("object"==typeof t&&null!=t){if(n.sqrt||r)throw new Error("cannot specify opts in two arguments");const e=t;e.BITS&&(i=e.BITS),e.sqrt&&(s=e.sqrt),"boolean"==typeof e.isLE&&(r=e.isLE),"boolean"==typeof e.modFromBytes&&(a=e.modFromBytes),o=e.allowedLengths}else"number"==typeof t&&(i=t),n.sqrt&&(s=n.sqrt);const{nBitLength:c,nByteLength:l}=bi(e,i);if(l>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let u;const f=Object.freeze({ORDER:e,isLE:r,BITS:c,BYTES:l,MASK:Gn(c),ZERO:Qn,ONE:Xn,allowedLengths:o,create:t=>ci(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return Qn<=t&&t<e},is0:e=>e===Qn,isValidNot0:e=>!f.is0(e)&&f.isValid(e),isOdd:e=>(e&Xn)===Xn,neg:t=>ci(-t,e),eql:(e,t)=>e===t,sqr:t=>ci(t*t,e),add:(t,r)=>ci(t+r,e),sub:(t,r)=>ci(t-r,e),mul:(t,r)=>ci(t*r,e),pow:(e,t)=>function(e,t,r){if(r<Qn)throw new Error("invalid exponent, negatives unsupported");if(r===Qn)return e.ONE;if(r===Xn)return t;let n=e.ONE,i=t;for(;r>Qn;)r&Xn&&(n=e.mul(n,i)),i=e.sqr(i),r>>=Xn;return n}(f,e,t),div:(t,r)=>ci(t*ui(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>ui(t,e),sqrt:s||(t=>(u||(u=function(e){return e%ri===ti?hi:e%si===ni?di:e%ai===oi?function(e){const t=wi(e),r=pi(e),n=r(t,t.neg(t.ONE)),i=r(t,n),s=r(t,t.neg(n)),o=(e+ii)/ai;return(e,t)=>{let r=e.pow(t,o),a=e.mul(r,n);const c=e.mul(r,i),l=e.mul(r,s),u=e.eql(e.sqr(a),t),f=e.eql(e.sqr(c),t);r=e.cmov(r,a,u),a=e.cmov(l,c,f);const h=e.eql(e.sqr(a),t),d=e.cmov(r,a,h);return fi(e,d,t),d}}(e):pi(e)}(e)),u(f,t))),toBytes:e=>r?Fn(e,l):Zn(e,l),fromBytes:(t,n=!0)=>{if(o){if(!o.includes(t.length)||t.length>l)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+t.length);const e=new Uint8Array(l);e.set(t,r?0:e.length-t.length),t=e}if(t.length!==l)throw new Error("Field.fromBytes: expected "+l+" bytes, got "+t.length);let i=r?zn(t):$n(t);if(a&&(i=ci(i,e)),!n&&!f.isValid(i))throw new Error("invalid field element: outside of range 0..ORDER");return i},invertBatch:e=>yi(f,e),cmov:(e,t,r)=>r?t:e});return Object.freeze(f)}function vi(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function Ei(e){const t=vi(e);return t+Math.ceil(t/2)}const xi=BigInt(0),Ii=BigInt(1);function Si(e,t){const r=t.negate();return e?r:t}function Oi(e,t){const r=yi(e.Fp,t.map(e=>e.Z));return t.map((t,n)=>e.fromAffine(t.toAffine(r[n])))}function _i(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Pi(e,t){_i(e,t);const r=2**e;return{windows:Math.ceil(t/e)+1,windowSize:2**(e-1),mask:Gn(e),maxNumber:r,shiftBy:BigInt(e)}}function Ai(e,t,r){const{windowSize:n,mask:i,maxNumber:s,shiftBy:o}=r;let a=Number(e&i),c=e>>o;a>n&&(a-=s,c+=Ii);const l=t*n;return{nextN:c,offset:l+Math.abs(a)-1,isZero:0===a,isNeg:a<0,isNegF:t%2!=0,offsetF:l}}const Ri=new WeakMap,Ti=new WeakMap;function Bi(e){return Ti.get(e)||1}function Ci(e){if(e!==xi)throw new Error("invalid wNAF")}class Ui{constructor(e,t){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=t}_unsafeLadder(e,t,r=this.ZERO){let n=e;for(;t>xi;)t&Ii&&(r=r.add(n)),n=n.double(),t>>=Ii;return r}precomputeWindow(e,t){const{windows:r,windowSize:n}=Pi(t,this.bits),i=[];let s=e,o=s;for(let a=0;a<r;a++){o=s,i.push(o);for(let e=1;e<n;e++)o=o.add(s),i.push(o);s=o.double()}return i}wNAF(e,t,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let n=this.ZERO,i=this.BASE;const s=Pi(e,this.bits);for(let o=0;o<s.windows;o++){const{nextN:e,offset:a,isZero:c,isNeg:l,isNegF:u,offsetF:f}=Ai(r,o,s);r=e,c?i=i.add(Si(u,t[f])):n=n.add(Si(l,t[a]))}return Ci(r),{p:n,f:i}}wNAFUnsafe(e,t,r,n=this.ZERO){const i=Pi(e,this.bits);for(let s=0;s<i.windows&&r!==xi;s++){const{nextN:e,offset:o,isZero:a,isNeg:c}=Ai(r,s,i);if(r=e,!a){const e=t[o];n=n.add(c?e.negate():e)}}return Ci(r),n}getPrecomputes(e,t,r){let n=Ri.get(t);return n||(n=this.precomputeWindow(t,e),1!==e&&("function"==typeof r&&(n=r(n)),Ri.set(t,n))),n}cached(e,t,r){const n=Bi(e);return this.wNAF(n,this.getPrecomputes(n,e,r),t)}unsafe(e,t,r,n){const i=Bi(e);return 1===i?this._unsafeLadder(e,t,n):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),t,n)}createCache(e,t){_i(t,this.bits),Ti.set(e,t),Ri.delete(e)}hasCache(e){return 1!==Bi(e)}}function Ni(e,t,r){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return function(e){Jn(e,gi.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"}))}(t),t}return wi(e,{isLE:r})}BigInt(0),BigInt(1),BigInt(2),BigInt(8),mt("HashToScalar-");const ki=BigInt(0),ji=BigInt(1),Li=BigInt(2);const Di=BigInt(1),qi=BigInt(2),Mi=BigInt(3),$i=BigInt(5),zi=(BigInt(8),BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"));function Zi(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}const Fi=wi([zi,BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")][0],{isLE:!0}),Ki=(()=>{const e=Fi.ORDER;return function(e){const t=function(e){return Jn(e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...e})}(e),{P:r,type:n,adjustScalarBytes:i,powPminus2:s,randomBytes:o}=t,a="x25519"===n;if(!a&&"x448"!==n)throw new Error("invalid type");const c=o||xt,l=a?255:448,u=a?32:56,f=BigInt(a?9:5),h=BigInt(a?121665:39081),d=a?Li**BigInt(254):Li**BigInt(447),p=a?BigInt(8)*Li**BigInt(251)-ji:BigInt(4)*Li**BigInt(445)-ji,g=d+p+ji,y=e=>ci(e,r),m=b(f);function b(e){return Fn(y(e),u)}function w(e,t){const n=function(e,t){Hn("u",e,ki,r),Hn("scalar",t,d,g);const n=t,i=e;let o=ji,a=ki,c=e,u=ji,f=ki;for(let r=BigInt(l-1);r>=ki;r--){const e=n>>r&ji;f^=e,({x_2:o,x_3:c}=E(f,o,c)),({x_2:a,x_3:u}=E(f,a,u)),f=e;const t=o+a,s=y(t*t),l=o-a,d=y(l*l),p=s-d,g=c+u,m=y((c-u)*t),b=y(g*l),w=m+b,v=m-b;c=y(w*w),u=y(i*y(v*v)),o=y(s*d),a=y(p*(s+y(h*p)))}({x_2:o,x_3:c}=E(f,o,c)),({x_2:a,x_3:u}=E(f,a,u));const p=s(a);return y(o*p)}(function(e){const t=Kn("u coordinate",e,u);return a&&(t[31]&=127),y(zn(t))}(t),function(e){return zn(i(Kn("scalar",e,u)))}(e));if(n===ki)throw new Error("invalid private or public key received");return b(n)}function v(e){return w(e,m)}function E(e,t,r){const n=y(e*(t-r));return{x_2:t=y(t-n),x_3:r=y(r+n)}}const x={secretKey:u,publicKey:u,seed:u},I=(e=c(u))=>(et(e,x.seed),e);return{keygen:function(e){const t=I(e);return{secretKey:t,publicKey:v(t)}},getSharedSecret:(e,t)=>w(e,t),getPublicKey:e=>v(e),scalarMult:w,scalarMultBase:v,utils:{randomSecretKey:I,randomPrivateKey:I},GuBytes:m.slice(),lengths:x}}({P:e,type:"x25519",powPminus2:t=>{const{pow_p_5_8:r,b2:n}=function(e){const t=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),s=zi,o=e*e%s*e%s,a=li(o,qi,s)*o%s,c=li(a,Di,s)*e%s,l=li(c,$i,s)*c%s,u=li(l,t,s)*l%s,f=li(u,r,s)*u%s,h=li(f,n,s)*f%s,d=li(h,i,s)*h%s,p=li(d,i,s)*h%s,g=li(p,t,s)*l%s;return{pow_p_5_8:li(g,qi,s)*e%s,b2:o}}(t);return ci(li(r,Mi,e)*n,e)},adjustScalarBytes:Zi})})(),Vi=(e,t)=>(e+(e>=0?t:-t)/Xi)/t;function Hi(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}function Wi(e,t){const r={};for(let n of Object.keys(t))r[n]=void 0===e[n]?t[n]:e[n];return Ln(r.lowS,"lowS"),Ln(r.prehash,"prehash"),void 0!==r.format&&Hi(r.format),r}class Gi extends Error{constructor(e=""){super(e)}}const Ji={Err:Gi,_tlv:{encode:(e,t)=>{const{Err:r}=Ji;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");const n=t.length/2,i=qn(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");const s=n>127?qn(i.length/2|128):"";return qn(e)+s+i+t},decode(e,t){const{Err:r}=Ji;let n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");const i=t[n++];let s=0;if(128&i){const e=127&i;if(!e)throw new r("tlv.decode(long): indefinite length not supported");if(e>4)throw new r("tlv.decode(long): byte length is too big");const o=t.subarray(n,n+e);if(o.length!==e)throw new r("tlv.decode: length bytes not complete");if(0===o[0])throw new r("tlv.decode(long): zero leftmost byte");for(const t of o)s=s<<8|t;if(n+=e,s<128)throw new r("tlv.decode(long): not minimal encoding")}else s=i;const o=t.subarray(n,n+s);if(o.length!==s)throw new r("tlv.decode: wrong value length");return{v:o,l:t.subarray(n+s)}}},_int:{encode(e){const{Err:t}=Ji;if(e<Yi)throw new t("integer: negative integers are not allowed");let r=qn(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){const{Err:t}=Ji;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return $n(e)}},toSig(e){const{Err:t,_int:r,_tlv:n}=Ji,i=Kn("signature",e),{v:s,l:o}=n.decode(48,i);if(o.length)throw new t("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,s),{v:l,l:u}=n.decode(2,c);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(e){const{_tlv:t,_int:r}=Ji,n=t.encode(2,r.encode(e.r)),i=t.encode(2,r.encode(e.s));return t.encode(48,n+i)}},Yi=BigInt(0),Qi=BigInt(1),Xi=BigInt(2),es=BigInt(3),ts=BigInt(4);function rs(e,t){const{BYTES:r}=e;let n;if("bigint"==typeof t)n=t;else{let i=Kn("private key",t);try{n=e.fromBytes(i)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof t}`)}}if(!e.isValidNot0(n))throw new Error("invalid private key: out of range [1..N-1]");return n}function ns(e,t={}){const r=function(e,t,r={},n){if(void 0===n&&(n="edwards"===e),!t||"object"!=typeof t)throw new Error(`expected valid ${e} CURVE object`);for(const a of["p","n","h"]){const e=t[a];if(!("bigint"==typeof e&&e>xi))throw new Error(`CURVE.${a} must be positive bigint`)}const i=Ni(t.p,r.Fp,n),s=Ni(t.n,r.Fn,n),o=["Gx","Gy","a","weierstrass"===e?"b":"d"];for(const a of o)if(!i.isValid(t[a]))throw new Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return{CURVE:t=Object.freeze(Object.assign({},t)),Fp:i,Fn:s}}("weierstrass",e,t),{Fp:n,Fn:i}=r;let s=r.CURVE;const{h:o,n:a}=s;Jn(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:c}=t;if(c&&(!n.is0(s.a)||"bigint"!=typeof c.beta||!Array.isArray(c.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const l=ss(n,i);function u(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}const f=t.toBytes||function(e,t,r){const{x:i,y:s}=t.toAffine(),o=n.toBytes(i);return Ln(r,"isCompressed"),r?(u(),wt(is(!n.isOdd(s)),o)):wt(Uint8Array.of(4),o,n.toBytes(s))},h=t.fromBytes||function(e){Dn(e,void 0,"Point");const{publicKey:t,publicKeyUncompressed:r}=l,i=e.length,s=e[0],o=e.subarray(1);if(i!==t||2!==s&&3!==s){if(i===r&&4===s){const e=n.BYTES,t=n.fromBytes(o.subarray(0,e)),r=n.fromBytes(o.subarray(e,2*e));if(!p(t,r))throw new Error("bad point: is not on curve");return{x:t,y:r}}throw new Error(`bad point: got length ${i}, expected compressed=${t} or uncompressed=${r}`)}{const e=n.fromBytes(o);if(!n.isValid(e))throw new Error("bad point: is not on curve, wrong x");const t=d(e);let r;try{r=n.sqrt(t)}catch(a){const e=a instanceof Error?": "+a.message:"";throw new Error("bad point: is not on curve, sqrt error"+e)}return u(),1==(1&s)!==n.isOdd(r)&&(r=n.neg(r)),{x:e,y:r}}};function d(e){const t=n.sqr(e),r=n.mul(t,e);return n.add(n.add(r,n.mul(e,s.a)),s.b)}function p(e,t){const r=n.sqr(t),i=d(e);return n.eql(r,i)}if(!p(s.Gx,s.Gy))throw new Error("bad curve params: generator point");const g=n.mul(n.pow(s.a,es),ts),y=n.mul(n.sqr(s.b),BigInt(27));if(n.is0(n.add(g,y)))throw new Error("bad curve params: a or b");function m(e,t,r=!1){if(!n.isValid(t)||r&&n.is0(t))throw new Error(`bad point coordinate ${e}`);return t}function b(e){if(!(e instanceof I))throw new Error("ProjectivePoint expected")}function w(e){if(!c||!c.basises)throw new Error("no endo");return function(e,t,r){const[[n,i],[s,o]]=t,a=Vi(o*e,r),c=Vi(-i*e,r);let l=e-a*n-c*s,u=-a*i-c*o;const f=l<Yi,h=u<Yi;f&&(l=-l),h&&(u=-u);const d=Gn(Math.ceil(Wn(r)/2))+Qi;if(l<Yi||l>=d||u<Yi||u>=d)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:f,k1:l,k2neg:h,k2:u}}(e,c.basises,i.ORDER)}const v=Yn((e,t)=>{const{X:r,Y:i,Z:s}=e;if(n.eql(s,n.ONE))return{x:r,y:i};const o=e.is0();null==t&&(t=o?n.ONE:n.inv(s));const a=n.mul(r,t),c=n.mul(i,t),l=n.mul(s,t);if(o)return{x:n.ZERO,y:n.ZERO};if(!n.eql(l,n.ONE))throw new Error("invZ was invalid");return{x:a,y:c}}),E=Yn(e=>{if(e.is0()){if(t.allowInfinityPoint&&!n.is0(e.Y))return;throw new Error("bad point: ZERO")}const{x:r,y:i}=e.toAffine();if(!n.isValid(r)||!n.isValid(i))throw new Error("bad point: x or y not field elements");if(!p(r,i))throw new Error("bad point: equation left != right");if(!e.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function x(e,t,r,i,s){return r=new I(n.mul(r.X,e),r.Y,r.Z),t=Si(i,t),r=Si(s,r),t.add(r)}class I{constructor(e,t,r){this.X=m("x",e),this.Y=m("y",t,!0),this.Z=m("z",r),Object.freeze(this)}static CURVE(){return s}static fromAffine(e){const{x:t,y:r}=e||{};if(!e||!n.isValid(t)||!n.isValid(r))throw new Error("invalid affine point");if(e instanceof I)throw new Error("projective point not allowed");return n.is0(t)&&n.is0(r)?I.ZERO:new I(t,r,n.ONE)}static fromBytes(e){const t=I.fromAffine(h(Dn(e,void 0,"point")));return t.assertValidity(),t}static fromHex(e){return I.fromBytes(Kn("pointHex",e))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(e=8,t=!0){return O.createCache(this,e),t||this.multiply(es),this}assertValidity(){E(this)}hasEvenY(){const{y:e}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(e)}equals(e){b(e);const{X:t,Y:r,Z:i}=this,{X:s,Y:o,Z:a}=e,c=n.eql(n.mul(t,a),n.mul(s,i)),l=n.eql(n.mul(r,a),n.mul(o,i));return c&&l}negate(){return new I(this.X,n.neg(this.Y),this.Z)}double(){const{a:e,b:t}=s,r=n.mul(t,es),{X:i,Y:o,Z:a}=this;let c=n.ZERO,l=n.ZERO,u=n.ZERO,f=n.mul(i,i),h=n.mul(o,o),d=n.mul(a,a),p=n.mul(i,o);return p=n.add(p,p),u=n.mul(i,a),u=n.add(u,u),c=n.mul(e,u),l=n.mul(r,d),l=n.add(c,l),c=n.sub(h,l),l=n.add(h,l),l=n.mul(c,l),c=n.mul(p,c),u=n.mul(r,u),d=n.mul(e,d),p=n.sub(f,d),p=n.mul(e,p),p=n.add(p,u),u=n.add(f,f),f=n.add(u,f),f=n.add(f,d),f=n.mul(f,p),l=n.add(l,f),d=n.mul(o,a),d=n.add(d,d),f=n.mul(d,p),c=n.sub(c,f),u=n.mul(d,h),u=n.add(u,u),u=n.add(u,u),new I(c,l,u)}add(e){b(e);const{X:t,Y:r,Z:i}=this,{X:o,Y:a,Z:c}=e;let l=n.ZERO,u=n.ZERO,f=n.ZERO;const h=s.a,d=n.mul(s.b,es);let p=n.mul(t,o),g=n.mul(r,a),y=n.mul(i,c),m=n.add(t,r),w=n.add(o,a);m=n.mul(m,w),w=n.add(p,g),m=n.sub(m,w),w=n.add(t,i);let v=n.add(o,c);return w=n.mul(w,v),v=n.add(p,y),w=n.sub(w,v),v=n.add(r,i),l=n.add(a,c),v=n.mul(v,l),l=n.add(g,y),v=n.sub(v,l),f=n.mul(h,w),l=n.mul(d,y),f=n.add(l,f),l=n.sub(g,f),f=n.add(g,f),u=n.mul(l,f),g=n.add(p,p),g=n.add(g,p),y=n.mul(h,y),w=n.mul(d,w),g=n.add(g,y),y=n.sub(p,y),y=n.mul(h,y),w=n.add(w,y),p=n.mul(g,w),u=n.add(u,p),p=n.mul(v,w),l=n.mul(m,l),l=n.sub(l,p),p=n.mul(m,g),f=n.mul(v,f),f=n.add(f,p),new I(l,u,f)}subtract(e){return this.add(e.negate())}is0(){return this.equals(I.ZERO)}multiply(e){const{endo:r}=t;if(!i.isValidNot0(e))throw new Error("invalid scalar: out of range");let n,s;const o=e=>O.cached(this,e,e=>Oi(I,e));if(r){const{k1neg:t,k1:i,k2neg:a,k2:c}=w(e),{p:l,f:u}=o(i),{p:f,f:h}=o(c);s=u.add(h),n=x(r.beta,l,f,t,a)}else{const{p:t,f:r}=o(e);n=t,s=r}return Oi(I,[n,s])[0]}multiplyUnsafe(e){const{endo:r}=t,n=this;if(!i.isValid(e))throw new Error("invalid scalar: out of range");if(e===Yi||n.is0())return I.ZERO;if(e===Qi)return n;if(O.hasCache(this))return this.multiply(e);if(r){const{k1neg:t,k1:i,k2neg:s,k2:o}=w(e),{p1:a,p2:c}=function(e,t,r,n){let i=t,s=e.ZERO,o=e.ZERO;for(;r>xi||n>xi;)r&Ii&&(s=s.add(i)),n&Ii&&(o=o.add(i)),i=i.double(),r>>=Ii,n>>=Ii;return{p1:s,p2:o}}(I,n,i,o);return x(r.beta,a,c,t,s)}return O.unsafe(n,e)}multiplyAndAddUnsafe(e,t,r){const n=this.multiplyUnsafe(t).add(e.multiplyUnsafe(r));return n.is0()?void 0:n}toAffine(e){return v(this,e)}isTorsionFree(){const{isTorsionFree:e}=t;return o===Qi||(e?e(I,this):O.unsafe(this,a).is0())}clearCofactor(){const{clearCofactor:e}=t;return o===Qi?this:e?e(I,this):this.multiplyUnsafe(o)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}toBytes(e=!0){return Ln(e,"isCompressed"),this.assertValidity(),f(I,this,e)}toHex(e=!0){return pt(this.toBytes(e))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(e=!0){return this.toBytes(e)}_setWindowSize(e){this.precompute(e)}static normalizeZ(e){return Oi(I,e)}static msm(e,t){return function(e,t,r,n){(function(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((e,r)=>{if(!(e instanceof t))throw new Error("invalid point at index "+r)})})(r,e),function(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((e,r)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+r)})}(n,t);const i=r.length,s=n.length;if(i!==s)throw new Error("arrays of points and scalars must have equal length");const o=e.ZERO,a=Wn(BigInt(i));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=Gn(c),u=new Array(Number(l)+1).fill(o);let f=o;for(let h=Math.floor((t.BITS-1)/c)*c;h>=0;h-=c){u.fill(o);for(let t=0;t<s;t++){const e=Number(n[t]>>BigInt(h)&l);u[e]=u[e].add(r[t])}let e=o;for(let t=u.length-1,r=o;t>0;t--)r=r.add(u[t]),e=e.add(r);if(f=f.add(e),0!==h)for(let t=0;t<c;t++)f=f.double()}return f}(I,i,e,t)}static fromPrivateKey(e){return I.BASE.multiply(rs(i,e))}}I.BASE=new I(s.Gx,s.Gy,n.ONE),I.ZERO=new I(n.ZERO,n.ONE,n.ZERO),I.Fp=n,I.Fn=i;const S=i.BITS,O=new Ui(I,t.endo?Math.ceil(S/2):S);return I.BASE.precompute(8),I}function is(e){return Uint8Array.of(e?2:3)}function ss(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function os(e,t,r={}){tt(t),Jn(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const n=r.randomBytes||xt,i=r.hmac||((e,...r)=>Bn(t,e,wt(...r))),{Fp:s,Fn:o}=e,{ORDER:a,BITS:c}=o,{keygen:l,getPublicKey:u,getSharedSecret:f,utils:h,lengths:d}=function(e,t={}){const{Fn:r}=e,n=t.randomBytes||xt,i=Object.assign(ss(e.Fp,r),{seed:Ei(r.ORDER)});function s(e){try{return!!rs(r,e)}catch{return!1}}function o(e=n(i.seed)){return function(e,t,r=!1){const n=e.length,i=vi(t),s=Ei(t);if(n<16||n<s||n>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+n);const o=ci(r?zn(e):$n(e),t-Xn)+Xn;return r?Fn(o,i):Zn(o,i)}(Dn(e,i.seed,"seed"),r.ORDER)}function a(t,n=!0){return e.BASE.multiply(rs(r,t)).toBytes(n)}function c(t){if("bigint"==typeof t)return!1;if(t instanceof e)return!0;const{secretKey:n,publicKey:s,publicKeyUncompressed:o}=i;if(r.allowedLengths||n===s)return;const a=Kn("key",t).length;return a===s||a===o}return Object.freeze({getPublicKey:a,getSharedSecret:function(t,n,i=!0){if(!0===c(t))throw new Error("first arg must be private key");if(!1===c(n))throw new Error("second arg must be public key");const s=rs(r,t);return e.fromHex(n).multiply(s).toBytes(i)},keygen:function(e){const t=o(e);return{secretKey:t,publicKey:a(t)}},Point:e,utils:{isValidSecretKey:s,isValidPublicKey:function(t,r){const{publicKey:n,publicKeyUncompressed:s}=i;try{const i=t.length;return!(!0===r&&i!==n||!1===r&&i!==s||!e.fromBytes(t))}catch{return!1}},randomSecretKey:o,isValidPrivateKey:s,randomPrivateKey:o,normPrivateKeyToScalar:e=>rs(r,e),precompute:(t=8,r=e.BASE)=>r.precompute(t,!1)},lengths:i})}(e,r),p={prehash:!1,lowS:"boolean"==typeof r.lowS&&r.lowS,format:void 0,extraEntropy:!1},g="compact";function y(e){return e>a>>Qi}function m(e,t){if(!o.isValidNot0(t))throw new Error(`invalid signature ${e}: out of range 1..Point.Fn.ORDER`);return t}class b{constructor(e,t,r){this.r=m("r",e),this.s=m("s",t),null!=r&&(this.recovery=r),Object.freeze(this)}static fromBytes(e,t=g){let r;if(function(e,t){Hi(t);const r=d.signature;Dn(e,"compact"===t?r:"recovered"===t?r+1:void 0,`${t} signature`)}(e,t),"der"===t){const{r:t,s:r}=Ji.toSig(Dn(e));return new b(t,r)}"recovered"===t&&(r=e[0],t="compact",e=e.subarray(1));const n=o.BYTES,i=e.subarray(0,n),s=e.subarray(n,2*n);return new b(o.fromBytes(i),o.fromBytes(s),r)}static fromHex(e,t){return this.fromBytes(yt(e),t)}addRecoveryBit(e){return new b(this.r,this.s,e)}recoverPublicKey(t){const r=s.ORDER,{r:n,s:i,recovery:c}=this;if(null==c||![0,1,2,3].includes(c))throw new Error("recovery id invalid");if(a*Xi<r&&c>1)throw new Error("recovery id is ambiguous for h>1 curve");const l=2===c||3===c?n+a:n;if(!s.isValid(l))throw new Error("recovery id 2 or 3 invalid");const u=s.toBytes(l),f=e.fromBytes(wt(is(0==(1&c)),u)),h=o.inv(l),d=v(Kn("msgHash",t)),p=o.create(-d*h),g=o.create(i*h),y=e.BASE.multiplyUnsafe(p).add(f.multiplyUnsafe(g));if(y.is0())throw new Error("point at infinify");return y.assertValidity(),y}hasHighS(){return y(this.s)}toBytes(e=g){if(Hi(e),"der"===e)return yt(Ji.hexFromSig(this));const t=o.toBytes(this.r),r=o.toBytes(this.s);if("recovered"===e){if(null==this.recovery)throw new Error("recovery bit must be present");return wt(Uint8Array.of(this.recovery),t,r)}return wt(t,r)}toHex(e){return pt(this.toBytes(e))}assertValidity(){}static fromCompact(e){return b.fromBytes(Kn("sig",e),"compact")}static fromDER(e){return b.fromBytes(Kn("sig",e),"der")}normalizeS(){return this.hasHighS()?new b(this.r,o.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return pt(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return pt(this.toBytes("compact"))}}const w=r.bits2int||function(e){if(e.length>8192)throw new Error("input is too large");const t=$n(e),r=8*e.length-c;return r>0?t>>BigInt(r):t},v=r.bits2int_modN||function(e){return o.create(w(e))},E=Gn(c);function x(e){return Hn("num < 2^"+c,e,Yi,E),o.toBytes(e)}function I(e,r){return Dn(e,void 0,"message"),r?Dn(t(e),void 0,"prehashed message"):e}return Object.freeze({keygen:l,getPublicKey:u,getSharedSecret:f,utils:h,lengths:d,Point:e,sign:function(r,s,a={}){r=Kn("message",r);const{seed:c,k2sig:l}=function(t,r,i){if(["recovered","canonical"].some(e=>e in i))throw new Error("sign() legacy options not supported");const{lowS:s,prehash:a,extraEntropy:c}=Wi(i,p);t=I(t,a);const l=v(t),u=rs(o,r),f=[x(u),x(l)];if(null!=c&&!1!==c){const e=!0===c?n(d.secretKey):c;f.push(Kn("extraEntropy",e))}const h=wt(...f),g=l;return{seed:h,k2sig:function(t){const r=w(t);if(!o.isValidNot0(r))return;const n=o.inv(r),i=e.BASE.multiply(r).toAffine(),a=o.create(i.x);if(a===Yi)return;const c=o.create(n*o.create(g+a*u));if(c===Yi)return;let l=(i.x===a?0:2)|Number(i.y&Qi),f=c;return s&&y(c)&&(f=o.neg(c),l^=1),new b(a,f,l)}}}(r,s,a);return function(e,t,r){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof r)throw new Error("hmacFn must be a function");const n=e=>new Uint8Array(e),i=e=>Uint8Array.of(e);let s=n(e),o=n(e),a=0;const c=()=>{s.fill(1),o.fill(0),a=0},l=(...e)=>r(o,s,...e),u=(e=n(0))=>{o=l(i(0),e),s=l(),0!==e.length&&(o=l(i(1),e),s=l())},f=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const r=[];for(;e<t;){s=l();const t=s.slice();r.push(t),e+=s.length}return wt(...r)};return(e,t)=>{let r;for(c(),u(e);!(r=t(f()));)u();return c(),r}}(t.outputLen,o.BYTES,i)(c,l)},verify:function(t,r,n,i={}){const{lowS:s,prehash:a,format:c}=Wi(i,p);if(n=Kn("publicKey",n),r=I(Kn("message",r),a),"strict"in i)throw new Error("options.strict was renamed to lowS");const l=void 0===c?function(e){let t;const r="string"==typeof e||Qe(e),n=!r&&null!==e&&"object"==typeof e&&"bigint"==typeof e.r&&"bigint"==typeof e.s;if(!r&&!n)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(n)t=new b(e.r,e.s);else if(r){try{t=b.fromBytes(Kn("sig",e),"der")}catch(s){if(!(s instanceof Ji.Err))throw s}if(!t)try{t=b.fromBytes(Kn("sig",e),"compact")}catch{return!1}}return t||!1}(t):b.fromBytes(Kn("sig",t),c);if(!1===l)return!1;try{const t=e.fromBytes(n);if(s&&l.hasHighS())return!1;const{r:i,s:a}=l,c=v(r),u=o.inv(a),f=o.create(c*u),h=o.create(i*u),d=e.BASE.multiplyUnsafe(f).add(t.multiplyUnsafe(h));return!d.is0()&&o.create(d.x)===i}catch{return!1}},recoverPublicKey:function(e,t,r={}){const{prehash:n}=Wi(r,p);return t=I(t,n),b.fromBytes(e,"recovered").recoverPublicKey(t).toBytes()},Signature:b,hash:t})}function as(e){const{CURVE:t,curveOpts:r,hash:n,ecdsaOpts:i}=function(e){const{CURVE:t,curveOpts:r}=function(e){const t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r=e.Fp;let n=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(e=>Math.ceil(e/2)))):void 0;return{CURVE:t,curveOpts:{Fp:r,Fn:wi(t.n,{BITS:e.nBitLength,allowedLengths:n,modFromBytes:e.wrapPrivateKey}),allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes}}}(e);return{CURVE:t,curveOpts:r,hash:e.hash,ecdsaOpts:{hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN}}}(e);return function(e,t){const r=t.Point;return Object.assign({},t,{ProjectivePoint:r,CURVE:Object.assign({},e,bi(r.Fn.ORDER,r.Fn.BITS))})}(e,os(ns(t,r),n,i))}function cs(e,t){const r=t=>as({...e,hash:t});return{...r(t),create:r}}const ls={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},us={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},fs={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},hs=wi(ls.p),ds=wi(us.p),ps=wi(fs.p),gs=cs({...ls,Fp:hs,lowS:!1},ir);cs({...us,Fp:ds,lowS:!1},or),cs({...fs,Fp:ps,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},sr);const ys=gs,ms="base16",bs="base64pad",ws="base64url",vs="utf8";function Es(){const e=xt(32);return(0,z.BB)(e,ms)}function xs(e){const t=Nn((0,z.mL)(e,ms));return(0,z.BB)(t,ms)}function Is(e){const t=Nn((0,z.mL)(e,vs));return(0,z.BB)(t,ms)}function Ss(e){return(0,z.mL)(`${e}`,"base10")}function Os(e){return Number((0,z.BB)(e,"base10"))}function _s(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function Ps(e){const t=e.replace(/-/g,"+").replace(/_/g,"/");return t+"=".repeat((4-t.length%4)%4)}function As(e){if(2===Os(e.type))return(0,z.BB)((0,z.zo)([e.type,e.sealed]),bs);if(1===Os(e.type)){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return(0,z.BB)((0,z.zo)([e.type,e.senderPublicKey,e.iv,e.sealed]),bs)}return(0,z.BB)((0,z.zo)([e.type,e.iv,e.sealed]),bs)}function Rs(e){const t=(e.encoding||bs)===ws?Ps(e.encoded):e.encoded,r=(0,z.mL)(t,bs),n=r.slice(0,1);if(1===Os(n)){const e=33,t=e+12,i=r.slice(1,e),s=r.slice(e,t);return{type:n,sealed:r.slice(t),iv:s,senderPublicKey:i}}if(2===Os(n))return{type:n,sealed:r.slice(1),iv:xt(12)};const i=r.slice(1,13);return{type:n,sealed:r.slice(13),iv:i}}function Ts(e){const t=e?.type||0;if(1===t){if(typeof e?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function Bs(e){return 1===e.type&&"string"==typeof e.senderPublicKey&&"string"==typeof e.receiverPublicKey}function Cs(e){return 2===e.type}function Us(e){return e?.relay||{protocol:"irn"}}function Ns(e){const t=Z.iO[e];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${e}`);return t}var ks=Object.defineProperty,js=Object.defineProperties,Ls=Object.getOwnPropertyDescriptors,Ds=Object.getOwnPropertySymbols,qs=Object.prototype.hasOwnProperty,Ms=Object.prototype.propertyIsEnumerable,$s=(e,t,r)=>t in e?ks(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,zs=(e,t)=>{for(var r in t||(t={}))qs.call(t,r)&&$s(e,r,t[r]);if(Ds)for(var r of Ds(t))Ms.call(t,r)&&$s(e,r,t[r]);return e};function Zs(e,t="-"){const r={},n="relay"+t;return Object.keys(e).forEach(t=>{if(t.startsWith(n)){const i=t.replace(n,"");r[i]=e[t]}}),r}function Fs(e){if(!e.includes("wc:")){const t=Te(e);null!=t&&t.includes("wc:")&&(e=t)}const t=(e=(e=e.includes("wc://")?e.replace("wc://",""):e).includes("wc:")?e.replace("wc:",""):e).indexOf(":"),r=-1!==e.indexOf("?")?e.indexOf("?"):void 0,n=e.substring(0,t),i=e.substring(t+1,r).split("@"),s=typeof r<"u"?e.substring(r):"",o=new URLSearchParams(s),a=Object.fromEntries(o.entries()),c="string"==typeof a.methods?a.methods.split(","):void 0;return{protocol:n,topic:Ks(i[0]),version:parseInt(i[1],10),symKey:a.symKey,relay:Zs(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function Ks(e){return e.startsWith("//")?e.substring(2):e}function Vs(e){const t=new URLSearchParams,r=zs(zs(((e,t)=>js(e,Ls(t)))(zs({},function(e,t="-"){const r={};return Object.keys(e).forEach(n=>{e[n]&&(r["relay"+t+n]=e[n])}),r}(e.relay)),{symKey:e.symKey}),e.expiryTimestamp&&{expiryTimestamp:e.expiryTimestamp.toString()}),e.methods&&{methods:e.methods.join(",")});return Object.entries(r).sort(([e],[t])=>e.localeCompare(t)).forEach(([e,r])=>{void 0!==r&&t.append(e,String(r))}),`${e.protocol}:${e.topic}@${e.version}?${t}`}function Hs(e,t,r){return`${e}?wc_ev=${r}&topic=${t}`}var Ws=Object.defineProperty,Gs=Object.defineProperties,Js=Object.getOwnPropertyDescriptors,Ys=Object.getOwnPropertySymbols,Qs=Object.prototype.hasOwnProperty,Xs=Object.prototype.propertyIsEnumerable,eo=(e,t,r)=>t in e?Ws(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,to=(e,t)=>{for(var r in t||(t={}))Qs.call(t,r)&&eo(e,r,t[r]);if(Ys)for(var r of Ys(t))Xs.call(t,r)&&eo(e,r,t[r]);return e},ro=(e,t)=>Gs(e,Js(t));function no(e){const t=[];return e.forEach(e=>{const[r,n]=e.split(":");t.push(`${r}:${n}`)}),t}function io(e){const t=[];return Object.values(e).forEach(e=>{t.push(...no(e.accounts))}),[...new Set(t)]}function so(e){return e.includes(":")}function oo(e){return so(e)?e.split(":")[0]:e}function ao(e){var t,r,n;const i={};if(!go(e))return i;for(const[s,o]of Object.entries(e)){const e=so(s)?[s]:o.chains,a=o.methods||[],c=o.events||[],l=oo(s);i[l]=ro(to({},i[l]),{chains:xe(e,null==(t=i[l])?void 0:t.chains),methods:xe(a,null==(r=i[l])?void 0:r.methods),events:xe(c,null==(n=i[l])?void 0:n.events)})}return i}function co(e,t){const r=function(e){const t={};return e?.forEach(e=>{var r;const[n,i]=e.split(":");t[n]||(t[n]={accounts:[],chains:[],events:[],methods:[]}),t[n].accounts.push(e),null==(r=t[n].chains)||r.push(`${n}:${i}`)}),t}(t=t.map(e=>e.replace("did:pkh:","")));for(const[n,i]of Object.entries(r))i.methods=i.methods?xe(i.methods,e):e,i.events=["chainChanged","accountsChanged"];return r}const lo={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},uo={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function fo(e,t){const{message:r,code:n}=uo[e];return{message:t?`${r} ${t}`:r,code:n}}function ho(e,t){const{message:r,code:n}=lo[e];return{message:t?`${r} ${t}`:r,code:n}}function po(e,t){return!!Array.isArray(e)&&(!(typeof t<"u"&&e.length)||e.every(t))}function go(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function yo(e){return typeof e>"u"}function mo(e,t){return!(!t||!yo(e))||"string"==typeof e&&!!e.trim().length}function bo(e,t){return!(!t||!yo(e))||"number"==typeof e&&!isNaN(e)}function wo(e){return!(!mo(e,!1)||!e.includes(":"))&&2===e.split(":").length}function vo(e){let t=!0;return po(e)?e.length&&(t=e.every(e=>mo(e,!1))):t=!1,t}function Eo(e,t){let r=null;return Object.values(e).forEach(e=>{if(r)return;const n=function(e,t){let r=null;return vo(e?.methods)?vo(e?.events)||(r=ho("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=ho("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}(e,`${t}, namespace`);n&&(r=n)}),r}function xo(e,t){let r=null;if(e&&go(e)){const n=Eo(e,t);n&&(r=n);const i=function(e,t){let r=null;return Object.values(e).forEach(e=>{if(r)return;const n=function(e,t){let r=null;return po(e)?e.forEach(e=>{r||function(e){if(mo(e,!1)&&e.includes(":")){const t=e.split(":");if(3===t.length){const e=t[0]+":"+t[1];return!!t[2]&&wo(e)}}return!1}(e)||(r=ho("UNSUPPORTED_ACCOUNTS",`${t}, account ${e} should be a string and conform to "namespace:chainId:address" format`))}):r=ho("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}(e?.accounts,`${t} namespace`);n&&(r=n)}),r}(e,t);i&&(r=i)}else r=fo("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function Io(e){return mo(e.protocol,!0)}function So(e){return typeof e<"u"&&null!==typeof e}function Oo(e,t){return!(!wo(t)||!io(e).includes(t))}function _o(e,t,r){let n=null;const i=function(e){const t={};return Object.keys(e).forEach(r=>{var n;r.includes(":")?t[r]=e[r]:null==(n=e[r].chains)||n.forEach(n=>{t[n]={methods:e[r].methods,events:e[r].events}})}),t}(e),s=function(e){const t={};return Object.keys(e).forEach(r=>{r.includes(":")?t[r]=e[r]:no(e[r].accounts)?.forEach(n=>{t[n]={accounts:e[r].accounts.filter(e=>e.includes(`${n}:`)),methods:e[r].methods,events:e[r].events}})}),t}(t),o=Object.keys(i),a=Object.keys(s),c=Po(Object.keys(e)),l=Po(Object.keys(t)),u=c.filter(e=>!l.includes(e));return u.length&&(n=fo("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.\n      Required: ${u.toString()}\n      Received: ${Object.keys(t).toString()}`)),he(o,a)||(n=fo("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.\n      Required: ${o.toString()}\n      Approved: ${a.toString()}`)),Object.keys(t).forEach(e=>{if(!e.includes(":")||n)return;const i=no(t[e].accounts);i.includes(e)||(n=fo("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${e}\n        Required: ${e}\n        Approved: ${i.toString()}`))}),o.forEach(e=>{n||(he(i[e].methods,s[e].methods)?he(i[e].events,s[e].events)||(n=fo("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${e}`)):n=fo("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${e}`))}),n}function Po(e){return[...new Set(e.map(e=>e.includes(":")?e.split(":")[0]:e))]}function Ao(){const e=ce();return new Promise(t=>{switch(e){case"browser":t(ae()&&navigator?.onLine);break;case"react-native":t(function(){return Ro.apply(this,arguments)}());break;default:t(!0)}})}function Ro(){return(Ro=(0,n.Z)(function*(){return!(oe()&&typeof global<"u"&&null!=global&&global.NetInfo)||(yield null==global?void 0:global.NetInfo.fetch())?.isConnected})).apply(this,arguments)}const To={};class Bo{static get(e){return To[e]}static set(e,t){To[e]=t}static delete(e){delete To[e]}}function Co(e){return new Uint8Array(e.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function Uo(e){const t=Uint8Array.from(Buffer.from(e.signature,"hex")),r=function(e){const t=M.Jq.decode(e);if(t.length<33)throw new Error("Too short to contain a public key");return t.slice(1,33)}(e.transaction.address),n=function({publicKey:e,signature:t,payload:r}){var n;const i=Co(r.method),s=128|parseInt((null==(n=r.version)?void 0:n.toString())||"4"),o=function(e){const t=M.Jq.decode(e)[0];return 42===t?0:60===t?2:1}(r.address),a="00"===r.era?new Uint8Array([0]):Co(r.era);if(1!==a.length&&2!==a.length)throw new Error("Invalid era length");const c=parseInt(r.nonce,16),l=new Uint8Array([255&c,c>>8&255]),u=BigInt(`0x${function(e){return e.startsWith("0x")?e.slice(2):e}(r.tip)}`),f=function(e){if(e<BigInt(1)<<BigInt(6))return new Uint8Array([Number(e<<BigInt(2))]);if(e<BigInt(1)<<BigInt(14)){const t=e<<BigInt(2)|BigInt(1);return new Uint8Array([Number(t&BigInt(255)),Number(t>>BigInt(8)&BigInt(255))])}if(e<BigInt(1)<<BigInt(30)){const t=e<<BigInt(2)|BigInt(2);return new Uint8Array([Number(t&BigInt(255)),Number(t>>BigInt(8)&BigInt(255)),Number(t>>BigInt(16)&BigInt(255)),Number(t>>BigInt(24)&BigInt(255))])}throw new Error("BigInt compact encoding not supported > 2^30")}(u),h=new Uint8Array([0,...e,o,...t,...a,...l,...f,...i]),d=function(e){if(e<64)return new Uint8Array([e<<2]);if(e<16384){const t=e<<2|1;return new Uint8Array([255&t,t>>8&255])}if(e<1<<30){const t=e<<2|2;return new Uint8Array([255&t,t>>8&255,t>>16&255,t>>24&255])}throw new Error("Compact encoding > 2^30 not supported")}(h.length+1);return new Uint8Array([...d,s,...h])}({publicKey:r,signature:t,payload:e.transaction});return function(e){const t=Co(e),r=(0,F.blake2b)(t,void 0,32);return"0x"+Buffer.from(r).toString("hex")}(Buffer.from(n).toString("hex"))}function No({logger:e,name:t}){const r="string"==typeof e?(0,K.Rt)({opts:{level:e,name:t}}).logger:e;return r.level="string"==typeof e?e:e.level,r}var ko=r(59093),jo=r(39927),Lo=r(52399),Do=Object.defineProperty,qo=(e,t,r)=>((e,t,r)=>t in e?Do(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class Mo extends Lo.q{constructor(e){super(),this.opts=e,qo(this,"protocol","wc"),qo(this,"version",2)}}var $o=Object.defineProperty;class zo extends Lo.q{constructor(e,t){super(),this.core=e,this.logger=t,((e,t,r)=>{((e,t,r)=>{t in e?$o(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r)})(this,"records",new Map)}}class Zo extends Lo.q{constructor(e,t){super(),this.relayer=e,this.logger=t}}class Fo extends Lo.q{constructor(e){super()}}class Ko extends Lo.q{constructor(e,t){super(),this.relayer=e,this.logger=t}}class Vo extends Lo.q{constructor(e,t){super(),this.core=e,this.logger=t}}var Ho=Object.defineProperty,Wo=(e,t,r)=>((e,t,r)=>t in e?Ho(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r),Go=r(80328),Jo=r(2517),Yo=r(22339),Qo=r(70213);const Xo="wc@2:core:",ea={database:":memory:"},ta="client_ed25519_seed",ra=o.ONE_DAY,na=o.SIX_HOURS,ia="wss://relay.walletconnect.org",sa="relayer_publish",oa="2.23.6",aa={link_mode:"link_mode",relay:"relay"},ca="WALLETCONNECT_LINK_MODE_APPS",la="subscription_created",ua="subscription_deleted",fa={wc_pairingDelete:{req:{ttl:o.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:o.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:o.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:o.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:o.ONE_DAY,prompt:!1,tag:0},res:{ttl:o.ONE_DAY,prompt:!1,tag:0}}},ha="expirer_expired",da="https://verify.walletconnect.org",pa=da,ga=`${pa}/v3`,ya=["https://verify.walletconnect.com",da];var ma=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function f(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var f=0,h=s-1;(0!==u||f<i)&&-1!==h;h--,f++)o[h]=(u+=a*o[h]>>>0)%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=f,t++}if(" "!==e[t]){for(var d=s-i;d!==s&&0===o[d];)d++;for(var p=new Uint8Array(n+(s-d)),g=n;d!==s;)p[g++]=o[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,s=t.length;i!==s&&0===t[i];)i++,r++;for(var o=(s-i)*u+1>>>0,l=new Uint8Array(o);i!==s;){for(var f=t[i],h=0,d=o-1;(0!==f||h<n)&&-1!==d;d--,h++)l[d]=(f+=256*l[d]>>>0)%a>>>0,f=f/a>>>0;if(0!==f)throw new Error("Non-zero carry");n=h,i++}for(var p=o-n;p!==o&&0===l[p];)p++;for(var g=c.repeat(r);p<o;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:f,decode:function(e){var r=f(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const ba=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};class wa{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class va{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return xa(this,e)}}class Ea{constructor(e){this.decoders=e}or(e){return xa(this,e)}decode(e){const t=this.decoders[e[0]];if(t)return t.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const xa=(e,t)=>new Ea({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Ia{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new wa(e,t,r),this.decoder=new va(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Sa=({name:e,prefix:t,encode:r,decode:n})=>new Ia(e,t,r,n),Oa=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=ma(r,t);return Sa({prefix:e,name:t,encode:n,decode:e=>ba(i(e))})},_a=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Sa({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;for(;"="===e[s-1];)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError(`Non-${n} character`);c=c<<r|t,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),Pa=Sa({prefix:"\0",name:"identity",encode:e=>(e=>(new TextDecoder).decode(e))(e),decode:e=>(e=>(new TextEncoder).encode(e))(e)});var Aa=Object.freeze({__proto__:null,identity:Pa});const Ra=_a({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Ta=Object.freeze({__proto__:null,base2:Ra});const Ba=_a({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Ca=Object.freeze({__proto__:null,base8:Ba});const Ua=Oa({prefix:"9",name:"base10",alphabet:"0123456789"});var Na=Object.freeze({__proto__:null,base10:Ua});const ka=_a({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),ja=_a({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var La=Object.freeze({__proto__:null,base16:ka,base16upper:ja});const Da=_a({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),qa=_a({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ma=_a({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),$a=_a({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),za=_a({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Za=_a({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Fa=_a({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Ka=_a({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Va=_a({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Ha=Object.freeze({__proto__:null,base32:Da,base32upper:qa,base32pad:Ma,base32padupper:$a,base32hex:za,base32hexupper:Za,base32hexpad:Fa,base32hexpadupper:Ka,base32z:Va});const Wa=Oa({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Ga=Oa({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ja=Object.freeze({__proto__:null,base36:Wa,base36upper:Ga});const Ya=Oa({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Qa=Oa({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Xa=Object.freeze({__proto__:null,base58btc:Ya,base58flickr:Qa});const ec=_a({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),tc=_a({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),rc=_a({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),nc=_a({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var ic=Object.freeze({__proto__:null,base64:ec,base64pad:tc,base64url:rc,base64urlpad:nc});const sc=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),oc=sc.reduce((e,t,r)=>(e[r]=t,e),[]),ac=sc.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]),cc=Sa({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+oc[t],"")},decode:function(e){const t=[];for(const r of e){const e=ac[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var lc=Object.freeze({__proto__:null,base256emoji:cc}),uc=Math.pow(2,31),fc=Math.pow(2,7),hc=Math.pow(2,14),dc=Math.pow(2,21),pc=Math.pow(2,28),gc=Math.pow(2,35),yc=Math.pow(2,42),mc=Math.pow(2,49),bc=Math.pow(2,56),wc=Math.pow(2,63),vc={encode:function e(t,r,n){r=r||[];for(var i=n=n||0;t>=uc;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},decode:function e(t,r){var n,i=0,s=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],i+=s<28?(127&n)<<s:(127&n)*Math.pow(2,s),s+=7}while(n>=128);return e.bytes=o-r,i},encodingLength:function(e){return e<fc?1:e<hc?2:e<dc?3:e<pc?4:e<gc?5:e<yc?6:e<mc?7:e<bc?8:e<wc?9:10}},Ec=vc;const xc=(e,t,r=0)=>(Ec.encode(e,t,r),t),Ic=e=>Ec.encodingLength(e),Sc=(e,t)=>{const r=t.byteLength,n=Ic(e),i=n+Ic(r),s=new Uint8Array(i+r);return xc(e,s,0),xc(r,s,n),s.set(t,i),new Oc(e,r,t,s)};class Oc{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const _c=({name:e,code:t,encode:r})=>new Pc(e,t,r);class Pc{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Sc(this.code,t):t.then(e=>Sc(this.code,e))}throw Error("Unknown type, must be binary type")}}const Ac=e=>function(){var t=(0,n.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(e,t))});return function(e){return t.apply(this,arguments)}}(),Rc=_c({name:"sha2-256",code:18,encode:Ac("SHA-256")}),Tc=_c({name:"sha2-512",code:19,encode:Ac("SHA-512")});Object.freeze({__proto__:null,sha256:Rc,sha512:Tc});const Bc=ba;Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:Bc,digest:e=>Sc(0,Bc(e))}}),new TextEncoder,new TextDecoder;const Cc={...Aa,...Ta,...Ca,...Na,...La,...Ha,...Ja,...Xa,...ic,...lc};function Uc(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Nc(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const kc=Nc("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>(new TextEncoder).encode(e.substring(1))),jc=Nc("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{const t=function(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?Uc(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),Lc={utf8:kc,"utf-8":kc,hex:Cc.base16,latin1:jc,ascii:jc,binary:jc,...Cc};var Dc=Object.defineProperty,qc=(e,t,r)=>((e,t,r)=>t in e?Dc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class Mc{constructor(e,t){var r=this;this.core=e,this.logger=t,qc(this,"keychain",new Map),qc(this,"name","keychain"),qc(this,"version","0.3"),qc(this,"initialized",!1),qc(this,"storagePrefix",Xo),qc(this,"init",(0,n.Z)(function*(){if(!r.initialized){const e=yield r.getKeyChain();typeof e<"u"&&(r.keychain=e),r.initialized=!0}})),qc(this,"has",e=>(this.isInitialized(),this.keychain.has(e))),qc(this,"set",function(){var e=(0,n.Z)(function*(e,t){r.isInitialized(),r.keychain.set(e,t),yield r.persist()});return function(t,r){return e.apply(this,arguments)}}()),qc(this,"get",e=>{this.isInitialized();const t=this.keychain.get(e);if(typeof t>"u"){const{message:t}=fo("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(t)}return t}),qc(this,"del",function(){var e=(0,n.Z)(function*(e){r.isInitialized(),r.keychain.delete(e),yield r.persist()});return function(t){return e.apply(this,arguments)}}()),this.core=e,this.logger=(0,K.Ep)(t,this.name)}get context(){return(0,K.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}setKeyChain(e){var t=this;return(0,n.Z)(function*(){yield t.core.storage.setItem(t.storageKey,de(e))})()}getKeyChain(){var e=this;return(0,n.Z)(function*(){const t=yield e.core.storage.getItem(e.storageKey);return typeof t<"u"?pe(t):void 0})()}persist(){var e=this;return(0,n.Z)(function*(){yield e.setKeyChain(e.keychain)})()}isInitialized(){if(!this.initialized){const{message:e}=fo("NOT_INITIALIZED",this.name);throw new Error(e)}}}var $c=Object.defineProperty,zc=(e,t,r)=>((e,t,r)=>t in e?$c(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class Zc{constructor(e,t,r){var i=this;this.core=e,this.logger=t,zc(this,"name","crypto"),zc(this,"keychain"),zc(this,"randomSessionIdentifier",Es()),zc(this,"initialized",!1),zc(this,"clientId"),zc(this,"init",(0,n.Z)(function*(){i.initialized||(yield i.keychain.init(),i.initialized=!0)})),zc(this,"hasKeys",e=>(this.isInitialized(),this.keychain.has(e))),zc(this,"getClientId",(0,n.Z)(function*(){if(i.isInitialized(),i.clientId)return i.clientId;const e=yield i.getClientSeed(),t=$.Au(e),r=$.bG(t.publicKey);return i.clientId=r,r})),zc(this,"generateKeyPair",()=>{this.isInitialized();const e=function(){const e=Ki.utils.randomPrivateKey(),t=Ki.getPublicKey(e);return{privateKey:(0,z.BB)(e,ms),publicKey:(0,z.BB)(t,ms)}}();return this.setPrivateKey(e.publicKey,e.privateKey)}),zc(this,"signJWT",function(){var e=(0,n.Z)(function*(e){i.isInitialized();const t=yield i.getClientSeed(),r=$.Au(t),n=i.randomSessionIdentifier,s=ra;return yield $.vf(n,e,s,r)});return function(t){return e.apply(this,arguments)}}()),zc(this,"generateSharedKey",(e,t,r)=>{this.isInitialized();const n=function(e,t){const r=Ki.getSharedSecret((0,z.mL)(e,ms),(0,z.mL)(t,ms)),n=((e,t,r,n,i)=>function(e,t,r,n=32){tt(e),Xe(n);const i=e.outputLen;if(n>255*i)throw new Error("Length should be <= 255*HashLen");const s=Math.ceil(n/i);void 0===r&&(r=Un);const o=new Uint8Array(s*i),a=Bn.create(e,t),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let u=0;u<s;u++)Cn[0]=u+1,c.update(0===u?Un:l).update(r).update(Cn).digestInto(l),o.set(l,i*u),a._cloneInto(c);return a.destroy(),c.destroy(),st(l,Cn),o.slice(0,n)}(e,function(e,t,r){return tt(e),void 0===r&&(r=new Uint8Array(e.outputLen)),Bn(e,bt(r),bt(t))}(e,t,r),n,i))(Nn,r,void 0,void 0,32);return(0,z.BB)(n,ms)}(this.getPrivateKey(e),t);return this.setSymKey(n,r)}),zc(this,"setSymKey",function(){var e=(0,n.Z)(function*(e,t){i.isInitialized();const r=t||xs(e);return yield i.keychain.set(r,e),r});return function(t,r){return e.apply(this,arguments)}}()),zc(this,"deleteKeyPair",function(){var e=(0,n.Z)(function*(e){i.isInitialized(),yield i.keychain.del(e)});return function(t){return e.apply(this,arguments)}}()),zc(this,"deleteSymKey",function(){var e=(0,n.Z)(function*(e){i.isInitialized(),yield i.keychain.del(e)});return function(t){return e.apply(this,arguments)}}()),zc(this,"encode",function(){var e=(0,n.Z)(function*(e,t,r){i.isInitialized();const n=Ts(r),s=(0,Go.u)(t);if(Cs(n))return function(e,t){const r=Ss(2),n=xt(12),i=As({type:r,sealed:(0,z.mL)(e,vs),iv:n});return t===ws?_s(i):i}(s,r?.encoding);if(Bs(n)){const t=n.senderPublicKey,r=n.receiverPublicKey;e=yield i.generateSharedKey(t,r)}const o=i.getSymKey(e),{type:a,senderPublicKey:c}=n;return function(e){const t=Ss(typeof e.type<"u"?e.type:0);if(1===Os(t)&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof e.senderPublicKey<"u"?(0,z.mL)(e.senderPublicKey,ms):void 0,n=typeof e.iv<"u"?(0,z.mL)(e.iv,ms):xt(12),i=(0,z.mL)(e.symKey,ms),s=As({type:t,sealed:Rn(i,n).encrypt((0,z.mL)(e.message,vs)),iv:n,senderPublicKey:r});return e.encoding===ws?_s(s):s}({type:a,symKey:o,message:s,senderPublicKey:c,encoding:r?.encoding})});return function(t,r,n){return e.apply(this,arguments)}}()),zc(this,"decode",function(){var e=(0,n.Z)(function*(e,t,r){i.isInitialized();const n=function(e,t){const r=Rs({encoded:e,encoding:t?.encoding});return Ts({type:Os(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?(0,z.BB)(r.senderPublicKey,ms):void 0,receiverPublicKey:t?.receiverPublicKey})}(t,r);if(Cs(n)){const e=function(e,t){const{sealed:r}=Rs({encoded:e,encoding:t});return(0,z.BB)(r,vs)}(t,r?.encoding);return(0,Go.D)(e)}if(Bs(n)){const t=n.receiverPublicKey,r=n.senderPublicKey;e=yield i.generateSharedKey(t,r)}try{const n=function(e){const t=(0,z.mL)(e.symKey,ms),{sealed:r,iv:n}=Rs({encoded:e.encoded,encoding:e.encoding}),i=Rn(t,n).decrypt(r);if(null===i)throw new Error("Failed to decrypt");return(0,z.BB)(i,vs)}({symKey:i.getSymKey(e),encoded:t,encoding:r?.encoding});return(0,Go.D)(n)}catch(s){i.logger.error(`Failed to decode message from topic: '${e}', clientId: '${yield i.getClientId()}'`),i.logger.error(s)}});return function(t,r,n){return e.apply(this,arguments)}}()),zc(this,"getPayloadType",(e,t=bs)=>Os(Rs({encoded:e,encoding:t}).type)),zc(this,"getPayloadSenderPublicKey",(e,t=bs)=>{const r=Rs({encoded:e,encoding:t});return r.senderPublicKey?(0,z.BB)(r.senderPublicKey,ms):void 0}),this.core=e,this.logger=(0,K.Ep)(t,this.name),this.keychain=r||new Mc(this.core,this.logger)}get context(){return(0,K.Fd)(this.logger)}setPrivateKey(e,t){var r=this;return(0,n.Z)(function*(){return yield r.keychain.set(e,t),e})()}getPrivateKey(e){return this.keychain.get(e)}getClientSeed(){var e=this;return(0,n.Z)(function*(){let t="";try{t=e.keychain.get(ta)}catch{t=Es(),yield e.keychain.set(ta,t)}return function(e,t="utf8"){const r=Lc[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):Uc(globalThis.Buffer.from(e,"utf-8"))}(t,"base16")})()}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=fo("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Fc=Object.defineProperty,Kc=Object.defineProperties,Vc=Object.getOwnPropertyDescriptors,Hc=Object.getOwnPropertySymbols,Wc=Object.prototype.hasOwnProperty,Gc=Object.prototype.propertyIsEnumerable,Jc=(e,t,r)=>t in e?Fc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Yc=(e,t,r)=>Jc(e,"symbol"!=typeof t?t+"":t,r);class Qc extends class{constructor(e,t){this.logger=e,this.core=t}}{constructor(e,t){var r;super(e,t),r=this,this.logger=e,this.core=t,Yc(this,"messages",new Map),Yc(this,"messagesWithoutClientAck",new Map),Yc(this,"name","messages"),Yc(this,"version","0.3"),Yc(this,"initialized",!1),Yc(this,"storagePrefix",Xo),Yc(this,"init",(0,n.Z)(function*(){if(!r.initialized){r.logger.trace("Initialized");try{const e=yield r.getRelayerMessages();typeof e<"u"&&(r.messages=e);const t=yield r.getRelayerMessagesWithoutClientAck();typeof t<"u"&&(r.messagesWithoutClientAck=t),r.logger.debug(`Successfully Restored records for ${r.name}`),r.logger.trace({type:"method",method:"restore",size:r.messages.size})}catch(e){r.logger.debug(`Failed to Restore records for ${r.name}`),r.logger.error(e)}finally{r.initialized=!0}}})),Yc(this,"set",function(){var e=(0,n.Z)(function*(e,t,n){r.isInitialized();const i=Is(t);let s=r.messages.get(e);if(typeof s>"u"&&(s={}),typeof s[i]<"u")return i;if(s[i]=t,r.messages.set(e,s),"inbound"===n){const n=r.messagesWithoutClientAck.get(e)||{};r.messagesWithoutClientAck.set(e,((e,t)=>Kc(e,Vc(t)))(((e,t)=>{for(var r in t||(t={}))Wc.call(t,r)&&Jc(e,r,t[r]);if(Hc)for(var r of Hc(t))Gc.call(t,r)&&Jc(e,r,t[r]);return e})({},n),{[i]:t}))}return yield r.persist(),i});return function(t,r,n){return e.apply(this,arguments)}}()),Yc(this,"get",e=>{this.isInitialized();let t=this.messages.get(e);return typeof t>"u"&&(t={}),t}),Yc(this,"getWithoutAck",e=>{this.isInitialized();const t={};for(const r of e){const e=this.messagesWithoutClientAck.get(r)||{};t[r]=Object.values(e)}return t}),Yc(this,"has",(e,t)=>(this.isInitialized(),typeof this.get(e)[Is(t)]<"u")),Yc(this,"ack",function(){var e=(0,n.Z)(function*(e,t){r.isInitialized();const n=r.messagesWithoutClientAck.get(e);typeof n>"u"||(delete n[Is(t)],0===Object.keys(n).length?r.messagesWithoutClientAck.delete(e):r.messagesWithoutClientAck.set(e,n),yield r.persist())});return function(t,r){return e.apply(this,arguments)}}()),Yc(this,"del",function(){var e=(0,n.Z)(function*(e){r.isInitialized(),r.messages.delete(e),r.messagesWithoutClientAck.delete(e),yield r.persist()});return function(t){return e.apply(this,arguments)}}()),this.logger=(0,K.Ep)(e,this.name),this.core=t}get context(){return(0,K.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}setRelayerMessages(e){var t=this;return(0,n.Z)(function*(){yield t.core.storage.setItem(t.storageKey,de(e))})()}setRelayerMessagesWithoutClientAck(e){var t=this;return(0,n.Z)(function*(){yield t.core.storage.setItem(t.storageKeyWithoutClientAck,de(e))})()}getRelayerMessages(){var e=this;return(0,n.Z)(function*(){const t=yield e.core.storage.getItem(e.storageKey);return typeof t<"u"?pe(t):void 0})()}getRelayerMessagesWithoutClientAck(){var e=this;return(0,n.Z)(function*(){const t=yield e.core.storage.getItem(e.storageKeyWithoutClientAck);return typeof t<"u"?pe(t):void 0})()}persist(){var e=this;return(0,n.Z)(function*(){yield e.setRelayerMessages(e.messages),yield e.setRelayerMessagesWithoutClientAck(e.messagesWithoutClientAck)})()}isInitialized(){if(!this.initialized){const{message:e}=fo("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Xc=Object.defineProperty,el=Object.defineProperties,tl=Object.getOwnPropertyDescriptors,rl=Object.getOwnPropertySymbols,nl=Object.prototype.hasOwnProperty,il=Object.prototype.propertyIsEnumerable,sl=(e,t,r)=>t in e?Xc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ol=(e,t)=>{for(var r in t||(t={}))nl.call(t,r)&&sl(e,r,t[r]);if(rl)for(var r of rl(t))il.call(t,r)&&sl(e,r,t[r]);return e},al=(e,t)=>el(e,tl(t)),cl=(e,t,r)=>sl(e,"symbol"!=typeof t?t+"":t,r);class ll extends Zo{constructor(e,t){var r;super(e,t),r=this,this.relayer=e,this.logger=t,cl(this,"events",new i.EventEmitter),cl(this,"name","publisher"),cl(this,"queue",new Map),cl(this,"publishTimeout",(0,o.toMiliseconds)(o.ONE_MINUTE)),cl(this,"initialPublishTimeout",(0,o.toMiliseconds)(15*o.ONE_SECOND)),cl(this,"needsTransportRestart",!1),cl(this,"publish",function(){var e=(0,n.Z)(function*(e,t,i){var s,o,a,c,l;r.logger.debug("Publishing Payload"),r.logger.trace({type:"method",method:"publish",params:{topic:e,message:t,opts:i}});const u=i?.ttl||na,f=i?.prompt||!1,h=i?.tag||0,d=i?.id||(0,Yo.getBigIntRpcId)().toString(),p=Ns(Us().protocol),g={id:d,method:i?.publishMethod||p.publish,params:ol({topic:e,message:t,ttl:u,prompt:f,tag:h,attestation:i?.attestation},i?.tvf)},y=`Failed to publish payload, please try again. id:${d} tag:${h}`;try{yo(null==(s=g.params)?void 0:s.prompt)&&(null==(o=g.params)||delete o.prompt),yo(null==(a=g.params)?void 0:a.tag)&&(null==(c=g.params)||delete c.tag);const l=new Promise(function(){var e=(0,n.Z)(function*(e){const t=({id:n})=>{var i;(null==(i=g.id)?void 0:i.toString())===n.toString()&&(r.removeRequestFromQueue(n),r.relayer.events.removeListener(sa,t),e())};r.relayer.events.on(sa,t);const n=ye(new Promise((e,t)=>{r.rpcPublish(g,i).then(e).catch(e=>{r.logger.warn(e,e?.message),t(e)})}),r.initialPublishTimeout,`Failed initial publish, retrying.... id:${d} tag:${h}`);try{yield n,r.events.removeListener(sa,t)}catch(s){r.queue.set(d,{request:g,opts:i,attempt:1}),r.logger.warn(s,s?.message)}});return function(t){return e.apply(this,arguments)}}());r.logger.trace({type:"method",method:"publish",params:{id:d,topic:e,message:t,opts:i}}),yield ye(l,r.publishTimeout,y)}catch(m){if(r.logger.debug("Failed to Publish Payload"),r.logger.error(m),null!=(l=i?.internal)&&l.throwOnFailedPublish)throw m}finally{r.queue.delete(d)}});return function(t,r,n){return e.apply(this,arguments)}}()),cl(this,"publishCustom",function(){var e=(0,n.Z)(function*(e){var t,i,s,a,c;r.logger.debug("Publishing custom payload"),r.logger.trace({type:"method",method:"publishCustom",params:e});const{payload:l,opts:u={}}=e,{attestation:f,tvf:h,publishMethod:d,prompt:p,tag:g,ttl:y=o.FIVE_MINUTES}=u,m=u.id||(0,Yo.getBigIntRpcId)().toString(),b=Ns(Us().protocol),w=d||b.publish,v={id:m,method:w,params:ol(al(ol({},l),{ttl:y,prompt:p,tag:g,attestation:f}),h)},E=`Failed to publish custom payload, please try again. id:${m} tag:${g}`;try{yo(null==(t=v.params)?void 0:t.prompt)&&(null==(i=v.params)||delete i.prompt),yo(null==(s=v.params)?void 0:s.tag)&&(null==(a=v.params)||delete a.tag);const e=new Promise(function(){var e=(0,n.Z)(function*(e){const t=({id:n})=>{var i;(null==(i=v.id)?void 0:i.toString())===n.toString()&&(r.removeRequestFromQueue(n),r.relayer.events.removeListener(sa,t),e())};r.relayer.events.on(sa,t);const n=ye(new Promise((e,t)=>{r.rpcPublish(v,u).then(e).catch(e=>{r.logger.warn(e,e?.message),t(e)})}),r.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${w} id:${m} tag:${g}`);try{yield n,r.events.removeListener(sa,t)}catch(i){r.queue.set(m,{request:v,opts:u,attempt:1}),r.logger.warn(i,i?.message)}});return function(t){return e.apply(this,arguments)}}());r.logger.trace({type:"method",method:"publish",params:{id:m,payload:l,opts:u}}),yield ye(e,r.publishTimeout,E)}catch(x){if(r.logger.debug("Failed to Publish Payload"),r.logger.error(x),null!=(c=u?.internal)&&c.throwOnFailedPublish)throw x}finally{r.queue.delete(m)}});return function(t){return e.apply(this,arguments)}}()),cl(this,"on",(e,t)=>{this.events.on(e,t)}),cl(this,"once",(e,t)=>{this.events.once(e,t)}),cl(this,"off",(e,t)=>{this.events.off(e,t)}),cl(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.relayer=e,this.logger=(0,K.Ep)(t,this.name),this.registerEventListeners()}get context(){return(0,K.Fd)(this.logger)}rpcPublish(e,t){var r=this;return(0,n.Z)(function*(){r.logger.debug("Outgoing Relay Payload"),r.logger.trace({type:"message",direction:"outgoing",request:e});const n=yield r.relayer.request(e);return r.relayer.events.emit(sa,ol(ol({},e),t)),r.logger.debug("Successfully Published Payload"),n})()}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){var e=this;this.queue.forEach(function(){var t=(0,n.Z)(function*(t,r){var n;const i=t.attempt+1;e.queue.set(r,al(ol({},t),{attempt:i})),e.logger.warn({},`Publisher: queue->publishing: ${t.request.id}, tag: ${null==(n=t.request.params)?void 0:n.tag}, attempt: ${i}`),yield e.rpcPublish(t.request,t.opts),e.logger.warn({},`Publisher: queue->published: ${t.request.id}`)});return function(e,r){return t.apply(this,arguments)}}())}registerEventListeners(){this.relayer.core.heartbeat.on(ko.Lx.pulse,()=>{if(this.needsTransportRestart)return this.needsTransportRestart=!1,void this.relayer.events.emit("relayer_connection_stalled");this.checkQueue()}),this.relayer.on("relayer_message_ack",e=>{this.removeRequestFromQueue(e.id.toString())})}}var ul=Object.defineProperty,fl=(e,t,r)=>((e,t,r)=>t in e?ul(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class hl{constructor(){fl(this,"map",new Map),fl(this,"set",(e,t)=>{const r=this.get(e);this.exists(e,t)||this.map.set(e,[...r,t])}),fl(this,"get",e=>this.map.get(e)||[]),fl(this,"exists",(e,t)=>this.get(e).includes(t)),fl(this,"delete",(e,t)=>{if(typeof t>"u")return void this.map.delete(e);if(!this.map.has(e))return;const r=this.get(e);if(!this.exists(e,t))return;const n=r.filter(e=>e!==t);n.length?this.map.set(e,n):this.map.delete(e)}),fl(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var dl=Object.defineProperty,pl=Object.defineProperties,gl=Object.getOwnPropertyDescriptors,yl=Object.getOwnPropertySymbols,ml=Object.prototype.hasOwnProperty,bl=Object.prototype.propertyIsEnumerable,wl=(e,t,r)=>t in e?dl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,vl=(e,t)=>{for(var r in t||(t={}))ml.call(t,r)&&wl(e,r,t[r]);if(yl)for(var r of yl(t))bl.call(t,r)&&wl(e,r,t[r]);return e},El=(e,t)=>pl(e,gl(t)),xl=(e,t,r)=>wl(e,"symbol"!=typeof t?t+"":t,r);class Il extends Ko{constructor(e,t){var r;super(e,t),r=this,this.relayer=e,this.logger=t,xl(this,"subscriptions",new Map),xl(this,"topicMap",new hl),xl(this,"events",new i.EventEmitter),xl(this,"name","subscription"),xl(this,"version","0.3"),xl(this,"pending",new Map),xl(this,"cached",[]),xl(this,"initialized",!1),xl(this,"storagePrefix",Xo),xl(this,"subscribeTimeout",(0,o.toMiliseconds)(o.ONE_MINUTE)),xl(this,"initialSubscribeTimeout",(0,o.toMiliseconds)(15*o.ONE_SECOND)),xl(this,"clientId"),xl(this,"batchSubscribeTopicsLimit",500),xl(this,"init",(0,n.Z)(function*(){r.initialized||(r.logger.trace("Initialized"),r.registerEventListeners(),yield r.restore()),r.initialized=!0})),xl(this,"subscribe",function(){var e=(0,n.Z)(function*(e,t){var n;r.isInitialized(),r.logger.debug("Subscribing Topic"),r.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}});try{const i=Us(t),s={topic:e,relay:i,transportType:t?.transportType};null!=(n=t?.internal)&&n.skipSubscribe||r.pending.set(e,s);const o=yield r.rpcSubscribe(e,i,t);return"string"==typeof o&&(r.onSubscribe(o,s),r.logger.debug("Successfully Subscribed Topic"),r.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}})),o}catch(i){throw r.logger.debug("Failed to Subscribe Topic"),r.logger.error(i),i}});return function(t,r){return e.apply(this,arguments)}}()),xl(this,"unsubscribe",function(){var e=(0,n.Z)(function*(e,t){r.isInitialized(),typeof t?.id<"u"?yield r.unsubscribeById(e,t.id,t):yield r.unsubscribeByTopic(e,t)});return function(t,r){return e.apply(this,arguments)}}()),xl(this,"isSubscribed",e=>new Promise(t=>{t(this.topicMap.topics.includes(e))})),xl(this,"isKnownTopic",e=>new Promise(t=>{t(this.topicMap.topics.includes(e)||this.pending.has(e)||this.cached.some(t=>t.topic===e))})),xl(this,"on",(e,t)=>{this.events.on(e,t)}),xl(this,"once",(e,t)=>{this.events.once(e,t)}),xl(this,"off",(e,t)=>{this.events.off(e,t)}),xl(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),xl(this,"start",(0,n.Z)(function*(){yield r.onConnect()})),xl(this,"stop",(0,n.Z)(function*(){yield r.onDisconnect()})),xl(this,"restart",(0,n.Z)(function*(){yield r.restore(),yield r.onRestart()})),xl(this,"checkPending",(0,n.Z)(function*(){if(!(0!==r.pending.size||r.initialized&&r.relayer.connected))return;const e=[];r.pending.forEach(t=>{e.push(t)}),yield r.batchSubscribe(e)})),xl(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(ko.Lx.pulse,(0,n.Z)(function*(){yield r.checkPending()})),this.events.on(la,function(){var e=(0,n.Z)(function*(e){const t=la;r.logger.info(`Emitting ${t}`),r.logger.debug({type:"event",event:t,data:e}),yield r.persist()});return function(t){return e.apply(this,arguments)}}()),this.events.on(ua,function(){var e=(0,n.Z)(function*(e){const t=ua;r.logger.info(`Emitting ${t}`),r.logger.debug({type:"event",event:t,data:e}),yield r.persist()});return function(t){return e.apply(this,arguments)}}())}),this.relayer=e,this.logger=(0,K.Ep)(t,this.name),this.clientId=""}get context(){return(0,K.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,t){let r=!1;try{r=this.getSubscription(e).topic===t}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}unsubscribeByTopic(e,t){var r=this;return(0,n.Z)(function*(){const i=r.topicMap.get(e);yield Promise.all(i.map(function(){var i=(0,n.Z)(function*(n){return yield r.unsubscribeById(e,n,t)});return function(e){return i.apply(this,arguments)}}()))})()}unsubscribeById(e,t,r){var i=this;return(0,n.Z)(function*(){i.logger.debug("Unsubscribing Topic"),i.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}});try{const n=Us(r);yield i.restartToComplete({topic:e,id:t,relay:n}),yield i.rpcUnsubscribe(e,t,n);const s=ho("USER_DISCONNECTED",`${i.name}, ${e}`);yield i.onUnsubscribe(e,t,s),i.logger.debug("Successfully Unsubscribed Topic"),i.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}})}catch(n){throw i.logger.debug("Failed to Unsubscribe Topic"),i.logger.error(n),n}})()}rpcSubscribe(e,t,r){var i=this;return(0,n.Z)(function*(){var s,a;const c=yield i.getSubscriptionId(e);if(null!=(s=r?.internal)&&s.skipSubscribe)return c;(!r||r?.transportType===aa.relay)&&(yield i.restartToComplete({topic:e,id:e,relay:t}));const l={method:Ns(t.protocol).subscribe,params:{topic:e}};i.logger.debug("Outgoing Relay Payload"),i.logger.trace({type:"payload",direction:"outgoing",request:l});const u=null==(a=r?.internal)?void 0:a.throwOnFailedPublish;try{if(r?.transportType===aa.link_mode)return setTimeout(()=>{(i.relayer.connected||i.relayer.connecting)&&i.relayer.request(l).catch(e=>i.logger.warn(e))},(0,o.toMiliseconds)(o.ONE_SECOND)),c;const t=new Promise(function(){var t=(0,n.Z)(function*(t){const r=n=>{n.topic===e&&(i.events.removeListener(la,r),t(n.id))};i.events.on(la,r);try{const n=yield ye(new Promise((e,t)=>{i.relayer.request(l).catch(e=>{i.logger.warn(e,e?.message),t(e)}).then(e)}),i.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);i.events.removeListener(la,r),t(n)}catch{}});return function(e){return t.apply(this,arguments)}}()),s=yield ye(t,i.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!s&&u)throw new Error(`Subscribing to ${e} failed, please try again`);return s?c:null}catch(f){if(i.logger.debug("Outgoing Relay Subscribe Payload stalled"),i.relayer.events.emit("relayer_connection_stalled"),u)throw f}return null})()}rpcBatchSubscribe(e){var t=this;return(0,n.Z)(function*(){if(!e.length)return!0;const r={method:Ns(e[0].relay.protocol).batchSubscribe,params:{topics:e.map(e=>e.topic)}};t.logger.debug("Outgoing Relay Payload"),t.logger.trace({type:"payload",direction:"outgoing",request:r});try{return yield ye(new Promise((e,n)=>{t.relayer.request(r).then(e).catch(e=>{t.logger.warn(e),n(e)})}),t.subscribeTimeout,"rpcBatchSubscribe failed, please try again"),!0}catch{return t.relayer.events.emit("relayer_connection_stalled"),!1}})()}rpcBatchFetchMessages(e){var t=this;return(0,n.Z)(function*(){if(!e.length)return;const r={method:Ns(e[0].relay.protocol).batchFetchMessages,params:{topics:e.map(e=>e.topic)}};let n;t.logger.debug("Outgoing Relay Payload"),t.logger.trace({type:"payload",direction:"outgoing",request:r});try{n=yield yield ye(new Promise((e,n)=>{t.relayer.request(r).catch(e=>{t.logger.warn(e),n(e)}).then(e)}),t.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{t.relayer.events.emit("relayer_connection_stalled")}return n})()}rpcUnsubscribe(e,t,r){const n={method:Ns(r.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.request(n)}onSubscribe(e,t){this.setSubscription(e,El(vl({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(e=>{this.setSubscription(e.id,vl({},e)),this.pending.delete(e.topic)})}onUnsubscribe(e,t,r){var i=this;return(0,n.Z)(function*(){i.events.removeAllListeners(t),i.hasSubscription(t,e)&&i.deleteSubscription(t,r),yield i.relayer.messages.del(e)})()}setRelayerSubscriptions(e){var t=this;return(0,n.Z)(function*(){yield t.relayer.core.storage.setItem(t.storageKey,e)})()}getRelayerSubscriptions(){var e=this;return(0,n.Z)(function*(){return yield e.relayer.core.storage.getItem(e.storageKey)})()}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,vl({},t)),this.topicMap.set(t.topic,e),this.events.emit(la,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:t}=fo("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(t)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(ua,El(vl({},r),{reason:t}))}persist(){var e=this;return(0,n.Z)(function*(){yield e.setRelayerSubscriptions(e.values),e.events.emit("subscription_sync")})()}onRestart(){var e=this;return(0,n.Z)(function*(){if(e.cached.length){const t=[...e.cached],r=Math.ceil(e.cached.length/e.batchSubscribeTopicsLimit);for(let n=0;n<r;n++){const r=t.splice(0,e.batchSubscribeTopicsLimit);yield e.batchSubscribe(r)}}e.events.emit("subscription_resubscribed")})()}restore(){var e=this;return(0,n.Z)(function*(){try{const t=yield e.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(e.subscriptions.size&&!t.every(t=>{var r;return t.topic===(null==(r=e.subscriptions.get(t.id))?void 0:r.topic)})){const{message:t}=fo("RESTORE_WILL_OVERRIDE",e.name);throw e.logger.error(t),e.logger.error(`${e.name}: ${JSON.stringify(e.values)}`),new Error(t)}e.cached=t,e.logger.debug(`Successfully Restored subscriptions for ${e.name}`),e.logger.trace({type:"method",method:"restore",subscriptions:e.values})}catch(t){e.logger.debug(`Failed to Restore subscriptions for ${e.name}`),e.logger.error(t)}})()}batchSubscribe(e){var t=this;return(0,n.Z)(function*(){if(e.length){if(!(yield t.rpcBatchSubscribe(e)))return t.logger.warn(`Batch subscribe failed for ${e.length} topics, adding to pending for retry`),void e.forEach(e=>{t.pending.set(e.topic,e)});t.onBatchSubscribe(yield Promise.all(e.map(function(){var e=(0,n.Z)(function*(e){return El(vl({},e),{id:yield t.getSubscriptionId(e.topic)})});return function(t){return e.apply(this,arguments)}}())))}})()}batchFetchMessages(e){var t=this;return(0,n.Z)(function*(){if(!e.length)return;t.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const r=yield t.rpcBatchFetchMessages(e);r&&r.messages&&(yield function(e){return new Promise(t=>setTimeout(t,e))}((0,o.toMiliseconds)(o.ONE_SECOND)),yield t.relayer.handleBatchMessageEvents(r.messages))})()}onConnect(){var e=this;return(0,n.Z)(function*(){yield e.restart(),e.reset()})()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=fo("NOT_INITIALIZED",this.name);throw new Error(e)}}restartToComplete(e){var t=this;return(0,n.Z)(function*(){!t.relayer.connected&&!t.relayer.connecting&&(t.cached.push(e),yield t.relayer.transportOpen())})()}getClientId(){var e=this;return(0,n.Z)(function*(){return e.clientId||(e.clientId=yield e.relayer.core.crypto.getClientId()),e.clientId})()}getSubscriptionId(e){var t=this;return(0,n.Z)(function*(){return Is(e+(yield t.getClientId()))})()}}var Sl=Object.defineProperty,Ol=Object.getOwnPropertySymbols,_l=Object.prototype.hasOwnProperty,Pl=Object.prototype.propertyIsEnumerable,Al=(e,t,r)=>t in e?Sl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Rl=(e,t)=>{for(var r in t||(t={}))_l.call(t,r)&&Al(e,r,t[r]);if(Ol)for(var r of Ol(t))Pl.call(t,r)&&Al(e,r,t[r]);return e},Tl=(e,t,r)=>Al(e,"symbol"!=typeof t?t+"":t,r);class Bl extends Fo{constructor(e){var t,r;super(e),t=this,Tl(this,"protocol","wc"),Tl(this,"version",2),Tl(this,"core"),Tl(this,"logger"),Tl(this,"events",new i.EventEmitter),Tl(this,"provider"),Tl(this,"messages"),Tl(this,"subscriber"),Tl(this,"publisher"),Tl(this,"name","relayer"),Tl(this,"transportExplicitlyClosed",!1),Tl(this,"initialized",!1),Tl(this,"connectionAttemptInProgress",!1),Tl(this,"relayUrl"),Tl(this,"projectId"),Tl(this,"packageName"),Tl(this,"bundleId"),Tl(this,"hasExperiencedNetworkDisruption",!1),Tl(this,"pingTimeout"),Tl(this,"heartBeatTimeout",(0,o.toMiliseconds)(o.THIRTY_SECONDS+o.FIVE_SECONDS)),Tl(this,"reconnectTimeout"),Tl(this,"connectPromise"),Tl(this,"reconnectInProgress",!1),Tl(this,"requestsInFlight",[]),Tl(this,"connectTimeout",(0,o.toMiliseconds)(15*o.ONE_SECOND)),Tl(this,"stalledRestartInProgress",!1),Tl(this,"stalledRestartTimeout"),Tl(this,"stalledRestartBackoff",0),Tl(this,"stalledRestartBaseInterval",(0,o.toMiliseconds)(2*o.ONE_SECOND)),Tl(this,"stalledRestartMaxInterval",(0,o.toMiliseconds)(o.THIRTY_SECONDS)),Tl(this,"request",function(){var e=(0,n.Z)(function*(e){var r,n;t.logger.debug("Publishing Request Payload");const i=e.id||(0,Yo.getBigIntRpcId)().toString();yield t.toEstablishConnection();try{t.logger.trace({id:i,method:e.method,topic:null==(r=e.params)?void 0:r.topic},"relayer.request - publishing...");const s=`${i}:${(null==(n=e.params)?void 0:n.tag)||""}`;t.requestsInFlight.push(s);const o=yield t.provider.request(e);return t.requestsInFlight=t.requestsInFlight.filter(e=>e!==s),o}catch(s){throw t.logger.debug(`Failed to Publish Request: ${i}`),s}});return function(t){return e.apply(this,arguments)}}()),Tl(this,"resetPingTimeout",()=>{se()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var e,t,r,n;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),null==(n=null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.terminate)||n.call(r)}catch(i){this.logger.warn(i,i?.message)}},this.heartBeatTimeout))}),Tl(this,"onPayloadHandler",e=>{this.onProviderPayload(e),this.resetPingTimeout()}),Tl(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected \ud83d\udedc"),this.startPingTimeout(),this.events.emit("relayer_connect")}),Tl(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected \ud83d\uded1"),this.requestsInFlight=[],this.onProviderDisconnect()}),Tl(this,"onProviderErrorHandler",e=>{this.logger.fatal(`Fatal socket error: ${e.message}`),this.events.emit("relayer_error",e),this.logger.fatal("Fatal socket error received, closing transport"),this.transportExplicitlyClosed=!0,clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0,this.reconnectInProgress=!1,this.transportClose().catch(e=>this.logger.warn(e))}),Tl(this,"registerProviderListeners",()=>{this.provider.on("payload",this.onPayloadHandler),this.provider.on("connect",this.onConnectHandler),this.provider.on("disconnect",this.onDisconnectHandler),this.provider.on("error",this.onProviderErrorHandler)}),this.core=e.core,this.logger=No({logger:null!=(r=e.logger)?r:"error",name:this.name}),this.messages=new Qc(this.logger,e.core),this.subscriber=new Il(this,this.logger),this.publisher=new ll(this,this.logger),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||ia,oe()&&typeof global<"u"&&typeof(null==global?void 0:global.Platform)<"u"&&"android"===(null==global?void 0:global.Platform.OS)?this.packageName=le():oe()&&typeof global<"u"&&typeof(null==global?void 0:global.Platform)<"u"&&"ios"===(null==global?void 0:global.Platform.OS)&&(this.bundleId=le()),this.provider={}}init(){var e=this;return(0,n.Z)(function*(){e.logger.trace("Initialized"),e.registerEventListeners(),yield Promise.all([e.messages.init(),e.subscriber.init()]),e.initialized=!0,e.transportOpen().catch(t=>e.logger.warn(t,t?.message))})()}get context(){return(0,K.Fd)(this.logger)}get connected(){var e,t,r;return 1===(null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.readyState)||!1}get connecting(){var e,t,r;return 0===(null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.readyState)||void 0!==this.connectPromise||!1}publish(e,t,r){var i=this;return(0,n.Z)(function*(){i.isInitialized(),yield i.publisher.publish(e,t,r),yield i.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:aa.relay},"outbound")})()}publishCustom(e){var t=this;return(0,n.Z)(function*(){t.isInitialized(),yield t.publisher.publishCustom(e)})()}subscribe(e,t){var r=this;return(0,n.Z)(function*(){var i,s,o;r.isInitialized(),(null==t||!t.transportType||"relay"===t?.transportType)&&(yield r.toEstablishConnection());const a=typeof(null==(i=t?.internal)?void 0:i.throwOnFailedPublish)>"u"||(null==(s=t?.internal)?void 0:s.throwOnFailedPublish);let c,l=(null==(o=r.subscriber.topicMap.get(e))?void 0:o[0])||"";const u=t=>{t.topic===e&&(r.subscriber.off(la,u),c())};return yield Promise.all([new Promise(e=>{c=e,r.subscriber.on(la,u)}),new Promise(function(){var i=(0,n.Z)(function*(n,i){l=(yield r.subscriber.subscribe(e,Rl({internal:{throwOnFailedPublish:a}},t)).catch(e=>{a&&i(e)}))||l,n()});return function(e,t){return i.apply(this,arguments)}}())]),l})()}unsubscribe(e,t){var r=this;return(0,n.Z)(function*(){r.isInitialized(),yield r.subscriber.unsubscribe(e,t)})()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}transportDisconnect(){var e=this;return(0,n.Z)(function*(){e.provider.disconnect&&(e.hasExperiencedNetworkDisruption||e.connected)?yield ye(e.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>e.onProviderDisconnect()):e.onProviderDisconnect()})()}transportClose(){var e=this;return(0,n.Z)(function*(){e.transportExplicitlyClosed=!0,clearTimeout(e.stalledRestartTimeout),e.stalledRestartInProgress=!1,e.stalledRestartBackoff=0,yield e.resetTransport()})()}transportOpen(e){var t=this;return(0,n.Z)(function*(){if(t.subscriber.hasAnyTopics){if(t.connectPromise?(t.logger.debug({},"Waiting for existing connection attempt to resolve..."),yield t.connectPromise,t.logger.debug({},"Existing connection attempt resolved")):(t.connectPromise=new Promise(function(){var r=(0,n.Z)(function*(r,n){yield t.connect(e).then(r).catch(n).finally(()=>{t.connectPromise=void 0})});return function(e,t){return r.apply(this,arguments)}}()),yield t.connectPromise),!t.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${t.relayUrl}`)}else t.logger.info("Starting WS connection skipped because the client has no topics to work with.")})()}restartTransport(e){var t=this;return(0,n.Z)(function*(){t.logger.debug({},"Restarting transport..."),!t.connectionAttemptInProgress&&(t.relayUrl=e||t.relayUrl,yield t.confirmOnlineStateOrThrow(),yield t.resetTransport(),yield t.transportOpen())})()}resetTransport(){var e=this;return(0,n.Z)(function*(){e.reconnectInProgress=!0,clearTimeout(e.reconnectTimeout),e.reconnectTimeout=void 0,yield e.transportDisconnect(),yield e.subscriber.stop(),e.reconnectInProgress=!1})()}confirmOnlineStateOrThrow(){return(0,n.Z)(function*(){if(!(yield Ao()))throw new Error("No internet connection detected. Please restart your network and try again.")})()}handleBatchMessageEvents(e){var t=this;return(0,n.Z)(function*(){if(0===e?.length)return void t.logger.trace("Batch message events is empty. Ignoring...");const r=e.sort((e,t)=>e.publishedAt-t.publishedAt);t.logger.debug(`Batch of ${r.length} message events sorted`);for(const e of r)try{yield t.onMessageEvent(e)}catch(n){t.logger.warn(n,"Error while processing batch message event: "+n?.message)}t.logger.trace(`Batch of ${r.length} message events processed`)})()}onLinkMessageEvent(e,t){var r=this;return(0,n.Z)(function*(){const{topic:n}=e;if(!t.sessionExists){const e={topic:n,expiry:we(o.FIVE_MINUTES),relay:{protocol:"irn"},active:!1};yield r.core.pairing.pairings.set(n,e)}r.events.emit("relayer_message",e),yield r.recordMessageEvent(e,"inbound")})()}connect(e){var t=this;return(0,n.Z)(function*(){yield t.confirmOnlineStateOrThrow(),e&&e!==t.relayUrl&&(t.relayUrl=e,yield t.transportDisconnect()),t.connectionAttemptInProgress=!0,t.transportExplicitlyClosed=!1;let r=1;for(;r<6;){try{if(t.transportExplicitlyClosed)break;t.logger.debug({},`Connecting to ${t.relayUrl}, attempt: ${r}...`),yield t.createProvider(),yield new Promise(function(){var e=(0,n.Z)(function*(e,r){const i=()=>{r(new Error("Connection interrupted while trying to connect"))};t.provider.once("disconnect",i),yield ye(new Promise((e,r)=>{t.provider.connect().then(e).catch(r)}),t.connectTimeout,`Socket stalled when trying to connect to ${t.relayUrl}`).catch(e=>{r(e)}).finally(()=>{t.provider.off("disconnect",i),clearTimeout(t.reconnectTimeout)}),yield new Promise(function(){var e=(0,n.Z)(function*(e,n){const i=()=>{r(new Error("Connection interrupted while trying to subscribe"))};t.provider.once("disconnect",i),yield t.subscriber.start().then(e).catch(n).finally(()=>{t.provider.off("disconnect",i)})});return function(t,r){return e.apply(this,arguments)}}()),t.hasExperiencedNetworkDisruption=!1,e()});return function(t,r){return e.apply(this,arguments)}}())}catch(i){yield t.subscriber.stop(),t.logger.warn({},i.message),t.hasExperiencedNetworkDisruption=!0}finally{t.connectionAttemptInProgress=!1}if(t.connected){t.logger.debug({},`Connected to ${t.relayUrl} successfully on attempt: ${r}`);break}yield new Promise(e=>setTimeout(e,(0,o.toMiliseconds)(1*r))),r++}})()}startPingTimeout(){var e,t,r,n,i;if(se())try{null!=(t=null==(e=this.provider)?void 0:e.connection)&&t.socket&&(null==(i=null==(n=null==(r=this.provider)?void 0:r.connection)?void 0:n.socket)||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(s){this.logger.warn(s,s?.message)}}createProvider(){var e=this;return(0,n.Z)(function*(){e.provider.connection&&e.unregisterProviderListeners();const t=yield e.core.crypto.signJWT(e.relayUrl);e.provider=new Jo.r(new Qo.Z(function({protocol:e,version:t,relayUrl:r,sdkVersion:n,auth:i,projectId:s,useOnCloseEvent:o,bundleId:a,packageName:c}){const l=r.split("?"),u=fe(e,t,n),f=function(e,t){const r=new URLSearchParams(e);return Object.entries(t).sort(([e],[t])=>e.localeCompare(t)).forEach(([e,t])=>{null!=t&&r.set(e,String(t))}),r.toString()}(l[1]||"",{auth:i,ua:u,projectId:s,useOnCloseEvent:o||void 0,packageName:c||void 0,bundleId:a||void 0});return l[0]+"?"+f}({sdkVersion:oa,protocol:e.protocol,version:e.version,relayUrl:e.relayUrl,projectId:e.projectId,auth:t,useOnCloseEvent:!0,bundleId:e.bundleId,packageName:e.packageName}))),e.registerProviderListeners()})()}recordMessageEvent(e,t){var r=this;return(0,n.Z)(function*(){const{topic:n,message:i}=e;yield r.messages.set(n,i,t)})()}shouldIgnoreMessageEvent(e){var t=this;return(0,n.Z)(function*(){const{topic:r,message:n}=e;if(!n||0===n.length)return t.logger.warn(`Ignoring invalid/empty message: ${n}`),!0;if(!(yield t.subscriber.isKnownTopic(r)))return t.logger.warn(`Ignoring message for unknown topic ${r}`),!0;const i=t.messages.has(r,n);return i&&t.logger.warn(`Ignoring duplicate message: ${n}`),i})()}onProviderPayload(e){var t=this;return(0,n.Z)(function*(){if(t.logger.debug("Incoming Relay Payload"),t.logger.trace({type:"payload",direction:"incoming",payload:e}),(0,Yo.isJsonRpcRequest)(e)){if(!e.method.endsWith("_subscription"))return;const r=e.params,{topic:n,message:i,publishedAt:s,attestation:o}=r.data,a={topic:n,message:i,publishedAt:s,transportType:aa.relay,attestation:o};t.logger.debug("Emitting Relayer Payload"),t.logger.trace(Rl({type:"event",event:r.id},a)),t.events.emit(r.id,a),yield t.acknowledgePayload(e),yield t.onMessageEvent(a)}else(0,Yo.isJsonRpcResponse)(e)&&t.events.emit("relayer_message_ack",e)})()}onMessageEvent(e){var t=this;return(0,n.Z)(function*(){(yield t.shouldIgnoreMessageEvent(e))||(yield t.recordMessageEvent(e,"inbound"),t.events.emit("relayer_message",e))})()}acknowledgePayload(e){var t=this;return(0,n.Z)(function*(){const r=(0,Yo.formatJsonRpcResult)(e.id,!0);yield t.provider.connection.send(r)})()}unregisterProviderListeners(){this.provider.off("payload",this.onPayloadHandler),this.provider.off("connect",this.onConnectHandler),this.provider.off("disconnect",this.onDisconnectHandler),this.provider.off("error",this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}registerEventListeners(){var e=this;return(0,n.Z)(function*(){let t=yield Ao();(function(e){switch(ce()){case"browser":!function(e){!oe()&&ae()&&(window.addEventListener("online",()=>e(!0)),window.addEventListener("offline",()=>e(!1)))}(e);break;case"react-native":!function(e){oe()&&typeof global<"u"&&null!=global&&global.NetInfo&&global?.NetInfo.addEventListener(t=>e(t?.isConnected))}(e)}})(function(){var r=(0,n.Z)(function*(r){t!==r&&(t=r,r?yield e.transportOpen().catch(t=>e.logger.error(t,t?.message)):(e.hasExperiencedNetworkDisruption=!0,yield e.transportDisconnect(),e.transportExplicitlyClosed=!1))});return function(e){return r.apply(this,arguments)}}()),e.core.heartbeat.on(ko.Lx.pulse,(0,n.Z)(function*(){if(!e.transportExplicitlyClosed&&!e.connected&&function(){var e;return!ae()||!(0,a.getDocument)()||"visible"===(null==(e=(0,a.getDocument)())?void 0:e.visibilityState)}())try{yield e.confirmOnlineStateOrThrow(),yield e.transportOpen()}catch(t){e.logger.warn(t,t?.message)}})),e.events.on("relayer_connection_stalled",()=>{if(e.transportExplicitlyClosed||e.stalledRestartInProgress)return;e.stalledRestartInProgress=!0;const t=0===e.stalledRestartBackoff?0:Math.min(Math.pow(2,e.stalledRestartBackoff-1)*e.stalledRestartBaseInterval,e.stalledRestartMaxInterval);e.stalledRestartBackoff++,e.logger.warn(`Connection stalled, restarting transport${t?` in ${t}ms`:""}...`),e.stalledRestartTimeout=setTimeout((0,n.Z)(function*(){try{if(e.transportExplicitlyClosed)return;yield e.restartTransport()}catch(t){e.logger.error(t,t?.message)}finally{e.stalledRestartInProgress=!1}}),t)})})()}onProviderDisconnect(){var e=this;return(0,n.Z)(function*(){clearTimeout(e.pingTimeout),e.events.emit("relayer_disconnect"),e.connectionAttemptInProgress=!1,!e.reconnectInProgress&&(e.reconnectInProgress=!0,yield e.subscriber.stop(),e.subscriber.hasAnyTopics&&(e.transportExplicitlyClosed||(e.reconnectTimeout=setTimeout((0,n.Z)(function*(){yield e.transportOpen().catch(t=>e.logger.error(t,t?.message)),e.reconnectTimeout=void 0,e.reconnectInProgress=!1}),(0,o.toMiliseconds)(.1)))))})()}isInitialized(){if(!this.initialized){const{message:e}=fo("NOT_INITIALIZED",this.name);throw new Error(e)}}toEstablishConnection(){var e=this;return(0,n.Z)(function*(){if(yield e.confirmOnlineStateOrThrow(),!e.connected){if(e.connectPromise)return void(yield e.connectPromise);yield e.connect()}})()}}function Cl(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function Ul(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const Nl="[object Arguments]",kl="[object Object]";function jl(e){if(!e||"object"!=typeof e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&"[object Object]"===Object.prototype.toString.call(e)}function Ll(e,t,r,n,i,s,o){const a=o(e,t,r,n,i,s);if(void 0!==a)return a;if(typeof e==typeof t)switch(typeof e){case"bigint":case"string":case"boolean":case"symbol":case"undefined":case"function":return e===t;case"number":return e===t||Object.is(e,t);case"object":return Dl(e,t,s,o)}return Dl(e,t,s,o)}function Dl(e,t,r,n){if(Object.is(e,t))return!0;let i=Ul(e),s=Ul(t);if(i===Nl&&(i=kl),s===Nl&&(s=kl),i!==s)return!1;switch(i){case"[object String]":return e.toString()===t.toString();case"[object Number]":return function(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}(e.valueOf(),t.valueOf());case"[object Boolean]":case"[object Date]":case"[object Symbol]":return Object.is(e.valueOf(),t.valueOf());case"[object RegExp]":return e.source===t.source&&e.flags===t.flags;case"[object Function]":return e===t}const o=(r=r??new Map).get(e),a=r.get(t);if(null!=o&&null!=a)return o===t;r.set(e,t),r.set(t,e);try{switch(i){case"[object Map]":if(e.size!==t.size)return!1;for(const[i,s]of e.entries())if(!t.has(i)||!Ll(s,t.get(i),i,e,t,r,n))return!1;return!0;case"[object Set]":{if(e.size!==t.size)return!1;const i=Array.from(e.values()),s=Array.from(t.values());for(let o=0;o<i.length;o++){const a=i[o],c=s.findIndex(i=>Ll(a,i,void 0,e,t,r,n));if(-1===c)return!1;s.splice(c,1)}return!0}case"[object Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":case"[object BigUint64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object BigInt64Array]":case"[object Float32Array]":case"[object Float64Array]":if(typeof Buffer<"u"&&Buffer.isBuffer(e)!==Buffer.isBuffer(t)||e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!Ll(e[i],t[i],i,e,t,r,n))return!1;return!0;case"[object ArrayBuffer]":return e.byteLength===t.byteLength&&Dl(new Uint8Array(e),new Uint8Array(t),r,n);case"[object DataView]":return e.byteLength===t.byteLength&&e.byteOffset===t.byteOffset&&Dl(new Uint8Array(e),new Uint8Array(t),r,n);case"[object Error]":return e.name===t.name&&e.message===t.message;case kl:{if(!(Dl(e.constructor,t.constructor,r,n)||jl(e)&&jl(t)))return!1;const i=[...Object.keys(e),...Cl(e)],s=[...Object.keys(t),...Cl(t)];if(i.length!==s.length)return!1;for(let o=0;o<i.length;o++){const s=i[o],a=e[s];if(!Object.hasOwn(t,s))return!1;if(!Ll(a,t[s],s,e,t,r,n))return!1}return!0}default:return!1}}finally{r.delete(e),r.delete(t)}}function ql(){}var Ml=Object.defineProperty,$l=Object.getOwnPropertySymbols,zl=Object.prototype.hasOwnProperty,Zl=Object.prototype.propertyIsEnumerable,Fl=(e,t,r)=>t in e?Ml(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Kl=(e,t)=>{for(var r in t||(t={}))zl.call(t,r)&&Fl(e,r,t[r]);if($l)for(var r of $l(t))Zl.call(t,r)&&Fl(e,r,t[r]);return e},Vl=(e,t,r)=>Fl(e,"symbol"!=typeof t?t+"":t,r);class Hl extends class{constructor(e,t,r,n){this.core=e,this.logger=t,this.name=r}}{constructor(e,t,r,i=Xo,s){var o;super(e,t,r,i),o=this,this.core=e,this.logger=t,this.name=r,Vl(this,"map",new Map),Vl(this,"version","0.3"),Vl(this,"cached",[]),Vl(this,"initialized",!1),Vl(this,"getKey"),Vl(this,"storagePrefix",Xo),Vl(this,"recentlyDeleted",[]),Vl(this,"recentlyDeletedLimit",200),Vl(this,"init",(0,n.Z)(function*(){o.initialized||(o.logger.trace("Initialized"),yield o.restore(),o.cached.forEach(e=>{o.getKey&&null!==e&&!yo(e)?o.map.set(o.getKey(e),e):function(e){var t;return null==(t=e?.proposer)?void 0:t.publicKey}(e)?o.map.set(e.id,e):function(e){return e?.topic}(e)&&o.map.set(e.topic,e)}),o.cached=[],o.initialized=!0)})),Vl(this,"set",function(){var e=(0,n.Z)(function*(e,t){o.isInitialized(),o.map.has(e)?yield o.update(e,t):(o.logger.debug("Setting value"),o.logger.trace({type:"method",method:"set",key:e,value:t}),o.map.set(e,t),yield o.persist())});return function(t,r){return e.apply(this,arguments)}}()),Vl(this,"get",e=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:e}),this.getData(e))),Vl(this,"getAll",e=>(this.isInitialized(),e?this.values.filter(t=>Object.keys(e).every(r=>function(e,t){return function(e,t,r){return Ll(e,t,void 0,void 0,void 0,void 0,r)}(e,t,ql)}(t[r],e[r]))):this.values)),Vl(this,"update",function(){var e=(0,n.Z)(function*(e,t){o.isInitialized(),o.logger.debug("Updating value"),o.logger.trace({type:"method",method:"update",key:e,update:t});const r=Kl(Kl({},o.getData(e)),t);o.map.set(e,r),yield o.persist()});return function(t,r){return e.apply(this,arguments)}}()),Vl(this,"delete",function(){var e=(0,n.Z)(function*(e,t){o.isInitialized(),o.map.has(e)&&(o.logger.debug("Deleting value"),o.logger.trace({type:"method",method:"delete",key:e,reason:t}),o.map.delete(e),o.addToRecentlyDeleted(e),yield o.persist())});return function(t,r){return e.apply(this,arguments)}}()),this.logger=(0,K.Ep)(t,this.name),this.storagePrefix=i,this.getKey=s}get context(){return(0,K.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}setDataStore(e){var t=this;return(0,n.Z)(function*(){yield t.core.storage.setItem(t.storageKey,e)})()}getDataStore(){var e=this;return(0,n.Z)(function*(){return yield e.core.storage.getItem(e.storageKey)})()}getData(e){const t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){const{message:t}=fo("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(t),new Error(t)}const{message:t}=fo("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(t),new Error(t)}return t}persist(){var e=this;return(0,n.Z)(function*(){yield e.setDataStore(e.values)})()}restore(){var e=this;return(0,n.Z)(function*(){try{const t=yield e.getDataStore();if(typeof t>"u"||!t.length)return;if(e.map.size){const{message:t}=fo("RESTORE_WILL_OVERRIDE",e.name);throw e.logger.error(t),new Error(t)}e.cached=t,e.logger.debug(`Successfully Restored value for ${e.name}`),e.logger.trace({type:"method",method:"restore",value:e.values})}catch(t){e.logger.debug(`Failed to Restore value for ${e.name}`),e.logger.error(t)}})()}isInitialized(){if(!this.initialized){const{message:e}=fo("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Wl=Object.defineProperty,Gl=(e,t,r)=>((e,t,r)=>t in e?Wl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class Jl{constructor(e,t){var r=this;this.core=e,this.logger=t,Gl(this,"name","pairing"),Gl(this,"version","0.3"),Gl(this,"events",new i),Gl(this,"pairings"),Gl(this,"initialized",!1),Gl(this,"storagePrefix",Xo),Gl(this,"ignoredPayloadTypes",[1]),Gl(this,"registeredMethods",[]),Gl(this,"init",(0,n.Z)(function*(){r.initialized||(yield r.pairings.init(),yield r.cleanup(),r.registerRelayerEvents(),r.registerExpirerEvents(),r.initialized=!0,r.logger.trace("Initialized"))})),Gl(this,"register",({methods:e})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...e])]}),Gl(this,"create",function(){var e=(0,n.Z)(function*(e){r.isInitialized();const t=Es(),n=yield r.core.crypto.setSymKey(t),i=we(o.FIVE_MINUTES),s={protocol:"irn"},a={topic:n,expiry:i,relay:s,active:!1,methods:e?.methods},c=Vs({protocol:r.core.protocol,version:r.core.version,topic:n,symKey:t,relay:s,expiryTimestamp:i,methods:e?.methods});return r.events.emit("pairing_create",a),r.core.expirer.set(n,i),yield r.pairings.set(n,a),yield r.core.relayer.subscribe(n,{transportType:e?.transportType,internal:e?.internal}),{topic:n,uri:c}});return function(t){return e.apply(this,arguments)}}()),Gl(this,"pair",function(){var e=(0,n.Z)(function*(e){r.isInitialized();const t=r.core.eventClient.createEvent({properties:{topic:e?.uri,trace:["pairing_started"]}});r.isValidPair(e,t);const{topic:n,symKey:i,relay:s,expiryTimestamp:a,methods:c}=Fs(e.uri);let l;if(t.props.properties.topic=n,t.addTrace("pairing_uri_validation_success"),t.addTrace("pairing_uri_not_expired"),r.pairings.keys.includes(n)){if(l=r.pairings.get(n),t.addTrace("existing_pairing"),l.active)throw t.setError("active_pairing_already_exists"),new Error(`Pairing already exists: ${n}. Please try again with a new connection URI.`);t.addTrace("pairing_not_expired")}const u=a||we(o.FIVE_MINUTES),f={topic:n,relay:s,expiry:u,active:!1,methods:c};r.core.expirer.set(n,u),yield r.pairings.set(n,f),t.addTrace("store_new_pairing"),e.activatePairing&&(yield r.activate({topic:n})),r.events.emit("pairing_create",f),t.addTrace("emit_inactive_pairing"),r.core.crypto.keychain.has(n)||(yield r.core.crypto.setSymKey(i,n)),t.addTrace("subscribing_pairing_topic");try{yield r.core.relayer.confirmOnlineStateOrThrow()}catch{t.setError("no_internet_connection")}try{yield r.core.relayer.subscribe(n,{relay:s})}catch(h){throw t.setError("subscribe_pairing_topic_failure"),h}return t.addTrace("subscribe_pairing_topic_success"),f});return function(t){return e.apply(this,arguments)}}()),Gl(this,"activate",function(){var e=(0,n.Z)(function*({topic:e}){r.isInitialized();const t=we(o.FIVE_MINUTES);r.core.expirer.set(e,t),yield r.pairings.update(e,{active:!0,expiry:t})});return function(t){return e.apply(this,arguments)}}()),Gl(this,"ping",function(){var e=(0,n.Z)(function*(e){r.isInitialized(),yield r.isValidPing(e),r.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:t}=e;if(r.pairings.keys.includes(t)){const e=yield r.sendRequest(t,"wc_pairingPing",{}),{done:n,resolve:i,reject:s}=ge();r.events.once(Ee("pairing_ping",e),({error:e})=>{e?s(e):i()}),yield n()}});return function(t){return e.apply(this,arguments)}}()),Gl(this,"updateExpiry",function(){var e=(0,n.Z)(function*({topic:e,expiry:t}){r.isInitialized(),yield r.pairings.update(e,{expiry:t})});return function(t){return e.apply(this,arguments)}}()),Gl(this,"updateMetadata",function(){var e=(0,n.Z)(function*({topic:e,metadata:t}){r.isInitialized(),yield r.pairings.update(e,{peerMetadata:t})});return function(t){return e.apply(this,arguments)}}()),Gl(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),Gl(this,"disconnect",function(){var e=(0,n.Z)(function*(e){r.isInitialized(),yield r.isValidDisconnect(e);const{topic:t}=e;r.pairings.keys.includes(t)&&(yield r.sendRequest(t,"wc_pairingDelete",ho("USER_DISCONNECTED")),yield r.deletePairing(t))});return function(t){return e.apply(this,arguments)}}()),Gl(this,"formatUriFromPairing",e=>{this.isInitialized();const{topic:t,relay:r,expiry:n,methods:i}=e,s=this.core.crypto.keychain.get(t);return Vs({protocol:this.core.protocol,version:this.core.version,topic:t,symKey:s,relay:r,expiryTimestamp:n,methods:i})}),Gl(this,"sendRequest",function(){var e=(0,n.Z)(function*(e,t,n){const i=(0,Yo.formatJsonRpcRequest)(t,n),s=yield r.core.crypto.encode(e,i),o=fa[t].req;return r.core.history.set(e,i),r.core.relayer.publish(e,s,o),i.id});return function(t,r,n){return e.apply(this,arguments)}}()),Gl(this,"sendResult",function(){var e=(0,n.Z)(function*(e,t,n){const i=(0,Yo.formatJsonRpcResult)(e,n),s=yield r.core.crypto.encode(t,i),o=(yield r.core.history.get(t,e)).request.method,a=fa[o].res;yield r.core.relayer.publish(t,s,a),yield r.core.history.resolve(i)});return function(t,r,n){return e.apply(this,arguments)}}()),Gl(this,"sendError",function(){var e=(0,n.Z)(function*(e,t,n){const i=(0,Yo.formatJsonRpcError)(e,n),s=yield r.core.crypto.encode(t,i),o=(yield r.core.history.get(t,e)).request.method,a=fa[o]?fa[o].res:fa.unregistered_method.res;yield r.core.relayer.publish(t,s,a),yield r.core.history.resolve(i)});return function(t,r,n){return e.apply(this,arguments)}}()),Gl(this,"deletePairing",function(){var e=(0,n.Z)(function*(e,t){yield r.core.relayer.unsubscribe(e),yield Promise.all([r.pairings.delete(e,ho("USER_DISCONNECTED")),r.core.crypto.deleteSymKey(e),t?Promise.resolve():r.core.expirer.del(e)])});return function(t,r){return e.apply(this,arguments)}}()),Gl(this,"cleanup",(0,n.Z)(function*(){const e=r.pairings.getAll().filter(e=>ve(e.expiry));yield Promise.all(e.map(e=>r.deletePairing(e.topic)))})),Gl(this,"onRelayEventRequest",function(){var e=(0,n.Z)(function*(e){const{topic:t,payload:n}=e;switch(n.method){case"wc_pairingPing":return yield r.onPairingPingRequest(t,n);case"wc_pairingDelete":return yield r.onPairingDeleteRequest(t,n);default:return yield r.onUnknownRpcMethodRequest(t,n)}});return function(t){return e.apply(this,arguments)}}()),Gl(this,"onRelayEventResponse",function(){var e=(0,n.Z)(function*(e){const{topic:t,payload:n}=e,i=(yield r.core.history.get(t,n.id)).request.method;return"wc_pairingPing"===i?r.onPairingPingResponse(t,n):r.onUnknownRpcMethodResponse(i)});return function(t){return e.apply(this,arguments)}}()),Gl(this,"onPairingPingRequest",function(){var e=(0,n.Z)(function*(e,t){const{id:n}=t;try{r.isValidPing({topic:e}),yield r.sendResult(n,e,!0),r.events.emit("pairing_ping",{id:n,topic:e})}catch(i){yield r.sendError(n,e,i),r.logger.error(i)}});return function(t,r){return e.apply(this,arguments)}}()),Gl(this,"onPairingPingResponse",(e,t)=>{const{id:r}=t;setTimeout(()=>{(0,Yo.isJsonRpcResult)(t)?this.events.emit(Ee("pairing_ping",r),{}):(0,Yo.isJsonRpcError)(t)&&this.events.emit(Ee("pairing_ping",r),{error:t.error})},500)}),Gl(this,"onPairingDeleteRequest",function(){var e=(0,n.Z)(function*(e,t){const{id:n}=t;try{r.isValidDisconnect({topic:e}),yield r.deletePairing(e),r.events.emit("pairing_delete",{id:n,topic:e})}catch(i){yield r.sendError(n,e,i),r.logger.error(i)}});return function(t,r){return e.apply(this,arguments)}}()),Gl(this,"onUnknownRpcMethodRequest",function(){var e=(0,n.Z)(function*(e,t){const{id:n,method:i}=t;try{if(r.registeredMethods.includes(i))return;const t=ho("WC_METHOD_UNSUPPORTED",i);yield r.sendError(n,e,t),r.logger.error(t)}catch(s){yield r.sendError(n,e,s),r.logger.error(s)}});return function(t,r){return e.apply(this,arguments)}}()),Gl(this,"onUnknownRpcMethodResponse",e=>{this.registeredMethods.includes(e)||this.logger.error(ho("WC_METHOD_UNSUPPORTED",e))}),Gl(this,"isValidPair",(e,t)=>{var r;if(!So(e)){const{message:r}=fo("MISSING_OR_INVALID",`pair() params: ${e}`);throw t.setError("malformed_pairing_uri"),new Error(r)}if(!function(e){function t(e){try{return typeof new URL(e)<"u"}catch{return!1}}try{if(mo(e,!1))return!!t(e)||t(Te(e))}catch{}return!1}(e.uri)){const{message:r}=fo("MISSING_OR_INVALID",`pair() uri: ${e.uri}`);throw t.setError("malformed_pairing_uri"),new Error(r)}const n=Fs(e?.uri);if(null==(r=n?.relay)||!r.protocol){const{message:e}=fo("MISSING_OR_INVALID","pair() uri#relay-protocol");throw t.setError("malformed_pairing_uri"),new Error(e)}if(null==n||!n.symKey){const{message:e}=fo("MISSING_OR_INVALID","pair() uri#symKey");throw t.setError("malformed_pairing_uri"),new Error(e)}if(null!=n&&n.expiryTimestamp&&(0,o.toMiliseconds)(n?.expiryTimestamp)<Date.now()){t.setError("pairing_expired");const{message:e}=fo("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(e)}}),Gl(this,"isValidPing",function(){var e=(0,n.Z)(function*(e){if(!So(e)){const{message:t}=fo("MISSING_OR_INVALID",`ping() params: ${e}`);throw new Error(t)}const{topic:t}=e;yield r.isValidPairingTopic(t)});return function(t){return e.apply(this,arguments)}}()),Gl(this,"isValidDisconnect",function(){var e=(0,n.Z)(function*(e){if(!So(e)){const{message:t}=fo("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw new Error(t)}const{topic:t}=e;yield r.isValidPairingTopic(t)});return function(t){return e.apply(this,arguments)}}()),Gl(this,"isValidPairingTopic",function(){var e=(0,n.Z)(function*(e){if(!mo(e,!1)){const{message:t}=fo("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!r.pairings.keys.includes(e)){const{message:t}=fo("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(ve(r.pairings.get(e).expiry)){yield r.deletePairing(e);const{message:t}=fo("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}});return function(t){return e.apply(this,arguments)}}()),this.core=e,this.logger=(0,K.Ep)(t,this.name),this.pairings=new Hl(this.core,this.logger,this.name,this.storagePrefix)}get context(){return(0,K.Fd)(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=fo("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){var e=this;this.core.relayer.on("relayer_message",function(){var t=(0,n.Z)(function*(t){const{topic:r,message:n,transportType:i}=t;if(e.pairings.keys.includes(r)&&i!==aa.link_mode&&!e.ignoredPayloadTypes.includes(e.core.crypto.getPayloadType(n)))try{const t=yield e.core.crypto.decode(r,n);(0,Yo.isJsonRpcRequest)(t)?(e.core.history.set(r,t),yield e.onRelayEventRequest({topic:r,payload:t})):(0,Yo.isJsonRpcResponse)(t)&&(yield e.core.history.resolve(t),yield e.onRelayEventResponse({topic:r,payload:t}),e.core.history.delete(r,t.id)),yield e.core.relayer.messages.ack(r,n)}catch(s){e.logger.error(s)}});return function(e){return t.apply(this,arguments)}}())}registerExpirerEvents(){var e=this;this.core.expirer.on(ha,function(){var t=(0,n.Z)(function*(t){const{topic:r}=be(t.target);r&&e.pairings.keys.includes(r)&&(yield e.deletePairing(r,!0),e.events.emit("pairing_expire",{topic:r}))});return function(e){return t.apply(this,arguments)}}())}}var Yl=Object.defineProperty,Ql=(e,t,r)=>((e,t,r)=>t in e?Yl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class Xl extends zo{constructor(e,t){var r;super(e,t),r=this,this.core=e,this.logger=t,Ql(this,"records",new Map),Ql(this,"events",new i.EventEmitter),Ql(this,"name","history"),Ql(this,"version","0.3"),Ql(this,"cached",[]),Ql(this,"initialized",!1),Ql(this,"storagePrefix",Xo),Ql(this,"init",(0,n.Z)(function*(){r.initialized||(r.logger.trace("Initialized"),yield r.restore(),r.cached.forEach(e=>r.records.set(e.id,e)),r.cached=[],r.registerEventListeners(),r.initialized=!0)})),Ql(this,"set",(e,t,r)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:e,request:t,chainId:r}),this.records.has(t.id))return;const n={id:t.id,topic:e,request:{method:t.method,params:t.params||null},chainId:r,expiry:we(o.THIRTY_DAYS)};this.records.set(n.id,n),this.persist(),this.events.emit("history_created",n)}),Ql(this,"resolve",function(){var e=(0,n.Z)(function*(e){if(r.isInitialized(),r.logger.debug("Updating JSON-RPC response history record"),r.logger.trace({type:"method",method:"update",response:e}),!r.records.has(e.id))return;const t=yield r.getRecord(e.id);typeof t.response>"u"&&(t.response=(0,Yo.isJsonRpcError)(e)?{error:e.error}:{result:e.result},r.records.set(t.id,t),r.persist(),r.events.emit("history_updated",t))});return function(t){return e.apply(this,arguments)}}()),Ql(this,"get",function(){var e=(0,n.Z)(function*(e,t){return r.isInitialized(),r.logger.debug("Getting record"),r.logger.trace({type:"method",method:"get",topic:e,id:t}),yield r.getRecord(t)});return function(t,r){return e.apply(this,arguments)}}()),Ql(this,"delete",(e,t)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:t}),this.values.forEach(r=>{if(r.topic===e){if(typeof t<"u"&&r.id!==t)return;this.records.delete(r.id),this.events.emit("history_deleted",r)}}),this.persist()}),Ql(this,"exists",function(){var e=(0,n.Z)(function*(e,t){return r.isInitialized(),!!r.records.has(t)&&(yield r.getRecord(t)).topic===e});return function(t,r){return e.apply(this,arguments)}}()),Ql(this,"on",(e,t)=>{this.events.on(e,t)}),Ql(this,"once",(e,t)=>{this.events.once(e,t)}),Ql(this,"off",(e,t)=>{this.events.off(e,t)}),Ql(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.logger=(0,K.Ep)(t,this.name)}get context(){return(0,K.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const r={topic:t.topic,request:(0,Yo.formatJsonRpcRequest)(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(r)}),e}setJsonRpcRecords(e){var t=this;return(0,n.Z)(function*(){yield t.core.storage.setItem(t.storageKey,e)})()}getJsonRpcRecords(){var e=this;return(0,n.Z)(function*(){return yield e.core.storage.getItem(e.storageKey)})()}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:t}=fo("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(t)}return t}persist(){var e=this;return(0,n.Z)(function*(){yield e.setJsonRpcRecords(e.values),e.events.emit("history_sync")})()}restore(){var e=this;return(0,n.Z)(function*(){try{const t=yield e.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(e.records.size){const{message:t}=fo("RESTORE_WILL_OVERRIDE",e.name);throw e.logger.error(t),new Error(t)}e.cached=t,e.logger.debug(`Successfully Restored records for ${e.name}`),e.logger.trace({type:"method",method:"restore",records:e.values})}catch(t){e.logger.debug(`Failed to Restore records for ${e.name}`),e.logger.error(t)}})()}registerEventListeners(){this.events.on("history_created",e=>{const t="history_created";this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on("history_updated",e=>{const t="history_updated";this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on("history_deleted",e=>{const t="history_deleted";this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(ko.Lx.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{(0,o.toMiliseconds)(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit("history_deleted",t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=fo("NOT_INITIALIZED",this.name);throw new Error(e)}}}var eu=Object.defineProperty,tu=(e,t,r)=>((e,t,r)=>t in e?eu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class ru extends Vo{constructor(e,t){var r;super(e,t),r=this,this.core=e,this.logger=t,tu(this,"expirations",new Map),tu(this,"events",new i.EventEmitter),tu(this,"name","expirer"),tu(this,"version","0.3"),tu(this,"cached",[]),tu(this,"initialized",!1),tu(this,"storagePrefix",Xo),tu(this,"init",(0,n.Z)(function*(){r.initialized||(r.logger.trace("Initialized"),yield r.restore(),r.cached.forEach(e=>r.expirations.set(e.target,e)),r.cached=[],r.registerEventListeners(),r.initialized=!0)})),tu(this,"has",e=>{try{const t=this.formatTarget(e);return typeof this.getExpiration(t)<"u"}catch{return!1}}),tu(this,"set",(e,t)=>{this.isInitialized();const r=this.formatTarget(e),n={target:r,expiry:t};this.expirations.set(r,n),this.checkExpiry(r,n),this.events.emit("expirer_created",{target:r,expiration:n})}),tu(this,"get",e=>{this.isInitialized();const t=this.formatTarget(e);return this.getExpiration(t)}),tu(this,"del",e=>{if(this.isInitialized(),this.has(e)){const t=this.formatTarget(e),r=this.getExpiration(t);this.expirations.delete(t),this.events.emit("expirer_deleted",{target:t,expiration:r})}}),tu(this,"on",(e,t)=>{this.events.on(e,t)}),tu(this,"once",(e,t)=>{this.events.once(e,t)}),tu(this,"off",(e,t)=>{this.events.off(e,t)}),tu(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.logger=(0,K.Ep)(t,this.name)}get context(){return(0,K.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if("string"==typeof e)return function(e){return me("topic",e)}(e);if("number"==typeof e)return function(e){return me("id",e)}(e);const{message:t}=fo("UNKNOWN_TYPE","Target type: "+typeof e);throw new Error(t)}setExpirations(e){var t=this;return(0,n.Z)(function*(){yield t.core.storage.setItem(t.storageKey,e)})()}getExpirations(){var e=this;return(0,n.Z)(function*(){return yield e.core.storage.getItem(e.storageKey)})()}persist(){var e=this;return(0,n.Z)(function*(){yield e.setExpirations(e.values),e.events.emit("expirer_sync")})()}restore(){var e=this;return(0,n.Z)(function*(){try{const t=yield e.getExpirations();if(typeof t>"u"||!t.length)return;if(e.expirations.size){const{message:t}=fo("RESTORE_WILL_OVERRIDE",e.name);throw e.logger.error(t),new Error(t)}e.cached=t,e.logger.debug(`Successfully Restored expirations for ${e.name}`),e.logger.trace({type:"method",method:"restore",expirations:e.values})}catch(t){e.logger.debug(`Failed to Restore expirations for ${e.name}`),e.logger.error(t)}})()}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:t}=fo("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(t),new Error(t)}return t}checkExpiry(e,t){const{expiry:r}=t;(0,o.toMiliseconds)(r)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(ha,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(ko.Lx.pulse,()=>this.checkExpirations()),this.events.on("expirer_created",e=>{const t="expirer_created";this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(ha,e=>{const t=ha;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on("expirer_deleted",e=>{const t="expirer_deleted";this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=fo("NOT_INITIALIZED",this.name);throw new Error(e)}}}var nu=Object.defineProperty,iu=(e,t,r)=>((e,t,r)=>t in e?nu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class su extends class{constructor(e,t,r){this.core=e,this.logger=t,this.store=r}}{constructor(e,t,r){var i;super(e,t,r),i=this,this.core=e,this.logger=t,this.store=r,iu(this,"name","verify-api"),iu(this,"abortController"),iu(this,"isDevEnv"),iu(this,"verifyUrlV3",ga),iu(this,"storagePrefix",Xo),iu(this,"version",2),iu(this,"publicKey"),iu(this,"fetchPromise"),iu(this,"init",(0,n.Z)(function*(){var e;i.isDevEnv||(i.publicKey=yield i.store.getItem(i.storeKey),i.publicKey&&(0,o.toMiliseconds)(null==(e=i.publicKey)?void 0:e.expiresAt)<Date.now()&&(i.logger.debug("verify v2 public key expired"),yield i.removePublicKey()))})),iu(this,"register",function(){var e=(0,n.Z)(function*(e){if(!ae()||i.isDevEnv)return;const t=window.location.origin,{id:r,decryptedId:n}=e,s=`${i.verifyUrlV3}/attestation?projectId=${i.core.projectId}&origin=${t}&id=${r}&decryptedId=${n}`;try{const e=(0,a.getDocument)(),t=i.startAbortTimer(5*o.ONE_SECOND),n=yield new Promise((n,o)=>{const a=()=>{window.removeEventListener("message",l),e.body.removeChild(c),o("attestation aborted")};i.abortController.signal.addEventListener("abort",a);const c=e.createElement("iframe");c.src=s,c.style.display="none",c.addEventListener("error",a,{signal:i.abortController.signal});const l=s=>{if(s.data&&"string"==typeof s.data)try{const o=JSON.parse(s.data);if("verify_attestation"===o.type){if((0,$.xp)(o.attestation).payload.id!==r)return;clearInterval(t),e.body.removeChild(c),i.abortController.signal.removeEventListener("abort",a),window.removeEventListener("message",l),n(null===o.attestation?"":o.attestation)}}catch(o){i.logger.warn(o)}};e.body.appendChild(c),window.addEventListener("message",l,{signal:i.abortController.signal})});return i.logger.debug(n,"jwt attestation"),n}catch(c){i.logger.warn(c)}return""});return function(t){return e.apply(this,arguments)}}()),iu(this,"resolve",function(){var e=(0,n.Z)(function*(e){if(i.isDevEnv)return"";const{attestationId:t,hash:r,encryptedId:n}=e;if(""===t)return void i.logger.debug("resolve: attestationId is empty, skipping");if(t){if((0,$.xp)(t).payload.id!==n)return;const e=yield i.isValidJwtAttestation(t);if(e)return e.isVerified?e:void i.logger.warn("resolve: jwt attestation: origin url not verified")}if(!r)return;const s=i.getVerifyUrl(e?.verifyUrl);return i.fetchAttestation(r,s)});return function(t){return e.apply(this,arguments)}}()),iu(this,"fetchAttestation",function(){var e=(0,n.Z)(function*(e,t){i.logger.debug(`resolving attestation: ${e} from url: ${t}`);const r=i.startAbortTimer(5*o.ONE_SECOND),n=yield fetch(`${t}/attestation/${e}?v2Supported=true`,{signal:i.abortController.signal});return clearTimeout(r),200===n.status?yield n.json():void 0});return function(t,r){return e.apply(this,arguments)}}()),iu(this,"getVerifyUrl",e=>{let t=e||pa;return ya.includes(t)||(this.logger.info(`verify url: ${t}, not included in trusted list, assigning default: ${pa}`),t=pa),t}),iu(this,"fetchPublicKey",(0,n.Z)(function*(){try{i.logger.debug(`fetching public key from: ${i.verifyUrlV3}`);const e=i.startAbortTimer(o.FIVE_SECONDS),t=yield fetch(`${i.verifyUrlV3}/public-key`,{signal:i.abortController.signal});return clearTimeout(e),yield t.json()}catch(e){i.logger.warn(e)}})),iu(this,"persistPublicKey",function(){var e=(0,n.Z)(function*(e){i.logger.debug(e,"persisting public key to local storage"),yield i.store.setItem(i.storeKey,e),i.publicKey=e});return function(t){return e.apply(this,arguments)}}()),iu(this,"removePublicKey",(0,n.Z)(function*(){i.logger.debug("removing verify v2 public key from storage"),yield i.store.removeItem(i.storeKey),i.publicKey=void 0})),iu(this,"isValidJwtAttestation",function(){var e=(0,n.Z)(function*(e){const t=yield i.getPublicKey();try{if(t)return i.validateAttestation(e,t)}catch(n){i.logger.error(n),i.logger.warn("error validating attestation")}const r=yield i.fetchAndPersistPublicKey();try{if(r)return i.validateAttestation(e,r)}catch(n){i.logger.error(n),i.logger.warn("error validating attestation")}});return function(t){return e.apply(this,arguments)}}()),iu(this,"getPublicKey",(0,n.Z)(function*(){return i.publicKey?i.publicKey:yield i.fetchAndPersistPublicKey()})),iu(this,"fetchAndPersistPublicKey",(0,n.Z)(function*(){if(i.fetchPromise)return yield i.fetchPromise,i.publicKey;i.fetchPromise=new Promise(function(){var e=(0,n.Z)(function*(e){const t=yield i.fetchPublicKey();t&&(yield i.persistPublicKey(t),e(t))});return function(t){return e.apply(this,arguments)}}());const e=yield i.fetchPromise;return i.fetchPromise=void 0,e})),iu(this,"validateAttestation",(e,t)=>{const r=function(e,t){const[r,n,i]=e.split("."),s=Buffer.from(Ps(i),"base64");if(64!==s.length)throw new Error("Invalid signature length");const o=s.slice(0,32),a=s.slice(32,64),c=Nn(`${r}.${n}`),l=function(e){const t=Buffer.from(e.x,"base64"),r=Buffer.from(e.y,"base64");return(0,z.zo)([new Uint8Array([4]),t,r])}(t);if(!ys.verify((0,z.zo)([o,a]),c,l))throw new Error("Invalid signature");return(0,$.xp)(e).payload}(e,t.publicKey),n={hasExpired:(0,o.toMiliseconds)(r.exp)<Date.now(),payload:r};if(n.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:n.payload.origin,isScam:n.payload.isScam,isVerified:n.payload.isVerified}}),this.logger=(0,K.Ep)(t,this.name),this.abortController=new AbortController,this.isDevEnv=Re(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return(0,K.Fd)(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),(0,o.toMiliseconds)(e))}}var ou=Object.defineProperty,au=(e,t,r)=>((e,t,r)=>t in e?ou(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class cu extends class{constructor(e,t){this.projectId=e,this.logger=t}}{constructor(e,t){var r;super(e,t),r=this,this.projectId=e,this.logger=t,au(this,"context","echo"),au(this,"registerDeviceToken",function(){var e=(0,n.Z)(function*(e){const{clientId:t,token:n,notificationType:i,enableEncrypted:s=!1}=e,o=`https://echo.walletconnect.com/${r.projectId}/clients`;yield fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:t,type:i,token:n,always_raw:s})})});return function(t){return e.apply(this,arguments)}}()),this.logger=(0,K.Ep)(t,this.context)}}var lu=Object.defineProperty,uu=Object.getOwnPropertySymbols,fu=Object.prototype.hasOwnProperty,hu=Object.prototype.propertyIsEnumerable,du=(e,t,r)=>t in e?lu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,pu=(e,t)=>{for(var r in t||(t={}))fu.call(t,r)&&du(e,r,t[r]);if(uu)for(var r of uu(t))hu.call(t,r)&&du(e,r,t[r]);return e},gu=(e,t,r)=>du(e,"symbol"!=typeof t?t+"":t,r);class yu extends class{constructor(e,t,r){this.core=e,this.logger=t,this.telemetryEnabled=r}}{constructor(e,t,r=!0){var i;super(e,t,r),i=this,this.core=e,this.logger=t,gu(this,"context","event-client"),gu(this,"storagePrefix",Xo),gu(this,"storageVersion",.1),gu(this,"events",new Map),gu(this,"shouldPersist",!1),gu(this,"init",(0,n.Z)(function*(){if(!Re())try{const e={eventId:Ae(),timestamp:Date.now(),domain:i.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:yield i.core.crypto.getClientId(),user_agent:fe(i.core.relayer.protocol,i.core.relayer.version,oa)}}};yield i.sendEvent([e])}catch(e){i.logger.warn(e)}})),gu(this,"createEvent",e=>{const{event:t="ERROR",type:r="",properties:{topic:n,trace:i}}=e,s=Ae(),o=this.core.projectId||"",a=Date.now(),c=pu({eventId:s,timestamp:a,props:{event:t,type:r,properties:{topic:n,trace:i}},bundleId:o,domain:this.getAppDomain()},this.setMethods(s));return this.telemetryEnabled&&(this.events.set(s,c),this.shouldPersist=!0),c}),gu(this,"getEvent",e=>{const{eventId:t,topic:r}=e;if(t)return this.events.get(t);const n=Array.from(this.events.values()).find(e=>e.props.properties.topic===r);return n?pu(pu({},n),this.setMethods(n.eventId)):void 0}),gu(this,"deleteEvent",e=>{const{eventId:t}=e;this.events.delete(t),this.shouldPersist=!0}),gu(this,"setEventListeners",()=>{this.core.heartbeat.on(ko.Lx.pulse,(0,n.Z)(function*(){i.shouldPersist&&(yield i.persist()),i.events.forEach(e=>{(0,o.fromMiliseconds)(Date.now())-(0,o.fromMiliseconds)(e.timestamp)>86400&&(i.events.delete(e.eventId),i.shouldPersist=!0)})}))}),gu(this,"setMethods",e=>({addTrace:t=>this.addTrace(e,t),setError:t=>this.setError(e,t)})),gu(this,"addTrace",(e,t)=>{const r=this.events.get(e);r&&(r.props.properties.trace.push(t),this.events.set(e,r),this.shouldPersist=!0)}),gu(this,"setError",(e,t)=>{const r=this.events.get(e);r&&(r.props.type=t,r.timestamp=Date.now(),this.events.set(e,r),this.shouldPersist=!0)}),gu(this,"persist",(0,n.Z)(function*(){yield i.core.storage.setItem(i.storageKey,Array.from(i.events.values())),i.shouldPersist=!1})),gu(this,"restore",(0,n.Z)(function*(){try{const e=(yield i.core.storage.getItem(i.storageKey))||[];if(!e.length)return;e.forEach(e=>{i.events.set(e.eventId,pu(pu({},e),i.setMethods(e.eventId)))})}catch(e){i.logger.warn(e)}})),gu(this,"submit",(0,n.Z)(function*(){if(!i.telemetryEnabled||0===i.events.size)return;const e=[];for(const[r,n]of i.events)n.props.type&&e.push(n);if(0!==e.length)try{if((yield i.sendEvent(e)).ok)for(const t of e)i.events.delete(t.eventId),i.shouldPersist=!0}catch(t){i.logger.warn(t)}})),gu(this,"sendEvent",function(){var e=(0,n.Z)(function*(e){const t=i.getAppDomain()?"":"&sp=desktop";return yield fetch(`https://pulse.walletconnect.org/batch?projectId=${i.core.projectId}&st=events_sdk&sv=js-${oa}${t}`,{method:"POST",body:JSON.stringify(e)})});return function(t){return e.apply(this,arguments)}}()),gu(this,"getAppDomain",()=>ue().url),this.logger=(0,K.Ep)(t,this.context),this.telemetryEnabled=r,r?this.restore().then((0,n.Z)(function*(){yield i.submit(),i.setEventListeners()})):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var mu=Object.defineProperty,bu=Object.getOwnPropertySymbols,wu=Object.prototype.hasOwnProperty,vu=Object.prototype.propertyIsEnumerable,Eu=(e,t,r)=>t in e?mu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,xu=(e,t)=>{for(var r in t||(t={}))wu.call(t,r)&&Eu(e,r,t[r]);if(bu)for(var r of bu(t))vu.call(t,r)&&Eu(e,r,t[r]);return e},Iu=(e,t,r)=>Eu(e,"symbol"!=typeof t?t+"":t,r);class Su extends Mo{constructor(e){var t,r;super(e),t=this,Iu(this,"protocol","wc"),Iu(this,"version",2),Iu(this,"name","core"),Iu(this,"relayUrl"),Iu(this,"projectId"),Iu(this,"customStoragePrefix"),Iu(this,"events",new i.EventEmitter),Iu(this,"logger"),Iu(this,"heartbeat"),Iu(this,"relayer"),Iu(this,"crypto"),Iu(this,"storage"),Iu(this,"history"),Iu(this,"expirer"),Iu(this,"pairing"),Iu(this,"verify"),Iu(this,"echoClient"),Iu(this,"linkModeSupportedApps"),Iu(this,"eventClient"),Iu(this,"initialized",!1),Iu(this,"logChunkController"),Iu(this,"on",(e,t)=>this.events.on(e,t)),Iu(this,"once",(e,t)=>this.events.once(e,t)),Iu(this,"off",(e,t)=>this.events.off(e,t)),Iu(this,"removeListener",(e,t)=>this.events.removeListener(e,t)),Iu(this,"dispatchEnvelope",({topic:e,message:t,sessionExists:r})=>{if(!e||!t)return;const n={topic:e,message:t,publishedAt:Date.now(),transportType:aa.link_mode};this.relayer.onLinkMessageEvent(n,{sessionExists:r})});const s=this.getGlobalCore(e?.customStoragePrefix);if(s)try{return this.customStoragePrefix=s.customStoragePrefix,this.logger=s.logger,this.heartbeat=s.heartbeat,this.crypto=s.crypto,this.history=s.history,this.expirer=s.expirer,this.storage=s.storage,this.relayer=s.relayer,this.pairing=s.pairing,this.verify=s.verify,this.echoClient=s.echoClient,this.linkModeSupportedApps=s.linkModeSupportedApps,this.eventClient=s.eventClient,this.initialized=s.initialized,this.logChunkController=s.logChunkController,s}catch(l){console.warn("Failed to copy global core",l)}this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||ia,this.customStoragePrefix=null!=e&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const o=(0,K.jI)({level:"string"==typeof e?.logger&&e.logger?e.logger:"error",name:"core"}),{logger:a,chunkLoggerController:c}=(0,K.Rt)({opts:o,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=c,null!=(r=this.logChunkController)&&r.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=(0,n.Z)(function*(){var e,r;null!=(e=t.logChunkController)&&e.downloadLogsBlobInBrowser&&(null==(r=t.logChunkController)||r.downloadLogsBlobInBrowser({clientId:yield t.crypto.getClientId()}))})),this.logger=(0,K.Ep)(a,this.name),this.heartbeat=new ko.C$,this.crypto=new Zc(this,this.logger,e?.keychain),this.history=new Xl(this,this.logger),this.expirer=new ru(this,this.logger),this.storage=null!=e&&e.storage?e.storage:new jo.Z(xu(xu({},ea),e?.storageOptions)),this.relayer=new Bl({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Jl(this,this.logger),this.verify=new su(this,this.logger,this.storage),this.echoClient=new cu(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new yu(this,this.logger,e?.telemetryEnabled),this.setGlobalCore(this)}static init(e){return(0,n.Z)(function*(){const t=new Su(e);yield t.initialize();const r=yield t.crypto.getClientId();return yield t.storage.setItem("WALLETCONNECT_CLIENT_ID",r),t})()}get context(){return(0,K.Fd)(this.logger)}start(){var e=this;return(0,n.Z)(function*(){e.initialized||(yield e.initialize())})()}getLogsBlob(){var e=this;return(0,n.Z)(function*(){var t;return null==(t=e.logChunkController)?void 0:t.logsToBlob({clientId:yield e.crypto.getClientId()})})()}addLinkModeSupportedApp(e){var t=this;return(0,n.Z)(function*(){t.linkModeSupportedApps.includes(e)||(t.linkModeSupportedApps.push(e),yield t.storage.setItem(ca,t.linkModeSupportedApps))})()}initialize(){var e=this;return(0,n.Z)(function*(){e.logger.trace("Initialized");try{yield e.crypto.init(),yield e.history.init(),yield e.expirer.init(),yield e.relayer.init(),yield e.heartbeat.init(),yield e.pairing.init(),e.linkModeSupportedApps=(yield e.storage.getItem(ca))||[],e.initialized=!0,e.logger.info("Core Initialization Success")}catch(t){throw e.logger.warn(t,`Core Initialization Failure at epoch ${Date.now()}`),e.logger.error(t.message),t}})()}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const t=`_walletConnectCore_${e}`,r=`${t}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[r]} times.`),globalThis[t]}catch(t){return void console.warn("Failed to get global WalletConnect core",t)}}setGlobalCore(e){var t;try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${(null==(t=e.opts)?void 0:t.customStoragePrefix)||""}`;globalThis[r]=e}catch(r){console.warn("Failed to set global WalletConnect core",r)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&"true"===process.env.DISABLE_GLOBAL_CORE}catch{return!0}}}const Ou=Su,_u="wc@2:client:",Pu="WALLETCONNECT_DEEPLINK_CHOICE",Au="Proposal expired",Ru=o.SEVEN_DAYS,Tu={wc_sessionPropose:{req:{ttl:o.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:o.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:o.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:o.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:o.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:o.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:o.ONE_DAY,prompt:!1,tag:1104},res:{ttl:o.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:o.ONE_DAY,prompt:!1,tag:1106},res:{ttl:o.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:o.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:o.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:o.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:o.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:o.ONE_DAY,prompt:!1,tag:1112},res:{ttl:o.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:o.ONE_DAY,prompt:!1,tag:1114},res:{ttl:o.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:o.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:o.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:o.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:o.FIVE_MINUTES,prompt:!1,tag:1119}}},Bu={min:o.FIVE_MINUTES,max:o.SEVEN_DAYS},Cu={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},Uu=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],Nu="wc@1.5:auth:",ku=`${Nu}:PUB_KEY`;var ju=Object.defineProperty,Lu=Object.defineProperties,Du=Object.getOwnPropertyDescriptors,qu=Object.getOwnPropertySymbols,Mu=Object.prototype.hasOwnProperty,$u=Object.prototype.propertyIsEnumerable,zu=(e,t,r)=>t in e?ju(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Zu=(e,t)=>{for(var r in t||(t={}))Mu.call(t,r)&&zu(e,r,t[r]);if(qu)for(var r of qu(t))$u.call(t,r)&&zu(e,r,t[r]);return e},Fu=(e,t)=>Lu(e,Du(t)),Ku=(e,t,r)=>zu(e,"symbol"!=typeof t?t+"":t,r);class Vu extends class{constructor(e){this.client=e}}{constructor(e){var t;super(e),t=this,Ku(this,"name","engine"),Ku(this,"events",new i),Ku(this,"initialized",!1),Ku(this,"requestQueue",{state:"IDLE",queue:[]}),Ku(this,"sessionRequestQueue",{state:"IDLE",queue:[]}),Ku(this,"emittedSessionRequests",new Be({limit:500})),Ku(this,"requestQueueDelay",o.ONE_SECOND),Ku(this,"expectedPairingMethodMap",new Map),Ku(this,"recentlyDeletedMap",new Map),Ku(this,"recentlyDeletedLimit",200),Ku(this,"relayMessageCache",[]),Ku(this,"pendingSessions",new Map),Ku(this,"init",(0,n.Z)(function*(){t.initialized||(yield t.cleanup(),t.registerRelayerEvents(),t.registerExpirerEvents(),t.registerPairingEvents(),yield t.registerLinkModeListeners(),t.client.core.pairing.register({methods:Object.keys(Tu)}),t.initialized=!0,setTimeout((0,n.Z)(function*(){yield t.processPendingMessageEvents(),t.sessionRequestQueue.queue=t.getPendingSessionRequests(),t.processSessionRequestQueue()}),(0,o.toMiliseconds)(t.requestQueueDelay)))})),Ku(this,"connect",function(){var e=(0,n.Z)(function*(e){var r;t.isInitialized(),yield t.confirmOnlineStateOrThrow();const n=Fu(Zu({},e),{requiredNamespaces:e.requiredNamespaces||{},optionalNamespaces:e.optionalNamespaces||{}});yield t.isValidConnect(n),n.optionalNamespaces=function(e,t){var r,n,i,s,o,a;const c=ao(e),l=ao(t),u={},f=Object.keys(c).concat(Object.keys(l));for(const h of f)u[h]={chains:xe(null==(r=c[h])?void 0:r.chains,null==(n=l[h])?void 0:n.chains),methods:xe(null==(i=c[h])?void 0:i.methods,null==(s=l[h])?void 0:s.methods),events:xe(null==(o=c[h])?void 0:o.events,null==(a=l[h])?void 0:a.events)};return u}(n.requiredNamespaces,n.optionalNamespaces),n.requiredNamespaces={};const{pairingTopic:i,requiredNamespaces:s,optionalNamespaces:a,sessionProperties:c,scopedProperties:l,relays:u,authentication:f,walletPay:h}=n,d=(null==(r=f?.[0])?void 0:r.ttl)||Tu.wc_sessionPropose.req.ttl||o.FIVE_MINUTES;t.validateRequestExpiry(d);let p,g=i,y=!1;try{if(g){const e=t.client.core.pairing.pairings.get(g);t.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),y=e.active}}catch(O){throw t.client.logger.error(`connect() -> pairing.get(${g}) failed`),O}if(!g||!y){const{topic:e,uri:r}=yield t.client.core.pairing.create({internal:{skipSubscribe:!0}});g=e,p=r}if(!g){const{message:e}=fo("NO_MATCHING_KEY",`connect() pairing topic: ${g}`);throw new Error(e)}const m=yield t.client.core.crypto.generateKeyPair(),b=we(d),w=Zu(Fu(Zu(Zu({requiredNamespaces:s,optionalNamespaces:a,relays:u??[{protocol:"irn"}],proposer:{publicKey:m,metadata:t.client.metadata},expiryTimestamp:b,pairingTopic:g},c&&{sessionProperties:c}),l&&{scopedProperties:l}),{id:(0,Yo.payloadId)()}),(f||h)&&{requests:{authentication:f?.map(e=>{const{domain:t,chains:r,nonce:n,uri:i,exp:s,nbf:o,type:a,statement:c,requestId:l,resources:u,signatureTypes:f}=e;return{domain:t,chains:r,nonce:n,type:a??"caip122",aud:i,version:"1",iat:(new Date).toISOString(),exp:s,nbf:o,statement:c,requestId:l,resources:u,signatureTypes:f}}),walletPay:h}}),v=Ee("session_connect",w.id),{reject:E,resolve:x,done:I}=ge(d,Au),S=({id:e})=>{e===w.id&&(t.client.events.off("proposal_expire",S),t.pendingSessions.delete(w.id),t.events.emit(v,{error:{message:Au,code:0}}))};return t.client.events.on("proposal_expire",S),t.events.once(v,({error:e,session:r})=>{t.client.events.off("proposal_expire",S),e?E(e):r&&x(r)}),yield t.setProposal(w.id,w),yield t.sendProposeSession({proposal:w,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:w.id}}}).catch(e=>{throw t.deleteProposal(w.id),e}),{uri:p,approval:I}});return function(t){return e.apply(this,arguments)}}()),Ku(this,"pair",function(){var e=(0,n.Z)(function*(e){t.isInitialized(),yield t.confirmOnlineStateOrThrow();try{return yield t.client.core.pairing.pair(e)}catch(r){throw t.client.logger.error("pair() failed"),r}});return function(t){return e.apply(this,arguments)}}()),Ku(this,"approve",function(){var e=(0,n.Z)(function*(e){var r,n,i;const s=t.client.core.eventClient.createEvent({properties:{topic:null==(r=e?.id)?void 0:r.toString(),trace:["session_approve_started"]}});try{t.isInitialized(),yield t.confirmOnlineStateOrThrow()}catch(O){throw s.setError("no_internet_connection"),O}try{yield t.isValidProposalId(e?.id)}catch(O){throw t.client.logger.error(`approve() -> proposal.get(${e?.id}) failed`),s.setError("proposal_not_found"),O}try{yield t.isValidApprove(e)}catch(O){throw t.client.logger.error("approve() -> isValidApprove() failed"),s.setError("session_approve_namespace_validation_failure"),O}const{id:o,relayProtocol:a,namespaces:c,sessionProperties:l,scopedProperties:u,sessionConfig:f,proposalRequestsResponses:h}=e,d=t.client.proposal.get(o);t.client.core.eventClient.deleteEvent({eventId:s.eventId});const{pairingTopic:p,proposer:g,requiredNamespaces:y,optionalNamespaces:m}=d;let b=null==(n=t.client.core.eventClient)?void 0:n.getEvent({topic:p});b||(b=null==(i=t.client.core.eventClient)?void 0:i.createEvent({type:"session_approve_started",properties:{topic:p,trace:["session_approve_started","session_namespaces_validation_success"]}}));const w=yield t.client.core.crypto.generateKeyPair(),v=g.publicKey,E=yield t.client.core.crypto.generateSharedKey(w,v),x=Fu(Zu(Zu(Zu({relay:{protocol:a??"irn"},namespaces:c,controller:{publicKey:w,metadata:t.client.metadata},expiry:we(Ru)},l&&{sessionProperties:l}),u&&{scopedProperties:u}),f&&{sessionConfig:f}),{proposalRequestsResponses:h}),I=aa.relay;b.addTrace("subscribing_session_topic");try{yield t.client.core.relayer.subscribe(E,{transportType:I,internal:{skipSubscribe:!0}})}catch(O){throw b.setError("subscribe_session_topic_failure"),O}b.addTrace("subscribe_session_topic_success");const S=Fu(Zu({},x),{topic:E,requiredNamespaces:y,optionalNamespaces:m,pairingTopic:p,acknowledged:!1,self:x.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:w,transportType:aa.relay,authentication:h?.authentication,walletPayResult:h?.walletPay});yield t.client.session.set(E,S),b.addTrace("store_session");try{yield t.sendApproveSession({sessionTopic:E,proposal:d,pairingProposalResponse:{relay:{protocol:a??"irn"},responderPublicKey:w},sessionSettleRequest:x,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:Zu({correlationId:o},t.getTVFApproveParams(S))}}),b.addTrace("session_approve_publish_success")}catch(O){throw t.client.logger.error(O),t.client.session.delete(E,ho("USER_DISCONNECTED")),yield t.client.core.relayer.unsubscribe(E),O}return t.client.core.eventClient.deleteEvent({eventId:b.eventId}),yield t.client.core.pairing.updateMetadata({topic:p,metadata:g.metadata}),yield t.deleteProposal(o),yield t.client.core.pairing.activate({topic:p}),yield t.setExpiry(E,we(Ru)),{topic:E,acknowledged:()=>Promise.resolve(t.client.session.get(E))}});return function(t){return e.apply(this,arguments)}}()),Ku(this,"reject",function(){var e=(0,n.Z)(function*(e){t.isInitialized(),yield t.confirmOnlineStateOrThrow();try{yield t.isValidReject(e)}catch(s){throw t.client.logger.error("reject() -> isValidReject() failed"),s}const{id:r,reason:n}=e;let i;try{i=t.client.proposal.get(r).pairingTopic}catch(s){throw t.client.logger.error(`reject() -> proposal.get(${r}) failed`),s}i&&(yield t.sendError({id:r,topic:i,error:n,rpcOpts:Tu.wc_sessionPropose.reject})),yield t.deleteProposal(r)});return function(t){return e.apply(this,arguments)}}()),Ku(this,"update",function(){var e=(0,n.Z)(function*(e){t.isInitialized(),yield t.confirmOnlineStateOrThrow();try{yield t.isValidUpdate(e)}catch(f){throw t.client.logger.error("update() -> isValidUpdate() failed"),f}const{topic:r,namespaces:n}=e,{done:i,resolve:s,reject:a}=ge(o.FIVE_MINUTES,"Session update request expired without receiving any acknowledgement"),c=(0,Yo.payloadId)(),l=(0,Yo.getBigIntRpcId)().toString(),u=t.client.session.get(r).namespaces;return t.events.once(Ee("session_update",c),({error:e})=>{e?a(e):s()}),yield t.client.session.update(r,{namespaces:n}),yield t.sendRequest({topic:r,method:"wc_sessionUpdate",params:{namespaces:n},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(e=>{t.client.logger.error(e),t.client.session.update(r,{namespaces:u}),a(e)}),{acknowledged:i}});return function(t){return e.apply(this,arguments)}}()),Ku(this,"extend",function(){var e=(0,n.Z)(function*(e){t.isInitialized(),yield t.confirmOnlineStateOrThrow();try{yield t.isValidExtend(e)}catch(c){throw t.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:r}=e,n=(0,Yo.payloadId)(),{done:i,resolve:s,reject:a}=ge(o.FIVE_MINUTES,"Session extend request expired without receiving any acknowledgement");return t.events.once(Ee("session_extend",n),({error:e})=>{e?a(e):s()}),yield t.setExpiry(r,we(Ru)),t.sendRequest({topic:r,method:"wc_sessionExtend",params:{},clientRpcId:n,throwOnFailedPublish:!0}).catch(e=>{a(e)}),{acknowledged:i}});return function(t){return e.apply(this,arguments)}}()),Ku(this,"request",function(){var e=(0,n.Z)(function*(e){t.isInitialized();try{yield t.isValidRequest(e)}catch(y){throw t.client.logger.error("request() -> isValidRequest() failed"),y}const{chainId:r,request:i,topic:s,expiry:o=Tu.wc_sessionRequest.req.ttl}=e,a=t.client.session.get(s);a?.transportType===aa.relay&&(yield t.confirmOnlineStateOrThrow());const c=(0,Yo.payloadId)(),l=(0,Yo.getBigIntRpcId)().toString(),{done:u,resolve:f,reject:h}=ge(o,"Request expired. Please try again.");t.events.once(Ee("session_request",c),({error:e,result:t})=>{e?h(e):f(t)});const d="wc_sessionRequest",p=t.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(p)return yield t.sendRequest({clientRpcId:c,relayRpcId:l,topic:s,method:d,params:{request:Fu(Zu({},i),{expiryTimestamp:we(o)}),chainId:r},expiry:o,throwOnFailedPublish:!0,appLink:p}).catch(e=>h(e)),t.client.events.emit("session_request_sent",{topic:s,request:i,chainId:r,id:c}),yield u();const g={request:Fu(Zu({},i),{expiryTimestamp:we(o)}),chainId:r};return yield Promise.all([new Promise(function(){var e=(0,n.Z)(function*(e){yield t.sendRequest({clientRpcId:c,relayRpcId:l,topic:s,method:d,params:g,expiry:o,throwOnFailedPublish:!0,tvf:t.getTVFParams(c,g)}).catch(e=>h(e)),t.client.events.emit("session_request_sent",{topic:s,request:i,chainId:r,id:c}),e()});return function(t){return e.apply(this,arguments)}}()),new Promise(function(){var e=(0,n.Z)(function*(e){var r;if(null==(r=a.sessionConfig)||!r.disableDeepLink){const e=yield function(e,t){return _e.apply(this,arguments)}(t.client.core.storage,Pu);yield function(e){return Ie.apply(this,arguments)}({id:c,topic:s,wcDeepLink:e})}e()});return function(t){return e.apply(this,arguments)}}()),u()]).then(e=>e[2])});return function(t){return e.apply(this,arguments)}}()),Ku(this,"respond",function(){var e=(0,n.Z)(function*(e){var r,n;t.isInitialized();const i=t.client.core.eventClient.createEvent({properties:{topic:e?.topic||(null==(n=null==(r=e?.response)?void 0:r.id)?void 0:n.toString()),trace:["session_request_response_started"]}});try{yield t.isValidRespond(e)}catch(u){throw i.addTrace(u?.message),i.setError("session_request_response_validation_failure"),u}i.addTrace("session_request_response_validation_success");const{topic:s,response:o}=e,{id:a}=o,c=t.client.session.get(s);c.transportType===aa.relay&&(yield t.confirmOnlineStateOrThrow());const l=t.getAppLinkIfEnabled(c.peer.metadata,c.transportType);try{i.addTrace("session_request_response_publish_started"),(0,Yo.isJsonRpcResult)(o)?yield t.sendResult({id:a,topic:s,result:o.result,throwOnFailedPublish:!0,appLink:l}):(0,Yo.isJsonRpcError)(o)&&(yield t.sendError({id:a,topic:s,error:o.error,appLink:l})),t.cleanupAfterResponse(e)}catch(u){throw i.addTrace(u?.message),i.setError("session_request_response_publish_failure"),u}});return function(t){return e.apply(this,arguments)}}()),Ku(this,"ping",function(){var e=(0,n.Z)(function*(e){t.isInitialized(),yield t.confirmOnlineStateOrThrow();try{yield t.isValidPing(e)}catch(n){throw t.client.logger.error("ping() -> isValidPing() failed"),n}const{topic:r}=e;if(t.client.session.keys.includes(r)){const e=(0,Yo.payloadId)(),n=(0,Yo.getBigIntRpcId)().toString(),{done:i,resolve:s,reject:a}=ge(o.FIVE_MINUTES,"Ping request expired without receiving any acknowledgement");t.events.once(Ee("session_ping",e),({error:e})=>{e?a(e):s()}),yield Promise.all([t.sendRequest({topic:r,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:e,relayRpcId:n}),i()])}else t.client.core.pairing.pairings.keys.includes(r)&&(t.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),yield t.client.core.pairing.ping({topic:r}))});return function(t){return e.apply(this,arguments)}}()),Ku(this,"emit",function(){var e=(0,n.Z)(function*(e){t.isInitialized(),yield t.confirmOnlineStateOrThrow(),yield t.isValidEmit(e);const{topic:r,event:n,chainId:i}=e,s=(0,Yo.getBigIntRpcId)().toString(),o=(0,Yo.payloadId)();yield t.sendRequest({topic:r,method:"wc_sessionEvent",params:{event:n,chainId:i},throwOnFailedPublish:!0,relayRpcId:s,clientRpcId:o})});return function(t){return e.apply(this,arguments)}}()),Ku(this,"disconnect",function(){var e=(0,n.Z)(function*(e){t.isInitialized(),yield t.confirmOnlineStateOrThrow(),yield t.isValidDisconnect(e);const{topic:r}=e;if(t.client.session.keys.includes(r))yield t.sendRequest({topic:r,method:"wc_sessionDelete",params:ho("USER_DISCONNECTED"),throwOnFailedPublish:!0}),yield t.deleteSession({topic:r,emitEvent:!1});else{if(!t.client.core.pairing.pairings.keys.includes(r)){const{message:e}=fo("MISMATCHED_TOPIC",`Session or pairing topic not found: ${r}`);throw new Error(e)}yield t.client.core.pairing.disconnect({topic:r})}});return function(t){return e.apply(this,arguments)}}()),Ku(this,"find",e=>(this.isInitialized(),this.client.session.getAll().filter(t=>function(e,t){const{requiredNamespaces:r}=t,n=Object.keys(e.namespaces),i=Object.keys(r);let s=!0;return!!he(i,n)&&(n.forEach(t=>{const{accounts:n,methods:i,events:o}=e.namespaces[t],a=no(n),c=r[t];he(W(t,c),a)&&he(c.methods,i)&&he(c.events,o)||(s=!1)}),s)}(t,e)))),Ku(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),Ku(this,"authenticate",function(){var e=(0,n.Z)(function*(e,r){var i;t.isInitialized(),t.isValidAuthenticate(e);const s=r&&t.client.core.linkModeSupportedApps.includes(r)&&(null==(i=t.client.metadata.redirect)?void 0:i.linkMode),o=s?aa.link_mode:aa.relay;o===aa.relay&&(yield t.confirmOnlineStateOrThrow());const{chains:a,statement:c="",uri:l,domain:u,nonce:f,type:h,exp:d,nbf:p,methods:g=[],expiry:y}=e,m=[...e.resources||[]],{topic:b,uri:w}=yield t.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});t.client.logger.info({message:"Generated new pairing",pairing:{topic:b,uri:w}});const v=yield t.client.core.crypto.generateKeyPair(),E=xs(v);if(yield Promise.all([t.client.auth.authKeys.set(ku,{responseTopic:E,publicKey:v}),t.client.auth.pairingTopics.set(E,{topic:E,pairingTopic:b})]),yield t.client.core.relayer.subscribe(E,{transportType:o}),t.client.logger.info(`sending request to new pairing topic: ${b}`),g.length>0){const{namespace:e}=V(a[0]);let t=function(e,t,r){const n=function(e,t,r,n={}){return r?.sort((e,t)=>e.localeCompare(t)),{att:{[e]:Kr(t,r,n)}}}(e,t,r);return Vr(n)}(e,"request",g);Yr(m)&&(t=Wr(t,m.pop())),m.push(t)}const x=y&&y>Tu.wc_sessionAuthenticate.req.ttl?y:Tu.wc_sessionAuthenticate.req.ttl,I={authPayload:{type:h??"caip122",chains:a,statement:c,aud:l,domain:u,version:"1",nonce:f,iat:(new Date).toISOString(),exp:d,nbf:p,resources:m},requester:{publicKey:v,metadata:t.client.metadata},expiryTimestamp:we(x)},S={requiredNamespaces:{},optionalNamespaces:{eip155:{chains:a,methods:[...new Set(["personal_sign",...g])],events:["chainChanged","accountsChanged"]}},relays:[{protocol:"irn"}],pairingTopic:b,proposer:{publicKey:v,metadata:t.client.metadata},expiryTimestamp:we(Tu.wc_sessionPropose.req.ttl),id:(0,Yo.payloadId)()},{done:O,resolve:_,reject:P}=ge(x,"Request expired"),A=(0,Yo.payloadId)(),R=Ee("session_connect",S.id),T=Ee("session_request",A),B=function(){var e=(0,n.Z)(function*({error:e,session:r}){t.events.off(T,C),e?P(e):r&&_({session:r})});return function(t){return e.apply(this,arguments)}}(),C=function(){var e=(0,n.Z)(function*(e){var n,i,s;if(yield t.deletePendingAuthRequest(A,{message:"fulfilled",code:0}),e.error){const r=ho("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return e.error.code===r.code?void 0:(t.events.off(R,B),P(e.error.message))}yield t.deleteProposal(S.id),t.events.off(R,B);const{cacaos:a,responder:c}=e.result,l=[],u=[];for(const r of a){(yield $r({cacao:r,projectId:t.client.core.projectId}))||(t.client.logger.error(r,"Signature verification failed"),P(ho("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:e}=r,n=Yr(e.resources),i=[qr(e.iss)],s=Mr(e.iss);if(n){const e=Gr(n),t=Jr(n);l.push(...e),i.push(...t)}for(const t of i)u.push(`${t}:${s}`)}const f=yield t.client.core.crypto.generateSharedKey(v,c.publicKey);let h;l.length>0&&(h={topic:f,acknowledged:!0,self:{publicKey:v,metadata:t.client.metadata},peer:c,controller:c.publicKey,expiry:we(Ru),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:b,namespaces:co([...new Set(l)],[...new Set(u)]),transportType:o},yield t.client.core.relayer.subscribe(f,{transportType:o}),yield t.client.session.set(f,h),b&&(yield t.client.core.pairing.updateMetadata({topic:b,metadata:c.metadata})),h=t.client.session.get(f)),null!=(n=t.client.metadata.redirect)&&n.linkMode&&null!=(i=c.metadata.redirect)&&i.linkMode&&null!=(s=c.metadata.redirect)&&s.universal&&r&&(t.client.core.addLinkModeSupportedApp(c.metadata.redirect.universal),t.client.session.update(f,{transportType:aa.link_mode})),_({auths:a,session:h})});return function(t){return e.apply(this,arguments)}}();let U;t.events.once(R,B),t.events.once(T,C);try{if(s){const e=(0,Yo.formatJsonRpcRequest)("wc_sessionAuthenticate",I,A);t.client.core.history.set(b,e);const n=yield t.client.core.crypto.encode("",e,{type:2,encoding:ws});U=Hs(r,b,n)}else yield Promise.all([t.sendRequest({topic:b,method:"wc_sessionAuthenticate",params:I,expiry:e.expiry,throwOnFailedPublish:!0,clientRpcId:A}),t.sendRequest({topic:b,method:"wc_sessionPropose",params:S,expiry:Tu.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:S.id})])}catch(N){throw t.events.off(R,B),t.events.off(T,C),N}return yield t.setProposal(S.id,S),yield t.setAuthRequest(A,{request:Fu(Zu({},I),{verifyContext:{}}),pairingTopic:b,transportType:o}),{uri:U??w,response:O}});return function(t,r){return e.apply(this,arguments)}}()),Ku(this,"approveSessionAuthenticate",function(){var e=(0,n.Z)(function*(e){const{id:r,auths:n}=e,i=t.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:["authenticated_session_approve_started"]}});try{t.isInitialized()}catch(g){throw i.setError("no_internet_connection"),g}const s=t.getPendingAuthRequest(r);if(!s)throw i.setError("authenticated_session_pending_request_not_found"),new Error(`Could not find pending auth request with id ${r}`);const o=s.transportType||aa.relay;o===aa.relay&&(yield t.confirmOnlineStateOrThrow());const a=s.requester.publicKey,c=yield t.client.core.crypto.generateKeyPair(),l=xs(a),u={type:1,receiverPublicKey:a,senderPublicKey:c},f=[],h=[];for(const y of n){if(!(yield $r({cacao:y,projectId:t.client.core.projectId}))){i.setError("invalid_cacao");const e=ho("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw yield t.sendError({id:r,topic:l,error:e,encodeOpts:u}),new Error(e.message)}i.addTrace("cacaos_verified");const{p:e}=y,n=Yr(e.resources),s=[qr(e.iss)],o=Mr(e.iss);if(n){const e=Gr(n),t=Jr(n);f.push(...e),s.push(...t)}for(const t of s)h.push(`${t}:${o}`)}const d=yield t.client.core.crypto.generateSharedKey(c,a);let p;if(i.addTrace("create_authenticated_session_topic"),f?.length>0){p={topic:d,acknowledged:!0,self:{publicKey:c,metadata:t.client.metadata},peer:{publicKey:a,metadata:s.requester.metadata},controller:a,expiry:we(Ru),authentication:n,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:s.pairingTopic,namespaces:co([...new Set(f)],[...new Set(h)]),transportType:o},i.addTrace("subscribing_authenticated_session_topic");try{yield t.client.core.relayer.subscribe(d,{transportType:o})}catch(g){throw i.setError("subscribe_authenticated_session_topic_failure"),g}i.addTrace("subscribe_authenticated_session_topic_success"),yield t.client.session.set(d,p),i.addTrace("store_authenticated_session"),yield t.client.core.pairing.updateMetadata({topic:s.pairingTopic,metadata:s.requester.metadata})}i.addTrace("publishing_authenticated_session_approve");try{yield t.sendResult({topic:l,id:r,result:{cacaos:n,responder:{publicKey:c,metadata:t.client.metadata}},encodeOpts:u,throwOnFailedPublish:!0,appLink:t.getAppLinkIfEnabled(s.requester.metadata,o)})}catch(g){throw i.setError("authenticated_session_approve_publish_failure"),g}return yield t.client.auth.requests.delete(r,{message:"fulfilled",code:0}),yield t.client.core.pairing.activate({topic:s.pairingTopic}),t.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:p}});return function(t){return e.apply(this,arguments)}}()),Ku(this,"rejectSessionAuthenticate",function(){var e=(0,n.Z)(function*(e){t.isInitialized();const{id:r,reason:n}=e,i=t.getPendingAuthRequest(r);if(!i)throw new Error(`Could not find pending auth request with id ${r}`);i.transportType===aa.relay&&(yield t.confirmOnlineStateOrThrow());const s=i.requester.publicKey,o=yield t.client.core.crypto.generateKeyPair(),a=xs(s),c={type:1,receiverPublicKey:s,senderPublicKey:o};yield t.sendError({id:r,topic:a,error:n,encodeOpts:c,rpcOpts:Tu.wc_sessionAuthenticate.reject,appLink:t.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),yield t.client.auth.requests.delete(r,{message:"rejected",code:0}),yield t.deleteProposal(r)});return function(t){return e.apply(this,arguments)}}()),Ku(this,"formatAuthMessage",e=>{this.isInitialized();const{request:t,iss:r}=e;return Zr(t,r)}),Ku(this,"processRelayMessageCache",()=>{setTimeout((0,n.Z)(function*(){if(0!==t.relayMessageCache.length)for(;t.relayMessageCache.length>0;)try{const e=t.relayMessageCache.shift();e&&(yield t.onRelayMessage(e))}catch(e){t.client.logger.error(e)}}),50)}),Ku(this,"cleanupDuplicatePairings",function(){var e=(0,n.Z)(function*(e){if(e.pairingTopic)try{const r=t.client.core.pairing.pairings.get(e.pairingTopic),n=t.client.core.pairing.pairings.getAll().filter(t=>{var n,i;return(null==(n=t.peerMetadata)?void 0:n.url)&&(null==(i=t.peerMetadata)?void 0:i.url)===e.peer.metadata.url&&t.topic&&t.topic!==r.topic});if(0===n.length)return;t.client.logger.info(`Cleaning up ${n.length} duplicate pairing(s)`),yield Promise.all(n.map(e=>t.client.core.pairing.disconnect({topic:e.topic}))),t.client.logger.info("Duplicate pairings clean up finished")}catch(r){t.client.logger.error(r)}});return function(t){return e.apply(this,arguments)}}()),Ku(this,"deleteSession",function(){var e=(0,n.Z)(function*(e){var r;const{topic:n,expirerHasDeleted:i=!1,emitEvent:s=!0,id:o=0}=e,{self:a}=t.client.session.get(n);yield t.client.core.relayer.unsubscribe(n),yield t.client.session.delete(n,ho("USER_DISCONNECTED")),t.addToRecentlyDeleted(n,"session"),t.client.core.crypto.keychain.has(a.publicKey)&&(yield t.client.core.crypto.deleteKeyPair(a.publicKey)),t.client.core.crypto.keychain.has(n)&&(yield t.client.core.crypto.deleteSymKey(n)),i||t.client.core.expirer.del(n),t.client.core.storage.removeItem(Pu).catch(e=>t.client.logger.warn(e)),n===(null==(r=t.sessionRequestQueue.queue[0])?void 0:r.topic)&&(t.sessionRequestQueue.state="IDLE"),yield Promise.all(t.getPendingSessionRequests().filter(e=>e.topic===n).map(e=>t.deletePendingSessionRequest(e.id,ho("USER_DISCONNECTED")))),s&&t.client.events.emit("session_delete",{id:o,topic:n})});return function(t){return e.apply(this,arguments)}}()),Ku(this,"deleteProposal",function(){var e=(0,n.Z)(function*(e,r){if(r)try{const r=t.client.proposal.get(e);t.client.core.eventClient.getEvent({topic:r.pairingTopic})?.setError("proposal_expired")}catch{}yield Promise.all([t.client.proposal.delete(e,ho("USER_DISCONNECTED")),r?Promise.resolve():t.client.core.expirer.del(e)]),t.addToRecentlyDeleted(e,"proposal")});return function(t,r){return e.apply(this,arguments)}}()),Ku(this,"deletePendingSessionRequest",function(){var e=(0,n.Z)(function*(e,r,n=!1){yield Promise.all([t.client.pendingRequest.delete(e,r),n?Promise.resolve():t.client.core.expirer.del(e)]),t.addToRecentlyDeleted(e,"request"),t.sessionRequestQueue.queue=t.sessionRequestQueue.queue.filter(t=>t.id!==e),n&&(t.sessionRequestQueue.state="IDLE",t.client.events.emit("session_request_expire",{id:e}))});return function(t,r){return e.apply(this,arguments)}}()),Ku(this,"deletePendingAuthRequest",function(){var e=(0,n.Z)(function*(e,r,n=!1){yield Promise.all([t.client.auth.requests.delete(e,r),n?Promise.resolve():t.client.core.expirer.del(e)])});return function(t,r){return e.apply(this,arguments)}}()),Ku(this,"setExpiry",function(){var e=(0,n.Z)(function*(e,r){t.client.session.keys.includes(e)&&(t.client.core.expirer.set(e,r),yield t.client.session.update(e,{expiry:r}))});return function(t,r){return e.apply(this,arguments)}}()),Ku(this,"setProposal",function(){var e=(0,n.Z)(function*(e,r){t.client.core.expirer.set(e,we(Tu.wc_sessionPropose.req.ttl)),yield t.client.proposal.set(e,r)});return function(t,r){return e.apply(this,arguments)}}()),Ku(this,"setAuthRequest",function(){var e=(0,n.Z)(function*(e,r){const{request:n,pairingTopic:i,transportType:s=aa.relay}=r;t.client.core.expirer.set(e,n.expiryTimestamp),yield t.client.auth.requests.set(e,{authPayload:n.authPayload,requester:n.requester,expiryTimestamp:n.expiryTimestamp,id:e,pairingTopic:i,verifyContext:n.verifyContext,transportType:s})});return function(t,r){return e.apply(this,arguments)}}()),Ku(this,"setPendingSessionRequest",function(){var e=(0,n.Z)(function*(e){const{id:r,topic:n,params:i,verifyContext:s}=e,o=i.request.expiryTimestamp||we(Tu.wc_sessionRequest.req.ttl);t.client.core.expirer.set(r,o),yield t.client.pendingRequest.set(r,{id:r,topic:n,params:i,verifyContext:s})});return function(t){return e.apply(this,arguments)}}()),Ku(this,"sendRequest",function(){var e=(0,n.Z)(function*(e){const{topic:r,method:n,params:i,expiry:s,relayRpcId:o,clientRpcId:a,throwOnFailedPublish:c,appLink:l,tvf:u,publishOpts:f={}}=e,h=(0,Yo.formatJsonRpcRequest)(n,i,a);let d;const p=!!l;try{const e=p?ws:bs;d=yield t.client.core.crypto.encode(r,h,{encoding:e})}catch(m){throw yield t.cleanup(),t.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${r} failed`),m}let g;if(Uu.includes(n)){const e=Is(JSON.stringify(h)),r=Is(d);g=yield t.client.core.verify.register({id:r,decryptedId:e})}const y=Zu(Zu({},Tu[n].req),f);if(y.attestation=g,s&&(y.ttl=s),o&&(y.id=o),t.client.core.history.set(r,h),p){const e=Hs(l,r,d);yield global.Linking.openURL(e,t.client.name)}else y.tvf=Fu(Zu({},u),{correlationId:h.id}),c?(y.internal=Fu(Zu({},y.internal),{throwOnFailedPublish:!0}),yield t.client.core.relayer.publish(r,d,y)):t.client.core.relayer.publish(r,d,y).catch(e=>t.client.logger.error(e));return h.id});return function(t){return e.apply(this,arguments)}}()),Ku(this,"sendProposeSession",function(){var e=(0,n.Z)(function*(e){const{proposal:r,publishOpts:n}=e,i=(0,Yo.formatJsonRpcRequest)("wc_sessionPropose",r,r.id);t.client.core.history.set(r.pairingTopic,i);const s=yield t.client.core.crypto.encode(r.pairingTopic,i,{encoding:bs}),o=Is(JSON.stringify(i)),a=Is(s),c=yield t.client.core.verify.register({id:a,decryptedId:o});yield t.client.core.relayer.publishCustom({payload:{pairingTopic:r.pairingTopic,sessionProposal:s},opts:Fu(Zu({},n),{publishMethod:"wc_proposeSession",attestation:c})})});return function(t){return e.apply(this,arguments)}}()),Ku(this,"sendApproveSession",function(){var e=(0,n.Z)(function*(e){const{sessionTopic:r,pairingProposalResponse:n,proposal:i,sessionSettleRequest:s,publishOpts:o}=e,a=(0,Yo.formatJsonRpcResult)(i.id,n),c=yield t.client.core.crypto.encode(i.pairingTopic,a,{encoding:bs}),l=(0,Yo.formatJsonRpcRequest)("wc_sessionSettle",s,o?.id),u=yield t.client.core.crypto.encode(r,l,{encoding:bs});t.client.core.history.set(r,l),yield t.client.core.relayer.publishCustom({payload:{sessionTopic:r,pairingTopic:i.pairingTopic,sessionProposalResponse:c,sessionSettlementRequest:u},opts:Fu(Zu({},o),{publishMethod:"wc_approveSession"})})});return function(t){return e.apply(this,arguments)}}()),Ku(this,"sendResult",function(){var e=(0,n.Z)(function*(e){const{id:r,topic:n,result:i,throwOnFailedPublish:s,encodeOpts:o,appLink:a}=e,c=(0,Yo.formatJsonRpcResult)(r,i);let l;const u=a&&typeof(null==global?void 0:global.Linking)<"u";try{const e=u?ws:bs;l=yield t.client.core.crypto.encode(n,c,Fu(Zu({},o||{}),{encoding:e}))}catch(d){throw yield t.cleanup(),t.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${n} failed`),d}let f,h;try{f=yield t.client.core.history.get(n,r);const e=f.request;try{h=t.getTVFParams(r,e.params,i)}catch(p){t.client.logger.warn(`sendResult() -> getTVFParams() failed: ${p?.message}`)}}catch(d){throw t.client.logger.error(`sendResult() -> history.get(${n}, ${r}) failed`),d}if(u){const e=Hs(a,n,l);yield global.Linking.openURL(e,t.client.name)}else{const e=Tu[f.request.method].res;e.tvf=Fu(Zu({},h),{correlationId:r}),s?(e.internal=Fu(Zu({},e.internal),{throwOnFailedPublish:!0}),yield t.client.core.relayer.publish(n,l,e)):t.client.core.relayer.publish(n,l,e).catch(e=>t.client.logger.error(e))}yield t.client.core.history.resolve(c)});return function(t){return e.apply(this,arguments)}}()),Ku(this,"sendError",function(){var e=(0,n.Z)(function*(e){const{id:r,topic:n,error:i,encodeOpts:s,rpcOpts:o,appLink:a}=e,c=(0,Yo.formatJsonRpcError)(r,i);let l;const u=a&&typeof(null==global?void 0:global.Linking)<"u";try{const e=u?ws:bs;l=yield t.client.core.crypto.encode(n,c,Fu(Zu({},s||{}),{encoding:e}))}catch(h){throw yield t.cleanup(),t.client.logger.error(`sendError() -> core.crypto.encode() for topic ${n} failed`),h}let f;try{f=yield t.client.core.history.get(n,r)}catch(h){throw t.client.logger.error(`sendError() -> history.get(${n}, ${r}) failed`),h}if(u){const e=Hs(a,n,l);yield global.Linking.openURL(e,t.client.name)}else{const e=f.request.method;t.client.core.relayer.publish(n,l,o||Tu[e].res)}yield t.client.core.history.resolve(c)});return function(t){return e.apply(this,arguments)}}()),Ku(this,"cleanup",(0,n.Z)(function*(){const e=[],r=[];t.client.session.getAll().forEach(r=>{let n=!1;ve(r.expiry)&&(n=!0),t.client.core.crypto.keychain.has(r.topic)||(n=!0),n&&e.push(r.topic)}),t.client.proposal.getAll().forEach(e=>{ve(e.expiryTimestamp)&&r.push(e.id)}),yield Promise.all([...e.map(e=>t.deleteSession({topic:e})),...r.map(e=>t.deleteProposal(e))])})),Ku(this,"onProviderMessageEvent",function(){var e=(0,n.Z)(function*(e){!t.initialized||t.relayMessageCache.length>0?t.relayMessageCache.push(e):yield t.onRelayMessage(e)});return function(t){return e.apply(this,arguments)}}()),Ku(this,"onRelayEventRequest",function(){var e=(0,n.Z)(function*(e){t.requestQueue.queue.push(e),yield t.processRequestsQueue()});return function(t){return e.apply(this,arguments)}}()),Ku(this,"processRequestsQueue",(0,n.Z)(function*(){if("ACTIVE"!==t.requestQueue.state){for(t.client.logger.info(`Request queue starting with ${t.requestQueue.queue.length} requests`);t.requestQueue.queue.length>0;){t.requestQueue.state="ACTIVE";const r=t.requestQueue.queue.shift();if(r)try{yield t.processRequest(r)}catch(e){t.client.logger.warn(e)}}t.requestQueue.state="IDLE"}else t.client.logger.info("Request queue already active, skipping...")})),Ku(this,"processRequest",function(){var e=(0,n.Z)(function*(e){const{topic:r,payload:n,attestation:i,transportType:s,encryptedId:o}=e,a=n.method;if(!t.shouldIgnorePairingRequest({topic:r,requestMethod:a}))switch(a){case"wc_sessionPropose":return yield t.onSessionProposeRequest({topic:r,payload:n,attestation:i,encryptedId:o});case"wc_sessionSettle":return yield t.onSessionSettleRequest(r,n);case"wc_sessionUpdate":return yield t.onSessionUpdateRequest(r,n);case"wc_sessionExtend":return yield t.onSessionExtendRequest(r,n);case"wc_sessionPing":return yield t.onSessionPingRequest(r,n);case"wc_sessionDelete":return yield t.onSessionDeleteRequest(r,n);case"wc_sessionRequest":return yield t.onSessionRequest({topic:r,payload:n,attestation:i,encryptedId:o,transportType:s});case"wc_sessionEvent":return yield t.onSessionEventRequest(r,n);case"wc_sessionAuthenticate":return yield t.onSessionAuthenticateRequest({topic:r,payload:n,attestation:i,encryptedId:o,transportType:s});default:return t.client.logger.info(`Unsupported request method ${a}`)}});return function(t){return e.apply(this,arguments)}}()),Ku(this,"onRelayEventResponse",function(){var e=(0,n.Z)(function*(e){const{topic:r,payload:n,transportType:i}=e,s=(yield t.client.core.history.get(r,n.id)).request.method;switch(s){case"wc_sessionPropose":return t.onSessionProposeResponse(r,n,i);case"wc_sessionSettle":return t.onSessionSettleResponse(r,n);case"wc_sessionUpdate":return t.onSessionUpdateResponse(r,n);case"wc_sessionExtend":return t.onSessionExtendResponse(r,n);case"wc_sessionPing":return t.onSessionPingResponse(r,n);case"wc_sessionRequest":return t.onSessionRequestResponse(r,n);case"wc_sessionAuthenticate":return t.onSessionAuthenticateResponse(r,n);default:return t.client.logger.info(`Unsupported response method ${s}`)}});return function(t){return e.apply(this,arguments)}}()),Ku(this,"onRelayEventUnknownPayload",e=>{const{topic:t}=e,{message:r}=fo("MISSING_OR_INVALID",`Decoded payload on topic ${t} is not identifiable as a JSON-RPC request or a response.`);throw new Error(r)}),Ku(this,"shouldIgnorePairingRequest",e=>{const{topic:t,requestMethod:r}=e,n=this.expectedPairingMethodMap.get(t);return!(!n||n.includes(r)||!(n.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0))}),Ku(this,"onSessionProposeRequest",function(){var e=(0,n.Z)(function*(e){const{topic:r,payload:n,attestation:i,encryptedId:s}=e,{params:o,id:a}=n;try{const e=t.client.core.eventClient.getEvent({topic:r});0===t.client.events.listenerCount("session_proposal")&&(console.warn("No listener for session_proposal event"),e?.setError("proposal_listener_not_found")),t.isValidConnect(Zu({},n.params));const c=o.expiryTimestamp||we(Tu.wc_sessionPropose.req.ttl),l=Zu({id:a,pairingTopic:r,expiryTimestamp:c,attestation:i,encryptedId:s},o);yield t.setProposal(a,l);const u=yield t.getVerifyContext({attestationId:i,hash:Is(JSON.stringify(n)),encryptedId:s,metadata:l.proposer.metadata});e?.addTrace("emit_session_proposal"),t.client.events.emit("session_proposal",{id:a,params:l,verifyContext:u})}catch(c){yield t.sendError({id:a,topic:r,error:c,rpcOpts:Tu.wc_sessionPropose.autoReject}),t.client.logger.error(c)}});return function(t){return e.apply(this,arguments)}}()),Ku(this,"onSessionProposeResponse",function(){var e=(0,n.Z)(function*(e,r,n){const{id:i}=r;if((0,Yo.isJsonRpcResult)(r)){const{result:s}=r;t.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});const o=t.client.proposal.get(i);t.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:o});const a=o.proposer.publicKey;t.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:a});const c=s.responderPublicKey;t.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:c});const l=yield t.client.core.crypto.generateSharedKey(a,c);t.pendingSessions.set(i,{sessionTopic:l,pairingTopic:e,proposalId:i,publicKey:a});const u=yield t.client.core.relayer.subscribe(l,{transportType:n});t.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:u}),yield t.client.core.pairing.activate({topic:e})}else if((0,Yo.isJsonRpcError)(r)){yield t.deleteProposal(i);const e=Ee("session_connect",i);if(0===t.events.listenerCount(e))throw new Error(`emitting ${e} without any listeners, 954`);t.events.emit(e,{error:r.error})}});return function(t,r,n){return e.apply(this,arguments)}}()),Ku(this,"onSessionSettleRequest",function(){var e=(0,n.Z)(function*(e,r){const{id:n,params:i}=r;try{t.isValidSessionSettleRequest(i);const{relay:n,controller:s,expiry:o,namespaces:a,sessionProperties:c,scopedProperties:l,sessionConfig:u,proposalRequestsResponses:f}=r.params,h=[...t.pendingSessions.values()].find(t=>t.sessionTopic===e);if(!h)return t.client.logger.error(`Pending session not found for topic ${e}`);const d=t.client.proposal.get(h.proposalId),p=Fu(Zu(Zu(Zu({topic:e,relay:n,expiry:o,namespaces:a,acknowledged:!0,pairingTopic:h.pairingTopic,requiredNamespaces:d.requiredNamespaces,optionalNamespaces:d.optionalNamespaces,controller:s.publicKey,self:{publicKey:h.publicKey,metadata:t.client.metadata},peer:{publicKey:s.publicKey,metadata:s.metadata}},c&&{sessionProperties:c}),l&&{scopedProperties:l}),u&&{sessionConfig:u}),{transportType:aa.relay,authentication:f?.authentication,walletPayResult:f?.walletPay});yield t.client.session.set(p.topic,p),yield t.setExpiry(p.topic,p.expiry),yield t.client.core.pairing.updateMetadata({topic:h.pairingTopic,metadata:p.peer.metadata}),t.pendingSessions.delete(h.proposalId),t.deleteProposal(h.proposalId,!1),t.cleanupDuplicatePairings(p),yield t.sendResult({id:r.id,topic:e,throwOnFailedPublish:!0,result:!0}),t.client.events.emit("session_connect",{session:p}),t.events.emit(Ee("session_connect",h.proposalId),{session:p})}catch(s){yield t.sendError({id:n,topic:e,error:s}),t.client.logger.error(s)}});return function(t,r){return e.apply(this,arguments)}}()),Ku(this,"onSessionSettleResponse",function(){var e=(0,n.Z)(function*(e,r){const{id:n}=r;(0,Yo.isJsonRpcResult)(r)?(yield t.client.session.update(e,{acknowledged:!0}),t.events.emit(Ee("session_approve",n),{})):(0,Yo.isJsonRpcError)(r)&&(yield t.client.session.delete(e,ho("USER_DISCONNECTED")),t.events.emit(Ee("session_approve",n),{error:r.error}))});return function(t,r){return e.apply(this,arguments)}}()),Ku(this,"onSessionUpdateRequest",function(){var e=(0,n.Z)(function*(e,r){const{params:n,id:i}=r;try{const r=`${e}_session_update`,o=Bo.get(r);if(o&&t.isRequestOutOfSync(o,i))return t.client.logger.warn(`Discarding out of sync request - ${i}`),void t.sendError({id:i,topic:e,error:ho("INVALID_UPDATE_REQUEST")});t.isValidUpdate(Zu({topic:e},n));try{Bo.set(r,i),yield t.client.session.update(e,{namespaces:n.namespaces}),yield t.sendResult({id:i,topic:e,result:!0})}catch(s){throw Bo.delete(r),s}t.client.events.emit("session_update",{id:i,topic:e,params:n})}catch(o){yield t.sendError({id:i,topic:e,error:o}),t.client.logger.error(o)}});return function(t,r){return e.apply(this,arguments)}}()),Ku(this,"isRequestOutOfSync",(e,t)=>t.toString().slice(0,-3)<e.toString().slice(0,-3)),Ku(this,"onSessionUpdateResponse",(e,t)=>{const{id:r}=t,n=Ee("session_update",r);if(0===this.events.listenerCount(n))throw new Error(`emitting ${n} without any listeners`);(0,Yo.isJsonRpcResult)(t)?this.events.emit(Ee("session_update",r),{}):(0,Yo.isJsonRpcError)(t)&&this.events.emit(Ee("session_update",r),{error:t.error})}),Ku(this,"onSessionExtendRequest",function(){var e=(0,n.Z)(function*(e,r){const{id:n}=r;try{t.isValidExtend({topic:e}),yield t.setExpiry(e,we(Ru)),yield t.sendResult({id:n,topic:e,result:!0}),t.client.events.emit("session_extend",{id:n,topic:e})}catch(i){yield t.sendError({id:n,topic:e,error:i}),t.client.logger.error(i)}});return function(t,r){return e.apply(this,arguments)}}()),Ku(this,"onSessionExtendResponse",(e,t)=>{const{id:r}=t,n=Ee("session_extend",r);if(0===this.events.listenerCount(n))throw new Error(`emitting ${n} without any listeners`);(0,Yo.isJsonRpcResult)(t)?this.events.emit(Ee("session_extend",r),{}):(0,Yo.isJsonRpcError)(t)&&this.events.emit(Ee("session_extend",r),{error:t.error})}),Ku(this,"onSessionPingRequest",function(){var e=(0,n.Z)(function*(e,r){const{id:n}=r;try{t.isValidPing({topic:e}),yield t.sendResult({id:n,topic:e,result:!0,throwOnFailedPublish:!0}),t.client.events.emit("session_ping",{id:n,topic:e})}catch(i){yield t.sendError({id:n,topic:e,error:i}),t.client.logger.error(i)}});return function(t,r){return e.apply(this,arguments)}}()),Ku(this,"onSessionPingResponse",(e,t)=>{const{id:r}=t,n=Ee("session_ping",r);setTimeout(()=>{if(0===this.events.listenerCount(n))throw new Error(`emitting ${n} without any listeners 2176`);(0,Yo.isJsonRpcResult)(t)?this.events.emit(Ee("session_ping",r),{}):(0,Yo.isJsonRpcError)(t)&&this.events.emit(Ee("session_ping",r),{error:t.error})},500)}),Ku(this,"onSessionDeleteRequest",function(){var e=(0,n.Z)(function*(e,r){const{id:n}=r;try{yield t.isValidDisconnect({topic:e,reason:r.params}),t.cleanupPendingSentRequestsForTopic({topic:e,error:ho("USER_DISCONNECTED")}),yield t.deleteSession({topic:e,id:n})}catch(i){t.client.logger.error(i)}});return function(t,r){return e.apply(this,arguments)}}()),Ku(this,"onSessionRequest",function(){var e=(0,n.Z)(function*(e){var r,n,i;const{topic:s,payload:o,attestation:a,encryptedId:c,transportType:l}=e,{id:u,params:f}=o;try{yield t.isValidRequest(Zu({topic:s},f));const e=t.client.session.get(s),o={id:u,topic:s,params:f,verifyContext:yield t.getVerifyContext({attestationId:a,hash:Is(JSON.stringify((0,Yo.formatJsonRpcRequest)("wc_sessionRequest",f,u))),encryptedId:c,metadata:e.peer.metadata,transportType:l})};yield t.setPendingSessionRequest(o),l===aa.link_mode&&null!=(r=e.peer.metadata.redirect)&&r.universal&&t.client.core.addLinkModeSupportedApp(null==(n=e.peer.metadata.redirect)?void 0:n.universal),null!=(i=t.client.signConfig)&&i.disableRequestQueue?t.emitSessionRequest(o):(t.addSessionRequestToSessionRequestQueue(o),t.processSessionRequestQueue())}catch(h){yield t.sendError({id:u,topic:s,error:h}),t.client.logger.error(h)}});return function(t){return e.apply(this,arguments)}}()),Ku(this,"onSessionRequestResponse",(e,t)=>{const{id:r}=t,n=Ee("session_request",r);if(0===this.events.listenerCount(n))throw new Error(`emitting ${n} without any listeners`);(0,Yo.isJsonRpcResult)(t)?this.events.emit(Ee("session_request",r),{result:t.result}):(0,Yo.isJsonRpcError)(t)&&this.events.emit(Ee("session_request",r),{error:t.error})}),Ku(this,"onSessionEventRequest",function(){var e=(0,n.Z)(function*(e,r){const{id:n,params:i}=r;try{const r=`${e}_session_event_${i.event.name}`,s=Bo.get(r);if(s&&t.isRequestOutOfSync(s,n))return void t.client.logger.info(`Discarding out of sync request - ${n}`);t.isValidEmit(Zu({topic:e},i)),t.client.events.emit("session_event",{id:n,topic:e,params:i}),Bo.set(r,n)}catch(s){yield t.sendError({id:n,topic:e,error:s}),t.client.logger.error(s)}});return function(t,r){return e.apply(this,arguments)}}()),Ku(this,"onSessionAuthenticateResponse",(e,t)=>{const{id:r}=t;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:e,payload:t}),(0,Yo.isJsonRpcResult)(t)?this.events.emit(Ee("session_request",r),{result:t.result}):(0,Yo.isJsonRpcError)(t)&&this.events.emit(Ee("session_request",r),{error:t.error})}),Ku(this,"onSessionAuthenticateRequest",function(){var e=(0,n.Z)(function*(e){var r;const{topic:n,payload:i,attestation:s,encryptedId:o,transportType:a}=e;try{const{requester:e,authPayload:c,expiryTimestamp:l}=i.params,u=yield t.getVerifyContext({attestationId:s,hash:Is(JSON.stringify(i)),encryptedId:o,metadata:e.metadata,transportType:a}),f={requester:e,pairingTopic:n,id:i.id,authPayload:c,verifyContext:u,expiryTimestamp:l};yield t.setAuthRequest(i.id,{request:f,pairingTopic:n,transportType:a}),a===aa.link_mode&&null!=(r=e.metadata.redirect)&&r.universal&&t.client.core.addLinkModeSupportedApp(e.metadata.redirect.universal),t.client.events.emit("session_authenticate",{topic:n,params:i.params,id:i.id,verifyContext:u})}catch(c){t.client.logger.error(c);const e=i.params.requester.publicKey,r=yield t.client.core.crypto.generateKeyPair(),s=t.getAppLinkIfEnabled(i.params.requester.metadata,a),o={type:1,receiverPublicKey:e,senderPublicKey:r};yield t.sendError({id:i.id,topic:n,error:c,encodeOpts:o,rpcOpts:Tu.wc_sessionAuthenticate.autoReject,appLink:s})}});return function(t){return e.apply(this,arguments)}}()),Ku(this,"addSessionRequestToSessionRequestQueue",e=>{this.sessionRequestQueue.queue.push(e)}),Ku(this,"cleanupAfterResponse",e=>{this.deletePendingSessionRequest(e.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state="IDLE",this.processSessionRequestQueue()},(0,o.toMiliseconds)(this.requestQueueDelay))}),Ku(this,"cleanupPendingSentRequestsForTopic",({topic:e,error:t})=>{const r=this.client.core.history.pending;r.length>0&&r.filter(t=>t.topic===e&&"wc_sessionRequest"===t.request.method).forEach(e=>{this.events.emit(Ee("session_request",e.request.id),{error:t})})}),Ku(this,"processSessionRequestQueue",()=>{if("ACTIVE"===this.sessionRequestQueue.state)return void this.client.logger.info("session request queue is already active.");const e=this.sessionRequestQueue.queue[0];if(e)try{this.emitSessionRequest(e)}catch(t){this.client.logger.error(t)}else this.client.logger.info("session request queue is empty.")}),Ku(this,"emitSessionRequest",e=>{this.emittedSessionRequests.has(e.id)?this.client.logger.warn({id:e.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${e.id}`):(this.sessionRequestQueue.state="ACTIVE",this.emittedSessionRequests.add(e.id),this.client.events.emit("session_request",e))}),Ku(this,"onPairingCreated",e=>{if(e.methods&&this.expectedPairingMethodMap.set(e.topic,e.methods),e.active)return;const t=this.client.proposal.getAll().find(t=>t.pairingTopic===e.topic);t&&this.onSessionProposeRequest({topic:e.topic,payload:(0,Yo.formatJsonRpcRequest)("wc_sessionPropose",Fu(Zu({},t),{requiredNamespaces:t.requiredNamespaces,optionalNamespaces:t.optionalNamespaces,relays:t.relays,proposer:t.proposer,sessionProperties:t.sessionProperties,scopedProperties:t.scopedProperties}),t.id),attestation:t.attestation,encryptedId:t.encryptedId})}),Ku(this,"isValidConnect",function(){var e=(0,n.Z)(function*(e){if(!So(e)){const{message:t}=fo("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(e)}`);throw new Error(t)}const{pairingTopic:r,requiredNamespaces:n,optionalNamespaces:i,sessionProperties:s,scopedProperties:o,relays:a}=e;if(yo(r)||(yield t.isValidPairingTopic(r)),!function(e,t){let r=!1;return e?e&&po(e)&&e.length&&e.forEach(e=>{r=Io(e)}):r=!0,r}(a)){const{message:e}=fo("MISSING_OR_INVALID",`connect() relays: ${a}`);throw new Error(e)}if(n&&!yo(n)&&0!==go(n)){const e="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(t.client.logger.level)?console.warn(e):t.client.logger.warn(e),t.validateNamespaces(n,"requiredNamespaces")}if(i&&!yo(i)&&0!==go(i)&&t.validateNamespaces(i,"optionalNamespaces"),s&&!yo(s)&&t.validateSessionProps(s,"sessionProperties"),o&&!yo(o)){t.validateSessionProps(o,"scopedProperties");const e=Object.keys(n||{}).concat(Object.keys(i||{}));if(!Object.keys(o).every(t=>e.includes(t.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(o)}, required/optional namespaces: ${JSON.stringify(e)}`)}});return function(t){return e.apply(this,arguments)}}()),Ku(this,"validateNamespaces",(e,t)=>{const r=function(e,t,r){let n=null;if(e&&go(e)){const i=Eo(e,t);i&&(n=i);const s=function(e,t,r){let n=null;return Object.entries(e).forEach(([e,i])=>{if(n)return;const s=function(e,t,r){let n=null;return po(t)&&t.length?t.forEach(e=>{n||wo(e)||(n=ho("UNSUPPORTED_CHAINS",`${r}, chain ${e} should be a string and conform to "namespace:chainId" format`))}):wo(e)||(n=ho("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}(e,W(e,i),`${t} ${r}`);s&&(n=s)}),n}(e,t,r);s&&(n=s)}else n=fo("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return n}(e,"connect()",t);if(r)throw new Error(r.message)}),Ku(this,"isValidApprove",function(){var e=(0,n.Z)(function*(e){if(!So(e))throw new Error(fo("MISSING_OR_INVALID",`approve() params: ${e}`).message);const{id:r,namespaces:n,relayProtocol:i,sessionProperties:s,scopedProperties:o}=e;t.checkRecentlyDeleted(r),yield t.isValidProposalId(r);const a=t.client.proposal.get(r),c=xo(n,"approve()");if(c)throw new Error(c.message);const l=_o(a.requiredNamespaces,n,"approve()");if(l)throw new Error(l.message);if(!mo(i,!0)){const{message:e}=fo("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(e)}if(s&&!yo(s)&&t.validateSessionProps(s,"sessionProperties"),o&&!yo(o)){t.validateSessionProps(o,"scopedProperties");const e=new Set(Object.keys(n));if(!Object.keys(o).every(t=>e.has(t.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(o)}, approved namespaces: ${Array.from(e).join(", ")}`)}});return function(t){return e.apply(this,arguments)}}()),Ku(this,"isValidReject",function(){var e=(0,n.Z)(function*(e){if(!So(e)){const{message:t}=fo("MISSING_OR_INVALID",`reject() params: ${e}`);throw new Error(t)}const{id:r,reason:n}=e;if(t.checkRecentlyDeleted(r),yield t.isValidProposalId(r),!function(e){return!!(e&&"object"==typeof e&&e.code&&bo(e.code,!1)&&e.message&&mo(e.message,!1))}(n)){const{message:e}=fo("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(e)}});return function(t){return e.apply(this,arguments)}}()),Ku(this,"isValidSessionSettleRequest",e=>{if(!So(e)){const{message:t}=fo("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${e}`);throw new Error(t)}const{relay:t,controller:r,namespaces:n,expiry:i}=e;if(!Io(t)){const{message:e}=fo("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(e)}const s=function(e,t){let r=null;return mo(e?.publicKey,!1)||(r=fo("MISSING_OR_INVALID","onSessionSettleRequest() controller public key should be a string")),r}(r);if(s)throw new Error(s.message);const o=xo(n,"onSessionSettleRequest()");if(o)throw new Error(o.message);if(ve(i)){const{message:e}=fo("EXPIRED","onSessionSettleRequest()");throw new Error(e)}}),Ku(this,"isValidUpdate",function(){var e=(0,n.Z)(function*(e){if(!So(e)){const{message:t}=fo("MISSING_OR_INVALID",`update() params: ${e}`);throw new Error(t)}const{topic:r,namespaces:n}=e;t.checkRecentlyDeleted(r),yield t.isValidSessionTopic(r);const i=t.client.session.get(r),s=xo(n,"update()");if(s)throw new Error(s.message);const o=_o(i.requiredNamespaces,n,"update()");if(o)throw new Error(o.message)});return function(t){return e.apply(this,arguments)}}()),Ku(this,"isValidExtend",function(){var e=(0,n.Z)(function*(e){if(!So(e)){const{message:t}=fo("MISSING_OR_INVALID",`extend() params: ${e}`);throw new Error(t)}const{topic:r}=e;t.checkRecentlyDeleted(r),yield t.isValidSessionTopic(r)});return function(t){return e.apply(this,arguments)}}()),Ku(this,"isValidRequest",function(){var e=(0,n.Z)(function*(e){if(!So(e)){const{message:t}=fo("MISSING_OR_INVALID",`request() params: ${e}`);throw new Error(t)}const{topic:r,request:n,chainId:i,expiry:s}=e;t.checkRecentlyDeleted(r),yield t.isValidSessionTopic(r);const{namespaces:o}=t.client.session.get(r);if(!Oo(o,i)){const{message:e}=fo("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(e)}if(!function(e){return!(yo(e)||!mo(e.method,!1))}(n)){const{message:e}=fo("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(e)}if(!function(e,t,r){return!!mo(r,!1)&&function(e,t){const r=[];return Object.values(e).forEach(e=>{no(e.accounts).includes(t)&&r.push(...e.methods)}),r}(e,t).includes(r)}(o,i,n.method)){const{message:e}=fo("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(e)}t.validateRequestExpiry(s)});return function(t){return e.apply(this,arguments)}}()),Ku(this,"isValidRespond",function(){var e=(0,n.Z)(function*(e){var r;if(!So(e)){const{message:t}=fo("MISSING_OR_INVALID",`respond() params: ${e}`);throw new Error(t)}const{topic:n,response:i}=e;try{yield t.isValidSessionTopic(n)}catch(o){throw null!=(r=e?.response)&&r.id&&t.cleanupAfterResponse(e),o}if(!function(e){return!(yo(e)||yo(e.result)&&yo(e.error)||!bo(e.id,!1)||!mo(e.jsonrpc,!1))}(i)){const{message:e}=fo("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(e)}const s=t.client.pendingRequest.get(i.id);if(s.topic!==n){const{message:e}=fo("MISMATCHED_TOPIC",`Request response topic mismatch. reqId: ${i.id}, expected topic: ${s.topic}, received topic: ${n}`);throw new Error(e)}});return function(t){return e.apply(this,arguments)}}()),Ku(this,"isValidPing",function(){var e=(0,n.Z)(function*(e){if(!So(e)){const{message:t}=fo("MISSING_OR_INVALID",`ping() params: ${e}`);throw new Error(t)}const{topic:r}=e;yield t.isValidSessionOrPairingTopic(r)});return function(t){return e.apply(this,arguments)}}()),Ku(this,"isValidEmit",function(){var e=(0,n.Z)(function*(e){if(!So(e)){const{message:t}=fo("MISSING_OR_INVALID",`emit() params: ${e}`);throw new Error(t)}const{topic:r,event:n,chainId:i}=e;yield t.isValidSessionTopic(r);const{namespaces:s}=t.client.session.get(r);if(!Oo(s,i)){const{message:e}=fo("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(e)}if(!function(e){return!(yo(e)||!mo(e.name,!1))}(n)){const{message:e}=fo("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(e)}if(!function(e,t,r){return!!mo(r,!1)&&function(e,t){const r=[];return Object.values(e).forEach(e=>{no(e.accounts).includes(t)&&r.push(...e.events)}),r}(e,t).includes(r)}(s,i,n.name)){const{message:e}=fo("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(e)}});return function(t){return e.apply(this,arguments)}}()),Ku(this,"isValidDisconnect",function(){var e=(0,n.Z)(function*(e){if(!So(e)){const{message:t}=fo("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw new Error(t)}const{topic:r}=e;yield t.isValidSessionOrPairingTopic(r)});return function(t){return e.apply(this,arguments)}}()),Ku(this,"isValidAuthenticate",e=>{const{chains:t,uri:r,domain:n,nonce:i}=e;if(!Array.isArray(t)||0===t.length)throw new Error("chains is required and must be a non-empty array");if(!mo(r,!1))throw new Error("uri is required parameter");if(!mo(n,!1))throw new Error("domain is required parameter");if(!mo(i,!1))throw new Error("nonce is required parameter");if([...new Set(t.map(e=>V(e).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:s}=V(t[0]);if("eip155"!==s)throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),Ku(this,"getVerifyContext",function(){var e=(0,n.Z)(function*(e){const{attestationId:r,hash:n,encryptedId:i,metadata:s,transportType:o}=e,a={verified:{verifyUrl:s.verifyUrl||pa,validation:"UNKNOWN",origin:s.url||""}};try{if(o===aa.link_mode){const e=t.getAppLinkIfEnabled(s,o);return a.verified.validation=e&&new URL(e).origin===new URL(s.url).origin?"VALID":"INVALID",a}const e=yield t.client.core.verify.resolve({attestationId:r,hash:n,encryptedId:i,verifyUrl:s.verifyUrl});e&&(a.verified.origin=e.origin,a.verified.isScam=e.isScam,a.verified.validation=e.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(c){t.client.logger.warn(c)}return t.client.logger.debug(`Verify context: ${JSON.stringify(a)}`),a});return function(t){return e.apply(this,arguments)}}()),Ku(this,"validateSessionProps",(e,t)=>{Object.values(e).forEach((r,n)=>{if(null==r){const{message:i}=fo("MISSING_OR_INVALID",`${t} must contain an existing value for each key. Received: ${r} for key ${Object.keys(e)[n]}`);throw new Error(i)}})}),Ku(this,"getPendingAuthRequest",e=>{const t=this.client.auth.requests.get(e);return"object"==typeof t?t:void 0}),Ku(this,"addToRecentlyDeleted",(e,t)=>{if(this.recentlyDeletedMap.set(e,t),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let e=0;const t=this.recentlyDeletedLimit/2;for(const r of this.recentlyDeletedMap.keys()){if(e++>=t)break;this.recentlyDeletedMap.delete(r)}}}),Ku(this,"checkRecentlyDeleted",e=>{const t=this.recentlyDeletedMap.get(e);if(t){const{message:r}=fo("MISSING_OR_INVALID",`Record was recently deleted - ${t}: ${e}`);throw new Error(r)}}),Ku(this,"isLinkModeEnabled",(e,t)=>{var r,n,i,s,o,a,c,l,u;return!(!e||t!==aa.link_mode)&&!0===(null==(n=null==(r=this.client.metadata)?void 0:r.redirect)?void 0:n.linkMode)&&void 0!==(null==(s=null==(i=this.client.metadata)?void 0:i.redirect)?void 0:s.universal)&&""!==(null==(a=null==(o=this.client.metadata)?void 0:o.redirect)?void 0:a.universal)&&void 0!==(null==(c=e?.redirect)?void 0:c.universal)&&""!==(null==(l=e?.redirect)?void 0:l.universal)&&!0===(null==(u=e?.redirect)?void 0:u.linkMode)&&this.client.core.linkModeSupportedApps.includes(e.redirect.universal)&&typeof(null==global?void 0:global.Linking)<"u"}),Ku(this,"getAppLinkIfEnabled",(e,t)=>{var r;return this.isLinkModeEnabled(e,t)?null==(r=e?.redirect)?void 0:r.universal:void 0}),Ku(this,"handleLinkModeMessage",({url:e})=>{if(!e||!e.includes("wc_ev")||!e.includes("topic"))return;const t=Pe(e,"topic")||"",r=decodeURIComponent(Pe(e,"wc_ev")||""),n=this.client.session.keys.includes(t);n&&this.client.session.update(t,{transportType:aa.link_mode}),this.client.core.dispatchEnvelope({topic:t,message:r,sessionExists:n})}),Ku(this,"registerLinkModeListeners",(0,n.Z)(function*(){var e;if(Re()||oe()&&null!=(e=t.client.metadata.redirect)&&e.linkMode){const e=null==global?void 0:global.Linking;if(typeof e<"u"){e.addEventListener("url",t.handleLinkModeMessage,t.client.name);const r=yield e.getInitialURL();r&&setTimeout(()=>{t.handleLinkModeMessage({url:r})},50)}}})),Ku(this,"getTVFApproveParams",e=>{try{const t=io(e.namespaces),r=function(e){const t=[];return Object.values(e).forEach(e=>{t.push(...e.methods)}),[...new Set(t)]}(e.namespaces),n=function(e){const t=[];return Object.values(e).forEach(e=>{t.push(...e.events)}),[...new Set(t)]}(e.namespaces);return{approvedChains:t,approvedMethods:r,approvedEvents:n,sessionProperties:e.sessionProperties,scopedProperties:e.scopedProperties}}catch(t){return this.client.logger.warn(t,"Error getting TVF approve params"),{}}}),Ku(this,"getTVFParams",(e,t,r)=>{var n,i,s;if(null==(n=t.request)||!n.method)return{};const o={correlationId:e,rpcMethods:[t.request.method],chainId:t.chainId};try{const e=this.extractTxHashesFromResult(t.request,r);o.txHashes=e,o.contractAddresses=this.isValidContractData(t.request.params)?[null==(s=null==(i=t.request.params)?void 0:i[0])?void 0:s.to]:[]}catch(a){this.client.logger.warn(a,"Error getting TVF params")}return o}),Ku(this,"isValidContractData",e=>{var t;if(!e)return!1;try{const r=e?.data||(null==(t=e?.[0])?void 0:t.data);if(!r.startsWith("0x"))return!1;const n=r.slice(2);return!!/^[0-9a-fA-F]*$/.test(n)&&n.length%2==0}catch{}return!1}),Ku(this,"extractTxHashesFromResult",(e,t)=>{var r;try{if(!t)return[];const n=e.method,i=Cu[n];if("sui_signTransaction"===n)return[Sr(t.transactionBytes)];if("near_signTransaction"===n)return[Or(t)];if("near_signTransactions"===n)return t.map(e=>Or(e));if("xrpl_signTransactionFor"===n||"xrpl_signTransaction"===n)return[null==(r=t.tx_json)?void 0:r.hash];if("polkadot_signTransaction"===n)return[Uo({transaction:e.params.transactionPayload,signature:t.signature})];if("algo_signTxn"===n)return po(t)?t.map(e=>_r(e)):[_r(t)];if("cosmos_signDirect"===n)return[Ar(t)];if("wallet_sendCalls"===n)return function(e){var r,n;const i=[];try{if("string"==typeof e)return i.push(e),i;if("object"!=typeof e)return i;null!=e&&e.id&&i.push(e.id);const t=null==(n=null==(r=e?.capabilities)?void 0:r.caip345)?void 0:n.transactionHashes;t&&i.push(...t)}catch(t){console.warn("getWalletSendCallsHashes failed: ",t)}return i}(t);if("string"==typeof t)return[t];const s=t[i.key];if(po(s))return"solana_signAllTransactions"===n?s.map(e=>function(e){const t=atob(e),r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);const n=r[0];if(0===n)throw new Error("No signatures found");if(r.length<1+64*n)throw new Error("Transaction data too short for claimed signature count");if(r.length<100)throw new Error("Transaction too short");const i=Buffer.from(e,"base64").slice(1,65);return M.Jq.encode(i)}(e)):s;if("string"==typeof s)return[s]}catch(n){this.client.logger.warn(n,"Error extracting tx hashes from result")}return[]})}processPendingMessageEvents(){var e=this;return(0,n.Z)(function*(){try{const t=e.client.core.relayer.messages.getWithoutAck(e.client.session.keys);for(const[r,n]of Object.entries(t))for(const t of n)try{yield e.onProviderMessageEvent({topic:r,message:t,publishedAt:Date.now()})}catch{e.client.logger.warn(`Error processing pending message event for topic: ${r}, message: ${t}`)}}catch(t){e.client.logger.warn(t,"processPendingMessageEvents failed")}})()}isInitialized(){if(!this.initialized){const{message:e}=fo("NOT_INITIALIZED",this.name);throw new Error(e)}}confirmOnlineStateOrThrow(){var e=this;return(0,n.Z)(function*(){yield e.client.core.relayer.confirmOnlineStateOrThrow()})()}registerRelayerEvents(){this.client.core.relayer.on("relayer_message",e=>{this.onProviderMessageEvent(e)})}onRelayMessage(e){var t=this;return(0,n.Z)(function*(){const{topic:r,message:n,attestation:i,transportType:s}=e,{publicKey:o}=t.client.auth.authKeys.keys.includes(ku)?t.client.auth.authKeys.get(ku):{responseTopic:void 0,publicKey:void 0};try{const e=yield t.client.core.crypto.decode(r,n,{receiverPublicKey:o,encoding:s===aa.link_mode?ws:bs});(0,Yo.isJsonRpcRequest)(e)?(t.client.core.history.set(r,e),yield t.onRelayEventRequest({topic:r,payload:e,attestation:i,transportType:s,encryptedId:Is(n)})):(0,Yo.isJsonRpcResponse)(e)?(yield t.client.core.history.resolve(e),yield t.onRelayEventResponse({topic:r,payload:e,transportType:s}),t.client.core.history.delete(r,e.id)):(t.client.logger.error(`onRelayMessage() -> unknown payload: ${JSON.stringify(e)}`),yield t.onRelayEventUnknownPayload({topic:r,payload:e,transportType:s})),yield t.client.core.relayer.messages.ack(r,n)}catch(a){t.client.logger.error(`onRelayMessage() -> failed to process an inbound message: ${n}`),t.client.logger.error(a)}})()}registerExpirerEvents(){var e=this;this.client.core.expirer.on(ha,function(){var t=(0,n.Z)(function*(t){const{topic:r,id:n}=be(t.target);return n&&e.client.pendingRequest.keys.includes(n)?yield e.deletePendingSessionRequest(n,fo("EXPIRED"),!0):n&&e.client.auth.requests.keys.includes(n)?yield e.deletePendingAuthRequest(n,fo("EXPIRED"),!0):void(r?e.client.session.keys.includes(r)&&(yield e.deleteSession({topic:r,expirerHasDeleted:!0}),e.client.events.emit("session_expire",{topic:r})):n&&(yield e.deleteProposal(n,!0),e.client.events.emit("proposal_expire",{id:n})))});return function(e){return t.apply(this,arguments)}}())}registerPairingEvents(){this.client.core.pairing.events.on("pairing_create",e=>this.onPairingCreated(e)),this.client.core.pairing.events.on("pairing_delete",e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!mo(e,!1)){const{message:t}=fo("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=fo("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(ve(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=fo("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}isValidSessionTopic(e){var t=this;return(0,n.Z)(function*(){if(!mo(e,!1)){const{message:t}=fo("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(t.checkRecentlyDeleted(e),!t.client.session.keys.includes(e)){const{message:t}=fo("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(ve(t.client.session.get(e).expiry)){yield t.deleteSession({topic:e});const{message:r}=fo("EXPIRED",`session topic: ${e}`);throw new Error(r)}if(!t.client.core.crypto.keychain.has(e)){const{message:r}=fo("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw yield t.deleteSession({topic:e}),new Error(r)}})()}isValidSessionOrPairingTopic(e){var t=this;return(0,n.Z)(function*(){if(t.checkRecentlyDeleted(e),t.client.session.keys.includes(e))yield t.isValidSessionTopic(e);else{if(!t.client.core.pairing.pairings.keys.includes(e)){if(mo(e,!1)){const{message:t}=fo("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}{const{message:t}=fo("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}t.isValidPairingTopic(e)}})()}isValidProposalId(e){var t=this;return(0,n.Z)(function*(){if(!function(e){return"number"==typeof e}(e)){const{message:t}=fo("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!t.client.proposal.keys.includes(e)){const{message:t}=fo("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(ve(t.client.proposal.get(e).expiryTimestamp)){yield t.deleteProposal(e);const{message:r}=fo("EXPIRED",`proposal id: ${e}`);throw new Error(r)}})()}validateRequestExpiry(e){if(e&&!function(e,t){return bo(e,!1)&&e<=t.max&&e>=t.min}(e,Bu)){const{message:t}=fo("MISSING_OR_INVALID",`request() expiry: ${e}. Expiry must be a number (in seconds) between ${Bu.min} and ${Bu.max}`);throw new Error(t)}}}class Hu extends Hl{constructor(e,t){super(e,t,"proposal",_u),this.core=e,this.logger=t}}class Wu extends Hl{constructor(e,t){super(e,t,"session",_u),this.core=e,this.logger=t}}class Gu extends Hl{constructor(e,t){super(e,t,"request",_u,e=>e.id),this.core=e,this.logger=t}}class Ju extends Hl{constructor(e,t){super(e,t,"authKeys",Nu,()=>ku),this.core=e,this.logger=t}}class Yu extends Hl{constructor(e,t){super(e,t,"pairingTopics",Nu),this.core=e,this.logger=t}}class Qu extends Hl{constructor(e,t){super(e,t,"requests",Nu,e=>e.id),this.core=e,this.logger=t}}var Xu=Object.defineProperty,ef=(e,t,r)=>((e,t,r)=>t in e?Xu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class tf{constructor(e,t){this.core=e,this.logger=t,ef(this,"authKeys"),ef(this,"pairingTopics"),ef(this,"requests"),this.authKeys=new Ju(this.core,this.logger),this.pairingTopics=new Yu(this.core,this.logger),this.requests=new Qu(this.core,this.logger)}init(){var e=this;return(0,n.Z)(function*(){yield e.authKeys.init(),yield e.pairingTopics.init(),yield e.requests.init()})()}}var rf=Object.defineProperty,nf=(e,t,r)=>((e,t,r)=>t in e?rf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class sf extends class{constructor(e){this.opts=e,Wo(this,"protocol","wc"),Wo(this,"version",2)}}{constructor(e){var t;super(e),t=this,nf(this,"protocol","wc"),nf(this,"version",2),nf(this,"name","client"),nf(this,"metadata"),nf(this,"core"),nf(this,"logger"),nf(this,"events",new i.EventEmitter),nf(this,"engine"),nf(this,"session"),nf(this,"proposal"),nf(this,"pendingRequest"),nf(this,"auth"),nf(this,"signConfig"),nf(this,"on",(e,t)=>this.events.on(e,t)),nf(this,"once",(e,t)=>this.events.once(e,t)),nf(this,"off",(e,t)=>this.events.off(e,t)),nf(this,"removeListener",(e,t)=>this.events.removeListener(e,t)),nf(this,"removeAllListeners",e=>this.events.removeAllListeners(e)),nf(this,"connect",function(){var e=(0,n.Z)(function*(e){try{return yield t.engine.connect(e)}catch(r){throw t.logger.error(r.message),r}});return function(t){return e.apply(this,arguments)}}()),nf(this,"pair",function(){var e=(0,n.Z)(function*(e){try{return yield t.engine.pair(e)}catch(r){throw t.logger.error(r.message),r}});return function(t){return e.apply(this,arguments)}}()),nf(this,"approve",function(){var e=(0,n.Z)(function*(e){try{return yield t.engine.approve(e)}catch(r){throw t.logger.error(r.message),r}});return function(t){return e.apply(this,arguments)}}()),nf(this,"reject",function(){var e=(0,n.Z)(function*(e){try{return yield t.engine.reject(e)}catch(r){throw t.logger.error(r.message),r}});return function(t){return e.apply(this,arguments)}}()),nf(this,"update",function(){var e=(0,n.Z)(function*(e){try{return yield t.engine.update(e)}catch(r){throw t.logger.error(r.message),r}});return function(t){return e.apply(this,arguments)}}()),nf(this,"extend",function(){var e=(0,n.Z)(function*(e){try{return yield t.engine.extend(e)}catch(r){throw t.logger.error(r.message),r}});return function(t){return e.apply(this,arguments)}}()),nf(this,"request",function(){var e=(0,n.Z)(function*(e){try{return yield t.engine.request(e)}catch(r){throw t.logger.error(r.message),r}});return function(t){return e.apply(this,arguments)}}()),nf(this,"respond",function(){var e=(0,n.Z)(function*(e){try{return yield t.engine.respond(e)}catch(r){throw t.logger.error(r.message),r}});return function(t){return e.apply(this,arguments)}}()),nf(this,"ping",function(){var e=(0,n.Z)(function*(e){try{return yield t.engine.ping(e)}catch(r){throw t.logger.error(r.message),r}});return function(t){return e.apply(this,arguments)}}()),nf(this,"emit",function(){var e=(0,n.Z)(function*(e){try{return yield t.engine.emit(e)}catch(r){throw t.logger.error(r.message),r}});return function(t){return e.apply(this,arguments)}}()),nf(this,"disconnect",function(){var e=(0,n.Z)(function*(e){try{return yield t.engine.disconnect(e)}catch(r){throw t.logger.error(r.message),r}});return function(t){return e.apply(this,arguments)}}()),nf(this,"find",e=>{try{return this.engine.find(e)}catch(t){throw this.logger.error(t.message),t}}),nf(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(e){throw this.logger.error(e.message),e}}),nf(this,"authenticate",function(){var e=(0,n.Z)(function*(e,r){try{return yield t.engine.authenticate(e,r)}catch(n){throw t.logger.error(n.message),n}});return function(t,r){return e.apply(this,arguments)}}()),nf(this,"formatAuthMessage",e=>{try{return this.engine.formatAuthMessage(e)}catch(t){throw this.logger.error(t.message),t}}),nf(this,"approveSessionAuthenticate",function(){var e=(0,n.Z)(function*(e){try{return yield t.engine.approveSessionAuthenticate(e)}catch(r){throw t.logger.error(r.message),r}});return function(t){return e.apply(this,arguments)}}()),nf(this,"rejectSessionAuthenticate",function(){var e=(0,n.Z)(function*(e){try{return yield t.engine.rejectSessionAuthenticate(e)}catch(r){throw t.logger.error(r.message),r}});return function(t){return e.apply(this,arguments)}}()),this.name=e?.name||"client",this.metadata=function(e){var t,r;const n=ue();try{return null!=e&&e.url&&n.url&&new URL(e.url).host!==new URL(n.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${e.url} differs from the actual page url:${n.url}. This is probably unintended and can lead to issues.`),e.url=n.url),null!=(t=e?.icons)&&t.length&&e.icons.length>0&&(e.icons=e.icons.filter(e=>""!==e)),((e,t)=>J(e,Y(t)))(re(re({},n),e),{url:e?.url||n.url,name:e?.name||n.name,description:e?.description||n.description,icons:null!=(r=e?.icons)&&r.length&&e.icons.length>0?e.icons:n.icons})}catch(i){return console.warn("Error populating app metadata",i),e||n}}(e?.metadata),this.signConfig=e?.signConfig;const r=No({logger:e?.logger||"error",name:this.name});this.logger=r,this.core=e?.core||new Ou(e),this.session=new Wu(this.core,this.logger),this.proposal=new Hu(this.core,this.logger),this.pendingRequest=new Gu(this.core,this.logger),this.engine=new Vu(this),this.auth=new tf(this.core,this.logger)}static init(e){return(0,n.Z)(function*(){const t=new sf(e);return yield t.initialize(),t})()}get context(){return(0,K.Fd)(this.logger)}get pairing(){return this.core.pairing.pairings}initialize(){var e=this;return(0,n.Z)(function*(){e.logger.trace("Initialized");try{yield e.core.start(),yield e.session.init(),yield e.proposal.init(),yield e.pendingRequest.init(),yield e.auth.init(),yield e.engine.init(),e.logger.info("SignClient Initialization Success")}catch(t){throw e.logger.info("SignClient Initialization Failure"),e.logger.error(t.message),t}})()}}const of=sf;var af=r(39330);function cf(e){return"__proto__"===e}function lf(e){return null==e||"object"!=typeof e&&"function"!=typeof e}function uf(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function ff(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const hf="[object String]",df="[object Number]",pf="[object Boolean]",gf="[object Arguments]",yf="[object Object]";function mf(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function bf(e,t,r,n=new Map,i){const s=i?.(e,t,r,n);if(void 0!==s)return s;if(lf(e))return e;if(n.has(e))return n.get(e);if(Array.isArray(e)){const t=new Array(e.length);n.set(e,t);for(let s=0;s<e.length;s++)t[s]=bf(e[s],s,r,n,i);return Object.hasOwn(e,"index")&&(t.index=e.index),Object.hasOwn(e,"input")&&(t.input=e.input),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){const t=new RegExp(e.source,e.flags);return t.lastIndex=e.lastIndex,t}if(e instanceof Map){const t=new Map;n.set(e,t);for(const[s,o]of e)t.set(s,bf(o,s,r,n,i));return t}if(e instanceof Set){const t=new Set;n.set(e,t);for(const s of e)t.add(bf(s,void 0,r,n,i));return t}if(typeof Buffer<"u"&&Buffer.isBuffer(e))return e.subarray();if(mf(e)){const t=new(Object.getPrototypeOf(e).constructor)(e.length);n.set(e,t);for(let s=0;s<e.length;s++)t[s]=bf(e[s],s,r,n,i);return t}if(e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){const t=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return n.set(e,t),wf(t,e,r,n,i),t}if(typeof File<"u"&&e instanceof File){const t=new File([e],e.name,{type:e.type});return n.set(e,t),wf(t,e,r,n,i),t}if(typeof Blob<"u"&&e instanceof Blob){const t=new Blob([e],{type:e.type});return n.set(e,t),wf(t,e,r,n,i),t}if(e instanceof Error){const t=new e.constructor;return n.set(e,t),t.message=e.message,t.name=e.name,t.stack=e.stack,t.cause=e.cause,wf(t,e,r,n,i),t}if(e instanceof Boolean){const t=new Boolean(e.valueOf());return n.set(e,t),wf(t,e,r,n,i),t}if(e instanceof Number){const t=new Number(e.valueOf());return n.set(e,t),wf(t,e,r,n,i),t}if(e instanceof String){const t=new String(e.valueOf());return n.set(e,t),wf(t,e,r,n,i),t}if("object"==typeof e&&function(e){switch(ff(e)){case gf:case"[object Array]":case"[object ArrayBuffer]":case"[object DataView]":case pf:case"[object Date]":case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Map]":case df:case yf:case"[object RegExp]":case"[object Set]":case hf:case"[object Symbol]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return!0;default:return!1}}(e)){const t=Object.create(Object.getPrototypeOf(e));return n.set(e,t),wf(t,e,r,n,i),t}return e}function wf(e,t,r=e,n,i){const s=[...Object.keys(t),...uf(t)];for(let o=0;o<s.length;o++){const a=s[o],c=Object.getOwnPropertyDescriptor(e,a);(null==c||c.writable)&&(e[a]=bf(t[a],a,r,n,i))}}function vf(e){return function(e,t){return function(e,t){return bf(e,void 0,e,new Map,t)}(e,(r,n,i,s)=>{const o=t?.(r,n,i,s);if(void 0!==o)return o;if("object"==typeof e){if(ff(e)===yf&&"function"!=typeof e.constructor){const t={};return s.set(e,t),wf(t,e,i,s),t}switch(Object.prototype.toString.call(e)){case df:case hf:case pf:{const t=new e.constructor(e?.valueOf());return wf(t,e),t}case gf:{const t={};return wf(t,e),t.length=e.length,t[Symbol.iterator]=e[Symbol.iterator],t}default:return}}})}(e)}function Ef(e){return null!==e&&"object"==typeof e&&"[object Arguments]"===ff(e)}function xf(e){return"object"==typeof e&&null!==e}function If(e){return xf(e)&&function(e){return null!=e&&"function"!=typeof e&&function(e){return Number.isSafeInteger(e)&&e>=0}(e.length)}(e)}function Sf(){}function Of(e){return mf(e)}function _f(e){if("object"!=typeof e||null==e)return!1;if(null===Object.getPrototypeOf(e))return!0;if("[object Object]"!==Object.prototype.toString.call(e)){const t=e[Symbol.toStringTag];return!(null==t||!Object.getOwnPropertyDescriptor(e,Symbol.toStringTag)?.writable)&&e.toString()===`[object ${t}]`}let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function Pf(e,t,r,n){if(lf(e)&&(e=Object(e)),null==t||"object"!=typeof t)return e;if(n.has(t))return function(e){if(lf(e))return e;if(Array.isArray(e)||mf(e)||e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer)return e.slice(0);const t=Object.getPrototypeOf(e);if(null==t)return Object.assign(Object.create(t),e);const r=t.constructor;if(e instanceof Date||e instanceof Map||e instanceof Set)return new r(e);if(e instanceof RegExp){const t=new r(e);return t.lastIndex=e.lastIndex,t}if(e instanceof DataView)return new r(e.buffer.slice(0));if(e instanceof Error){let t;return t=e instanceof AggregateError?new r(e.errors,e.message,{cause:e.cause}):new r(e.message,{cause:e.cause}),t.stack=e.stack,Object.assign(t,e),t}if(typeof File<"u"&&e instanceof File)return new r([e],e.name,{type:e.type,lastModified:e.lastModified});if("object"==typeof e){const r=Object.create(t);return Object.assign(r,e)}return e}(n.get(t));if(n.set(t,e),Array.isArray(t)){t=t.slice();for(let e=0;e<t.length;e++)t[e]=t[e]??void 0}const i=[...Object.keys(t),...uf(t)];for(let s=0;s<i.length;s++){const o=i[s];if(cf(o))continue;let a=t[o],c=e[o];if(Ef(a)&&(a={...a}),Ef(c)&&(c={...c}),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=vf(a)),Array.isArray(a))if(Array.isArray(c)){const e=[],t=Reflect.ownKeys(c);for(let r=0;r<t.length;r++){const n=t[r];e[n]=c[n]}c=e}else if(If(c)){const e=[];for(let t=0;t<c.length;t++)e[t]=c[t];c=e}else c=[];const l=r(c,a,o,e,t,n);void 0!==l?e[o]=l:Array.isArray(a)||xf(c)&&xf(a)&&(_f(c)||_f(a)||Of(c)||Of(a))?e[o]=Pf(c,a,r,n):null==c&&_f(a)?e[o]=Pf({},a,r,n):null==c&&Of(a)?e[o]=vf(a):(void 0===c||void 0!==a)&&(e[o]=a)}return e}const Af="universal_provider",Rf=`wc@2:${Af}:`,Tf="https://rpc.walletconnect.org/v1/",Bf="generic",Cf=`${Tf}bundler`,Uf="call_status";var Nf=Object.defineProperty,kf=Object.defineProperties,jf=Object.getOwnPropertyDescriptors,Lf=Object.getOwnPropertySymbols,Df=Object.prototype.hasOwnProperty,qf=Object.prototype.propertyIsEnumerable,Mf=(e,t,r)=>t in e?Nf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,$f=(e,t)=>{for(var r in t||(t={}))Df.call(t,r)&&Mf(e,r,t[r]);if(Lf)for(var r of Lf(t))qf.call(t,r)&&Mf(e,r,t[r]);return e},zf=(e,t)=>kf(e,jf(t));function Zf(e,t,r){var n;const i=V(e);return(null==(n=t.rpcMap)?void 0:n[i.reference])||`${Tf}?chainId=${i.namespace}:${i.reference}&projectId=${r}`}function Ff(e){return e.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function Kf(e){return Object.fromEntries(Object.entries(e).filter(([e,t])=>{var r,n;return(null==(r=t?.chains)?void 0:r.length)&&(null==(n=t?.chains)?void 0:n.length)>0}))}function Vf(e={},t={}){return function(e,...t){return function(e,...t){const r=t.slice(0,-1),n=t[t.length-1];let i=e;for(let s=0;s<r.length;s++)i=Pf(i,r[s],n,new Map);return i}(e,...t,Sf)}(Kf(Hf(e)),Kf(Hf(t)))}function Hf(e){var t,r,n,i,s;const o={};if(!go(e))return o;for(const[a,c]of Object.entries(e)){const e=so(a)?[a]:c.chains,l=c.methods||[],u=c.events||[],f=c.rpcMap||{},h=oo(a);o[h]=zf($f($f({},o[h]),c),{chains:xe(e,null==(t=o[h])?void 0:t.chains),methods:xe(l,null==(r=o[h])?void 0:r.methods),events:xe(u,null==(n=o[h])?void 0:n.events)}),(go(f)||go((null==(i=o[h])?void 0:i.rpcMap)||{}))&&(o[h].rpcMap=$f($f({},f),null==(s=o[h])?void 0:s.rpcMap))}return o}function Wf(e){return e.includes(":")?e.split(":")[2]:e}function Gf(e){const t={};for(const[r,n]of Object.entries(e)){const e=n.methods||[],i=n.events||[],s=n.accounts||[],o=so(r)?[r]:n.chains?n.chains:Ff(n.accounts);t[r]={chains:o,methods:e,events:i,accounts:s}}return t}function Jf(e){return"number"==typeof e?e:e.includes("0x")?parseInt(e,16):(e=e.includes(":")?e.split(":")[1]:e,isNaN(Number(e))?e:Number(e))}const Yf={},Qf=e=>Yf[e],Xf=(e,t)=>{Yf[e]=t};var eh=Object.defineProperty,th=Object.getOwnPropertySymbols,rh=Object.prototype.hasOwnProperty,nh=Object.prototype.propertyIsEnumerable,ih=(e,t,r)=>t in e?eh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,sh=(e,t)=>{for(var r in t||(t={}))rh.call(t,r)&&ih(e,r,t[r]);if(th)for(var r of th(t))nh.call(t,r)&&ih(e,r,t[r]);return e};const oh=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],ah=e=>e&&e.startsWith("0x")?BigInt(e).toString(10):e,ch=e=>e&&e.startsWith("0x")?e:`0x${BigInt(e).toString(16)}`,lh=e=>Object.keys(e).filter(e=>oh.includes(e)).reduce((t,r)=>(t[r]=uh(e[r]),t),{}),uh=e=>"string"==typeof e&&function(e){try{const t=JSON.parse(e);return"object"==typeof t&&null!==t&&!Array.isArray(t)}catch{return!1}}(e)?JSON.parse(e):e;var fh=Object.defineProperty;let hh;class dh{constructor(e){((e,t,r)=>{((e,t,r)=>{t in e?fh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r)})(this,"storage"),this.storage=e}getItem(e){var t=this;return(0,n.Z)(function*(){return yield t.storage.getItem(e)})()}setItem(e,t){var r=this;return(0,n.Z)(function*(){return yield r.storage.setItem(e,t)})()}removeItem(e){var t=this;return(0,n.Z)(function*(){return yield t.storage.removeItem(e)})()}static getStorage(e){return hh||(hh=new dh(e)),hh}}var ph=Object.defineProperty,gh=Object.defineProperties,yh=Object.getOwnPropertyDescriptors,mh=Object.getOwnPropertySymbols,bh=Object.prototype.hasOwnProperty,wh=Object.prototype.propertyIsEnumerable,vh=(e,t,r)=>t in e?ph(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Eh=(e,t)=>{for(var r in t||(t={}))bh.call(t,r)&&vh(e,r,t[r]);if(mh)for(var r of mh(t))wh.call(t,r)&&vh(e,r,t[r]);return e},xh=(e,t)=>gh(e,yh(t));function Ih(){return Ih=(0,n.Z)(function*(e,t){const r=V(e.result.capabilities.caip345.caip2),n=e.result.capabilities.caip345.transactionHashes,i=yield Promise.allSettled(n.map(e=>Sh(r.reference,e,t))),s=i.filter(e=>"fulfilled"===e.status).map(e=>e.value).filter(e=>e);i.filter(e=>"rejected"===e.status).forEach(e=>console.warn("Failed to fetch transaction receipt:",e.reason));const o=!s.length||s.some(e=>!e),a=s.every(e=>"0x1"===e?.status),c=s.every(e=>"0x0"===e?.status),l=s.some(e=>"0x0"===e?.status);let u;return o?u=100:a?u=200:c?u=500:l&&(u=600),{id:e.result.id,version:e.request.version,atomic:e.request.atomicRequired,chainId:e.request.chainId,capabilities:e.result.capabilities,receipts:s,status:u}}),Ih.apply(this,arguments)}function Sh(e,t,r){return Oh.apply(this,arguments)}function Oh(){return Oh=(0,n.Z)(function*(e,t,r){return yield r(parseInt(e)).request((0,Yo.formatJsonRpcRequest)("eth_getTransactionReceipt",[t]))}),Oh.apply(this,arguments)}function _h(){return _h=(0,n.Z)(function*({sendCalls:e,storage:t}){const r=yield t.getItem(Uf);yield t.setItem(Uf,xh(Eh({},r),{[e.result.id]:{request:e.request,result:e.result,expiry:we(86400)}}))}),_h.apply(this,arguments)}function Ph(e){return Ah.apply(this,arguments)}function Ah(){return Ah=(0,n.Z)(function*({resultId:e,storage:t}){const r=yield t.getItem(Uf);if(r){delete r[e],yield t.setItem(Uf,r);for(const e in r)ve(r[e].expiry)&&delete r[e];yield t.setItem(Uf,r)}}),Ah.apply(this,arguments)}function Rh(){return Rh=(0,n.Z)(function*({resultId:e,storage:t}){const r=(yield t.getItem(Uf))?.[e];if(r&&!ve(r.expiry))return r;yield Ph({resultId:e,storage:t})}),Rh.apply(this,arguments)}var Th=Object.defineProperty,Bh=Object.defineProperties,Ch=Object.getOwnPropertyDescriptors,Uh=Object.getOwnPropertySymbols,Nh=Object.prototype.hasOwnProperty,kh=Object.prototype.propertyIsEnumerable,jh=(e,t,r)=>t in e?Th(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Lh=(e,t)=>{for(var r in t||(t={}))Nh.call(t,r)&&jh(e,r,t[r]);if(Uh)for(var r of Uh(t))kh.call(t,r)&&jh(e,r,t[r]);return e},Dh=(e,t)=>Bh(e,Ch(t)),qh=(e,t,r)=>jh(e,"symbol"!=typeof t?t+"":t,r);class Mh{constructor(e){qh(this,"name","eip155"),qh(this,"client"),qh(this,"chainId"),qh(this,"namespace"),qh(this,"httpProviders"),qh(this,"events"),qh(this,"storage"),this.namespace=e.namespace,this.events=Qf("events"),this.client=Qf("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain()),this.storage=dh.getStorage(this.client.core.storage)}request(e){var t=this;return(0,n.Z)(function*(){switch(e.request.method){case"eth_requestAccounts":case"eth_accounts":return t.getAccounts();case"wallet_switchEthereumChain":return yield t.handleSwitchChain(e);case"eth_chainId":return parseInt(t.getDefaultChain());case"wallet_getCapabilities":return yield t.getCapabilities(e);case"wallet_getCallsStatus":return yield t.getCallStatus(e);case"wallet_sendCalls":return yield t.sendCalls(e)}return t.namespace.methods.includes(e.request.method)?yield t.client.request(e):t.getHttpProvider().request(e.request)})()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t);const r=this.chainId;this.chainId=parseInt(e),this.events.emit("default_chain_changed",{currentCaipChainId:`${this.name}:${e}`,previousCaipChainId:`${this.name}:${r}`})}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const r=t||Zf(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Jo.r(new af.k(r,Qf("disableProviderPing")))}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const n=parseInt(function(e){return e.includes(":")?e.split(":")[1]:e}(t));e[n]=this.createHttpProvider(n,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}getHttpProvider(e){const t=e||this.chainId;return this.httpProviders[t]||(this.httpProviders=Dh(Lh({},this.httpProviders),{[t]:this.createHttpProvider(t)}),this.httpProviders[t])}handleSwitchChain(e){var t=this;return(0,n.Z)(function*(){var r,n;let i=e.request.params?null==(r=e.request.params[0])?void 0:r.chainId:"0x0";i=i.startsWith("0x")?i:`0x${i}`;const s=parseInt(i,16);if(t.isChainApproved(s))t.setDefaultChain(`${s}`);else{if(!t.namespace.methods.includes("wallet_switchEthereumChain"))throw new Error(`Failed to switch to chain 'eip155:${s}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);yield t.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:i}]},chainId:null==(n=t.namespace.chains)?void 0:n[0]}),t.setDefaultChain(`${s}`)}return null})()}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}getCapabilities(e){var t=this;return(0,n.Z)(function*(){var r,n,i,s,o;const a=null==(n=null==(r=e.request)?void 0:r.params)?void 0:n[0],c=(null==(s=null==(i=e.request)?void 0:i.params)?void 0:s[1])||[];if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const l=t.client.session.get(e.topic),u=(null==(o=l?.sessionProperties)?void 0:o.capabilities)||{},f=`${a}${c.length>0?c.join(","):`0x${t.chainId.toString(16)}`}`,h=u?.[f];if(h)return h;let d;try{d=((e,t,r)=>{const{sessionProperties:n={},scopedProperties:i={}}=e,s={};if(!go(i)&&!go(n))return;const o=lh(n);for(const a of r){const e=ah(a);if(!e)continue;s[ch(e)]=o;const r=i?.[`eip155:${e}`];if(r){const n=r?.[`eip155:${e}:${t}`];s[ch(e)]=sh(sh({},s[ch(e)]),lh(n||r))}}for(const[a,c]of Object.entries(s))0===Object.keys(c).length&&delete s[a];return Object.keys(s).length>0?s:void 0})(l,a,c)}catch(g){console.warn("Failed to extract capabilities from session",g)}if(d)return d;const p=yield t.client.request(e);try{yield t.client.session.update(e.topic,{sessionProperties:Dh(Lh({},l.sessionProperties||{}),{capabilities:Dh(Lh({},u||{}),{[f]:p})})})}catch(g){console.warn("Failed to update session with capabilities",g)}return p})()}getCallStatus(e){var t=this;return(0,n.Z)(function*(){var r,n,i;const s=t.client.session.get(e.topic),o=null==(r=s.sessionProperties)?void 0:r.bundler_name;if(o){const r=t.getBundlerUrl(e.chainId,o);try{return yield t.getUserOperationReceipt(r,e)}catch(l){console.warn("Failed to fetch call status from bundler",l,r)}}const a=null==(n=s.sessionProperties)?void 0:n.bundler_url;if(a)try{return yield t.getUserOperationReceipt(a,e)}catch(u){console.warn("Failed to fetch call status from custom bundler",u,a)}const c=yield function(e){return Rh.apply(this,arguments)}({resultId:null==(i=e.request.params)?void 0:i[0],storage:t.storage});if(c)try{return yield function(e,t){return Ih.apply(this,arguments)}(c,t.getHttpProvider.bind(t))}catch(u){console.warn("Failed to fetch call status from stored send calls",u,c)}if(t.namespace.methods.includes(e.request.method))return yield t.client.request(e);throw new Error("Fetching call status not approved by the wallet.")})()}getUserOperationReceipt(e,t){return(0,n.Z)(function*(){var r;const n=new URL(e),i=yield fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify((0,Yo.formatJsonRpcRequest)("eth_getUserOperationReceipt",[null==(r=t.request.params)?void 0:r[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return yield i.json()})()}getBundlerUrl(e,t){return`${Cf}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}sendCalls(e){var t=this;return(0,n.Z)(function*(){var r,n,i;const s=yield t.client.request(e),o=null==(r=e.request.params)?void 0:r[0],a=s?.id,c=s?.capabilities||{},l=null==(n=c?.caip345)?void 0:n.caip2,u=null==(i=c?.caip345)?void 0:i.transactionHashes;return!a||!l||!(null!=u&&u.length)||(yield function(e){return _h.apply(this,arguments)}({sendCalls:{request:o,result:s},storage:t.storage})),s})()}}var $h=Object.defineProperty,zh=(e,t,r)=>((e,t,r)=>t in e?$h(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class Zh{constructor(e){zh(this,"name",Bf),zh(this,"client"),zh(this,"httpProviders"),zh(this,"events"),zh(this,"namespace"),zh(this,"chainId"),this.namespace=e.namespace,this.events=Qf("events"),this.client=Qf("client"),this.chainId=this.getDefaultChain(),this.name=this.getNamespaceName(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t);const r=this.chainId;this.chainId=e,this.events.emit("default_chain_changed",{currentCaipChainId:`${this.name}:${e}`,previousCaipChainId:`${this.name}:${r}`})}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getNamespaceName(){const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return V(e).namespace}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){var e,t;const r={};return null==(t=null==(e=this.namespace)?void 0:e.accounts)||t.forEach(e=>{var t,n;const i=V(e),s=null==(n=null==(t=this.namespace)?void 0:t.rpcMap)?void 0:n[`${i.namespace}:${i.reference}`];r[i.reference]=this.createHttpProvider(e,s)}),r}getHttpProvider(e){const t=V(e).reference,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||Zf(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Jo.r(new af.Z(r,Qf("disableProviderPing")))}}var Fh=Object.defineProperty,Kh=Object.defineProperties,Vh=Object.getOwnPropertyDescriptors,Hh=Object.getOwnPropertySymbols,Wh=Object.prototype.hasOwnProperty,Gh=Object.prototype.propertyIsEnumerable,Jh=(e,t,r)=>t in e?Fh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Yh=(e,t)=>{for(var r in t||(t={}))Wh.call(t,r)&&Jh(e,r,t[r]);if(Hh)for(var r of Hh(t))Gh.call(t,r)&&Jh(e,r,t[r]);return e},Qh=(e,t)=>Kh(e,Vh(t)),Xh=(e,t,r)=>Jh(e,"symbol"!=typeof t?t+"":t,r);class ed{constructor(e){var t,r;Xh(this,"client"),Xh(this,"namespaces"),Xh(this,"optionalNamespaces"),Xh(this,"sessionProperties"),Xh(this,"scopedProperties"),Xh(this,"events",new i),Xh(this,"rpcProviders",{}),Xh(this,"session"),Xh(this,"providerOpts"),Xh(this,"logger"),Xh(this,"uri"),Xh(this,"disableProviderPing",!1),Xh(this,"connectParams"),this.providerOpts=e,this.logger=No({logger:null!=(t=e.logger)?t:"error",name:null!=(r=this.providerOpts.name)?r:Af}),this.disableProviderPing=e?.disableProviderPing||!1}static init(e){return(0,n.Z)(function*(){const t=new ed(e);return yield t.initialize(),t})()}request(e,t,r){var i=this;return(0,n.Z)(function*(){const[n,s]=i.validateChain(t);if(!i.session)throw new Error("Please call connect() before request()");return yield i.getProvider(n).request({request:Yh({},e),chainId:`${n}:${s}`,topic:i.session.topic,expiry:r})})()}sendAsync(e,t,r,n){const i=(new Date).getTime();this.request(e,r,n).then(e=>t(null,(0,Yo.formatJsonRpcResult)(i,e))).catch(e=>t(e,void 0))}enable(){var e=this;return(0,n.Z)(function*(){if(!e.client)throw new Error("Sign Client not initialized");return e.session||(yield e.connect({namespaces:e.namespaces,optionalNamespaces:e.optionalNamespaces,sessionProperties:e.sessionProperties,scopedProperties:e.scopedProperties})),yield e.requestAccounts()})()}disconnect(){var e=this;return(0,n.Z)(function*(){var t;if(!e.session)throw new Error("Please call connect() before enable()");yield e.client.disconnect({topic:null==(t=e.session)?void 0:t.topic,reason:ho("USER_DISCONNECTED")}),yield e.cleanup()})()}connect(e){var t=this;return(0,n.Z)(function*(){if(!t.client)throw new Error("Sign Client not initialized");if(t.connectParams=e,t.setNamespaces(e),t.cleanupPendingPairings(),!e.skipPairing)return yield t.pair(e.pairingTopic)})()}authenticate(e,t){var r=this;return(0,n.Z)(function*(){if(!r.client)throw new Error("Sign Client not initialized");r.setNamespaces(e),yield r.cleanupPendingPairings();const{uri:n,response:i}=yield r.client.authenticate(e,t);n&&(r.uri=n,r.events.emit("display_uri",n));const s=yield i();if(r.session=s.session,r.session){const e=Gf(r.session.namespaces);r.namespaces=Vf(r.namespaces,e),yield r.persist("namespaces",r.namespaces),r.onConnect()}return s})()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}pair(e){var t=this;return(0,n.Z)(function*(){var r,n;const{uri:i,approval:s}=yield t.client.connect({pairingTopic:e,requiredNamespaces:t.namespaces,optionalNamespaces:t.optionalNamespaces,sessionProperties:t.sessionProperties,scopedProperties:t.scopedProperties,authentication:null==(r=t.connectParams)?void 0:r.authentication,walletPay:null==(n=t.connectParams)?void 0:n.walletPay});i&&(t.uri=i,t.events.emit("display_uri",i));const o=yield s();t.session=o;const a=Gf(o.namespaces);return t.namespaces=Vf(t.namespaces,a),yield t.persist("namespaces",t.namespaces),yield t.persist("optionalNamespaces",t.optionalNamespaces),t.onConnect(),t.session})()}setDefaultChain(e,t){try{if(!this.session)return;const[r,n]=this.validateChain(e),i=this.getProvider(r);i?i.setDefaultChain(n,t):this.session&&this.logger.warn(`Provider for namespace '${r}' not found in setDefaultChain`)}catch(r){if(!/Please call connect/.test(r.message))throw r}}cleanupPendingPairings(e={}){var t=this;return(0,n.Z)(function*(){try{t.logger.info("Cleaning up inactive pairings...");const r=t.client.pairing.getAll();if(!po(r))return;for(const n of r)e.deletePairings?t.client.core.expirer.set(n.topic,0):yield t.client.core.relayer.subscriber.unsubscribe(n.topic);t.logger.info(`Inactive pairings cleared: ${r.length}`)}catch(r){t.logger.warn(r,"Failed to cleanup pending pairings")}})()}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}checkStorage(){var e=this;return(0,n.Z)(function*(){e.namespaces=(yield e.getFromStore("namespaces"))||{},e.optionalNamespaces=(yield e.getFromStore("optionalNamespaces"))||{},e.session&&e.createProviders()})()}initialize(){var e=this;return(0,n.Z)(function*(){e.logger.trace("Initialized"),yield e.createClient(),yield e.checkStorage(),e.registerEventListeners()})()}createClient(){var e=this;return(0,n.Z)(function*(){var t,r;if(e.client=e.providerOpts.client||(yield of.init({core:e.providerOpts.core,logger:e.providerOpts.logger||"error",relayUrl:e.providerOpts.relayUrl||"wss://relay.walletconnect.org",projectId:e.providerOpts.projectId,metadata:e.providerOpts.metadata,storageOptions:e.providerOpts.storageOptions,storage:e.providerOpts.storage,name:e.providerOpts.name,customStoragePrefix:e.providerOpts.customStoragePrefix,telemetryEnabled:e.providerOpts.telemetryEnabled})),e.providerOpts.session)try{e.session=e.client.session.get(e.providerOpts.session.topic)}catch(n){throw e.logger.error(n,"Failed to get session"),new Error(`The provided session: ${null==(r=null==(t=e.providerOpts)?void 0:t.session)?void 0:r.topic} doesn't exist in the Sign client`)}else{const t=e.client.session.getAll();e.session=t[0]}e.logger.trace("SignClient Initialized")})()}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(e=>oo(e)))];Xf("client",this.client),Xf("events",this.events),Xf("disableProviderPing",this.disableProviderPing),e.forEach(e=>{if(!this.session)return;const t=function(e,t){const r=Object.keys(t.namespaces).filter(t=>t.includes(e));if(!r.length)return[];const n=[];return r.forEach(e=>{n.push(...t.namespaces[e].accounts)}),n}(e,this.session);if(0===t?.length)return;const r=Ff(t),n=Vf(this.namespaces,this.optionalNamespaces),i=Qh(Yh({},n[e]),{accounts:t,chains:r});this.rpcProviders[e]="eip155"===e?new Mh({namespace:i}):new Zh({namespace:i})})}registerEventListeners(){var e=this;if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var t;const{topic:r}=e;r===(null==(t=this.session)?void 0:t.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var t;const{params:r,topic:n}=e;if(n!==(null==(t=this.session)?void 0:t.topic))return;const{event:i}=r;if("accountsChanged"===i.name){const e=i.data;e&&po(e)&&this.events.emit("accountsChanged",e.map(Wf))}else if("chainChanged"===i.name){const e=r.chainId,t=r.event.data,n=oo(e),i=Jf(e)!==Jf(t)?`${n}:${Jf(t)}`:e;this.onChainChanged({currentCaipChainId:i})}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var r,n;if(e!==(null==(r=this.session)?void 0:r.topic))return;const{namespaces:i}=t,s=null==(n=this.client)?void 0:n.session.get(e);this.session=Qh(Yh({},s),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",function(){var t=(0,n.Z)(function*(t){var r;t.topic===(null==(r=e.session)?void 0:r.topic)&&(yield e.cleanup(),e.events.emit("session_delete",t),e.events.emit("disconnect",Qh(Yh({},ho("USER_DISCONNECTED")),{data:t.topic})))});return function(e){return t.apply(this,arguments)}}()),this.on("default_chain_changed",e=>{this.onChainChanged(Qh(Yh({},e),{internal:!0}))})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[Bf]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace(null==(t=this.session)?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t={},optionalNamespaces:r={},sessionProperties:n,scopedProperties:i}=e;this.optionalNamespaces=Vf(t,r),this.sessionProperties=n,this.scopedProperties=i}validateChain(e){const[t,r]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,r];if(t&&!Object.keys(this.namespaces||{}).map(e=>oo(e)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&r)return[t,r];const n=oo(Object.keys(this.namespaces)[0]);return[n,this.rpcProviders[n].getDefaultChain()]}requestAccounts(){var e=this;return(0,n.Z)(function*(){const[t]=e.validateChain();return yield e.getProvider(t).requestAccounts()})()}onChainChanged({currentCaipChainId:e,previousCaipChainId:t,internal:r=!1}){var i=this;return(0,n.Z)(function*(){if(!i.namespaces)return;const[n,s]=i.validateChain(e);if(s){if(i.updateNamespaceChain(n,s),r)i.events.emit("chainChanged",s),i.emitAccountsChangedOnChainChange({namespace:n,currentCaipChainId:e,previousCaipChainId:t});else{const e=i.getProvider(n);e?e.setDefaultChain(s):i.session&&i.logger.warn(`Provider for namespace '${n}' not found during chain change`)}yield i.persist("namespaces",i.namespaces)}})()}emitAccountsChangedOnChainChange({namespace:e,currentCaipChainId:t,previousCaipChainId:r}){var n,i;try{if(r===t)return;const s=null==(i=null==(n=this.session)?void 0:n.namespaces[e])?void 0:i.accounts;if(!s)return;const o=s.filter(e=>e.includes(`${t}:`)).map(Wf);if(!po(o))return;this.events.emit("accountsChanged",o)}catch(s){this.logger.warn(s,"Failed to emit accountsChanged on chain change")}}updateNamespaceChain(e,t){if(!this.namespaces)return;const r=this.namespaces[e]?e:`${e}:${t}`,n={chains:[],methods:[],events:[],defaultChain:t};this.namespaces[r]?this.namespaces[r]&&(this.namespaces[r].defaultChain=t):this.namespaces[r]=n}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}cleanup(){var e=this;return(0,n.Z)(function*(){e.connectParams=void 0,e.namespaces=void 0,e.optionalNamespaces=void 0,e.sessionProperties=void 0,yield e.deleteFromStore("namespaces"),yield e.deleteFromStore("optionalNamespaces"),yield e.deleteFromStore("sessionProperties"),e.session=void 0,e.cleanupPendingPairings({deletePairings:!0}),yield e.cleanupStorage()})()}persist(e,t){var r=this;return(0,n.Z)(function*(){var n;const i=(null==(n=r.session)?void 0:n.topic)||"";yield r.client.core.storage.setItem(`${Rf}/${e}${i}`,t)})()}getFromStore(e){var t=this;return(0,n.Z)(function*(){var r;const n=(null==(r=t.session)?void 0:r.topic)||"";return yield t.client.core.storage.getItem(`${Rf}/${e}${n}`)})()}deleteFromStore(e){var t=this;return(0,n.Z)(function*(){var r;const n=(null==(r=t.session)?void 0:r.topic)||"";yield t.client.core.storage.removeItem(`${Rf}/${e}${n}`)})()}cleanupStorage(){var e=this;return(0,n.Z)(function*(){var t;try{if((null==(t=e.client)?void 0:t.session.length)>0)return;const r=yield e.client.core.storage.getKeys();for(const t of r)t.startsWith(Rf)&&(yield e.client.core.storage.removeItem(t))}catch(r){e.logger.warn(r,"Failed to cleanup storage")}})()}}const td=ed,rd=["eth_sendTransaction","personal_sign"],nd=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_sendCalls","wallet_getCapabilities","wallet_getCallsStatus","wallet_showCallsStatus"],id=["chainChanged","accountsChanged"],sd=["chainChanged","accountsChanged","message","disconnect","connect"],od=function(){var e=(0,n.Z)(function*(){const{createAppKit:e}=yield r.e(1426).then(r.bind(r,71426));return e});return function(){return e.apply(this,arguments)}}();var ad=Object.defineProperty,cd=Object.defineProperties,ld=Object.getOwnPropertyDescriptors,ud=Object.getOwnPropertySymbols,fd=Object.prototype.hasOwnProperty,hd=Object.prototype.propertyIsEnumerable,dd=(e,t,r)=>t in e?ad(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,pd=(e,t)=>{for(var r in t||(t={}))fd.call(t,r)&&dd(e,r,t[r]);if(ud)for(var r of ud(t))hd.call(t,r)&&dd(e,r,t[r]);return e},gd=(e,t)=>cd(e,ld(t)),yd=(e,t,r)=>dd(e,"symbol"!=typeof t?t+"":t,r);function md(e){return Number(e[0].split(":")[1])}function bd(e){return`0x${e.toString(16)}`}class wd{constructor(){yd(this,"events",new i.EventEmitter),yd(this,"namespace","eip155"),yd(this,"accounts",[]),yd(this,"signer"),yd(this,"chainId",1),yd(this,"modal"),yd(this,"rpc"),yd(this,"STORAGE_KEY","wc@2:ethereum_provider:"),yd(this,"on",(e,t)=>(this.events.on(e,t),this)),yd(this,"once",(e,t)=>(this.events.once(e,t),this)),yd(this,"removeListener",(e,t)=>(this.events.removeListener(e,t),this)),yd(this,"off",(e,t)=>(this.events.off(e,t),this)),yd(this,"parseAccount",e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e),this.signer={},this.rpc={}}static init(e){return(0,n.Z)(function*(){const t=new wd;return yield t.initialize(e),t})()}request(e,t){var r=this;return(0,n.Z)(function*(){return yield r.signer.request(e,r.formatChainId(r.chainId),t)})()}sendAsync(e,t,r){this.signer.sendAsync(e,t,this.formatChainId(this.chainId),r)}get connected(){return!!this.signer.client&&this.signer.client.core.relayer.connected}get connecting(){return!!this.signer.client&&this.signer.client.core.relayer.connecting}enable(){var e=this;return(0,n.Z)(function*(){return e.session||(yield e.connect()),yield e.request({method:"eth_requestAccounts"})})()}connect(e){var t=this;return(0,n.Z)(function*(){var r;if(!t.signer.client)throw new Error("Provider not initialized. Call init() first");t.loadConnectOpts(e);const{required:i,optional:s}=function(e){const{chains:t,optionalChains:r,methods:n,optionalMethods:i,events:s,optionalEvents:o,rpcMap:a}=e;if(!po(t))throw new Error("Invalid chains");const c={chains:t,methods:n||rd,events:s||id,rpcMap:pd({},t.length?{[md(t)]:a[md(t)]}:{})},l=s?.filter(e=>!id.includes(e)),u=n?.filter(e=>!rd.includes(e));if(!(r||o||i||null!=l&&l.length||null!=u&&u.length))return{required:t.length?c:void 0};const f={chains:[...new Set(l?.length&&u?.length||!r?c.chains.concat(r||[]):r)],methods:[...new Set(c.methods.concat(null!=i&&i.length?i:nd))],events:[...new Set(c.events.concat(null!=o&&o.length?o:sd))],rpcMap:a};return{required:t.length?c:void 0,optional:r.length?f:void 0}}(t.rpc);try{const o=yield new Promise(function(){var r=(0,n.Z)(function*(r,n){var o,a;t.rpc.showQrModal&&(null==(o=t.modal)||o.open(),null==(a=t.modal)||a.subscribeState(e=>{!e.open&&!t.signer.session&&(t.signer.abortPairingAttempt(),n(new Error("Connection request reset. Please try again.")))}));const c=null!=e&&e.scopedProperties?{[t.namespace]:e.scopedProperties}:void 0;yield t.signer.connect(gd(pd({namespaces:pd({},i&&{[t.namespace]:i})},s&&{optionalNamespaces:{[t.namespace]:s}}),{pairingTopic:e?.pairingTopic,scopedProperties:c})).then(e=>{r(e)}).catch(e=>{var r;null==(r=t.modal)||r.showErrorMessage("Unable to connect"),n(new Error(e.message))})});return function(e,t){return r.apply(this,arguments)}}());if(!o)return;const a=H(o.namespaces,[t.namespace]);t.setChainIds(t.rpc.chains.length?t.rpc.chains:a),t.setAccounts(a),t.events.emit("connect",{chainId:bd(t.chainId)})}catch(o){throw t.signer.logger.error(o),o}finally{null==(r=t.modal)||r.close()}})()}authenticate(e,t){var r=this;return(0,n.Z)(function*(){var i;if(!r.signer.client)throw new Error("Provider not initialized. Call init() first");r.loadConnectOpts({chains:e?.chains});try{const s=yield new Promise(function(){var i=(0,n.Z)(function*(n,i){var s,o;r.rpc.showQrModal&&(null==(s=r.modal)||s.open(),null==(o=r.modal)||o.subscribeState(e=>{!e.open&&!r.signer.session&&(r.signer.abortPairingAttempt(),i(new Error("Connection request reset. Please try again.")))})),yield r.signer.authenticate(gd(pd({},e),{chains:r.rpc.chains}),t).then(e=>{n(e)}).catch(e=>{var t;null==(t=r.modal)||t.showErrorMessage("Unable to connect"),i(new Error(e.message))})});return function(e,t){return i.apply(this,arguments)}}()),o=s.session;if(o){const e=H(o.namespaces,[r.namespace]);r.setChainIds(r.rpc.chains.length?r.rpc.chains:e),r.setAccounts(e),r.events.emit("connect",{chainId:bd(r.chainId)})}return s}catch(s){throw r.signer.logger.error(s),s}finally{null==(i=r.modal)||i.close()}})()}disconnect(){var e=this;return(0,n.Z)(function*(){e.session&&(yield e.signer.disconnect()),e.reset()})()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:r}=t;"accountsChanged"===r.name?(this.accounts=this.parseAccounts(r.data),this.events.emit("accountsChanged",this.accounts)):"chainChanged"===r.name?this.setChainId(this.formatChainId(r.data)):this.events.emit(r.name,r.data),this.events.emit("session_event",e)}),this.signer.on("accountsChanged",e=>{this.accounts=this.parseAccounts(e),this.events.emit("accountsChanged",this.accounts)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",bd(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",gd(pd({},ho("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return"string"==typeof e&&e.startsWith(`${this.namespace}:`)}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(e=>this.isCompatibleChainId(e)).map(e=>this.parseChainId(e));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",bd(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,r,n]=e.split(":");return{chainId:`${t}:${r}`,address:n}}setAccounts(e){this.accounts=e.filter(e=>this.parseChainId(this.parseAccountId(e).chainId)===this.chainId).map(e=>this.parseAccountId(e).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,r;const n=null!=(t=e?.chains)?t:[],i=null!=(r=e?.optionalChains)?r:[],s=n.concat(i);if(!s.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const o=n.length?e?.methods||rd:[],a=n.length?e?.events||id:[],c=e?.optionalMethods||[],l=e?.optionalEvents||[],u=e?.rpcMap||this.buildRpcMap(s,e.projectId),f=e?.qrModalOptions||void 0;return{chains:n?.map(e=>this.formatChainId(e)),optionalChains:i.map(e=>this.formatChainId(e)),methods:o,events:a,optionalMethods:c,optionalEvents:l,rpcMap:u,showQrModal:!(null==e||!e.showQrModal),qrModalOptions:f,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const r={};return e.forEach(e=>{r[e]=this.getRpcUrl(e,t)}),r}initialize(e){var t=this;return(0,n.Z)(function*(){var r;if(t.rpc=t.getRpcConfig(e),t.chainId=md(t.rpc.chains.length?t.rpc.chains:t.rpc.optionalChains),t.signer=yield td.init({projectId:t.rpc.projectId,metadata:t.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storage:e.storage,storageOptions:e.storageOptions,customStoragePrefix:e.customStoragePrefix,telemetryEnabled:e.telemetryEnabled,logger:e.logger}),t.registerEventListeners(),yield t.loadPersistedSession(),t.rpc.showQrModal){let e;try{const n=yield od(),{convertWCMToAppKitOptions:i}=yield Promise.resolve().then(function(){return Ud}),s=i(gd(pd({},t.rpc.qrModalOptions),{chains:[...new Set([...t.rpc.chains,...t.rpc.optionalChains])],metadata:t.rpc.metadata,projectId:t.rpc.projectId}));if(!s.networks.length)throw new Error("No networks found for WalletConnect");e=n(gd(pd({},s),{universalProvider:t.signer,manualWCControl:!0,enableMobileFullScreen:!0===(null==(r=t.rpc.qrModalOptions)?void 0:r.enableMobileFullScreen)}))}catch(n){throw console.warn(n),new Error("To use QR modal, please install @reown/appkit package")}if(e)try{t.modal=e}catch(n){throw t.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}})()}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:r,rpcMap:n}=e;t&&po(t)&&(this.rpc.chains=t.map(e=>this.formatChainId(e)),t.forEach(e=>{this.rpc.rpcMap[e]=n?.[e]||this.getRpcUrl(e)})),r&&po(r)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=r?.map(e=>this.formatChainId(e)),r.forEach(e=>{this.rpc.rpcMap[e]=n?.[e]||this.getRpcUrl(e)}))}getRpcUrl(e,t){var r;return(null==(r=this.rpc.rpcMap)?void 0:r[e])||`https://rpc.walletconnect.org/v1/?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}loadPersistedSession(){var e=this;return(0,n.Z)(function*(){if(e.session)try{const t=yield e.signer.client.core.storage.getItem(`${e.STORAGE_KEY}/chainId`),r=e.session.namespaces[`${e.namespace}:${t}`]?e.session.namespaces[`${e.namespace}:${t}`]:e.session.namespaces[e.namespace];e.setChainIds(t?[e.formatChainId(t)]:r?.accounts),e.setAccounts(r?.accounts)}catch(t){e.signer.logger.error("Failed to load persisted session, clearing state..."),e.signer.logger.error(t),yield e.disconnect().catch(t=>e.signer.logger.warn(t))}})()}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return"string"==typeof e||e instanceof String?[this.parseAccount(e)]:e.map(e=>this.parseAccount(e))}}const vd=wd;var Ed=Object.defineProperty,xd=Object.defineProperties,Id=Object.getOwnPropertyDescriptors,Sd=Object.getOwnPropertySymbols,Od=Object.prototype.hasOwnProperty,_d=Object.prototype.propertyIsEnumerable,Pd=(e,t,r)=>t in e?Ed(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ad=(e,t)=>{for(var r in t||(t={}))Od.call(t,r)&&Pd(e,r,t[r]);if(Sd)for(var r of Sd(t))_d.call(t,r)&&Pd(e,r,t[r]);return e},Rd=(e,t)=>xd(e,Id(t));function Td(e){if(e)return{"--w3m-font-family":e["--wcm-font-family"],"--w3m-accent":e["--wcm-accent-color"],"--w3m-color-mix":e["--wcm-background-color"],"--w3m-z-index":e["--wcm-z-index"]?Number(e["--wcm-z-index"]):void 0,"--w3m-qr-color":e["--wcm-accent-color"],"--w3m-font-size-master":e["--wcm-text-medium-regular-size"],"--w3m-border-radius-master":e["--wcm-container-border-radius"],"--w3m-color-mix-strength":0}}const Bd=e=>{const[t,r]=e.split(":");return Cd({id:r,caipNetworkId:e,chainNamespace:t,name:"",nativeCurrency:{name:"",symbol:"",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}})};function Cd(e){return Ad({formatters:void 0,fees:void 0,serializers:void 0},e)}var Ud=Object.freeze({__proto__:null,convertWCMToAppKitOptions:function(e){var t,r,n,i,s,o,a;const c=null==(t=e.chains)?void 0:t.map(Bd).filter(Boolean);if(0===c.length)throw new Error("At least one chain must be specified");const l=c.find(t=>{var r;return t.id===(null==(r=e.defaultChain)?void 0:r.id)}),u={projectId:e.projectId,networks:c,themeMode:e.themeMode,themeVariables:Td(e.themeVariables),chainImages:e.chainImages,connectorImages:e.walletImages,defaultNetwork:l,metadata:Rd(Ad({},e.metadata),{name:(null==(r=e.metadata)?void 0:r.name)||"WalletConnect",description:(null==(n=e.metadata)?void 0:n.description)||"Connect to WalletConnect-compatible wallets",url:(null==(i=e.metadata)?void 0:i.url)||"https://walletconnect.org",icons:(null==(s=e.metadata)?void 0:s.icons)||["https://walletconnect.org/walletconnect-logo.png"]}),showWallets:!0,featuredWalletIds:"NONE"===e.explorerRecommendedWalletIds?[]:Array.isArray(e.explorerRecommendedWalletIds)?e.explorerRecommendedWalletIds:[],excludeWalletIds:"ALL"===e.explorerExcludedWalletIds?[]:Array.isArray(e.explorerExcludedWalletIds)?e.explorerExcludedWalletIds:[],enableEIP6963:!1,enableInjected:!1,enableCoinbase:!0,enableWalletConnect:!0,features:{email:!1,socials:!1}};if(null!=(o=e.mobileWallets)&&o.length||null!=(a=e.desktopWallets)&&a.length){const t=[...(e.mobileWallets||[]).map(e=>({id:e.id,name:e.name,links:e.links})),...(e.desktopWallets||[]).map(e=>({id:e.id,name:e.name,links:{native:e.links.native,universal:e.links.universal}}))],r=[...u.featuredWalletIds||[],...u.excludeWalletIds||[]],n=t.filter(e=>!r.includes(e.id));n.length&&(u.customWallets=n)}return u},defineChain:Cd})},47737:function(e,t,r){"use strict";r.d(t,{G:function(){return n}});class n extends Error{constructor(e,t={}){const r=(()=>{if(t.cause instanceof n){if(t.cause.details)return t.cause.details;if(t.cause.shortMessage)return t.cause.shortMessage}return t.cause&&"details"in t.cause&&"string"==typeof t.cause.details?t.cause.details:t.cause?.message?t.cause.message:t.details})(),i=t.cause instanceof n&&t.cause.docsPath||t.docsPath,s=`https://oxlib.sh${i??""}`;super([e||"An error occurred.",...t.metaMessages?["",...t.metaMessages]:[],...r||i?["",r?`Details: ${r}`:void 0,i?`See: ${s}`:void 0]:[]].filter(e=>"string"==typeof e).join("\n"),t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:"ox@0.1.1"}),this.cause=t.cause,this.details=r,this.docs=s,this.docsPath=i,this.shortMessage=e}walk(e){return i(this,e)}}function i(e,t){return t?.(e)?e:e&&"object"==typeof e&&"cause"in e&&e.cause?i(e.cause,t):t?null:e}},89062:function(e,t,r){"use strict";r.d(t,{zo:function(){return a},Dp:function(){return c},xv:function(){return l},xS:function(){return u},eh:function(){return f},tP:function(){return h},dp:function(){return d},Gu:function(){return p},M6:function(){return b},mV:function(){return w},$s:function(){return v}});var n=r(47737),i=r(85900),s=r(36125);const o=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function a(...e){return`0x${e.reduce((e,t)=>e+t.replace("0x",""),"")}`}function c(e){return e instanceof Uint8Array?l(e):Array.isArray(e)?l(new Uint8Array(e)):e}function l(e,t={}){let r="";for(let i=0;i<e.length;i++)r+=o[e[i]];const n=`0x${r}`;return"number"==typeof t.size?(i.Yf(n,t.size),f(n,t.size)):n}function u(e,t={}){const{signed:r,size:n}=t,s=BigInt(e);let o;n?o=r?(1n<<8n*BigInt(n)-1n)-1n:2n**(8n*BigInt(n))-1n:"number"==typeof e&&(o=BigInt(Number.MAX_SAFE_INTEGER));const a="bigint"==typeof o&&r?-o-1n:0;if(o&&s>o||s<a){const t="bigint"==typeof e?"n":"";throw new g({max:o?`${o}${t}`:void 0,min:`${a}${t}`,signed:r,size:n,value:`${e}${t}`})}const c=`0x${(r&&s<0?(1n<<BigInt(8*n))+BigInt(s):s).toString(16)}`;return n?function(e,t){return i.vk(e,{dir:"left",size:t})}(c,n):c}function f(e,t){return i.vk(e,{dir:"right",size:t})}function h(e,t,r,n={}){const{strict:s}=n;i.EM(e,t);const o=`0x${e.replace("0x","").slice(2*(t??0),2*(r??e.length))}`;return s&&i.Ro(o,t,r),o}function d(e){return Math.ceil((e.length-2)/2)}function p(e,t={}){const{strict:r=!1}=t;try{return function(e,t={}){const{strict:r=!1}=t;if(!e)throw new y(e);if("string"!=typeof e)throw new y(e);if(r&&!/^0x[0-9a-fA-F]*$/.test(e))throw new m(e);if(!e.startsWith("0x"))throw new m(e)}(e,{strict:r}),!0}catch{return!1}}class g extends n.G{constructor({max:e,min:t,signed:r,size:n,value:i}){super(`Number \`${i}\` is not in safe${n?` ${8*n}-bit`:""}${r?" signed":" unsigned"} integer range ${e?`(\`${t}\` to \`${e}\`)`:`(above \`${t}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}}class y extends n.G{constructor(e){super(`Value \`${"object"==typeof e?s.P(e):e}\` of type \`${typeof e}\` is an invalid hex type.`,{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"})}}class m extends n.G{constructor(e){super(`Value \`${e}\` is an invalid hex value.`,{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"})}}class b extends n.G{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed \`${t}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}}class w extends n.G{constructor({offset:e,position:t,size:r}){super(`Slice ${"start"===t?"starting":"ending"} at offset \`${e}\` is out-of-bounds (size: \`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"})}}class v extends n.G{constructor({size:e,targetSize:t,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${t}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}}},36125:function(e,t,r){"use strict";r.d(t,{P:function(){return n}});function n(e,t,r){return JSON.stringify(e,(e,r)=>"function"==typeof t?t(e,r):"bigint"==typeof r?r.toString()+"#__bigint":r,r)}},4180:function(e,t,r){"use strict";r.d(t,{RJ:function(){return zt}});const n="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function i(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function s(e,...t){if(!function(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function o(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function a(e,t){s(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function c(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function l(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function u(e,t){return e<<32-t|e>>>t}function f(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}const h=(()=>68===new Uint8Array(new Uint32Array([287454020]).buffer)[0])()?e=>e:function(e){for(let t=0;t<e.length;t++)e[t]=f(e[t]);return e};function d(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}(e)),s(e),e}class p{}function g(e){const t=t=>e().update(d(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function y(e=32){if(n&&"function"==typeof n.getRandomValues)return n.getRandomValues(new Uint8Array(e));if(n&&"function"==typeof n.randomBytes)return Uint8Array.from(n.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}function m(e,t,r){return e&t^~e&r}function b(e,t,r){return e&t^e&r^t&r}class w extends p{constructor(e,t,r,n){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=n,this.buffer=new Uint8Array(e),this.view=l(this.buffer)}update(e){o(this),s(e=d(e));const{view:t,buffer:r,blockLen:n}=this,i=e.length;for(let s=0;s<i;){const o=Math.min(n-this.pos,i-s);if(o!==n)r.set(e.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===n&&(this.process(t,0),this.pos=0);else{const t=l(e);for(;n<=i-s;s+=n)this.process(t,s)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){o(this),a(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:n,isLE:i}=this;let{pos:s}=this;t[s++]=128,c(this.buffer.subarray(s)),this.padOffset>n-s&&(this.process(r,0),s=0);for(let o=s;o<n;o++)t[o]=0;(function(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?0:4;e.setUint32(t+(n?4:0),o,n),e.setUint32(t+c,a,n)})(r,n-8,BigInt(8*this.length),i),this.process(r,0);const u=l(e),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const h=f/4,d=this.get();if(h>d.length)throw new Error("_sha2: outputLen bigger than state");for(let o=0;o<h;o++)u.setUint32(4*o,d[o],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:n,finished:i,destroyed:s,pos:o}=this;return e.destroyed=s,e.finished=i,e.length=n,e.pos=o,n%t&&e.buffer.set(r),e}clone(){return this._cloneInto()}}const v=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),E=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),x=new Uint32Array(64);class I extends w{constructor(e=32){super(64,e,8,!1),this.A=0|v[0],this.B=0|v[1],this.C=0|v[2],this.D=0|v[3],this.E=0|v[4],this.F=0|v[5],this.G=0|v[6],this.H=0|v[7]}get(){const{A:e,B:t,C:r,D:n,E:i,F:s,G:o,H:a}=this;return[e,t,r,n,i,s,o,a]}set(e,t,r,n,i,s,o,a){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|s,this.G=0|o,this.H=0|a}process(e,t){for(let u=0;u<16;u++,t+=4)x[u]=e.getUint32(t,!1);for(let f=16;f<64;f++){const e=x[f-15],t=x[f-2],r=u(e,7)^u(e,18)^e>>>3,n=u(t,17)^u(t,19)^t>>>10;x[f]=n+x[f-7]+r+x[f-16]|0}let{A:r,B:n,C:i,D:s,E:o,F:a,G:c,H:l}=this;for(let f=0;f<64;f++){const e=l+(u(o,6)^u(o,11)^u(o,25))+m(o,a,c)+E[f]+x[f]|0,t=(u(r,2)^u(r,13)^u(r,22))+b(r,n,i)|0;l=c,c=a,a=o,o=s+e|0,s=i,i=n,n=r,r=e+t|0}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,s=s+this.D|0,o=o+this.E|0,a=a+this.F|0,c=c+this.G|0,l=l+this.H|0,this.set(r,n,i,s,o,a,c,l)}roundClean(){c(x)}destroy(){this.set(0,0,0,0,0,0,0,0),c(this.buffer)}}const S=g(()=>new I);class O extends p{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,function(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.createHasher");i(e.outputLen),i(e.blockLen)}(e);const r=d(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,s=new Uint8Array(n);s.set(r.length>n?e.create().update(r).digest():r);for(let i=0;i<s.length;i++)s[i]^=54;this.iHash.update(s),this.oHash=e.create();for(let i=0;i<s.length;i++)s[i]^=106;this.oHash.update(s),c(s)}update(e){return o(this),this.iHash.update(e),this}digestInto(e){o(this),s(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:n,destroyed:i,blockLen:s,outputLen:o}=this;return e.finished=n,e.destroyed=i,e.blockLen=s,e.outputLen=o,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const _=(e,t,r)=>new O(e,t).update(r).digest();_.create=(e,t)=>new O(e,t);const P=BigInt(0),A=BigInt(1);function R(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function T(e){if(!R(e))throw new Error("Uint8Array expected")}function B(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)}function C(e){const t=e.toString(16);return 1&t.length?"0"+t:t}function U(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?P:BigInt("0x"+e)}const N="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,k=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function j(e){if(T(e),N)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=k[e[r]];return t}function L(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}function D(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);if(N)return Uint8Array.fromHex(e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){const t=L(e.charCodeAt(s)),r=L(e.charCodeAt(s+1));if(void 0===t||void 0===r)throw new Error('hex string expected, got non-hex character "'+(e[s]+e[s+1])+'" at index '+s);n[i]=16*t+r}return n}function q(e){return U(j(e))}function M(e){return T(e),U(j(Uint8Array.from(e).reverse()))}function $(e,t){return D(e.toString(16).padStart(2*t,"0"))}function z(e,t){return $(e,t).reverse()}function Z(e,t,r){let n;if("string"==typeof t)try{n=D(t)}catch(s){throw new Error(e+" must be hex string or Uint8Array, cause: "+s)}else{if(!R(t))throw new Error(e+" must be hex string or Uint8Array");n=Uint8Array.from(t)}const i=n.length;if("number"==typeof r&&i!==r)throw new Error(e+" of length "+r+" expected, got "+i);return n}function F(...e){let t=0;for(let n=0;n<e.length;n++){const r=e[n];T(r),t+=r.length}const r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){const t=e[n];r.set(t,i),i+=t.length}return r}const K=e=>"bigint"==typeof e&&P<=e;function V(e,t,r){return K(e)&&K(t)&&K(r)&&t<=e&&e<r}function H(e,t,r,n){if(!V(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}const W=e=>(A<<BigInt(e))-A,G=e=>new Uint8Array(e),J=e=>Uint8Array.from(e),Y={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||R(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function Q(e,t,r={}){const n=(t,r,n)=>{const i=Y[r];if("function"!=typeof i)throw new Error("invalid validator function");const s=e[t];if(!(n&&void 0===s||i(s,e)))throw new Error("param "+String(t)+" is invalid. Expected "+r+", got "+s)};for(const[i,s]of Object.entries(t))n(i,s,!1);for(const[i,s]of Object.entries(r))n(i,s,!0);return e}function X(e){const t=new WeakMap;return(r,...n)=>{const i=t.get(r);if(void 0!==i)return i;const s=e(r,...n);return t.set(r,s),s}}const ee=BigInt(0),te=BigInt(1),re=BigInt(2),ne=BigInt(3),ie=BigInt(4),se=BigInt(5),oe=BigInt(8);function ae(e,t){const r=e%t;return r>=ee?r:t+r}function ce(e,t,r){let n=e;for(;t-- >ee;)n*=n,n%=r;return n}function le(e,t){if(e===ee)throw new Error("invert: expected non-zero number");if(t<=ee)throw new Error("invert: expected positive modulus, got "+t);let r=ae(e,t),n=t,i=ee,s=te,o=te,a=ee;for(;r!==ee;){const e=n/r,t=n%r,c=i-o*e,l=s-a*e;n=r,r=t,i=o,s=a,o=c,a=l}if(n!==te)throw new Error("invert: does not exist");return ae(i,t)}function ue(e,t){const r=e.pow(t,(e.ORDER+te)/ie);if(!e.eql(e.sqr(r),t))throw new Error("Cannot find square root");return r}function fe(e,t){const r=(e.ORDER-se)/oe,n=e.mul(t,re),i=e.pow(n,r),s=e.mul(t,i),o=e.mul(e.mul(s,re),i),a=e.mul(s,e.sub(o,e.ONE));if(!e.eql(e.sqr(a),t))throw new Error("Cannot find square root");return a}const he=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function de(e,t,r=!1){const n=new Array(t.length).fill(r?e.ZERO:void 0),i=t.reduce((t,r,i)=>e.is0(r)?t:(n[i]=t,e.mul(t,r)),e.ONE),s=e.inv(i);return t.reduceRight((t,r,i)=>e.is0(r)?t:(n[i]=e.mul(t,n[i]),e.mul(t,r)),s),n}function pe(e,t){const r=e.pow(t,(e.ORDER-te)/re),n=e.eql(r,e.ONE),i=e.eql(r,e.ZERO),s=e.eql(r,e.neg(e.ONE));if(!n&&!i&&!s)throw new Error("invalid Legendre symbol result");return n?1:i?0:-1}function ge(e,t){void 0!==t&&i(t);const r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function ye(e,t,r=!1,n={}){if(e<=ee)throw new Error("invalid field: expected ORDER > 0, got "+e);const{nBitLength:i,nByteLength:s}=ge(e,t);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:e,isLE:r,BITS:i,BYTES:s,MASK:W(i),ZERO:ee,ONE:te,create:t=>ae(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return ee<=t&&t<e},is0:e=>e===ee,isOdd:e=>(e&te)===te,neg:t=>ae(-t,e),eql:(e,t)=>e===t,sqr:t=>ae(t*t,e),add:(t,r)=>ae(t+r,e),sub:(t,r)=>ae(t-r,e),mul:(t,r)=>ae(t*r,e),pow:(e,t)=>function(e,t,r){if(r<ee)throw new Error("invalid exponent, negatives unsupported");if(r===ee)return e.ONE;if(r===te)return t;let n=e.ONE,i=t;for(;r>ee;)r&te&&(n=e.mul(n,i)),i=e.sqr(i),r>>=te;return n}(a,e,t),div:(t,r)=>ae(t*le(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>le(t,e),sqrt:n.sqrt||(t=>(o||(o=function(e){return e%ie===ne?ue:e%oe===se?fe:function(e){if(e<BigInt(3))throw new Error("sqrt is not defined for small field");let t=e-te,r=0;for(;t%re===ee;)t/=re,r++;let n=re;const i=ye(e);for(;1===pe(i,n);)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===r)return ue;let s=i.pow(n,t);const o=(t+te)/re;return function(e,n){if(e.is0(n))return n;if(1!==pe(e,n))throw new Error("Cannot find square root");let i=r,a=e.mul(e.ONE,s),c=e.pow(n,t),l=e.pow(n,o);for(;!e.eql(c,e.ONE);){if(e.is0(c))return e.ZERO;let t=1,r=e.sqr(c);for(;!e.eql(r,e.ONE);)if(t++,r=e.sqr(r),t===i)throw new Error("Cannot find square root");const n=te<<BigInt(i-t-1),s=e.pow(a,n);i=t,a=e.sqr(s),c=e.mul(c,a),l=e.mul(l,s)}return l}}(e)}(e)),o(a,t))),toBytes:e=>r?z(e,s):$(e,s),fromBytes:e=>{if(e.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+e.length);return r?M(e):q(e)},invertBatch:e=>de(a,e),cmov:(e,t,r)=>r?t:e});return Object.freeze(a)}function me(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function be(e){const t=me(e);return t+Math.ceil(t/2)}const we=BigInt(0),ve=BigInt(1);function Ee(e,t){const r=t.negate();return e?r:t}function xe(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Ie(e,t){xe(e,t);const r=2**e;return{windows:Math.ceil(t/e)+1,windowSize:2**(e-1),mask:W(e),maxNumber:r,shiftBy:BigInt(e)}}function Se(e,t,r){const{windowSize:n,mask:i,maxNumber:s,shiftBy:o}=r;let a=Number(e&i),c=e>>o;a>n&&(a-=s,c+=ve);const l=t*n;return{nextN:c,offset:l+Math.abs(a)-1,isZero:0===a,isNeg:a<0,isNegF:t%2!=0,offsetF:l}}const Oe=new WeakMap,_e=new WeakMap;function Pe(e){return _e.get(e)||1}function Ae(e,t,r,n){(function(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((e,r)=>{if(!(e instanceof t))throw new Error("invalid point at index "+r)})})(r,e),function(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((e,r)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+r)})}(n,t);const i=r.length,s=n.length;if(i!==s)throw new Error("arrays of points and scalars must have equal length");const o=e.ZERO,a=function(e){let t;for(t=0;e>P;e>>=A,t+=1);return t}(BigInt(i));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=W(c),u=new Array(Number(l)+1).fill(o);let f=o;for(let h=Math.floor((t.BITS-1)/c)*c;h>=0;h-=c){u.fill(o);for(let t=0;t<s;t++){const e=Number(n[t]>>BigInt(h)&l);u[e]=u[e].add(r[t])}let e=o;for(let t=u.length-1,r=o;t>0;t--)r=r.add(u[t]),e=e.add(r);if(f=f.add(e),0!==h)for(let t=0;t<c;t++)f=f.double()}return f}function Re(e){return function(e){Q(e,he.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}(e.Fp),Q(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...ge(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}function Te(e){void 0!==e.lowS&&B("lowS",e.lowS),void 0!==e.prehash&&B("prehash",e.prehash)}class Be extends Error{constructor(e=""){super(e)}}const Ce={Err:Be,_tlv:{encode:(e,t)=>{const{Err:r}=Ce;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");const n=t.length/2,i=C(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");const s=n>127?C(i.length/2|128):"";return C(e)+s+i+t},decode(e,t){const{Err:r}=Ce;let n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");const i=t[n++];let s=0;if(128&i){const e=127&i;if(!e)throw new r("tlv.decode(long): indefinite length not supported");if(e>4)throw new r("tlv.decode(long): byte length is too big");const o=t.subarray(n,n+e);if(o.length!==e)throw new r("tlv.decode: length bytes not complete");if(0===o[0])throw new r("tlv.decode(long): zero leftmost byte");for(const t of o)s=s<<8|t;if(n+=e,s<128)throw new r("tlv.decode(long): not minimal encoding")}else s=i;const o=t.subarray(n,n+s);if(o.length!==s)throw new r("tlv.decode: wrong value length");return{v:o,l:t.subarray(n+s)}}},_int:{encode(e){const{Err:t}=Ce;if(e<Ne)throw new t("integer: negative integers are not allowed");let r=C(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){const{Err:t}=Ce;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return q(e)}},toSig(e){const{Err:t,_int:r,_tlv:n}=Ce,i=Z("signature",e),{v:s,l:o}=n.decode(48,i);if(o.length)throw new t("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,s),{v:l,l:u}=n.decode(2,c);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(e){const{_tlv:t,_int:r}=Ce,n=t.encode(2,r.encode(e.r)),i=t.encode(2,r.encode(e.s));return t.encode(48,n+i)}};function Ue(e,t){return j($(e,t))}const Ne=BigInt(0),ke=BigInt(1),je=(BigInt(2),BigInt(3)),Le=BigInt(4);function De(e){const t=function(e){const t=Re(e);return Q(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}(e),{Fp:r,n,nByteLength:i,nBitLength:s}=t,o=r.BYTES+1,a=2*r.BYTES+1;function c(e){return ae(e,n)}function l(e){return le(e,n)}const{ProjectivePoint:u,normPrivateKeyToScalar:f,weierstrassEquation:h,isWithinCurveOrder:d}=function(e){const t=function(e){const t=Re(e);Q(t,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});const{endo:r,Fp:n,a:i}=t;if(r){if(!n.eql(i,n.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...t})}(e),{Fp:r}=t,n=ye(t.n,t.nBitLength),i=t.toBytes||((e,t,n)=>{const i=t.toAffine();return F(Uint8Array.from([4]),r.toBytes(i.x),r.toBytes(i.y))}),s=t.fromBytes||(e=>{const t=e.subarray(1);return{x:r.fromBytes(t.subarray(0,r.BYTES)),y:r.fromBytes(t.subarray(r.BYTES,2*r.BYTES))}});function o(e){const{a:n,b:i}=t,s=r.sqr(e),o=r.mul(s,e);return r.add(r.add(o,r.mul(e,n)),i)}function a(e,t){const n=r.sqr(t),i=o(e);return r.eql(n,i)}if(!a(t.Gx,t.Gy))throw new Error("bad curve params: generator point");const c=r.mul(r.pow(t.a,je),Le),l=r.mul(r.sqr(t.b),BigInt(27));if(r.is0(r.add(c,l)))throw new Error("bad curve params: a or b");function u(e){const{allowedPrivateKeyLengths:r,nByteLength:n,wrapPrivateKey:i,n:s}=t;if(r&&"bigint"!=typeof e){if(R(e)&&(e=j(e)),"string"!=typeof e||!r.includes(e.length))throw new Error("invalid private key");e=e.padStart(2*n,"0")}let o;try{o="bigint"==typeof e?e:q(Z("private key",e,n))}catch{throw new Error("invalid private key, expected hex or "+n+" bytes, got "+typeof e)}return i&&(o=ae(o,s)),H("private key",o,ke,s),o}function f(e){if(!(e instanceof p))throw new Error("ProjectivePoint expected")}const h=X((e,t)=>{const{px:n,py:i,pz:s}=e;if(r.eql(s,r.ONE))return{x:n,y:i};const o=e.is0();null==t&&(t=o?r.ONE:r.inv(s));const a=r.mul(n,t),c=r.mul(i,t),l=r.mul(s,t);if(o)return{x:r.ZERO,y:r.ZERO};if(!r.eql(l,r.ONE))throw new Error("invZ was invalid");return{x:a,y:c}}),d=X(e=>{if(e.is0()){if(t.allowInfinityPoint&&!r.is0(e.py))return;throw new Error("bad point: ZERO")}const{x:n,y:i}=e.toAffine();if(!r.isValid(n)||!r.isValid(i))throw new Error("bad point: x or y not FE");if(!a(n,i))throw new Error("bad point: equation left != right");if(!e.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class p{constructor(e,t,n){if(null==e||!r.isValid(e))throw new Error("x required");if(null==t||!r.isValid(t)||r.is0(t))throw new Error("y required");if(null==n||!r.isValid(n))throw new Error("z required");this.px=e,this.py=t,this.pz=n,Object.freeze(this)}static fromAffine(e){const{x:t,y:n}=e||{};if(!e||!r.isValid(t)||!r.isValid(n))throw new Error("invalid affine point");if(e instanceof p)throw new Error("projective point not allowed");const i=e=>r.eql(e,r.ZERO);return i(t)&&i(n)?p.ZERO:new p(t,n,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){const t=de(r,e.map(e=>e.pz));return e.map((e,r)=>e.toAffine(t[r])).map(p.fromAffine)}static fromHex(e){const t=p.fromAffine(s(Z("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return p.BASE.multiply(u(e))}static msm(e,t){return Ae(p,n,e,t)}_setWindowSize(e){m.setWindowSize(this,e)}assertValidity(){d(this)}hasEvenY(){const{y:e}=this.toAffine();if(r.isOdd)return!r.isOdd(e);throw new Error("Field doesn't support isOdd")}equals(e){f(e);const{px:t,py:n,pz:i}=this,{px:s,py:o,pz:a}=e,c=r.eql(r.mul(t,a),r.mul(s,i)),l=r.eql(r.mul(n,a),r.mul(o,i));return c&&l}negate(){return new p(this.px,r.neg(this.py),this.pz)}double(){const{a:e,b:n}=t,i=r.mul(n,je),{px:s,py:o,pz:a}=this;let c=r.ZERO,l=r.ZERO,u=r.ZERO,f=r.mul(s,s),h=r.mul(o,o),d=r.mul(a,a),g=r.mul(s,o);return g=r.add(g,g),u=r.mul(s,a),u=r.add(u,u),c=r.mul(e,u),l=r.mul(i,d),l=r.add(c,l),c=r.sub(h,l),l=r.add(h,l),l=r.mul(c,l),c=r.mul(g,c),u=r.mul(i,u),d=r.mul(e,d),g=r.sub(f,d),g=r.mul(e,g),g=r.add(g,u),u=r.add(f,f),f=r.add(u,f),f=r.add(f,d),f=r.mul(f,g),l=r.add(l,f),d=r.mul(o,a),d=r.add(d,d),f=r.mul(d,g),c=r.sub(c,f),u=r.mul(d,h),u=r.add(u,u),u=r.add(u,u),new p(c,l,u)}add(e){f(e);const{px:n,py:i,pz:s}=this,{px:o,py:a,pz:c}=e;let l=r.ZERO,u=r.ZERO,h=r.ZERO;const d=t.a,g=r.mul(t.b,je);let y=r.mul(n,o),m=r.mul(i,a),b=r.mul(s,c),w=r.add(n,i),v=r.add(o,a);w=r.mul(w,v),v=r.add(y,m),w=r.sub(w,v),v=r.add(n,s);let E=r.add(o,c);return v=r.mul(v,E),E=r.add(y,b),v=r.sub(v,E),E=r.add(i,s),l=r.add(a,c),E=r.mul(E,l),l=r.add(m,b),E=r.sub(E,l),h=r.mul(d,v),l=r.mul(g,b),h=r.add(l,h),l=r.sub(m,h),h=r.add(m,h),u=r.mul(l,h),m=r.add(y,y),m=r.add(m,y),b=r.mul(d,b),v=r.mul(g,v),m=r.add(m,b),b=r.sub(y,b),b=r.mul(d,b),v=r.add(v,b),y=r.mul(m,v),u=r.add(u,y),y=r.mul(E,v),l=r.mul(w,l),l=r.sub(l,y),y=r.mul(w,m),h=r.mul(E,h),h=r.add(h,y),new p(l,u,h)}subtract(e){return this.add(e.negate())}is0(){return this.equals(p.ZERO)}wNAF(e){return m.wNAFCached(this,e,p.normalizeZ)}multiplyUnsafe(e){const{endo:n,n:i}=t;H("scalar",e,Ne,i);const s=p.ZERO;if(e===Ne)return s;if(this.is0()||e===ke)return this;if(!n||m.hasPrecomputes(this))return m.wNAFCachedUnsafe(this,e,p.normalizeZ);let{k1neg:o,k1:a,k2neg:c,k2:l}=n.splitScalar(e),u=s,f=s,h=this;for(;a>Ne||l>Ne;)a&ke&&(u=u.add(h)),l&ke&&(f=f.add(h)),h=h.double(),a>>=ke,l>>=ke;return o&&(u=u.negate()),c&&(f=f.negate()),f=new p(r.mul(f.px,n.beta),f.py,f.pz),u.add(f)}multiply(e){const{endo:n,n:i}=t;let s,o;if(H("scalar",e,ke,i),n){const{k1neg:t,k1:i,k2neg:a,k2:c}=n.splitScalar(e);let{p:l,f:u}=this.wNAF(i),{p:f,f:h}=this.wNAF(c);l=m.constTimeNegate(t,l),f=m.constTimeNegate(a,f),f=new p(r.mul(f.px,n.beta),f.py,f.pz),s=l.add(f),o=u.add(h)}else{const{p:t,f:r}=this.wNAF(e);s=t,o=r}return p.normalizeZ([s,o])[0]}multiplyAndAddUnsafe(e,t,r){const n=p.BASE,i=(e,t)=>t!==Ne&&t!==ke&&e.equals(n)?e.multiply(t):e.multiplyUnsafe(t),s=i(this,t).add(i(e,r));return s.is0()?void 0:s}toAffine(e){return h(this,e)}isTorsionFree(){const{h:e,isTorsionFree:r}=t;if(e===ke)return!0;if(r)return r(p,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:e,clearCofactor:r}=t;return e===ke?this:r?r(p,this):this.multiplyUnsafe(t.h)}toRawBytes(e=!0){return B("isCompressed",e),this.assertValidity(),i(p,this,e)}toHex(e=!0){return B("isCompressed",e),j(this.toRawBytes(e))}}p.BASE=new p(t.Gx,t.Gy,r.ONE),p.ZERO=new p(r.ZERO,r.ONE,r.ZERO);const{endo:g,nBitLength:y}=t,m=function(e,t){return{constTimeNegate:Ee,hasPrecomputes:e=>1!==Pe(e),unsafeLadder(t,r,n=e.ZERO){let i=t;for(;r>we;)r&ve&&(n=n.add(i)),i=i.double(),r>>=ve;return n},precomputeWindow(e,r){const{windows:n,windowSize:i}=Ie(r,t),s=[];let o=e,a=o;for(let t=0;t<n;t++){a=o,s.push(a);for(let e=1;e<i;e++)a=a.add(o),s.push(a);o=a.double()}return s},wNAF(r,n,i){let s=e.ZERO,o=e.BASE;const a=Ie(r,t);for(let e=0;e<a.windows;e++){const{nextN:t,offset:r,isZero:c,isNeg:l,isNegF:u,offsetF:f}=Se(i,e,a);i=t,c?o=o.add(Ee(u,n[f])):s=s.add(Ee(l,n[r]))}return{p:s,f:o}},wNAFUnsafe(r,n,i,s=e.ZERO){const o=Ie(r,t);for(let e=0;e<o.windows&&i!==we;e++){const{nextN:t,offset:r,isZero:a,isNeg:c}=Se(i,e,o);if(i=t,!a){const e=n[r];s=s.add(c?e.negate():e)}}return s},getPrecomputes(e,t,r){let n=Oe.get(t);return n||(n=this.precomputeWindow(t,e),1!==e&&Oe.set(t,r(n))),n},wNAFCached(e,t,r){const n=Pe(e);return this.wNAF(n,this.getPrecomputes(n,e,r),t)},wNAFCachedUnsafe(e,t,r,n){const i=Pe(e);return 1===i?this.unsafeLadder(e,t,n):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),t,n)},setWindowSize(e,r){xe(r,t),_e.set(e,r),Oe.delete(e)}}}(p,g?Math.ceil(y/2):y);return{CURVE:t,ProjectivePoint:p,normPrivateKeyToScalar:u,weierstrassEquation:o,isWithinCurveOrder:function(e){return V(e,ke,t.n)}}}({...t,toBytes(e,t,n){const i=t.toAffine(),s=r.toBytes(i.x),o=F;return B("isCompressed",n),n?o(Uint8Array.from([t.hasEvenY()?2:3]),s):o(Uint8Array.from([4]),s,r.toBytes(i.y))},fromBytes(e){const t=e.length,n=e[0],i=e.subarray(1);if(t!==o||2!==n&&3!==n){if(t===a&&4===n)return{x:r.fromBytes(i.subarray(0,r.BYTES)),y:r.fromBytes(i.subarray(r.BYTES,2*r.BYTES))};throw new Error("invalid Point, expected length of "+o+", or uncompressed "+a+", got "+t)}{const e=q(i);if(!V(e,ke,r.ORDER))throw new Error("Point is not on curve");const t=h(e);let o;try{o=r.sqrt(t)}catch(s){const e=s instanceof Error?": "+s.message:"";throw new Error("Point is not on curve"+e)}return 1==(1&n)!=((o&ke)===ke)&&(o=r.neg(o)),{x:e,y:o}}}});function p(e){return e>n>>ke}const g=(e,t,r)=>q(e.slice(t,r));class y{constructor(e,t,r){H("r",e,ke,n),H("s",t,ke,n),this.r=e,this.s=t,null!=r&&(this.recovery=r),Object.freeze(this)}static fromCompact(e){const t=i;return e=Z("compactSignature",e,2*t),new y(g(e,0,t),g(e,t,2*t))}static fromDER(e){const{r:t,s:r}=Ce.toSig(Z("DER",e));return new y(t,r)}assertValidity(){}addRecoveryBit(e){return new y(this.r,this.s,e)}recoverPublicKey(e){const{r:n,s:i,recovery:s}=this,o=v(Z("msgHash",e));if(null==s||![0,1,2,3].includes(s))throw new Error("recovery id invalid");const a=2===s||3===s?n+t.n:n;if(a>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const f=u.fromHex((0==(1&s)?"02":"03")+Ue(a,r.BYTES)),h=l(a),d=c(-o*h),p=c(i*h),g=u.BASE.multiplyAndAddUnsafe(f,d,p);if(!g)throw new Error("point at infinify");return g.assertValidity(),g}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new y(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return D(this.toDERHex())}toDERHex(){return Ce.hexFromSig(this)}toCompactRawBytes(){return D(this.toCompactHex())}toCompactHex(){const e=i;return Ue(this.r,e)+Ue(this.s,e)}}const m={isValidPrivateKey(e){try{return f(e),!0}catch{return!1}},normPrivateKeyToScalar:f,randomPrivateKey:()=>{const e=be(t.n);return function(e,t,r=!1){const n=e.length,i=me(t),s=be(t);if(n<16||n<s||n>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+n);const o=ae(r?M(e):q(e),t-te)+te;return r?z(o,i):$(o,i)}(t.randomBytes(e),t.n)},precompute:(e=8,t=u.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)};function b(e){if("bigint"==typeof e)return!1;if(e instanceof u)return!0;const n=Z("key",e).length,s=r.BYTES,o=s+1;return t.allowedPrivateKeyLengths||i===o?void 0:n===o||n===2*s+1}const w=t.bits2int||function(e){if(e.length>8192)throw new Error("input is too large");const t=q(e),r=8*e.length-s;return r>0?t>>BigInt(r):t},v=t.bits2int_modN||function(e){return c(w(e))},E=W(s);function x(e){return H("num < 2^"+s,e,Ne,E),$(e,i)}const I={lowS:t.lowS,prehash:!1},S={lowS:t.lowS,prehash:!1};return u.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e,t=!0){return u.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t,r=!0){if(!0===b(e))throw new Error("first arg must be private key");if(!1===b(t))throw new Error("second arg must be public key");return u.fromHex(t).multiply(f(e)).toRawBytes(r)},sign:function(e,n,i=I){const{seed:s,k2sig:o}=function(e,n,i=I){if(["recovered","canonical"].some(e=>e in i))throw new Error("sign() legacy options not supported");const{hash:s,randomBytes:o}=t;let{lowS:a,prehash:h,extraEntropy:g}=i;null==a&&(a=!0),e=Z("msgHash",e),Te(i),h&&(e=Z("prehashed msgHash",s(e)));const m=v(e),b=f(n),E=[x(b),x(m)];if(null!=g&&!1!==g){const e=!0===g?o(r.BYTES):g;E.push(Z("extraEntropy",e))}const S=F(...E),O=m;return{seed:S,k2sig:function(e){const t=w(e);if(!d(t))return;const r=l(t),n=u.BASE.multiply(t).toAffine(),i=c(n.x);if(i===Ne)return;const s=c(r*c(O+i*b));if(s===Ne)return;let o=(n.x===i?0:2)|Number(n.y&ke),f=s;return a&&p(s)&&(f=function(e){return p(e)?c(-e):e}(s),o^=1),new y(i,f,o)}}}(e,n,i);return function(e,t,r){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof r)throw new Error("hmacFn must be a function");let n=G(e),i=G(e),s=0;const o=()=>{n.fill(1),i.fill(0),s=0},a=(...e)=>r(i,n,...e),c=(e=G(0))=>{i=a(J([0]),e),n=a(),0!==e.length&&(i=a(J([1]),e),n=a())},l=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const r=[];for(;e<t;){n=a();const t=n.slice();r.push(t),e+=n.length}return F(...r)};return(e,t)=>{let r;for(o(),c(e);!(r=t(l()));)c();return o(),r}}(t.hash.outputLen,t.nByteLength,t.hmac)(s,o)},verify:function(e,r,n,i=S){const s=e;r=Z("msgHash",r),n=Z("publicKey",n);const{lowS:o,prehash:a,format:f}=i;if(Te(i),"strict"in i)throw new Error("options.strict was renamed to lowS");if(void 0!==f&&"compact"!==f&&"der"!==f)throw new Error("format must be compact or der");const h="string"==typeof s||R(s),d=!h&&!f&&"object"==typeof s&&null!==s&&"bigint"==typeof s.r&&"bigint"==typeof s.s;if(!h&&!d)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let p,g;try{if(d&&(p=new y(s.r,s.s)),h){try{"compact"!==f&&(p=y.fromDER(s))}catch(_){if(!(_ instanceof Ce.Err))throw _}!p&&"der"!==f&&(p=y.fromCompact(s))}g=u.fromHex(n)}catch{return!1}if(!p||o&&p.hasHighS())return!1;a&&(r=t.hash(r));const{r:m,s:b}=p,w=v(r),E=l(b),x=c(w*E),I=c(m*E),O=u.BASE.multiplyAndAddUnsafe(g,x,I)?.toAffine();return!!O&&c(O.x)===m},ProjectivePoint:u,Signature:y,utils:m}}function qe(e){return{hash:e,hmac:(t,...r)=>_(e,t,function(...e){let t=0;for(let n=0;n<e.length;n++){const r=e[n];s(r),t+=r.length}const r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){const t=e[n];r.set(t,i),i+=t.length}return r}(...r)),randomBytes:y}}const Me=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),$e=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),ze=BigInt(0),Ze=BigInt(1),Fe=BigInt(2),Ke=(e,t)=>(e+t/Fe)/t;const Ve=ye(Me,void 0,void 0,{sqrt:function(e){const t=Me,r=BigInt(3),n=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=e*e*e%t,u=l*l*e%t,f=ce(u,r,t)*u%t,h=ce(f,r,t)*u%t,d=ce(h,Fe,t)*l%t,p=ce(d,i,t)*d%t,g=ce(p,s,t)*p%t,y=ce(g,a,t)*g%t,m=ce(y,c,t)*y%t,b=ce(m,a,t)*g%t,w=ce(b,r,t)*u%t,v=ce(w,o,t)*p%t,E=ce(v,n,t)*l%t,x=ce(E,Fe,t);if(!Ve.eql(Ve.sqr(x),e))throw new Error("Cannot find square root");return x}}),He=function(e,t){const r=t=>De({...e,...qe(t)});return{...r(t),create:r}}({a:ze,b:BigInt(7),Fp:Ve,n:$e,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=$e,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-Ze*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=BigInt("0x100000000000000000000000000000000"),a=Ke(s*e,t),c=Ke(-n*e,t);let l=ae(e-a*r-c*i,t),u=ae(-a*n-c*s,t);const f=l>o,h=u>o;if(f&&(l=t-l),h&&(u=t-u),l>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:f,k1:l,k2neg:h,k2:u}}}},S);var We=r(47737),Ge=r(89062);function Je(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}var Ye=r(85900),Qe=r(36125);const Xe=new TextEncoder;function et(e){return e instanceof Uint8Array?e:"string"==typeof e?function(e,t={}){const{size:r}=t;let n=e;r&&(Ye.Yf(e,r),n=Ge.eh(e,r));let i=n.slice(2);i.length%2&&(i=`0${i}`);const s=i.length/2,o=new Uint8Array(s);for(let a=0,c=0;a<s;a++){const e=Je(i.charCodeAt(c++)),t=Je(i.charCodeAt(c++));if(void 0===e||void 0===t)throw new We.G(`Invalid byte sequence ("${i[c-2]}${i[c-1]}" in "${i}").`);o[a]=16*e+t}return o}(e):function(e){return e instanceof Uint8Array?e:new Uint8Array(e)}(e)}function tt(e){return e.length}class rt extends We.G{constructor(e){super(`Value \`${"object"==typeof e?Qe.P(e):e}\` of type \`${typeof e}\` is an invalid Bytes value.`,{metaMessages:["Bytes values must be of type `Bytes`."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.InvalidBytesTypeError"})}}class nt extends We.G{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed \`${t}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}}class it extends We.G{constructor({size:e,targetSize:t,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${t}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}}class st extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const t=super.get(e);return super.has(e)&&void 0!==t&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){const e=this.keys().next().value;e&&this.delete(e)}return this}}const ot={checksum:new st(8192)}.checksum,at=BigInt(2**32-1),ct=BigInt(32);function lt(e,t=!1){return t?{h:Number(e&at),l:Number(e>>ct&at)}:{h:0|Number(e>>ct&at),l:0|Number(e&at)}}const ut=BigInt(0),ft=BigInt(1),ht=BigInt(2),dt=BigInt(7),pt=BigInt(256),gt=BigInt(113),yt=[],mt=[],bt=[];for(let Zt=0,Ft=ft,Kt=1,Vt=0;Zt<24;Zt++){[Kt,Vt]=[Vt,(2*Kt+3*Vt)%5],yt.push(2*(5*Vt+Kt)),mt.push((Zt+1)*(Zt+2)/2%64);let e=ut;for(let t=0;t<7;t++)Ft=(Ft<<ft^(Ft>>dt)*gt)%pt,Ft&ht&&(e^=ft<<(ft<<BigInt(t))-ft);bt.push(e)}const wt=function(e,t=!1){const r=e.length;let n=new Uint32Array(r),i=new Uint32Array(r);for(let s=0;s<r;s++){const{h:r,l:o}=lt(e[s],t);[n[s],i[s]]=[r,o]}return[n,i]}(bt,!0),vt=wt[0],Et=wt[1],xt=(e,t,r)=>r>32?((e,t,r)=>t<<r-32|e>>>64-r)(e,t,r):((e,t,r)=>e<<r|t>>>32-r)(e,t,r),It=(e,t,r)=>r>32?((e,t,r)=>e<<r-32|t>>>64-r)(e,t,r):((e,t,r)=>t<<r|e>>>32-r)(e,t,r);class St extends p{constructor(e,t,r,n=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=n,this.rounds=s,i(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");var o;this.state=new Uint8Array(200),this.state32=(o=this.state,new Uint32Array(o.buffer,o.byteOffset,Math.floor(o.byteLength/4)))}clone(){return this._cloneInto()}keccak(){h(this.state32),function(e,t=24){const r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let n=0;n<10;n++)r[n]=e[n]^e[n+10]^e[n+20]^e[n+30]^e[n+40];for(let n=0;n<10;n+=2){const t=(n+8)%10,i=(n+2)%10,s=r[i],o=r[i+1],a=xt(s,o,1)^r[t],c=It(s,o,1)^r[t+1];for(let r=0;r<50;r+=10)e[n+r]^=a,e[n+r+1]^=c}let t=e[2],i=e[3];for(let r=0;r<24;r++){const n=mt[r],s=xt(t,i,n),o=It(t,i,n),a=yt[r];t=e[a],i=e[a+1],e[a]=s,e[a+1]=o}for(let n=0;n<50;n+=10){for(let t=0;t<10;t++)r[t]=e[n+t];for(let t=0;t<10;t++)e[n+t]^=~r[(t+2)%10]&r[(t+4)%10]}e[0]^=vt[n],e[1]^=Et[n]}c(r)}(this.state32,this.rounds),h(this.state32),this.posOut=0,this.pos=0}update(e){o(this),s(e=d(e));const{blockLen:t,state:r}=this,n=e.length;for(let i=0;i<n;){const s=Math.min(t-this.pos,n-i);for(let t=0;t<s;t++)r[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:n}=this;e[r]^=t,0!=(128&t)&&r===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}writeInto(e){o(this,!1),s(e),this.finish();const t=this.state,{blockLen:r}=this;for(let n=0,i=e.length;n<i;){this.posOut>=r&&this.keccak();const s=Math.min(r-this.posOut,i-n);e.set(t.subarray(this.posOut,this.posOut+s),n),this.posOut+=s,n+=s}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return i(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(a(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,c(this.state)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:n,rounds:i,enableXOF:s}=this;return e||(e=new St(t,r,n,s,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=n,e.enableXOF=s,e.destroyed=this.destroyed,e}}const Ot=(()=>(1,136,32,g(()=>new St(136,1,32))))();function _t(e,t={}){const{as:r=("string"==typeof e?"Hex":"Bytes")}=t,n=Ot(et(e));return"Bytes"===r?n:Ge.xv(n)}function Pt(e,t={}){const{compressed:r}=t,{prefix:n,x:i,y:s}=e;if(!1===r||"bigint"==typeof i&&"bigint"==typeof s){if(4!==n)throw new Bt({prefix:n,cause:new Ut})}else{if(!0!==r&&("bigint"!=typeof i||void 0!==s))throw new Tt({publicKey:e});if(3!==n&&2!==n)throw new Bt({prefix:n,cause:new Ct})}}function At(e){const t=(()=>{if(Ge.Gu(e))return Rt(e);if(function(e){try{return function(e){if(!(e instanceof Uint8Array)){if(!e)throw new rt(e);if("object"!=typeof e)throw new rt(e);if(!("BYTES_PER_ELEMENT"in e))throw new rt(e);if(1!==e.BYTES_PER_ELEMENT||"Uint8Array"!==e.constructor.name)throw new rt(e)}}(e),!0}catch{return!1}}(e))return function(e){return Rt(Ge.xv(e))}(e);const{prefix:t,x:r,y:n}=e;return"bigint"==typeof r&&"bigint"==typeof n?{prefix:t??4,x:r,y:n}:{prefix:t,x:r}})();return Pt(t),t}function Rt(e){if(132!==e.length&&130!==e.length&&68!==e.length)throw new Nt({publicKey:e});return 130===e.length?{prefix:4,x:BigInt(Ge.tP(e,0,32)),y:BigInt(Ge.tP(e,32,64))}:132===e.length?{prefix:Number(Ge.tP(e,0,1)),x:BigInt(Ge.tP(e,1,33)),y:BigInt(Ge.tP(e,33,65))}:{prefix:Number(Ge.tP(e,0,1)),x:BigInt(Ge.tP(e,1,33))}}class Tt extends We.G{constructor({publicKey:e}){super(`Value \`${Qe.P(e)}\` is not a valid public key.`,{metaMessages:["Public key must contain:","- an `x` and `prefix` value (compressed)","- an `x`, `y`, and `prefix` value (uncompressed)"]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidError"})}}class Bt extends We.G{constructor({prefix:e,cause:t}){super(`Prefix "${e}" is invalid.`,{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidPrefixError"})}}class Ct extends We.G{constructor(){super("Prefix must be 2 or 3 for compressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidCompressedPrefixError"})}}class Ut extends We.G{constructor(){super("Prefix must be 4 for uncompressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidUncompressedPrefixError"})}}class Nt extends We.G{constructor({publicKey:e}){super(`Value \`${e}\` is an invalid public key size.`,{metaMessages:["Expected: 33 bytes (compressed + prefix), 64 bytes (uncompressed) or 65 bytes (uncompressed + prefix).",`Received ${Ge.dp(Ge.Dp(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidSerializedSizeError"})}}const kt=/^0x[a-fA-F0-9]{40}$/;function jt(e,t={}){const{strict:r=!0}=t;if(!kt.test(e))throw new qt({address:e,cause:new Mt});if(r){if(e.toLowerCase()===e)return;if(Lt(e)!==e)throw new qt({address:e,cause:new $t})}}function Lt(e){if(ot.has(e))return ot.get(e);jt(e,{strict:!1});const t=e.substring(2).toLowerCase(),r=_t(function(e,t={}){const{size:r}=t,n=Xe.encode(e);return"number"==typeof r?(function(e,t){if(tt(e)>t)throw new nt({givenSize:tt(e),maxSize:t})}(n,r),function(e,t){return function(e,t={}){const{dir:r,size:n=32}=t;if(0===n)return e;if(e.length>n)throw new it({size:e.length,targetSize:n,type:"Bytes"});const i=new Uint8Array(n);for(let s=0;s<n;s++){const t="right"===r;i[t?s:n-s-1]=e[t?s:e.length-s-1]}return i}(e,{dir:"right",size:t})}(n,r)):n}(t),{as:"Bytes"}),n=t.split("");for(let s=0;s<40;s+=2)r[s>>1]>>4>=8&&n[s]&&(n[s]=n[s].toUpperCase()),(15&r[s>>1])>=8&&n[s+1]&&(n[s+1]=n[s+1].toUpperCase());const i=`0x${n.join("")}`;return ot.set(e,i),i}function Dt(e,t={}){return function(e,t={}){const{checksum:r=!1}=t;return jt(e),r?Lt(e):e}(`0x${_t(`0x${function(e,t={}){Pt(e);const{prefix:r,x:n,y:i}=e,{includePrefix:s=!0}=t;return Ge.zo(s?Ge.xS(r,{size:1}):"0x",Ge.xS(n,{size:32}),"bigint"==typeof i?Ge.xS(i,{size:32}):"0x")}(e).slice(4)}`).substring(26)}`,t)}class qt extends We.G{constructor({address:e,cause:t}){super(`Address "${e}" is invalid.`,{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}}class Mt extends We.G{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}}class $t extends We.G{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}}function zt(e){return Dt(function(e){const{payload:t,signature:r}=e,{r:n,s:i,yParity:s}=r;return At(new He.Signature(BigInt(n),BigInt(i)).addRecoveryBit(s).recoverPublicKey(Ge.Dp(t).substring(2)))}(e))}},13324:function(e,t,r){"use strict";r.d(t,{H_:function(){return s}});var n=r(47737),i=r(89062);function s(e){if(130!==e.length&&132!==e.length)throw new o({signature:e});const t=BigInt(i.tP(e,0,32)),r=BigInt(i.tP(e,32,64)),n=(()=>{const t=Number(`0x${e.slice(130)}`);if(!Number.isNaN(t))try{return function(e){if(0===e||27===e)return 0;if(1===e||28===e)return 1;if(e>=35)return e%2==0?1:0;throw new c({value:e})}(t)}catch{throw new a({value:t})}})();return void 0===n?{r:t,s:r}:{r:t,s:r,yParity:n}}class o extends n.G{constructor({signature:e}){super(`Value \`${e}\` is an invalid signature size.`,{metaMessages:["Expected: 64 bytes or 65 bytes.",`Received ${i.dp(i.Dp(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSerializedSizeError"})}}class a extends n.G{constructor({value:e}){super(`Value \`${e}\` is an invalid y-parity value. Y-parity must be 0 or 1.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidYParityError"})}}class c extends n.G{constructor({value:e}){super(`Value \`${e}\` is an invalid v value. v must be 27, 28 or >=35.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidVError"})}}},85900:function(e,t,r){"use strict";r.d(t,{Yf:function(){return i},EM:function(){return s},Ro:function(){return o},vk:function(){return a}});var n=r(89062);function i(e,t){if(n.dp(e)>t)throw new n.M6({givenSize:n.dp(e),maxSize:t})}function s(e,t){if("number"==typeof t&&t>0&&t>n.dp(e)-1)throw new n.mV({offset:t,position:"start",size:n.dp(e)})}function o(e,t,r){if("number"==typeof t&&"number"==typeof r&&n.dp(e)!==r-t)throw new n.mV({offset:r,position:"end",size:n.dp(e)})}function a(e,t={}){const{dir:r,size:i=32}=t;if(0===i)return e;const s=e.replace("0x","");if(s.length>2*i)throw new n.$s({size:Math.ceil(s.length/2),targetSize:i,type:"Hex"});return`0x${s["right"===r?"padEnd":"padStart"](2*i,"0")}`}},51462:function(e,t,r){"use strict";r.d(t,{zo:function(){return w},mL:function(){return $e},BB:function(){return ze}});var n={};r.r(n),r.d(n,{identity:function(){return R}});var i={};r.r(i),r.d(i,{base2:function(){return T}});var s={};r.r(s),r.d(s,{base8:function(){return B}});var o={};r.r(o),r.d(o,{base10:function(){return C}});var a={};r.r(a),r.d(a,{base16:function(){return U},base16upper:function(){return N}});var c={};r.r(c),r.d(c,{base32:function(){return k},base32hex:function(){return q},base32hexpad:function(){return $},base32hexpadupper:function(){return z},base32hexupper:function(){return M},base32pad:function(){return L},base32padupper:function(){return D},base32upper:function(){return j},base32z:function(){return Z}});var l={};r.r(l),r.d(l,{base36:function(){return F},base36upper:function(){return K}});var u={};r.r(u),r.d(u,{base58btc:function(){return V},base58flickr:function(){return H}});var f={};r.r(f),r.d(f,{base64:function(){return W},base64pad:function(){return G},base64url:function(){return J},base64urlpad:function(){return Y}});var h={};r.r(h),r.d(h,{base256emoji:function(){return te}});var d={};r.r(d),r.d(d,{sha256:function(){return xe},sha512:function(){return Ie}});var p={};r.r(p),r.d(p,{identity:function(){return Oe}});var g={};r.r(g),r.d(g,{code:function(){return Pe},decode:function(){return Re},encode:function(){return Ae},name:function(){return _e}});var y={};function m(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function b(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?m(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function w(e,t){t||(t=e.reduce((e,t)=>e+t.length,0));const r=b(t);let n=0;for(const i of e)r.set(i,n),n+=i.length;return m(r)}r.r(y),r.d(y,{code:function(){return Ue},decode:function(){return ke},encode:function(){return Ne},name:function(){return Ce}});new Uint8Array(0);const v=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};class E{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class x{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return S(this,e)}}class I{constructor(e){this.decoders=e}or(e){return S(this,e)}decode(e){const t=this.decoders[e[0]];if(t)return t.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const S=(e,t)=>new I({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class O{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new E(e,t,r),this.decoder=new x(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const _=({name:e,prefix:t,encode:r,decode:n})=>new O(e,t,r,n),P=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function f(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var f=0,h=s-1;(0!==u||f<i)&&-1!==h;h--,f++)o[h]=(u+=a*o[h]>>>0)%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=f,t++}if(" "!==e[t]){for(var d=s-i;d!==s&&0===o[d];)d++;for(var p=new Uint8Array(n+(s-d)),g=n;d!==s;)p[g++]=o[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,s=t.length;i!==s&&0===t[i];)i++,r++;for(var o=(s-i)*u+1>>>0,l=new Uint8Array(o);i!==s;){for(var f=t[i],h=0,d=o-1;(0!==f||h<n)&&-1!==d;d--,h++)l[d]=(f+=256*l[d]>>>0)%a>>>0,f=f/a>>>0;if(0!==f)throw new Error("Non-zero carry");n=h,i++}for(var p=o-n;p!==o&&0===l[p];)p++;for(var g=c.repeat(r);p<o;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:f,decode:function(e){var r=f(e);if(r)return r;throw new Error(`Non-${t} character`)}}}(r,t);return _({prefix:e,name:t,encode:n,decode:e=>v(i(e))})},A=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>_({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;for(;"="===e[s-1];)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError(`Non-${n} character`);c=c<<r|t,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),R=_({prefix:"\0",name:"identity",encode:e=>(e=>(new TextDecoder).decode(e))(e),decode:e=>(e=>(new TextEncoder).encode(e))(e)}),T=A({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),B=A({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),C=P({prefix:"9",name:"base10",alphabet:"0123456789"}),U=A({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),N=A({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),k=A({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),j=A({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),L=A({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),D=A({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),q=A({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),M=A({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),$=A({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),z=A({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Z=A({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),F=P({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),K=P({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),V=P({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),H=P({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),W=A({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),G=A({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),J=A({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Y=A({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Q=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),X=Q.reduce((e,t,r)=>(e[r]=t,e),[]),ee=Q.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]),te=_({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+X[t],"")},decode:function(e){const t=[];for(const r of e){const e=ee[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var re=r(8239),ne=Math.pow(2,31),ie=Math.pow(2,7),se=Math.pow(2,14),oe=Math.pow(2,21),ae=Math.pow(2,28),ce=Math.pow(2,35),le=Math.pow(2,42),ue=Math.pow(2,49),fe=Math.pow(2,56),he=Math.pow(2,63),de=function e(t,r,n){r=r||[];for(var i=n=n||0;t>=ne;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},pe=function(e){return e<ie?1:e<se?2:e<oe?3:e<ae?4:e<ce?5:e<le?6:e<ue?7:e<fe?8:e<he?9:10};const ge=(e,t,r=0)=>(de(e,t,r),t),ye=e=>pe(e),me=(e,t)=>{const r=t.byteLength,n=ye(e),i=n+ye(r),s=new Uint8Array(i+r);return ge(e,s,0),ge(r,s,n),s.set(t,i),new be(e,r,t,s)};class be{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const we=({name:e,code:t,encode:r})=>new ve(e,t,r);class ve{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?me(this.code,t):t.then(e=>me(this.code,e))}throw Error("Unknown type, must be binary type")}}const Ee=e=>function(){var t=(0,re.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(e,t))});return function(e){return t.apply(this,arguments)}}(),xe=we({name:"sha2-256",code:18,encode:Ee("SHA-256")}),Ie=we({name:"sha2-512",code:19,encode:Ee("SHA-512")}),Se=v,Oe={code:0,name:"identity",encode:Se,digest:e=>me(0,Se(e))},_e="raw",Pe=85,Ae=e=>v(e),Re=e=>v(e),Te=new TextEncoder,Be=new TextDecoder,Ce="json",Ue=512,Ne=e=>Te.encode(JSON.stringify(e)),ke=e=>JSON.parse(Be.decode(e));Symbol,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");const je={...n,...i,...s,...o,...a,...c,...l,...u,...f,...h};function Le(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const De=Le("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>(new TextEncoder).encode(e.substring(1))),qe=Le("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{const t=b((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t});var Me={utf8:De,"utf-8":De,hex:je.base16,latin1:qe,ascii:qe,binary:qe,...je};function $e(e,t="utf8"){const r=Me[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):m(globalThis.Buffer.from(e,"utf-8"))}function ze(e,t="utf8"){const r=Me[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}},64697:function(e,t,r){"use strict";function n(e){this.wrapped=e}r.d(t,{Z:function(){return n}})},19663:function(e,t,r){"use strict";function n(e,t){var r={},n=!1;function i(r,i){return n=!0,i=new Promise(function(t){t(e[r](i))}),{done:!1,value:t(i)}}return r["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},r.next=function(e){return n?(n=!1,e):i("next",e)},"function"==typeof e.throw&&(r.throw=function(e){if(n)throw n=!1,e;return i("throw",e)}),"function"==typeof e.return&&(r.return=function(e){return n?(n=!1,e):i("return",e)}),r}r.d(t,{Z:function(){return n}})},48415:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(64697);function i(e){return new n.Z(e)}},5640:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(64697);function i(e){var t,r;function i(t,r){try{var o=e[t](r),a=o.value,c=a instanceof n.Z;Promise.resolve(c?a.wrapped:a).then(function(e){c?i("return"===t?"return":"next",e):s(o.done?"return":"normal",e)},function(e){i("throw",e)})}catch(l){s("throw",l)}}function s(e,n){switch(e){case"return":t.resolve({value:n,done:!0});break;case"throw":t.reject(n);break;default:t.resolve({value:n,done:!1})}(t=t.next)?i(t.key,t.arg):r=null}this._invoke=function(e,n){return new Promise(function(s,o){var a={key:e,arg:n,resolve:s,reject:o,next:null};r?r=r.next=a:(t=r=a,i(e,n))})},"function"!=typeof e.return&&(this.return=void 0)}function s(e){return function(){return new i(e.apply(this,arguments))}}i.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},i.prototype.next=function(e){return this._invoke("next",e)},i.prototype.throw=function(e){return this._invoke("throw",e)},i.prototype.return=function(e){return this._invoke("return",e)}}}]);